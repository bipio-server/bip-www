(function(){function t(t){function e(e,i,n,r,s,o){for(;s>=0&&o>s;s+=t){var a=r?r[s]:s;n=i(n,e[a],a,e)}return n}return function(i,n,r,s){n=v(n,s,4);var o=!x(i)&&m.keys(i),a=(o||i).length,l=t>0?0:a-1;return arguments.length<3&&(r=i[o?o[l]:l],l+=t),e(i,n,r,o,l,a)}}function e(t){return function(e,i,n){i=b(i,n);for(var r=null!=e&&e.length,s=t>0?0:r-1;s>=0&&r>s;s+=t)if(i(e[s],s,e))return s;return-1}}var i=this,n=i._,r=Array.prototype,s=Object.prototype,o=Function.prototype,a=r.push,l=r.slice,c=s.toString,u=s.hasOwnProperty,h=Array.isArray,d=Object.keys,p=o.bind,f=Object.create,g=function(){},m=function(t){return t instanceof m?t:this instanceof m?void(this._wrapped=t):new m(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=m),exports._=m):i._=m,m.VERSION="1.8.1";var v=function(t,e,i){if(void 0===e)return t;switch(null==i?3:i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,r){return t.call(e,i,n,r)};case 4:return function(i,n,r,s){return t.call(e,i,n,r,s)}}return function(){return t.apply(e,arguments)}},b=function(t,e,i){return null==t?m.identity:m.isFunction(t)?v(t,e,i):m.isObject(t)?m.matcher(t):m.property(t)};m.iteratee=function(t,e){return b(t,e,1/0)};var y=function(t,e){return function(i){var n=arguments.length;if(2>n||null==i)return i;for(var r=1;n>r;r++)for(var s=arguments[r],o=t(s),a=o.length,l=0;a>l;l++){var c=o[l];e&&void 0!==i[c]||(i[c]=s[c])}return i}},_=function(t){if(!m.isObject(t))return{};if(f)return f(t);g.prototype=t;var e=new g;return g.prototype=null,e},w=Math.pow(2,53)-1,x=function(t){var e=t&&t.length;return"number"==typeof e&&e>=0&&w>=e};m.each=m.forEach=function(t,e,i){e=v(e,i);var n,r;if(x(t))for(n=0,r=t.length;r>n;n++)e(t[n],n,t);else{var s=m.keys(t);for(n=0,r=s.length;r>n;n++)e(t[s[n]],s[n],t)}return t},m.map=m.collect=function(t,e,i){e=b(e,i);for(var n=!x(t)&&m.keys(t),r=(n||t).length,s=Array(r),o=0;r>o;o++){var a=n?n[o]:o;s[o]=e(t[a],a,t)}return s},m.reduce=m.foldl=m.inject=t(1),m.reduceRight=m.foldr=t(-1),m.find=m.detect=function(t,e,i){var n;return n=x(t)?m.findIndex(t,e,i):m.findKey(t,e,i),void 0!==n&&-1!==n?t[n]:void 0},m.filter=m.select=function(t,e,i){var n=[];return e=b(e,i),m.each(t,function(t,i,r){e(t,i,r)&&n.push(t)}),n},m.reject=function(t,e,i){return m.filter(t,m.negate(b(e)),i)},m.every=m.all=function(t,e,i){e=b(e,i);for(var n=!x(t)&&m.keys(t),r=(n||t).length,s=0;r>s;s++){var o=n?n[s]:s;if(!e(t[o],o,t))return!1}return!0},m.some=m.any=function(t,e,i){e=b(e,i);for(var n=!x(t)&&m.keys(t),r=(n||t).length,s=0;r>s;s++){var o=n?n[s]:s;if(e(t[o],o,t))return!0}return!1},m.contains=m.includes=m.include=function(t,e){return x(t)||(t=m.values(t)),m.indexOf(t,e)>=0},m.invoke=function(t,e){var i=l.call(arguments,2),n=m.isFunction(e);return m.map(t,function(t){var r=n?e:t[e];return null==r?r:r.apply(t,i)})},m.pluck=function(t,e){return m.map(t,m.property(e))},m.where=function(t,e){return m.filter(t,m.matcher(e))},m.findWhere=function(t,e){return m.find(t,m.matcher(e))},m.max=function(t,e,i){var n,r,s=-1/0,o=-1/0;if(null==e&&null!=t){t=x(t)?t:m.values(t);for(var a=0,l=t.length;l>a;a++)n=t[a],n>s&&(s=n)}else e=b(e,i),m.each(t,function(t,i,n){r=e(t,i,n),(r>o||r===-1/0&&s===-1/0)&&(s=t,o=r)});return s},m.min=function(t,e,i){var n,r,s=1/0,o=1/0;if(null==e&&null!=t){t=x(t)?t:m.values(t);for(var a=0,l=t.length;l>a;a++)n=t[a],s>n&&(s=n)}else e=b(e,i),m.each(t,function(t,i,n){r=e(t,i,n),(o>r||1/0===r&&1/0===s)&&(s=t,o=r)});return s},m.shuffle=function(t){for(var e,i=x(t)?t:m.values(t),n=i.length,r=Array(n),s=0;n>s;s++)e=m.random(0,s),e!==s&&(r[s]=r[e]),r[e]=i[s];return r},m.sample=function(t,e,i){return null==e||i?(x(t)||(t=m.values(t)),t[m.random(t.length-1)]):m.shuffle(t).slice(0,Math.max(0,e))},m.sortBy=function(t,e,i){return e=b(e,i),m.pluck(m.map(t,function(t,i,n){return{value:t,index:i,criteria:e(t,i,n)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return t.index-e.index}),"value")};var k=function(t){return function(e,i,n){var r={};return i=b(i,n),m.each(e,function(n,s){var o=i(n,s,e);t(r,n,o)}),r}};m.groupBy=k(function(t,e,i){m.has(t,i)?t[i].push(e):t[i]=[e]}),m.indexBy=k(function(t,e,i){t[i]=e}),m.countBy=k(function(t,e,i){m.has(t,i)?t[i]++:t[i]=1}),m.toArray=function(t){return t?m.isArray(t)?l.call(t):x(t)?m.map(t,m.identity):m.values(t):[]},m.size=function(t){return null==t?0:x(t)?t.length:m.keys(t).length},m.partition=function(t,e,i){e=b(e,i);var n=[],r=[];return m.each(t,function(t,i,s){(e(t,i,s)?n:r).push(t)}),[n,r]},m.first=m.head=m.take=function(t,e,i){return null==t?void 0:null==e||i?t[0]:m.initial(t,t.length-e)},m.initial=function(t,e,i){return l.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))},m.last=function(t,e,i){return null==t?void 0:null==e||i?t[t.length-1]:m.rest(t,Math.max(0,t.length-e))},m.rest=m.tail=m.drop=function(t,e,i){return l.call(t,null==e||i?1:e)},m.compact=function(t){return m.filter(t,m.identity)};var C=function(t,e,i,n){for(var r=[],s=0,o=n||0,a=t&&t.length;a>o;o++){var l=t[o];if(x(l)&&(m.isArray(l)||m.isArguments(l))){e||(l=C(l,e,i));var c=0,u=l.length;for(r.length+=u;u>c;)r[s++]=l[c++]}else i||(r[s++]=l)}return r};m.flatten=function(t,e){return C(t,e,!1)},m.without=function(t){return m.difference(t,l.call(arguments,1))},m.uniq=m.unique=function(t,e,i,n){if(null==t)return[];m.isBoolean(e)||(n=i,i=e,e=!1),null!=i&&(i=b(i,n));for(var r=[],s=[],o=0,a=t.length;a>o;o++){var l=t[o],c=i?i(l,o,t):l;e?(o&&s===c||r.push(l),s=c):i?m.contains(s,c)||(s.push(c),r.push(l)):m.contains(r,l)||r.push(l)}return r},m.union=function(){return m.uniq(C(arguments,!0,!0))},m.intersection=function(t){if(null==t)return[];for(var e=[],i=arguments.length,n=0,r=t.length;r>n;n++){var s=t[n];if(!m.contains(e,s)){for(var o=1;i>o&&m.contains(arguments[o],s);o++);o===i&&e.push(s)}}return e},m.difference=function(t){var e=C(arguments,!0,!0,1);return m.filter(t,function(t){return!m.contains(e,t)})},m.zip=function(){return m.unzip(arguments)},m.unzip=function(t){for(var e=t&&m.max(t,"length").length||0,i=Array(e),n=0;e>n;n++)i[n]=m.pluck(t,n);return i},m.object=function(t,e){for(var i={},n=0,r=t&&t.length;r>n;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},m.indexOf=function(t,e,i){var n=0,r=t&&t.length;if("number"==typeof i)n=0>i?Math.max(0,r+i):i;else if(i&&r)return n=m.sortedIndex(t,e),t[n]===e?n:-1;if(e!==e)return m.findIndex(l.call(t,n),m.isNaN);for(;r>n;n++)if(t[n]===e)return n;return-1},m.lastIndexOf=function(t,e,i){var n=t?t.length:0;if("number"==typeof i&&(n=0>i?n+i+1:Math.min(n,i+1)),e!==e)return m.findLastIndex(l.call(t,0,n),m.isNaN);for(;--n>=0;)if(t[n]===e)return n;return-1},m.findIndex=e(1),m.findLastIndex=e(-1),m.sortedIndex=function(t,e,i,n){i=b(i,n,1);for(var r=i(e),s=0,o=t.length;o>s;){var a=Math.floor((s+o)/2);i(t[a])<r?s=a+1:o=a}return s},m.range=function(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=i||1;for(var n=Math.max(Math.ceil((e-t)/i),0),r=Array(n),s=0;n>s;s++,t+=i)r[s]=t;return r};var A=function(t,e,i,n,r){if(!(n instanceof e))return t.apply(i,r);var s=_(t.prototype),o=t.apply(s,r);return m.isObject(o)?o:s};m.bind=function(t,e){if(p&&t.bind===p)return p.apply(t,l.call(arguments,1));if(!m.isFunction(t))throw new TypeError("Bind must be called on a function");var i=l.call(arguments,2),n=function(){return A(t,n,e,this,i.concat(l.call(arguments)))};return n},m.partial=function(t){var e=l.call(arguments,1),i=function(){for(var n=0,r=e.length,s=Array(r),o=0;r>o;o++)s[o]=e[o]===m?arguments[n++]:e[o];for(;n<arguments.length;)s.push(arguments[n++]);return A(t,i,this,this,s)};return i},m.bindAll=function(t){var e,i,n=arguments.length;if(1>=n)throw new Error("bindAll must be passed function names");for(e=1;n>e;e++)i=arguments[e],t[i]=m.bind(t[i],t);return t},m.memoize=function(t,e){var i=function(n){var r=i.cache,s=""+(e?e.apply(this,arguments):n);return m.has(r,s)||(r[s]=t.apply(this,arguments)),r[s]};return i.cache={},i},m.delay=function(t,e){var i=l.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},m.defer=m.partial(m.delay,m,1),m.throttle=function(t,e,i){var n,r,s,o=null,a=0;i||(i={});var l=function(){a=i.leading===!1?0:m.now(),o=null,s=t.apply(n,r),o||(n=r=null)};return function(){var c=m.now();a||i.leading!==!1||(a=c);var u=e-(c-a);return n=this,r=arguments,0>=u||u>e?(o&&(clearTimeout(o),o=null),a=c,s=t.apply(n,r),o||(n=r=null)):o||i.trailing===!1||(o=setTimeout(l,u)),s}},m.debounce=function(t,e,i){var n,r,s,o,a,l=function(){var c=m.now()-o;e>c&&c>=0?n=setTimeout(l,e-c):(n=null,i||(a=t.apply(s,r),n||(s=r=null)))};return function(){s=this,r=arguments,o=m.now();var c=i&&!n;return n||(n=setTimeout(l,e)),c&&(a=t.apply(s,r),s=r=null),a}},m.wrap=function(t,e){return m.partial(e,t)},m.negate=function(t){return function(){return!t.apply(this,arguments)}},m.compose=function(){var t=arguments,e=t.length-1;return function(){for(var i=e,n=t[e].apply(this,arguments);i--;)n=t[i].call(this,n);return n}},m.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},m.before=function(t,e){var i;return function(){return--t>0&&(i=e.apply(this,arguments)),1>=t&&(e=null),i}},m.once=m.partial(m.before,2),m.keys=function(t){if(!m.isObject(t))return[];if(d)return d(t);var e=[];for(var i in t)m.has(t,i)&&e.push(i);return e},m.allKeys=function(t){if(!m.isObject(t))return[];var e=[];for(var i in t)e.push(i);return e},m.values=function(t){for(var e=m.keys(t),i=e.length,n=Array(i),r=0;i>r;r++)n[r]=t[e[r]];return n},m.mapObject=function(t,e,i){e=b(e,i);for(var n,r=m.keys(t),s=r.length,o={},a=0;s>a;a++)n=r[a],o[n]=e(t[n],n,t);return o},m.pairs=function(t){for(var e=m.keys(t),i=e.length,n=Array(i),r=0;i>r;r++)n[r]=[e[r],t[e[r]]];return n},m.invert=function(t){for(var e={},i=m.keys(t),n=0,r=i.length;r>n;n++)e[t[i[n]]]=i[n];return e},m.functions=m.methods=function(t){var e=[];for(var i in t)m.isFunction(t[i])&&e.push(i);return e.sort()},m.extend=y(m.allKeys),m.extendOwn=y(m.keys),m.findKey=function(t,e,i){e=b(e,i);for(var n,r=m.keys(t),s=0,o=r.length;o>s;s++)if(n=r[s],e(t[n],n,t))return n},m.pick=function(t,e,i){var n,r={};if(null==t)return r;if(m.isFunction(e)){e=v(e,i);for(var s=m.allKeys(t),o=0;o<s.length;o++){var n=s[o],a=t[n];e(a,n,t)&&(r[n]=a)}}else{var s=C(arguments,!1,!1,1);t=new Object(t);for(var o=0,l=s.length;l>o;o++)n=s[o],n in t&&(r[n]=t[n])}return r},m.omit=function(t,e,i){if(m.isFunction(e))e=m.negate(e);else{var n=m.map(C(arguments,!1,!1,1),String);e=function(t,e){return!m.contains(n,e)}}return m.pick(t,e,i)},m.defaults=y(m.allKeys,!0),m.clone=function(t){return m.isObject(t)?m.isArray(t)?t.slice():m.extend({},t):t},m.tap=function(t,e){return e(t),t},m.isMatch=function(t,e){var i=m.keys(e),n=i.length;if(null==t)return!n;for(var r=Object(t),s=0;n>s;s++){var o=i[s];if(e[o]!==r[o]||!(o in r))return!1}return!0};var T=function(t,e,i,n){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof m&&(t=t._wrapped),e instanceof m&&(e=e._wrapped);var r=c.call(t);if(r!==c.call(e))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var s="[object Array]"===r;if(!s){if("object"!=typeof t||"object"!=typeof e)return!1;var o=t.constructor,a=e.constructor;if(o!==a&&!(m.isFunction(o)&&o instanceof o&&m.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}i=i||[],n=n||[];for(var l=i.length;l--;)if(i[l]===t)return n[l]===e;if(i.push(t),n.push(e),s){if(l=t.length,l!==e.length)return!1;for(;l--;)if(!T(t[l],e[l],i,n))return!1}else{var u,h=m.keys(t);if(l=h.length,m.keys(e).length!==l)return!1;for(;l--;)if(u=h[l],!m.has(e,u)||!T(t[u],e[u],i,n))return!1}return i.pop(),n.pop(),!0};m.isEqual=function(t,e){return T(t,e)},m.isEmpty=function(t){return null==t?!0:x(t)&&(m.isArray(t)||m.isString(t)||m.isArguments(t))?0===t.length:0===m.keys(t).length},m.isElement=function(t){return!(!t||1!==t.nodeType)},m.isArray=h||function(t){return"[object Array]"===c.call(t)},m.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},m.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){m["is"+t]=function(e){return c.call(e)==="[object "+t+"]"}}),m.isArguments(arguments)||(m.isArguments=function(t){return m.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(m.isFunction=function(t){return"function"==typeof t||!1}),m.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},m.isNaN=function(t){return m.isNumber(t)&&t!==+t},m.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===c.call(t)},m.isNull=function(t){return null===t},m.isUndefined=function(t){return void 0===t},m.has=function(t,e){return null!=t&&u.call(t,e)},m.noConflict=function(){return i._=n,this},m.identity=function(t){return t},m.constant=function(t){return function(){return t}},m.noop=function(){},m.property=function(t){return function(e){return null==e?void 0:e[t]}},m.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},m.matcher=m.matches=function(t){return t=m.extendOwn({},t),function(e){return m.isMatch(e,t)}},m.times=function(t,e,i){var n=Array(Math.max(0,t));e=v(e,i,1);for(var r=0;t>r;r++)n[r]=e(r);return n},m.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},m.now=Date.now||function(){return(new Date).getTime()};var S={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},M=m.invert(S),D=function(t){var e=function(e){return t[e]},i="(?:"+m.keys(t).join("|")+")",n=RegExp(i),r=RegExp(i,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(r,e):t}};m.escape=D(S),m.unescape=D(M),m.result=function(t,e,i){var n=null==t?void 0:t[e];return void 0===n&&(n=i),m.isFunction(n)?n.call(t):n};var $=0;m.uniqueId=function(t){var e=++$+"";return t?t+e:e},m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var E=/(.)^/,P={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},I=/\\|'|\r|\n|\u2028|\u2029/g,N=function(t){return"\\"+P[t]};m.template=function(t,e,i){!e&&i&&(e=i),e=m.defaults({},e,m.templateSettings);var n=RegExp([(e.escape||E).source,(e.interpolate||E).source,(e.evaluate||E).source].join("|")+"|$","g"),r=0,s="__p+='";t.replace(n,function(e,i,n,o,a){return s+=t.slice(r,a).replace(I,N),r=a+e.length,i?s+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?s+="'+\n((__t=("+n+"))==null?'':__t)+\n'":o&&(s+="';\n"+o+"\n__p+='"),e}),s+="';\n",e.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var o=new Function(e.variable||"obj","_",s)}catch(a){throw a.source=s,a}var l=function(t){return o.call(this,t,m)},c=e.variable||"obj";return l.source="function("+c+"){\n"+s+"}",l},m.chain=function(t){var e=m(t);return e._chain=!0,e};var F=function(t,e){return t._chain?m(e).chain():e};m.mixin=function(t){m.each(m.functions(t),function(e){var i=m[e]=t[e];m.prototype[e]=function(){var t=[this._wrapped];return a.apply(t,arguments),F(this,i.apply(m,t))}})},m.mixin(m),m.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=r[t];m.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!==t&&"splice"!==t||0!==i.length||delete i[0],F(this,i)}}),m.each(["concat","join","slice"],function(t){var e=r[t];m.prototype[t]=function(){return F(this,e.apply(this._wrapped,arguments))}}),m.prototype.value=function(){return this._wrapped},m.prototype.valueOf=m.prototype.toJSON=m.prototype.value,m.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return m})}).call(this),function(t,e){"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(t,e){function i(t){var e=t.length,i=re.type(t);return"function"===i||re.isWindow(t)?!1:1===t.nodeType&&e?!0:"array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t}function n(t,e,i){if(re.isFunction(e))return re.grep(t,function(t,n){return!!e.call(t,n,t)!==i});if(e.nodeType)return re.grep(t,function(t){return t===e!==i});if("string"==typeof e){if(de.test(e))return re.filter(e,t,i);e=re.filter(e,t)}return re.grep(t,function(t){return re.inArray(t,e)>=0!==i})}function r(t,e){do t=t[e];while(t&&1!==t.nodeType);return t}function s(t){var e=_e[t]={};return re.each(t.match(ye)||[],function(t,i){e[i]=!0}),e}function o(){fe.addEventListener?(fe.removeEventListener("DOMContentLoaded",a,!1),t.removeEventListener("load",a,!1)):(fe.detachEvent("onreadystatechange",a),t.detachEvent("onload",a))}function a(){(fe.addEventListener||"load"===event.type||"complete"===fe.readyState)&&(o(),re.ready())}function l(t,e,i){if(void 0===i&&1===t.nodeType){var n="data-"+e.replace(Ae,"-$1").toLowerCase();if(i=t.getAttribute(n),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:Ce.test(i)?re.parseJSON(i):i}catch(r){}re.data(t,e,i)}else i=void 0}return i}function c(t){var e;for(e in t)if(("data"!==e||!re.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function u(t,e,i,n){if(re.acceptData(t)){var r,s,o=re.expando,a=t.nodeType,l=a?re.cache:t,c=a?t[o]:t[o]&&o;if(c&&l[c]&&(n||l[c].data)||void 0!==i||"string"!=typeof e)return c||(c=a?t[o]=G.pop()||re.guid++:o),l[c]||(l[c]=a?{}:{toJSON:re.noop}),("object"==typeof e||"function"==typeof e)&&(n?l[c]=re.extend(l[c],e):l[c].data=re.extend(l[c].data,e)),s=l[c],n||(s.data||(s.data={}),s=s.data),void 0!==i&&(s[re.camelCase(e)]=i),"string"==typeof e?(r=s[e],null==r&&(r=s[re.camelCase(e)])):r=s,r}}function h(t,e,i){if(re.acceptData(t)){var n,r,s=t.nodeType,o=s?re.cache:t,a=s?t[re.expando]:re.expando;if(o[a]){if(e&&(n=i?o[a]:o[a].data)){re.isArray(e)?e=e.concat(re.map(e,re.camelCase)):e in n?e=[e]:(e=re.camelCase(e),e=e in n?[e]:e.split(" ")),r=e.length;for(;r--;)delete n[e[r]];if(i?!c(n):!re.isEmptyObject(n))return}(i||(delete o[a].data,c(o[a])))&&(s?re.cleanData([t],!0):ie.deleteExpando||o!=o.window?delete o[a]:o[a]=null)}}}function d(){return!0}function p(){return!1}function f(){try{return fe.activeElement}catch(t){}}function g(t){var e=Oe.split("|"),i=t.createDocumentFragment();if(i.createElement)for(;e.length;)i.createElement(e.pop());return i}function m(t,e){var i,n,r=0,s=typeof t.getElementsByTagName!==ke?t.getElementsByTagName(e||"*"):typeof t.querySelectorAll!==ke?t.querySelectorAll(e||"*"):void 0;if(!s)for(s=[],i=t.childNodes||t;null!=(n=i[r]);r++)!e||re.nodeName(n,e)?s.push(n):re.merge(s,m(n,e));return void 0===e||e&&re.nodeName(t,e)?re.merge([t],s):s}function v(t){$e.test(t.type)&&(t.defaultChecked=t.checked)}function b(t,e){return re.nodeName(t,"table")&&re.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function y(t){return t.type=(null!==re.find.attr(t,"type"))+"/"+t.type,t}function _(t){var e=Ye.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function w(t,e){for(var i,n=0;null!=(i=t[n]);n++)re._data(i,"globalEval",!e||re._data(e[n],"globalEval"))}function x(t,e){if(1===e.nodeType&&re.hasData(t)){var i,n,r,s=re._data(t),o=re._data(e,s),a=s.events;if(a){delete o.handle,o.events={};for(i in a)for(n=0,r=a[i].length;r>n;n++)re.event.add(e,i,a[i][n])}o.data&&(o.data=re.extend({},o.data))}}function k(t,e){var i,n,r;if(1===e.nodeType){if(i=e.nodeName.toLowerCase(),!ie.noCloneEvent&&e[re.expando]){r=re._data(e);for(n in r.events)re.removeEvent(e,n,r.handle);e.removeAttribute(re.expando)}"script"===i&&e.text!==t.text?(y(e).text=t.text,_(e)):"object"===i?(e.parentNode&&(e.outerHTML=t.outerHTML),ie.html5Clone&&t.innerHTML&&!re.trim(e.innerHTML)&&(e.innerHTML=t.innerHTML)):"input"===i&&$e.test(t.type)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===i?e.defaultSelected=e.selected=t.defaultSelected:("input"===i||"textarea"===i)&&(e.defaultValue=t.defaultValue)}}function C(e,i){var n,r=re(i.createElement(e)).appendTo(i.body),s=t.getDefaultComputedStyle&&(n=t.getDefaultComputedStyle(r[0]))?n.display:re.css(r[0],"display");return r.detach(),s}function A(t){var e=fe,i=Ze[t];return i||(i=C(t,e),"none"!==i&&i||(Qe=(Qe||re("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement),e=(Qe[0].contentWindow||Qe[0].contentDocument).document,e.write(),e.close(),i=C(t,e),Qe.detach()),Ze[t]=i),i}function T(t,e){return{get:function(){var i=t();if(null!=i)return i?void delete this.get:(this.get=e).apply(this,arguments)}}}function S(t,e){if(e in t)return e;for(var i=e.charAt(0).toUpperCase()+e.slice(1),n=e,r=di.length;r--;)if(e=di[r]+i,e in t)return e;return n}function M(t,e){for(var i,n,r,s=[],o=0,a=t.length;a>o;o++)n=t[o],n.style&&(s[o]=re._data(n,"olddisplay"),i=n.style.display,e?(s[o]||"none"!==i||(n.style.display=""),""===n.style.display&&Me(n)&&(s[o]=re._data(n,"olddisplay",A(n.nodeName)))):(r=Me(n),(i&&"none"!==i||!r)&&re._data(n,"olddisplay",r?i:re.css(n,"display"))));for(o=0;a>o;o++)n=t[o],n.style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?s[o]||"":"none"));return t}function D(t,e,i){var n=li.exec(e);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):e}function $(t,e,i,n,r){for(var s=i===(n?"border":"content")?4:"width"===e?1:0,o=0;4>s;s+=2)"margin"===i&&(o+=re.css(t,i+Se[s],!0,r)),n?("content"===i&&(o-=re.css(t,"padding"+Se[s],!0,r)),"margin"!==i&&(o-=re.css(t,"border"+Se[s]+"Width",!0,r))):(o+=re.css(t,"padding"+Se[s],!0,r),"padding"!==i&&(o+=re.css(t,"border"+Se[s]+"Width",!0,r)));return o}function E(t,e,i){var n=!0,r="width"===e?t.offsetWidth:t.offsetHeight,s=ti(t),o=ie.boxSizing&&"border-box"===re.css(t,"boxSizing",!1,s);if(0>=r||null==r){if(r=ei(t,e,s),(0>r||null==r)&&(r=t.style[e]),ni.test(r))return r;n=o&&(ie.boxSizingReliable()||r===t.style[e]),r=parseFloat(r)||0}return r+$(t,e,i||(o?"border":"content"),n,s)+"px"}function P(t,e,i,n,r){return new P.prototype.init(t,e,i,n,r)}function I(){return setTimeout(function(){pi=void 0}),pi=re.now()}function N(t,e){var i,n={height:t},r=0;for(e=e?1:0;4>r;r+=2-e)i=Se[r],n["margin"+i]=n["padding"+i]=t;return e&&(n.opacity=n.width=t),n}function F(t,e,i){for(var n,r=(yi[e]||[]).concat(yi["*"]),s=0,o=r.length;o>s;s++)if(n=r[s].call(i,e,t))return n}function O(t,e,i){var n,r,s,o,a,l,c,u,h=this,d={},p=t.style,f=t.nodeType&&Me(t),g=re._data(t,"fxshow");i.queue||(a=re._queueHooks(t,"fx"),null==a.unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,h.always(function(){h.always(function(){a.unqueued--,re.queue(t,"fx").length||a.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],c=re.css(t,"display"),u="none"===c?re._data(t,"olddisplay")||A(t.nodeName):c,"inline"===u&&"none"===re.css(t,"float")&&(ie.inlineBlockNeedsLayout&&"inline"!==A(t.nodeName)?p.zoom=1:p.display="inline-block")),i.overflow&&(p.overflow="hidden",ie.shrinkWrapBlocks()||h.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(n in e)if(r=e[n],gi.exec(r)){if(delete e[n],s=s||"toggle"===r,r===(f?"hide":"show")){if("show"!==r||!g||void 0===g[n])continue;f=!0}d[n]=g&&g[n]||re.style(t,n)}else c=void 0;if(re.isEmptyObject(d))"inline"===("none"===c?A(t.nodeName):c)&&(p.display=c);else{g?"hidden"in g&&(f=g.hidden):g=re._data(t,"fxshow",{}),s&&(g.hidden=!f),f?re(t).show():h.done(function(){re(t).hide()}),h.done(function(){var e;re._removeData(t,"fxshow");for(e in d)re.style(t,e,d[e])});for(n in d)o=F(f?g[n]:0,n,h),n in g||(g[n]=o.start,f&&(o.end=o.start,o.start="width"===n||"height"===n?1:0))}}function B(t,e){var i,n,r,s,o;for(i in t)if(n=re.camelCase(i),r=e[n],s=t[i],re.isArray(s)&&(r=s[1],s=t[i]=s[0]),i!==n&&(t[n]=s,delete t[i]),o=re.cssHooks[n],o&&"expand"in o){s=o.expand(s),delete t[n];for(i in s)i in t||(t[i]=s[i],e[i]=r)}else e[n]=r}function z(t,e,i){var n,r,s=0,o=bi.length,a=re.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var e=pi||I(),i=Math.max(0,c.startTime+c.duration-e),n=i/c.duration||0,s=1-n,o=0,l=c.tweens.length;l>o;o++)c.tweens[o].run(s);return a.notifyWith(t,[c,s,i]),1>s&&l?i:(a.resolveWith(t,[c]),!1)},c=a.promise({elem:t,props:re.extend({},e),opts:re.extend(!0,{specialEasing:{}},i),originalProperties:e,originalOptions:i,startTime:pi||I(),duration:i.duration,tweens:[],createTween:function(e,i){var n=re.Tween(t,c.opts,e,i,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(n),n},stop:function(e){var i=0,n=e?c.tweens.length:0;if(r)return this;for(r=!0;n>i;i++)c.tweens[i].run(1);return e?a.resolveWith(t,[c,e]):a.rejectWith(t,[c,e]),this}}),u=c.props;for(B(u,c.opts.specialEasing);o>s;s++)if(n=bi[s].call(c,t,u,c.opts))return n;return re.map(u,F,c),re.isFunction(c.opts.start)&&c.opts.start.call(t,c),re.fx.timer(re.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function R(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,r=0,s=e.toLowerCase().match(ye)||[];if(re.isFunction(i))for(;n=s[r++];)"+"===n.charAt(0)?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function L(t,e,i,n){function r(a){var l;return s[a]=!0,re.each(t[a]||[],function(t,a){var c=a(e,i,n);return"string"!=typeof c||o||s[c]?o?!(l=c):void 0:(e.dataTypes.unshift(c),r(c),!1)}),l}var s={},o=t===ji;return r(e.dataTypes[0])||!s["*"]&&r("*")}function H(t,e){var i,n,r=re.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:i||(i={}))[n]=e[n]);return i&&re.extend(!0,t,i),t}function W(t,e,i){for(var n,r,s,o,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===r&&(r=t.mimeType||e.getResponseHeader("Content-Type"));if(r)for(o in a)if(a[o]&&a[o].test(r)){l.unshift(o);break}if(l[0]in i)s=l[0];else{for(o in i){if(!l[0]||t.converters[o+" "+l[0]]){s=o;break}n||(n=o)}s=s||n}return s?(s!==l[0]&&l.unshift(s),i[s]):void 0}function j(t,e,i,n){var r,s,o,a,l,c={},u=t.dataTypes.slice();if(u[1])for(o in t.converters)c[o.toLowerCase()]=t.converters[o];for(s=u.shift();s;)if(t.responseFields[s]&&(i[t.responseFields[s]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=s,s=u.shift())if("*"===s)s=l;else if("*"!==l&&l!==s){if(o=c[l+" "+s]||c["* "+s],!o)for(r in c)if(a=r.split(" "),a[1]===s&&(o=c[l+" "+a[0]]||c["* "+a[0]])){o===!0?o=c[r]:c[r]!==!0&&(s=a[0],u.unshift(a[1]));break}if(o!==!0)if(o&&t["throws"])e=o(e);else try{e=o(e)}catch(h){return{state:"parsererror",error:o?h:"No conversion from "+l+" to "+s}}}return{state:"success",data:e}}function q(t,e,i,n){var r;if(re.isArray(e))re.each(e,function(e,r){i||Yi.test(t)?n(t,r):q(t+"["+("object"==typeof r?e:"")+"]",r,i,n)});else if(i||"object"!==re.type(e))n(t,e);else for(r in e)q(t+"["+r+"]",e[r],i,n)}function V(){try{return new t.XMLHttpRequest}catch(e){}}function U(){try{return new t.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function Y(t){return re.isWindow(t)?t:9===t.nodeType?t.defaultView||t.parentWindow:!1}var G=[],K=G.slice,J=G.concat,X=G.push,Q=G.indexOf,Z={},te=Z.toString,ee=Z.hasOwnProperty,ie={},ne="1.11.2",re=function(t,e){return new re.fn.init(t,e)},se=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,oe=/^-ms-/,ae=/-([\da-z])/gi,le=function(t,e){return e.toUpperCase()};re.fn=re.prototype={jquery:ne,constructor:re,selector:"",length:0,toArray:function(){return K.call(this)},get:function(t){return null!=t?0>t?this[t+this.length]:this[t]:K.call(this)},pushStack:function(t){var e=re.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return re.each(this,t,e)},map:function(t){return this.pushStack(re.map(this,function(e,i){return t.call(e,i,e)}))},slice:function(){return this.pushStack(K.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(0>t?e:0);return this.pushStack(i>=0&&e>i?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:X,sort:G.sort,splice:G.splice},re.extend=re.fn.extend=function(){var t,e,i,n,r,s,o=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof o&&(c=o,o=arguments[a]||{},a++),"object"==typeof o||re.isFunction(o)||(o={}),a===l&&(o=this,a--);l>a;a++)if(null!=(r=arguments[a]))for(n in r)t=o[n],i=r[n],o!==i&&(c&&i&&(re.isPlainObject(i)||(e=re.isArray(i)))?(e?(e=!1,s=t&&re.isArray(t)?t:[]):s=t&&re.isPlainObject(t)?t:{},o[n]=re.extend(c,s,i)):void 0!==i&&(o[n]=i));return o},re.extend({expando:"jQuery"+(ne+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===re.type(t)},isArray:Array.isArray||function(t){return"array"===re.type(t)},isWindow:function(t){return null!=t&&t==t.window},isNumeric:function(t){return!re.isArray(t)&&t-parseFloat(t)+1>=0},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},isPlainObject:function(t){var e;if(!t||"object"!==re.type(t)||t.nodeType||re.isWindow(t))return!1;try{if(t.constructor&&!ee.call(t,"constructor")&&!ee.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}if(ie.ownLast)for(e in t)return ee.call(t,e);for(e in t);return void 0===e||ee.call(t,e)},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?Z[te.call(t)]||"object":typeof t},globalEval:function(e){e&&re.trim(e)&&(t.execScript||function(e){t.eval.call(t,e)})(e)},camelCase:function(t){return t.replace(oe,"ms-").replace(ae,le)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,n){var r,s=0,o=t.length,a=i(t);if(n){if(a)for(;o>s&&(r=e.apply(t[s],n),r!==!1);s++);else for(s in t)if(r=e.apply(t[s],n),r===!1)break}else if(a)for(;o>s&&(r=e.call(t[s],s,t[s]),r!==!1);s++);else for(s in t)if(r=e.call(t[s],s,t[s]),r===!1)break;return t},trim:function(t){return null==t?"":(t+"").replace(se,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(i(Object(t))?re.merge(n,"string"==typeof t?[t]:t):X.call(n,t)),n},inArray:function(t,e,i){var n;if(e){if(Q)return Q.call(e,t,i);for(n=e.length,i=i?0>i?Math.max(0,n+i):i:0;n>i;i++)if(i in e&&e[i]===t)return i}return-1},merge:function(t,e){for(var i=+e.length,n=0,r=t.length;i>n;)t[r++]=e[n++];if(i!==i)for(;void 0!==e[n];)t[r++]=e[n++];return t.length=r,t},grep:function(t,e,i){for(var n,r=[],s=0,o=t.length,a=!i;o>s;s++)n=!e(t[s],s),n!==a&&r.push(t[s]);return r},map:function(t,e,n){var r,s=0,o=t.length,a=i(t),l=[];if(a)for(;o>s;s++)r=e(t[s],s,n),null!=r&&l.push(r);else for(s in t)r=e(t[s],s,n),null!=r&&l.push(r);return J.apply([],l)},guid:1,proxy:function(t,e){var i,n,r;return"string"==typeof e&&(r=t[e],e=t,t=r),re.isFunction(t)?(i=K.call(arguments,2),n=function(){return t.apply(e||this,i.concat(K.call(arguments)))},n.guid=t.guid=t.guid||re.guid++,n):void 0},now:function(){return+new Date},support:ie}),re.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){Z["[object "+e+"]"]=e.toLowerCase()});var ce=function(t){function e(t,e,i,n){var r,s,o,a,l,c,h,p,f,g;if((e?e.ownerDocument||e:L)!==P&&E(e),e=e||P,i=i||[],a=e.nodeType,"string"!=typeof t||!t||1!==a&&9!==a&&11!==a)return i;if(!n&&N){if(11!==a&&(r=be.exec(t)))if(o=r[1]){if(9===a){if(s=e.getElementById(o),!s||!s.parentNode)return i;if(s.id===o)return i.push(s),i}else if(e.ownerDocument&&(s=e.ownerDocument.getElementById(o))&&z(e,s)&&s.id===o)return i.push(s),i}else{if(r[2])return Q.apply(i,e.getElementsByTagName(t)),i;if((o=r[3])&&w.getElementsByClassName)return Q.apply(i,e.getElementsByClassName(o)),i}if(w.qsa&&(!F||!F.test(t))){if(p=h=R,f=e,g=1!==a&&t,1===a&&"object"!==e.nodeName.toLowerCase()){for(c=A(t),(h=e.getAttribute("id"))?p=h.replace(_e,"\\$&"):e.setAttribute("id",p),p="[id='"+p+"'] ",l=c.length;l--;)c[l]=p+d(c[l]);
f=ye.test(t)&&u(e.parentNode)||e,g=c.join(",")}if(g)try{return Q.apply(i,f.querySelectorAll(g)),i}catch(m){}finally{h||e.removeAttribute("id")}}}return S(t.replace(le,"$1"),e,i,n)}function i(){function t(i,n){return e.push(i+" ")>x.cacheLength&&delete t[e.shift()],t[i+" "]=n}var e=[];return t}function n(t){return t[R]=!0,t}function r(t){var e=P.createElement("div");try{return!!t(e)}catch(i){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function s(t,e){for(var i=t.split("|"),n=t.length;n--;)x.attrHandle[i[n]]=e}function o(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||Y)-(~t.sourceIndex||Y);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function a(t){return function(e){var i=e.nodeName.toLowerCase();return"input"===i&&e.type===t}}function l(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function c(t){return n(function(e){return e=+e,n(function(i,n){for(var r,s=t([],i.length,e),o=s.length;o--;)i[r=s[o]]&&(i[r]=!(n[r]=i[r]))})})}function u(t){return t&&"undefined"!=typeof t.getElementsByTagName&&t}function h(){}function d(t){for(var e=0,i=t.length,n="";i>e;e++)n+=t[e].value;return n}function p(t,e,i){var n=e.dir,r=i&&"parentNode"===n,s=W++;return e.first?function(e,i,s){for(;e=e[n];)if(1===e.nodeType||r)return t(e,i,s)}:function(e,i,o){var a,l,c=[H,s];if(o){for(;e=e[n];)if((1===e.nodeType||r)&&t(e,i,o))return!0}else for(;e=e[n];)if(1===e.nodeType||r){if(l=e[R]||(e[R]={}),(a=l[n])&&a[0]===H&&a[1]===s)return c[2]=a[2];if(l[n]=c,c[2]=t(e,i,o))return!0}}}function f(t){return t.length>1?function(e,i,n){for(var r=t.length;r--;)if(!t[r](e,i,n))return!1;return!0}:t[0]}function g(t,i,n){for(var r=0,s=i.length;s>r;r++)e(t,i[r],n);return n}function m(t,e,i,n,r){for(var s,o=[],a=0,l=t.length,c=null!=e;l>a;a++)(s=t[a])&&(!i||i(s,n,r))&&(o.push(s),c&&e.push(a));return o}function v(t,e,i,r,s,o){return r&&!r[R]&&(r=v(r)),s&&!s[R]&&(s=v(s,o)),n(function(n,o,a,l){var c,u,h,d=[],p=[],f=o.length,v=n||g(e||"*",a.nodeType?[a]:a,[]),b=!t||!n&&e?v:m(v,d,t,a,l),y=i?s||(n?t:f||r)?[]:o:b;if(i&&i(b,y,a,l),r)for(c=m(y,p),r(c,[],a,l),u=c.length;u--;)(h=c[u])&&(y[p[u]]=!(b[p[u]]=h));if(n){if(s||t){if(s){for(c=[],u=y.length;u--;)(h=y[u])&&c.push(b[u]=h);s(null,y=[],c,l)}for(u=y.length;u--;)(h=y[u])&&(c=s?te(n,h):d[u])>-1&&(n[c]=!(o[c]=h))}}else y=m(y===o?y.splice(f,y.length):y),s?s(null,o,y,l):Q.apply(o,y)})}function b(t){for(var e,i,n,r=t.length,s=x.relative[t[0].type],o=s||x.relative[" "],a=s?1:0,l=p(function(t){return t===e},o,!0),c=p(function(t){return te(e,t)>-1},o,!0),u=[function(t,i,n){var r=!s&&(n||i!==M)||((e=i).nodeType?l(t,i,n):c(t,i,n));return e=null,r}];r>a;a++)if(i=x.relative[t[a].type])u=[p(f(u),i)];else{if(i=x.filter[t[a].type].apply(null,t[a].matches),i[R]){for(n=++a;r>n&&!x.relative[t[n].type];n++);return v(a>1&&f(u),a>1&&d(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(le,"$1"),i,n>a&&b(t.slice(a,n)),r>n&&b(t=t.slice(n)),r>n&&d(t))}u.push(i)}return f(u)}function y(t,i){var r=i.length>0,s=t.length>0,o=function(n,o,a,l,c){var u,h,d,p=0,f="0",g=n&&[],v=[],b=M,y=n||s&&x.find.TAG("*",c),_=H+=null==b?1:Math.random()||.1,w=y.length;for(c&&(M=o!==P&&o);f!==w&&null!=(u=y[f]);f++){if(s&&u){for(h=0;d=t[h++];)if(d(u,o,a)){l.push(u);break}c&&(H=_)}r&&((u=!d&&u)&&p--,n&&g.push(u))}if(p+=f,r&&f!==p){for(h=0;d=i[h++];)d(g,v,o,a);if(n){if(p>0)for(;f--;)g[f]||v[f]||(v[f]=J.call(l));v=m(v)}Q.apply(l,v),c&&!n&&v.length>0&&p+i.length>1&&e.uniqueSort(l)}return c&&(H=_,M=b),g};return r?n(o):o}var _,w,x,k,C,A,T,S,M,D,$,E,P,I,N,F,O,B,z,R="sizzle"+1*new Date,L=t.document,H=0,W=0,j=i(),q=i(),V=i(),U=function(t,e){return t===e&&($=!0),0},Y=1<<31,G={}.hasOwnProperty,K=[],J=K.pop,X=K.push,Q=K.push,Z=K.slice,te=function(t,e){for(var i=0,n=t.length;n>i;i++)if(t[i]===e)return i;return-1},ee="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ie="[\\x20\\t\\r\\n\\f]",ne="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",re=ne.replace("w","w#"),se="\\["+ie+"*("+ne+")(?:"+ie+"*([*^$|!~]?=)"+ie+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+re+"))|)"+ie+"*\\]",oe=":("+ne+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+se+")*)|.*)\\)|)",ae=new RegExp(ie+"+","g"),le=new RegExp("^"+ie+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ie+"+$","g"),ce=new RegExp("^"+ie+"*,"+ie+"*"),ue=new RegExp("^"+ie+"*([>+~]|"+ie+")"+ie+"*"),he=new RegExp("="+ie+"*([^\\]'\"]*?)"+ie+"*\\]","g"),de=new RegExp(oe),pe=new RegExp("^"+re+"$"),fe={ID:new RegExp("^#("+ne+")"),CLASS:new RegExp("^\\.("+ne+")"),TAG:new RegExp("^("+ne.replace("w","w*")+")"),ATTR:new RegExp("^"+se),PSEUDO:new RegExp("^"+oe),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ie+"*(even|odd|(([+-]|)(\\d*)n|)"+ie+"*(?:([+-]|)"+ie+"*(\\d+)|))"+ie+"*\\)|)","i"),bool:new RegExp("^(?:"+ee+")$","i"),needsContext:new RegExp("^"+ie+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ie+"*((?:-\\d)?\\d*)"+ie+"*\\)|)(?=[^-]|$)","i")},ge=/^(?:input|select|textarea|button)$/i,me=/^h\d$/i,ve=/^[^{]+\{\s*\[native \w/,be=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ye=/[+~]/,_e=/'|\\/g,we=new RegExp("\\\\([\\da-f]{1,6}"+ie+"?|("+ie+")|.)","ig"),xe=function(t,e,i){var n="0x"+e-65536;return n!==n||i?e:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},ke=function(){E()};try{Q.apply(K=Z.call(L.childNodes),L.childNodes),K[L.childNodes.length].nodeType}catch(Ce){Q={apply:K.length?function(t,e){X.apply(t,Z.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}w=e.support={},C=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return e?"HTML"!==e.nodeName:!1},E=e.setDocument=function(t){var e,i,n=t?t.ownerDocument||t:L;return n!==P&&9===n.nodeType&&n.documentElement?(P=n,I=n.documentElement,i=n.defaultView,i&&i!==i.top&&(i.addEventListener?i.addEventListener("unload",ke,!1):i.attachEvent&&i.attachEvent("onunload",ke)),N=!C(n),w.attributes=r(function(t){return t.className="i",!t.getAttribute("className")}),w.getElementsByTagName=r(function(t){return t.appendChild(n.createComment("")),!t.getElementsByTagName("*").length}),w.getElementsByClassName=ve.test(n.getElementsByClassName),w.getById=r(function(t){return I.appendChild(t).id=R,!n.getElementsByName||!n.getElementsByName(R).length}),w.getById?(x.find.ID=function(t,e){if("undefined"!=typeof e.getElementById&&N){var i=e.getElementById(t);return i&&i.parentNode?[i]:[]}},x.filter.ID=function(t){var e=t.replace(we,xe);return function(t){return t.getAttribute("id")===e}}):(delete x.find.ID,x.filter.ID=function(t){var e=t.replace(we,xe);return function(t){var i="undefined"!=typeof t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}}),x.find.TAG=w.getElementsByTagName?function(t,e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t):w.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,n=[],r=0,s=e.getElementsByTagName(t);if("*"===t){for(;i=s[r++];)1===i.nodeType&&n.push(i);return n}return s},x.find.CLASS=w.getElementsByClassName&&function(t,e){return N?e.getElementsByClassName(t):void 0},O=[],F=[],(w.qsa=ve.test(n.querySelectorAll))&&(r(function(t){I.appendChild(t).innerHTML="<a id='"+R+"'></a><select id='"+R+"-\f]' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&F.push("[*^$]="+ie+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||F.push("\\["+ie+"*(?:value|"+ee+")"),t.querySelectorAll("[id~="+R+"-]").length||F.push("~="),t.querySelectorAll(":checked").length||F.push(":checked"),t.querySelectorAll("a#"+R+"+*").length||F.push(".#.+[+~]")}),r(function(t){var e=n.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&F.push("name"+ie+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||F.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),F.push(",.*:")})),(w.matchesSelector=ve.test(B=I.matches||I.webkitMatchesSelector||I.mozMatchesSelector||I.oMatchesSelector||I.msMatchesSelector))&&r(function(t){w.disconnectedMatch=B.call(t,"div"),B.call(t,"[s!='']:x"),O.push("!=",oe)}),F=F.length&&new RegExp(F.join("|")),O=O.length&&new RegExp(O.join("|")),e=ve.test(I.compareDocumentPosition),z=e||ve.test(I.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},U=e?function(t,e){if(t===e)return $=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i?i:(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&i||!w.sortDetached&&e.compareDocumentPosition(t)===i?t===n||t.ownerDocument===L&&z(L,t)?-1:e===n||e.ownerDocument===L&&z(L,e)?1:D?te(D,t)-te(D,e):0:4&i?-1:1)}:function(t,e){if(t===e)return $=!0,0;var i,r=0,s=t.parentNode,a=e.parentNode,l=[t],c=[e];if(!s||!a)return t===n?-1:e===n?1:s?-1:a?1:D?te(D,t)-te(D,e):0;if(s===a)return o(t,e);for(i=t;i=i.parentNode;)l.unshift(i);for(i=e;i=i.parentNode;)c.unshift(i);for(;l[r]===c[r];)r++;return r?o(l[r],c[r]):l[r]===L?-1:c[r]===L?1:0},n):P},e.matches=function(t,i){return e(t,null,null,i)},e.matchesSelector=function(t,i){if((t.ownerDocument||t)!==P&&E(t),i=i.replace(he,"='$1']"),!(!w.matchesSelector||!N||O&&O.test(i)||F&&F.test(i)))try{var n=B.call(t,i);if(n||w.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(r){}return e(i,P,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==P&&E(t),z(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==P&&E(t);var i=x.attrHandle[e.toLowerCase()],n=i&&G.call(x.attrHandle,e.toLowerCase())?i(t,e,!N):void 0;return void 0!==n?n:w.attributes||!N?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,i=[],n=0,r=0;if($=!w.detectDuplicates,D=!w.sortStable&&t.slice(0),t.sort(U),$){for(;e=t[r++];)e===t[r]&&(n=i.push(r));for(;n--;)t.splice(i[n],1)}return D=null,t},k=e.getText=function(t){var e,i="",n=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=k(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[n++];)i+=k(e);return i},x=e.selectors={cacheLength:50,createPseudo:n,match:fe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(we,xe),t[3]=(t[3]||t[4]||t[5]||"").replace(we,xe),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return fe.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&de.test(i)&&(e=A(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(we,xe).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=j[t+" "];return e||(e=new RegExp("(^|"+ie+")"+t+"("+ie+"|$)"))&&j(t,function(t){return e.test("string"==typeof t.className&&t.className||"undefined"!=typeof t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,i,n){return function(r){var s=e.attr(r,t);return null==s?"!="===i:i?(s+="","="===i?s===n:"!="===i?s!==n:"^="===i?n&&0===s.indexOf(n):"*="===i?n&&s.indexOf(n)>-1:"$="===i?n&&s.slice(-n.length)===n:"~="===i?(" "+s.replace(ae," ")+" ").indexOf(n)>-1:"|="===i?s===n||s.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(t,e,i,n,r){var s="nth"!==t.slice(0,3),o="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===r?function(t){return!!t.parentNode}:function(e,i,l){var c,u,h,d,p,f,g=s!==o?"nextSibling":"previousSibling",m=e.parentNode,v=a&&e.nodeName.toLowerCase(),b=!l&&!a;if(m){if(s){for(;g;){for(h=e;h=h[g];)if(a?h.nodeName.toLowerCase()===v:1===h.nodeType)return!1;f=g="only"===t&&!f&&"nextSibling"}return!0}if(f=[o?m.firstChild:m.lastChild],o&&b){for(u=m[R]||(m[R]={}),c=u[t]||[],p=c[0]===H&&c[1],d=c[0]===H&&c[2],h=p&&m.childNodes[p];h=++p&&h&&h[g]||(d=p=0)||f.pop();)if(1===h.nodeType&&++d&&h===e){u[t]=[H,p,d];break}}else if(b&&(c=(e[R]||(e[R]={}))[t])&&c[0]===H)d=c[1];else for(;(h=++p&&h&&h[g]||(d=p=0)||f.pop())&&((a?h.nodeName.toLowerCase()!==v:1!==h.nodeType)||!++d||(b&&((h[R]||(h[R]={}))[t]=[H,d]),h!==e)););return d-=r,d===n||d%n===0&&d/n>=0}}},PSEUDO:function(t,i){var r,s=x.pseudos[t]||x.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return s[R]?s(i):s.length>1?(r=[t,t,"",i],x.setFilters.hasOwnProperty(t.toLowerCase())?n(function(t,e){for(var n,r=s(t,i),o=r.length;o--;)n=te(t,r[o]),t[n]=!(e[n]=r[o])}):function(t){return s(t,0,r)}):s}},pseudos:{not:n(function(t){var e=[],i=[],r=T(t.replace(le,"$1"));return r[R]?n(function(t,e,i,n){for(var s,o=r(t,null,n,[]),a=t.length;a--;)(s=o[a])&&(t[a]=!(e[a]=s))}):function(t,n,s){return e[0]=t,r(e,null,s,i),e[0]=null,!i.pop()}}),has:n(function(t){return function(i){return e(t,i).length>0}}),contains:n(function(t){return t=t.replace(we,xe),function(e){return(e.textContent||e.innerText||k(e)).indexOf(t)>-1}}),lang:n(function(t){return pe.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(we,xe).toLowerCase(),function(e){var i;do if(i=N?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return i=i.toLowerCase(),i===t||0===i.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===I},focus:function(t){return t===P.activeElement&&(!P.hasFocus||P.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!x.pseudos.empty(t)},header:function(t){return me.test(t.nodeName)},input:function(t){return ge.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:c(function(){return[0]}),last:c(function(t,e){return[e-1]}),eq:c(function(t,e,i){return[0>i?i+e:i]}),even:c(function(t,e){for(var i=0;e>i;i+=2)t.push(i);return t}),odd:c(function(t,e){for(var i=1;e>i;i+=2)t.push(i);return t}),lt:c(function(t,e,i){for(var n=0>i?i+e:i;--n>=0;)t.push(n);return t}),gt:c(function(t,e,i){for(var n=0>i?i+e:i;++n<e;)t.push(n);return t})}},x.pseudos.nth=x.pseudos.eq;for(_ in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})x.pseudos[_]=a(_);for(_ in{submit:!0,reset:!0})x.pseudos[_]=l(_);return h.prototype=x.filters=x.pseudos,x.setFilters=new h,A=e.tokenize=function(t,i){var n,r,s,o,a,l,c,u=q[t+" "];if(u)return i?0:u.slice(0);for(a=t,l=[],c=x.preFilter;a;){(!n||(r=ce.exec(a)))&&(r&&(a=a.slice(r[0].length)||a),l.push(s=[])),n=!1,(r=ue.exec(a))&&(n=r.shift(),s.push({value:n,type:r[0].replace(le," ")}),a=a.slice(n.length));for(o in x.filter)!(r=fe[o].exec(a))||c[o]&&!(r=c[o](r))||(n=r.shift(),s.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return i?a.length:a?e.error(t):q(t,l).slice(0)},T=e.compile=function(t,e){var i,n=[],r=[],s=V[t+" "];if(!s){for(e||(e=A(t)),i=e.length;i--;)s=b(e[i]),s[R]?n.push(s):r.push(s);s=V(t,y(r,n)),s.selector=t}return s},S=e.select=function(t,e,i,n){var r,s,o,a,l,c="function"==typeof t&&t,h=!n&&A(t=c.selector||t);if(i=i||[],1===h.length){if(s=h[0]=h[0].slice(0),s.length>2&&"ID"===(o=s[0]).type&&w.getById&&9===e.nodeType&&N&&x.relative[s[1].type]){if(e=(x.find.ID(o.matches[0].replace(we,xe),e)||[])[0],!e)return i;c&&(e=e.parentNode),t=t.slice(s.shift().value.length)}for(r=fe.needsContext.test(t)?0:s.length;r--&&(o=s[r],!x.relative[a=o.type]);)if((l=x.find[a])&&(n=l(o.matches[0].replace(we,xe),ye.test(s[0].type)&&u(e.parentNode)||e))){if(s.splice(r,1),t=n.length&&d(s),!t)return Q.apply(i,n),i;break}}return(c||T(t,h))(n,e,!N,i,ye.test(t)&&u(e.parentNode)||e),i},w.sortStable=R.split("").sort(U).join("")===R,w.detectDuplicates=!!$,E(),w.sortDetached=r(function(t){return 1&t.compareDocumentPosition(P.createElement("div"))}),r(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||s("type|href|height|width",function(t,e,i){return i?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),w.attributes&&r(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||s("value",function(t,e,i){return i||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue}),r(function(t){return null==t.getAttribute("disabled")})||s(ee,function(t,e,i){var n;return i?void 0:t[e]===!0?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null}),e}(t);re.find=ce,re.expr=ce.selectors,re.expr[":"]=re.expr.pseudos,re.unique=ce.uniqueSort,re.text=ce.getText,re.isXMLDoc=ce.isXML,re.contains=ce.contains;var ue=re.expr.match.needsContext,he=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,de=/^.[^:#\[\.,]*$/;re.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?re.find.matchesSelector(n,t)?[n]:[]:re.find.matches(t,re.grep(e,function(t){return 1===t.nodeType}))},re.fn.extend({find:function(t){var e,i=[],n=this,r=n.length;if("string"!=typeof t)return this.pushStack(re(t).filter(function(){for(e=0;r>e;e++)if(re.contains(n[e],this))return!0}));for(e=0;r>e;e++)re.find(t,n[e],i);return i=this.pushStack(r>1?re.unique(i):i),i.selector=this.selector?this.selector+" "+t:t,i},filter:function(t){return this.pushStack(n(this,t||[],!1))},not:function(t){return this.pushStack(n(this,t||[],!0))},is:function(t){return!!n(this,"string"==typeof t&&ue.test(t)?re(t):t||[],!1).length}});var pe,fe=t.document,ge=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,me=re.fn.init=function(t,e){var i,n;if(!t)return this;if("string"==typeof t){if(i="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:ge.exec(t),!i||!i[1]&&e)return!e||e.jquery?(e||pe).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof re?e[0]:e,re.merge(this,re.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:fe,!0)),he.test(i[1])&&re.isPlainObject(e))for(i in e)re.isFunction(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}if(n=fe.getElementById(i[2]),n&&n.parentNode){if(n.id!==i[2])return pe.find(t);this.length=1,this[0]=n}return this.context=fe,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):re.isFunction(t)?"undefined"!=typeof pe.ready?pe.ready(t):t(re):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),re.makeArray(t,this))};me.prototype=re.fn,pe=re(fe);var ve=/^(?:parents|prev(?:Until|All))/,be={children:!0,contents:!0,next:!0,prev:!0};re.extend({dir:function(t,e,i){for(var n=[],r=t[e];r&&9!==r.nodeType&&(void 0===i||1!==r.nodeType||!re(r).is(i));)1===r.nodeType&&n.push(r),r=r[e];return n},sibling:function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}}),re.fn.extend({has:function(t){var e,i=re(t,this),n=i.length;return this.filter(function(){for(e=0;n>e;e++)if(re.contains(this,i[e]))return!0})},closest:function(t,e){for(var i,n=0,r=this.length,s=[],o=ue.test(t)||"string"!=typeof t?re(t,e||this.context):0;r>n;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(o?o.index(i)>-1:1===i.nodeType&&re.find.matchesSelector(i,t))){s.push(i);break}return this.pushStack(s.length>1?re.unique(s):s)},index:function(t){return t?"string"==typeof t?re.inArray(this[0],re(t)):re.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(re.unique(re.merge(this.get(),re(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),re.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return re.dir(t,"parentNode")},parentsUntil:function(t,e,i){return re.dir(t,"parentNode",i)},next:function(t){return r(t,"nextSibling")},prev:function(t){return r(t,"previousSibling")},nextAll:function(t){return re.dir(t,"nextSibling")},prevAll:function(t){return re.dir(t,"previousSibling")},nextUntil:function(t,e,i){return re.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return re.dir(t,"previousSibling",i)},siblings:function(t){return re.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return re.sibling(t.firstChild)},contents:function(t){return re.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:re.merge([],t.childNodes)}},function(t,e){re.fn[t]=function(i,n){var r=re.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=re.filter(n,r)),this.length>1&&(be[t]||(r=re.unique(r)),ve.test(t)&&(r=r.reverse())),this.pushStack(r)}});var ye=/\S+/g,_e={};re.Callbacks=function(t){t="string"==typeof t?_e[t]||s(t):re.extend({},t);var e,i,n,r,o,a,l=[],c=!t.once&&[],u=function(s){for(i=t.memory&&s,n=!0,o=a||0,a=0,r=l.length,e=!0;l&&r>o;o++)if(l[o].apply(s[0],s[1])===!1&&t.stopOnFalse){i=!1;break}e=!1,l&&(c?c.length&&u(c.shift()):i?l=[]:h.disable())},h={add:function(){if(l){var n=l.length;!function s(e){re.each(e,function(e,i){var n=re.type(i);"function"===n?t.unique&&h.has(i)||l.push(i):i&&i.length&&"string"!==n&&s(i)})}(arguments),e?r=l.length:i&&(a=n,u(i))}return this},remove:function(){return l&&re.each(arguments,function(t,i){for(var n;(n=re.inArray(i,l,n))>-1;)l.splice(n,1),e&&(r>=n&&r--,o>=n&&o--)}),this},has:function(t){return t?re.inArray(t,l)>-1:!(!l||!l.length)},empty:function(){return l=[],r=0,this},disable:function(){return l=c=i=void 0,this},disabled:function(){return!l},lock:function(){return c=void 0,i||h.disable(),this},locked:function(){return!c},fireWith:function(t,i){return!l||n&&!c||(i=i||[],i=[t,i.slice?i.slice():i],e?c.push(i):u(i)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!n}};return h},re.extend({Deferred:function(t){var e=[["resolve","done",re.Callbacks("once memory"),"resolved"],["reject","fail",re.Callbacks("once memory"),"rejected"],["notify","progress",re.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var t=arguments;return re.Deferred(function(i){re.each(e,function(e,s){var o=re.isFunction(t[e])&&t[e];r[s[1]](function(){var t=o&&o.apply(this,arguments);t&&re.isFunction(t.promise)?t.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[s[0]+"With"](this===n?i.promise():this,o?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?re.extend(t,n):n}},r={};return n.pipe=n.then,re.each(e,function(t,s){var o=s[2],a=s[3];n[s[1]]=o.add,a&&o.add(function(){i=a},e[1^t][2].disable,e[2][2].lock),r[s[0]]=function(){return r[s[0]+"With"](this===r?n:this,arguments),this},r[s[0]+"With"]=o.fireWith}),n.promise(r),t&&t.call(r,r),r},when:function(t){var e,i,n,r=0,s=K.call(arguments),o=s.length,a=1!==o||t&&re.isFunction(t.promise)?o:0,l=1===a?t:re.Deferred(),c=function(t,i,n){return function(r){i[t]=this,n[t]=arguments.length>1?K.call(arguments):r,n===e?l.notifyWith(i,n):--a||l.resolveWith(i,n)}};if(o>1)for(e=new Array(o),i=new Array(o),n=new Array(o);o>r;r++)s[r]&&re.isFunction(s[r].promise)?s[r].promise().done(c(r,n,s)).fail(l.reject).progress(c(r,i,e)):--a;return a||l.resolveWith(n,s),l.promise()}});var we;re.fn.ready=function(t){return re.ready.promise().done(t),this},re.extend({isReady:!1,readyWait:1,holdReady:function(t){t?re.readyWait++:re.ready(!0)},ready:function(t){if(t===!0?!--re.readyWait:!re.isReady){if(!fe.body)return setTimeout(re.ready);re.isReady=!0,t!==!0&&--re.readyWait>0||(we.resolveWith(fe,[re]),re.fn.triggerHandler&&(re(fe).triggerHandler("ready"),re(fe).off("ready")))}}}),re.ready.promise=function(e){if(!we)if(we=re.Deferred(),"complete"===fe.readyState)setTimeout(re.ready);else if(fe.addEventListener)fe.addEventListener("DOMContentLoaded",a,!1),t.addEventListener("load",a,!1);else{fe.attachEvent("onreadystatechange",a),t.attachEvent("onload",a);var i=!1;try{i=null==t.frameElement&&fe.documentElement}catch(n){}i&&i.doScroll&&!function r(){if(!re.isReady){try{i.doScroll("left")}catch(t){return setTimeout(r,50)}o(),re.ready()}}()}return we.promise(e)};var xe,ke="undefined";for(xe in re(ie))break;ie.ownLast="0"!==xe,ie.inlineBlockNeedsLayout=!1,re(function(){var t,e,i,n;i=fe.getElementsByTagName("body")[0],i&&i.style&&(e=fe.createElement("div"),n=fe.createElement("div"),n.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",i.appendChild(n).appendChild(e),typeof e.style.zoom!==ke&&(e.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",ie.inlineBlockNeedsLayout=t=3===e.offsetWidth,t&&(i.style.zoom=1)),i.removeChild(n))}),function(){var t=fe.createElement("div");if(null==ie.deleteExpando){ie.deleteExpando=!0;try{delete t.test}catch(e){ie.deleteExpando=!1}}t=null}(),re.acceptData=function(t){var e=re.noData[(t.nodeName+" ").toLowerCase()],i=+t.nodeType||1;return 1!==i&&9!==i?!1:!e||e!==!0&&t.getAttribute("classid")===e};var Ce=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ae=/([A-Z])/g;re.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(t){return t=t.nodeType?re.cache[t[re.expando]]:t[re.expando],!!t&&!c(t)},data:function(t,e,i){return u(t,e,i)},removeData:function(t,e){return h(t,e)},_data:function(t,e,i){return u(t,e,i,!0)},_removeData:function(t,e){return h(t,e,!0)}}),re.fn.extend({data:function(t,e){var i,n,r,s=this[0],o=s&&s.attributes;if(void 0===t){if(this.length&&(r=re.data(s),1===s.nodeType&&!re._data(s,"parsedAttrs"))){for(i=o.length;i--;)o[i]&&(n=o[i].name,0===n.indexOf("data-")&&(n=re.camelCase(n.slice(5)),l(s,n,r[n])));re._data(s,"parsedAttrs",!0)}return r}return"object"==typeof t?this.each(function(){re.data(this,t)}):arguments.length>1?this.each(function(){re.data(this,t,e)}):s?l(s,t,re.data(s,t)):void 0},removeData:function(t){return this.each(function(){re.removeData(this,t)})}}),re.extend({queue:function(t,e,i){var n;return t?(e=(e||"fx")+"queue",n=re._data(t,e),i&&(!n||re.isArray(i)?n=re._data(t,e,re.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(t,e){e=e||"fx";var i=re.queue(t,e),n=i.length,r=i.shift(),s=re._queueHooks(t,e),o=function(){re.dequeue(t,e)};"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===e&&i.unshift("inprogress"),delete s.stop,r.call(t,o,s)),!n&&s&&s.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return re._data(t,i)||re._data(t,i,{empty:re.Callbacks("once memory").add(function(){re._removeData(t,e+"queue"),re._removeData(t,i)})})}}),re.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?re.queue(this[0],t):void 0===e?this:this.each(function(){var i=re.queue(this,t,e);re._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&re.dequeue(this,t)})},dequeue:function(t){return this.each(function(){re.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,r=re.Deferred(),s=this,o=this.length,a=function(){--n||r.resolveWith(s,[s])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";o--;)i=re._data(s[o],t+"queueHooks"),i&&i.empty&&(n++,i.empty.add(a));return a(),r.promise(e)}});var Te=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Se=["Top","Right","Bottom","Left"],Me=function(t,e){return t=e||t,"none"===re.css(t,"display")||!re.contains(t.ownerDocument,t)},De=re.access=function(t,e,i,n,r,s,o){var a=0,l=t.length,c=null==i;if("object"===re.type(i)){r=!0;for(a in i)re.access(t,e,a,i[a],!0,s,o)}else if(void 0!==n&&(r=!0,re.isFunction(n)||(o=!0),c&&(o?(e.call(t,n),e=null):(c=e,e=function(t,e,i){return c.call(re(t),i)})),e))for(;l>a;a++)e(t[a],i,o?n:n.call(t[a],a,e(t[a],i)));return r?t:c?e.call(t):l?e(t[0],i):s},$e=/^(?:checkbox|radio)$/i;!function(){var t=fe.createElement("input"),e=fe.createElement("div"),i=fe.createDocumentFragment();if(e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",ie.leadingWhitespace=3===e.firstChild.nodeType,ie.tbody=!e.getElementsByTagName("tbody").length,ie.htmlSerialize=!!e.getElementsByTagName("link").length,ie.html5Clone="<:nav></:nav>"!==fe.createElement("nav").cloneNode(!0).outerHTML,t.type="checkbox",t.checked=!0,i.appendChild(t),ie.appendChecked=t.checked,e.innerHTML="<textarea>x</textarea>",ie.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue,i.appendChild(e),e.innerHTML="<input type='radio' checked='checked' name='t'/>",ie.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,ie.noCloneEvent=!0,e.attachEvent&&(e.attachEvent("onclick",function(){ie.noCloneEvent=!1}),e.cloneNode(!0).click()),null==ie.deleteExpando){ie.deleteExpando=!0;try{delete e.test}catch(n){ie.deleteExpando=!1}}}(),function(){var e,i,n=fe.createElement("div");for(e in{submit:!0,change:!0,focusin:!0})i="on"+e,(ie[e+"Bubbles"]=i in t)||(n.setAttribute(i,"t"),ie[e+"Bubbles"]=n.attributes[i].expando===!1);n=null}();var Ee=/^(?:input|select|textarea)$/i,Pe=/^key/,Ie=/^(?:mouse|pointer|contextmenu)|click/,Ne=/^(?:focusinfocus|focusoutblur)$/,Fe=/^([^.]*)(?:\.(.+)|)$/;re.event={global:{},add:function(t,e,i,n,r){var s,o,a,l,c,u,h,d,p,f,g,m=re._data(t);if(m){for(i.handler&&(l=i,i=l.handler,r=l.selector),i.guid||(i.guid=re.guid++),(o=m.events)||(o=m.events={}),(u=m.handle)||(u=m.handle=function(t){return typeof re===ke||t&&re.event.triggered===t.type?void 0:re.event.dispatch.apply(u.elem,arguments)},u.elem=t),e=(e||"").match(ye)||[""],a=e.length;a--;)s=Fe.exec(e[a])||[],p=g=s[1],f=(s[2]||"").split(".").sort(),p&&(c=re.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,c=re.event.special[p]||{},h=re.extend({type:p,origType:g,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&re.expr.match.needsContext.test(r),namespace:f.join(".")},l),(d=o[p])||(d=o[p]=[],d.delegateCount=0,c.setup&&c.setup.call(t,n,f,u)!==!1||(t.addEventListener?t.addEventListener(p,u,!1):t.attachEvent&&t.attachEvent("on"+p,u))),c.add&&(c.add.call(t,h),h.handler.guid||(h.handler.guid=i.guid)),r?d.splice(d.delegateCount++,0,h):d.push(h),re.event.global[p]=!0);t=null}},remove:function(t,e,i,n,r){var s,o,a,l,c,u,h,d,p,f,g,m=re.hasData(t)&&re._data(t);if(m&&(u=m.events)){for(e=(e||"").match(ye)||[""],c=e.length;c--;)if(a=Fe.exec(e[c])||[],p=g=a[1],f=(a[2]||"").split(".").sort(),p){for(h=re.event.special[p]||{},p=(n?h.delegateType:h.bindType)||p,d=u[p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=s=d.length;s--;)o=d[s],!r&&g!==o.origType||i&&i.guid!==o.guid||a&&!a.test(o.namespace)||n&&n!==o.selector&&("**"!==n||!o.selector)||(d.splice(s,1),o.selector&&d.delegateCount--,h.remove&&h.remove.call(t,o));l&&!d.length&&(h.teardown&&h.teardown.call(t,f,m.handle)!==!1||re.removeEvent(t,p,m.handle),delete u[p])}else for(p in u)re.event.remove(t,p+e[c],i,n,!0);re.isEmptyObject(u)&&(delete m.handle,re._removeData(t,"events"))}},trigger:function(e,i,n,r){var s,o,a,l,c,u,h,d=[n||fe],p=ee.call(e,"type")?e.type:e,f=ee.call(e,"namespace")?e.namespace.split("."):[];if(a=u=n=n||fe,3!==n.nodeType&&8!==n.nodeType&&!Ne.test(p+re.event.triggered)&&(p.indexOf(".")>=0&&(f=p.split("."),p=f.shift(),f.sort()),o=p.indexOf(":")<0&&"on"+p,e=e[re.expando]?e:new re.Event(p,"object"==typeof e&&e),e.isTrigger=r?2:3,e.namespace=f.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),i=null==i?[e]:re.makeArray(i,[e]),c=re.event.special[p]||{},r||!c.trigger||c.trigger.apply(n,i)!==!1)){if(!r&&!c.noBubble&&!re.isWindow(n)){for(l=c.delegateType||p,Ne.test(l+p)||(a=a.parentNode);a;a=a.parentNode)d.push(a),u=a;
u===(n.ownerDocument||fe)&&d.push(u.defaultView||u.parentWindow||t)}for(h=0;(a=d[h++])&&!e.isPropagationStopped();)e.type=h>1?l:c.bindType||p,s=(re._data(a,"events")||{})[e.type]&&re._data(a,"handle"),s&&s.apply(a,i),s=o&&a[o],s&&s.apply&&re.acceptData(a)&&(e.result=s.apply(a,i),e.result===!1&&e.preventDefault());if(e.type=p,!r&&!e.isDefaultPrevented()&&(!c._default||c._default.apply(d.pop(),i)===!1)&&re.acceptData(n)&&o&&n[p]&&!re.isWindow(n)){u=n[o],u&&(n[o]=null),re.event.triggered=p;try{n[p]()}catch(g){}re.event.triggered=void 0,u&&(n[o]=u)}return e.result}},dispatch:function(t){t=re.event.fix(t);var e,i,n,r,s,o=[],a=K.call(arguments),l=(re._data(this,"events")||{})[t.type]||[],c=re.event.special[t.type]||{};if(a[0]=t,t.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,t)!==!1){for(o=re.event.handlers.call(this,t,l),e=0;(r=o[e++])&&!t.isPropagationStopped();)for(t.currentTarget=r.elem,s=0;(n=r.handlers[s++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(n.namespace))&&(t.handleObj=n,t.data=n.data,i=((re.event.special[n.origType]||{}).handle||n.handler).apply(r.elem,a),void 0!==i&&(t.result=i)===!1&&(t.preventDefault(),t.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(t,e){var i,n,r,s,o=[],a=e.delegateCount,l=t.target;if(a&&l.nodeType&&(!t.button||"click"!==t.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(l.disabled!==!0||"click"!==t.type)){for(r=[],s=0;a>s;s++)n=e[s],i=n.selector+" ",void 0===r[i]&&(r[i]=n.needsContext?re(i,this).index(l)>=0:re.find(i,this,null,[l]).length),r[i]&&r.push(n);r.length&&o.push({elem:l,handlers:r})}return a<e.length&&o.push({elem:this,handlers:e.slice(a)}),o},fix:function(t){if(t[re.expando])return t;var e,i,n,r=t.type,s=t,o=this.fixHooks[r];for(o||(this.fixHooks[r]=o=Ie.test(r)?this.mouseHooks:Pe.test(r)?this.keyHooks:{}),n=o.props?this.props.concat(o.props):this.props,t=new re.Event(s),e=n.length;e--;)i=n[e],t[i]=s[i];return t.target||(t.target=s.srcElement||fe),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey=!!t.metaKey,o.filter?o.filter(t,s):t},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var i,n,r,s=e.button,o=e.fromElement;return null==t.pageX&&null!=e.clientX&&(n=t.target.ownerDocument||fe,r=n.documentElement,i=n.body,t.pageX=e.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),t.pageY=e.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),!t.relatedTarget&&o&&(t.relatedTarget=o===t.target?e.toElement:o),t.which||void 0===s||(t.which=1&s?1:2&s?3:4&s?2:0),t}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==f()&&this.focus)try{return this.focus(),!1}catch(t){}},delegateType:"focusin"},blur:{trigger:function(){return this===f()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return re.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(t){return re.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i,n){var r=re.extend(new re.Event,i,{type:t,isSimulated:!0,originalEvent:{}});n?re.event.trigger(r,null,e):re.event.dispatch.call(e,r),r.isDefaultPrevented()&&i.preventDefault()}},re.removeEvent=fe.removeEventListener?function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)}:function(t,e,i){var n="on"+e;t.detachEvent&&(typeof t[n]===ke&&(t[n]=null),t.detachEvent(n,i))},re.Event=function(t,e){return this instanceof re.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&t.returnValue===!1?d:p):this.type=t,e&&re.extend(this,e),this.timeStamp=t&&t.timeStamp||re.now(),void(this[re.expando]=!0)):new re.Event(t,e)},re.Event.prototype={isDefaultPrevented:p,isPropagationStopped:p,isImmediatePropagationStopped:p,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=d,t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=d,t&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=d,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},re.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){re.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,r=t.relatedTarget,s=t.handleObj;return(!r||r!==n&&!re.contains(n,r))&&(t.type=s.origType,i=s.handler.apply(this,arguments),t.type=e),i}}}),ie.submitBubbles||(re.event.special.submit={setup:function(){return re.nodeName(this,"form")?!1:void re.event.add(this,"click._submit keypress._submit",function(t){var e=t.target,i=re.nodeName(e,"input")||re.nodeName(e,"button")?e.form:void 0;i&&!re._data(i,"submitBubbles")&&(re.event.add(i,"submit._submit",function(t){t._submit_bubble=!0}),re._data(i,"submitBubbles",!0))})},postDispatch:function(t){t._submit_bubble&&(delete t._submit_bubble,this.parentNode&&!t.isTrigger&&re.event.simulate("submit",this.parentNode,t,!0))},teardown:function(){return re.nodeName(this,"form")?!1:void re.event.remove(this,"._submit")}}),ie.changeBubbles||(re.event.special.change={setup:function(){return Ee.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(re.event.add(this,"propertychange._change",function(t){"checked"===t.originalEvent.propertyName&&(this._just_changed=!0)}),re.event.add(this,"click._change",function(t){this._just_changed&&!t.isTrigger&&(this._just_changed=!1),re.event.simulate("change",this,t,!0)})),!1):void re.event.add(this,"beforeactivate._change",function(t){var e=t.target;Ee.test(e.nodeName)&&!re._data(e,"changeBubbles")&&(re.event.add(e,"change._change",function(t){!this.parentNode||t.isSimulated||t.isTrigger||re.event.simulate("change",this.parentNode,t,!0)}),re._data(e,"changeBubbles",!0))})},handle:function(t){var e=t.target;return this!==e||t.isSimulated||t.isTrigger||"radio"!==e.type&&"checkbox"!==e.type?t.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return re.event.remove(this,"._change"),!Ee.test(this.nodeName)}}),ie.focusinBubbles||re.each({focus:"focusin",blur:"focusout"},function(t,e){var i=function(t){re.event.simulate(e,t.target,re.event.fix(t),!0)};re.event.special[e]={setup:function(){var n=this.ownerDocument||this,r=re._data(n,e);r||n.addEventListener(t,i,!0),re._data(n,e,(r||0)+1)},teardown:function(){var n=this.ownerDocument||this,r=re._data(n,e)-1;r?re._data(n,e,r):(n.removeEventListener(t,i,!0),re._removeData(n,e))}}}),re.fn.extend({on:function(t,e,i,n,r){var s,o;if("object"==typeof t){"string"!=typeof e&&(i=i||e,e=void 0);for(s in t)this.on(s,e,i,t[s],r);return this}if(null==i&&null==n?(n=e,i=e=void 0):null==n&&("string"==typeof e?(n=i,i=void 0):(n=i,i=e,e=void 0)),n===!1)n=p;else if(!n)return this;return 1===r&&(o=n,n=function(t){return re().off(t),o.apply(this,arguments)},n.guid=o.guid||(o.guid=re.guid++)),this.each(function(){re.event.add(this,t,n,i,e)})},one:function(t,e,i,n){return this.on(t,e,i,n,1)},off:function(t,e,i){var n,r;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,re(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return(e===!1||"function"==typeof e)&&(i=e,e=void 0),i===!1&&(i=p),this.each(function(){re.event.remove(this,t,i,e)})},trigger:function(t,e){return this.each(function(){re.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];return i?re.event.trigger(t,e,i,!0):void 0}});var Oe="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Be=/ jQuery\d+="(?:null|\d+)"/g,ze=new RegExp("<(?:"+Oe+")[\\s/>]","i"),Re=/^\s+/,Le=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,He=/<([\w:]+)/,We=/<tbody/i,je=/<|&#?\w+;/,qe=/<(?:script|style|link)/i,Ve=/checked\s*(?:[^=]|=\s*.checked.)/i,Ue=/^$|\/(?:java|ecma)script/i,Ye=/^true\/(.*)/,Ge=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Ke={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ie.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Je=g(fe),Xe=Je.appendChild(fe.createElement("div"));Ke.optgroup=Ke.option,Ke.tbody=Ke.tfoot=Ke.colgroup=Ke.caption=Ke.thead,Ke.th=Ke.td,re.extend({clone:function(t,e,i){var n,r,s,o,a,l=re.contains(t.ownerDocument,t);if(ie.html5Clone||re.isXMLDoc(t)||!ze.test("<"+t.nodeName+">")?s=t.cloneNode(!0):(Xe.innerHTML=t.outerHTML,Xe.removeChild(s=Xe.firstChild)),!(ie.noCloneEvent&&ie.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||re.isXMLDoc(t)))for(n=m(s),a=m(t),o=0;null!=(r=a[o]);++o)n[o]&&k(r,n[o]);if(e)if(i)for(a=a||m(t),n=n||m(s),o=0;null!=(r=a[o]);o++)x(r,n[o]);else x(t,s);return n=m(s,"script"),n.length>0&&w(n,!l&&m(t,"script")),n=a=r=null,s},buildFragment:function(t,e,i,n){for(var r,s,o,a,l,c,u,h=t.length,d=g(e),p=[],f=0;h>f;f++)if(s=t[f],s||0===s)if("object"===re.type(s))re.merge(p,s.nodeType?[s]:s);else if(je.test(s)){for(a=a||d.appendChild(e.createElement("div")),l=(He.exec(s)||["",""])[1].toLowerCase(),u=Ke[l]||Ke._default,a.innerHTML=u[1]+s.replace(Le,"<$1></$2>")+u[2],r=u[0];r--;)a=a.lastChild;if(!ie.leadingWhitespace&&Re.test(s)&&p.push(e.createTextNode(Re.exec(s)[0])),!ie.tbody)for(s="table"!==l||We.test(s)?"<table>"!==u[1]||We.test(s)?0:a:a.firstChild,r=s&&s.childNodes.length;r--;)re.nodeName(c=s.childNodes[r],"tbody")&&!c.childNodes.length&&s.removeChild(c);for(re.merge(p,a.childNodes),a.textContent="";a.firstChild;)a.removeChild(a.firstChild);a=d.lastChild}else p.push(e.createTextNode(s));for(a&&d.removeChild(a),ie.appendChecked||re.grep(m(p,"input"),v),f=0;s=p[f++];)if((!n||-1===re.inArray(s,n))&&(o=re.contains(s.ownerDocument,s),a=m(d.appendChild(s),"script"),o&&w(a),i))for(r=0;s=a[r++];)Ue.test(s.type||"")&&i.push(s);return a=null,d},cleanData:function(t,e){for(var i,n,r,s,o=0,a=re.expando,l=re.cache,c=ie.deleteExpando,u=re.event.special;null!=(i=t[o]);o++)if((e||re.acceptData(i))&&(r=i[a],s=r&&l[r])){if(s.events)for(n in s.events)u[n]?re.event.remove(i,n):re.removeEvent(i,n,s.handle);l[r]&&(delete l[r],c?delete i[a]:typeof i.removeAttribute!==ke?i.removeAttribute(a):i[a]=null,G.push(r))}}}),re.fn.extend({text:function(t){return De(this,function(t){return void 0===t?re.text(this):this.empty().append((this[0]&&this[0].ownerDocument||fe).createTextNode(t))},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=b(this,t);e.appendChild(t)}})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=b(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var i,n=t?re.filter(t,this):this,r=0;null!=(i=n[r]);r++)e||1!==i.nodeType||re.cleanData(m(i)),i.parentNode&&(e&&re.contains(i.ownerDocument,i)&&w(m(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++){for(1===t.nodeType&&re.cleanData(m(t,!1));t.firstChild;)t.removeChild(t.firstChild);t.options&&re.nodeName(t,"select")&&(t.options.length=0)}return this},clone:function(t,e){return t=null==t?!1:t,e=null==e?t:e,this.map(function(){return re.clone(this,t,e)})},html:function(t){return De(this,function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t)return 1===e.nodeType?e.innerHTML.replace(Be,""):void 0;if(!("string"!=typeof t||qe.test(t)||!ie.htmlSerialize&&ze.test(t)||!ie.leadingWhitespace&&Re.test(t)||Ke[(He.exec(t)||["",""])[1].toLowerCase()])){t=t.replace(Le,"<$1></$2>");try{for(;n>i;i++)e=this[i]||{},1===e.nodeType&&(re.cleanData(m(e,!1)),e.innerHTML=t);e=0}catch(r){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,function(e){t=this.parentNode,re.cleanData(m(this)),t&&t.replaceChild(e,this)}),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e){t=J.apply([],t);var i,n,r,s,o,a,l=0,c=this.length,u=this,h=c-1,d=t[0],p=re.isFunction(d);if(p||c>1&&"string"==typeof d&&!ie.checkClone&&Ve.test(d))return this.each(function(i){var n=u.eq(i);p&&(t[0]=d.call(this,i,n.html())),n.domManip(t,e)});if(c&&(a=re.buildFragment(t,this[0].ownerDocument,!1,this),i=a.firstChild,1===a.childNodes.length&&(a=i),i)){for(s=re.map(m(a,"script"),y),r=s.length;c>l;l++)n=a,l!==h&&(n=re.clone(n,!0,!0),r&&re.merge(s,m(n,"script"))),e.call(this[l],n,l);if(r)for(o=s[s.length-1].ownerDocument,re.map(s,_),l=0;r>l;l++)n=s[l],Ue.test(n.type||"")&&!re._data(n,"globalEval")&&re.contains(o,n)&&(n.src?re._evalUrl&&re._evalUrl(n.src):re.globalEval((n.text||n.textContent||n.innerHTML||"").replace(Ge,"")));a=i=null}return this}}),re.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){re.fn[t]=function(t){for(var i,n=0,r=[],s=re(t),o=s.length-1;o>=n;n++)i=n===o?this:this.clone(!0),re(s[n])[e](i),X.apply(r,i.get());return this.pushStack(r)}});var Qe,Ze={};!function(){var t;ie.shrinkWrapBlocks=function(){if(null!=t)return t;t=!1;var e,i,n;return i=fe.getElementsByTagName("body")[0],i&&i.style?(e=fe.createElement("div"),n=fe.createElement("div"),n.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",i.appendChild(n).appendChild(e),typeof e.style.zoom!==ke&&(e.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",e.appendChild(fe.createElement("div")).style.width="5px",t=3!==e.offsetWidth),i.removeChild(n),t):void 0}}();var ti,ei,ii=/^margin/,ni=new RegExp("^("+Te+")(?!px)[a-z%]+$","i"),ri=/^(top|right|bottom|left)$/;t.getComputedStyle?(ti=function(e){return e.ownerDocument.defaultView.opener?e.ownerDocument.defaultView.getComputedStyle(e,null):t.getComputedStyle(e,null)},ei=function(t,e,i){var n,r,s,o,a=t.style;return i=i||ti(t),o=i?i.getPropertyValue(e)||i[e]:void 0,i&&(""!==o||re.contains(t.ownerDocument,t)||(o=re.style(t,e)),ni.test(o)&&ii.test(e)&&(n=a.width,r=a.minWidth,s=a.maxWidth,a.minWidth=a.maxWidth=a.width=o,o=i.width,a.width=n,a.minWidth=r,a.maxWidth=s)),void 0===o?o:o+""}):fe.documentElement.currentStyle&&(ti=function(t){return t.currentStyle},ei=function(t,e,i){var n,r,s,o,a=t.style;return i=i||ti(t),o=i?i[e]:void 0,null==o&&a&&a[e]&&(o=a[e]),ni.test(o)&&!ri.test(e)&&(n=a.left,r=t.runtimeStyle,s=r&&r.left,s&&(r.left=t.currentStyle.left),a.left="fontSize"===e?"1em":o,o=a.pixelLeft+"px",a.left=n,s&&(r.left=s)),void 0===o?o:o+""||"auto"}),function(){function e(){var e,i,n,r;i=fe.getElementsByTagName("body")[0],i&&i.style&&(e=fe.createElement("div"),n=fe.createElement("div"),n.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",i.appendChild(n).appendChild(e),e.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",s=o=!1,l=!0,t.getComputedStyle&&(s="1%"!==(t.getComputedStyle(e,null)||{}).top,o="4px"===(t.getComputedStyle(e,null)||{width:"4px"}).width,r=e.appendChild(fe.createElement("div")),r.style.cssText=e.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",r.style.marginRight=r.style.width="0",e.style.width="1px",l=!parseFloat((t.getComputedStyle(r,null)||{}).marginRight),e.removeChild(r)),e.innerHTML="<table><tr><td></td><td>t</td></tr></table>",r=e.getElementsByTagName("td"),r[0].style.cssText="margin:0;border:0;padding:0;display:none",a=0===r[0].offsetHeight,a&&(r[0].style.display="",r[1].style.display="none",a=0===r[0].offsetHeight),i.removeChild(n))}var i,n,r,s,o,a,l;i=fe.createElement("div"),i.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",r=i.getElementsByTagName("a")[0],n=r&&r.style,n&&(n.cssText="float:left;opacity:.5",ie.opacity="0.5"===n.opacity,ie.cssFloat=!!n.cssFloat,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",ie.clearCloneStyle="content-box"===i.style.backgroundClip,ie.boxSizing=""===n.boxSizing||""===n.MozBoxSizing||""===n.WebkitBoxSizing,re.extend(ie,{reliableHiddenOffsets:function(){return null==a&&e(),a},boxSizingReliable:function(){return null==o&&e(),o},pixelPosition:function(){return null==s&&e(),s},reliableMarginRight:function(){return null==l&&e(),l}}))}(),re.swap=function(t,e,i,n){var r,s,o={};for(s in e)o[s]=t.style[s],t.style[s]=e[s];r=i.apply(t,n||[]);for(s in e)t.style[s]=o[s];return r};var si=/alpha\([^)]*\)/i,oi=/opacity\s*=\s*([^)]*)/,ai=/^(none|table(?!-c[ea]).+)/,li=new RegExp("^("+Te+")(.*)$","i"),ci=new RegExp("^([+-])=("+Te+")","i"),ui={position:"absolute",visibility:"hidden",display:"block"},hi={letterSpacing:"0",fontWeight:"400"},di=["Webkit","O","Moz","ms"];re.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=ei(t,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":ie.cssFloat?"cssFloat":"styleFloat"},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,s,o,a=re.camelCase(e),l=t.style;if(e=re.cssProps[a]||(re.cssProps[a]=S(l,a)),o=re.cssHooks[e]||re.cssHooks[a],void 0===i)return o&&"get"in o&&void 0!==(r=o.get(t,!1,n))?r:l[e];if(s=typeof i,"string"===s&&(r=ci.exec(i))&&(i=(r[1]+1)*r[2]+parseFloat(re.css(t,e)),s="number"),null!=i&&i===i&&("number"!==s||re.cssNumber[a]||(i+="px"),ie.clearCloneStyle||""!==i||0!==e.indexOf("background")||(l[e]="inherit"),!(o&&"set"in o&&void 0===(i=o.set(t,i,n)))))try{l[e]=i}catch(c){}}},css:function(t,e,i,n){var r,s,o,a=re.camelCase(e);return e=re.cssProps[a]||(re.cssProps[a]=S(t.style,a)),o=re.cssHooks[e]||re.cssHooks[a],o&&"get"in o&&(s=o.get(t,!0,i)),void 0===s&&(s=ei(t,e,n)),"normal"===s&&e in hi&&(s=hi[e]),""===i||i?(r=parseFloat(s),i===!0||re.isNumeric(r)?r||0:s):s}}),re.each(["height","width"],function(t,e){re.cssHooks[e]={get:function(t,i,n){return i?ai.test(re.css(t,"display"))&&0===t.offsetWidth?re.swap(t,ui,function(){return E(t,e,n)}):E(t,e,n):void 0},set:function(t,i,n){var r=n&&ti(t);return D(t,i,n?$(t,e,n,ie.boxSizing&&"border-box"===re.css(t,"boxSizing",!1,r),r):0)}}}),ie.opacity||(re.cssHooks.opacity={get:function(t,e){return oi.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":e?"1":""},set:function(t,e){var i=t.style,n=t.currentStyle,r=re.isNumeric(e)?"alpha(opacity="+100*e+")":"",s=n&&n.filter||i.filter||"";i.zoom=1,(e>=1||""===e)&&""===re.trim(s.replace(si,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===e||n&&!n.filter)||(i.filter=si.test(s)?s.replace(si,r):s+" "+r)}}),re.cssHooks.marginRight=T(ie.reliableMarginRight,function(t,e){return e?re.swap(t,{display:"inline-block"},ei,[t,"marginRight"]):void 0}),re.each({margin:"",padding:"",border:"Width"},function(t,e){re.cssHooks[t+e]={expand:function(i){for(var n=0,r={},s="string"==typeof i?i.split(" "):[i];4>n;n++)r[t+Se[n]+e]=s[n]||s[n-2]||s[0];return r}},ii.test(t)||(re.cssHooks[t+e].set=D)}),re.fn.extend({css:function(t,e){return De(this,function(t,e,i){var n,r,s={},o=0;if(re.isArray(e)){for(n=ti(t),r=e.length;r>o;o++)s[e[o]]=re.css(t,e[o],!1,n);return s}return void 0!==i?re.style(t,e,i):re.css(t,e)},t,e,arguments.length>1)},show:function(){return M(this,!0)},hide:function(){return M(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){Me(this)?re(this).show():re(this).hide()})}}),re.Tween=P,P.prototype={constructor:P,init:function(t,e,i,n,r,s){this.elem=t,this.prop=i,this.easing=r||"swing",this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=s||(re.cssNumber[i]?"":"px")},cur:function(){var t=P.propHooks[this.prop];return t&&t.get?t.get(this):P.propHooks._default.get(this)},run:function(t){var e,i=P.propHooks[this.prop];return this.pos=e=this.options.duration?re.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):P.propHooks._default.set(this),this}},P.prototype.init.prototype=P.prototype,P.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=re.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){re.fx.step[t.prop]?re.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[re.cssProps[t.prop]]||re.cssHooks[t.prop])?re.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},P.propHooks.scrollTop=P.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},re.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},re.fx=P.prototype.init,re.fx.step={};var pi,fi,gi=/^(?:toggle|show|hide)$/,mi=new RegExp("^(?:([+-])=|)("+Te+")([a-z%]*)$","i"),vi=/queueHooks$/,bi=[O],yi={"*":[function(t,e){var i=this.createTween(t,e),n=i.cur(),r=mi.exec(e),s=r&&r[3]||(re.cssNumber[t]?"":"px"),o=(re.cssNumber[t]||"px"!==s&&+n)&&mi.exec(re.css(i.elem,t)),a=1,l=20;if(o&&o[3]!==s){s=s||o[3],r=r||[],o=+n||1;do a=a||".5",o/=a,re.style(i.elem,t,o+s);while(a!==(a=i.cur()/n)&&1!==a&&--l)}return r&&(o=i.start=+o||+n||0,i.unit=s,i.end=r[1]?o+(r[1]+1)*r[2]:+r[2]),i}]};re.Animation=re.extend(z,{tweener:function(t,e){re.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var i,n=0,r=t.length;r>n;n++)i=t[n],yi[i]=yi[i]||[],yi[i].unshift(e)},prefilter:function(t,e){e?bi.unshift(t):bi.push(t)}}),re.speed=function(t,e,i){var n=t&&"object"==typeof t?re.extend({},t):{complete:i||!i&&e||re.isFunction(t)&&t,duration:t,easing:i&&e||e&&!re.isFunction(e)&&e};return n.duration=re.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in re.fx.speeds?re.fx.speeds[n.duration]:re.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){re.isFunction(n.old)&&n.old.call(this),n.queue&&re.dequeue(this,n.queue)},n},re.fn.extend({fadeTo:function(t,e,i,n){return this.filter(Me).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var r=re.isEmptyObject(t),s=re.speed(e,i,n),o=function(){var e=z(this,re.extend({},t),s);(r||re._data(this,"finish"))&&e.stop(!0)};return o.finish=o,r||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,r=null!=t&&t+"queueHooks",s=re.timers,o=re._data(this);if(r)o[r]&&o[r].stop&&n(o[r]);else for(r in o)o[r]&&o[r].stop&&vi.test(r)&&n(o[r]);for(r=s.length;r--;)s[r].elem!==this||null!=t&&s[r].queue!==t||(s[r].anim.stop(i),e=!1,s.splice(r,1));(e||!i)&&re.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,i=re._data(this),n=i[t+"queue"],r=i[t+"queueHooks"],s=re.timers,o=n?n.length:0;for(i.finish=!0,re.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=s.length;e--;)s[e].elem===this&&s[e].queue===t&&(s[e].anim.stop(!0),s.splice(e,1));for(e=0;o>e;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish})}}),re.each(["toggle","show","hide"],function(t,e){var i=re.fn[e];re.fn[e]=function(t,n,r){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(N(e,!0),t,n,r)}}),re.each({slideDown:N("show"),slideUp:N("hide"),slideToggle:N("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){re.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),re.timers=[],re.fx.tick=function(){var t,e=re.timers,i=0;for(pi=re.now();i<e.length;i++)t=e[i],t()||e[i]!==t||e.splice(i--,1);e.length||re.fx.stop(),pi=void 0},re.fx.timer=function(t){re.timers.push(t),t()?re.fx.start():re.timers.pop()},re.fx.interval=13,re.fx.start=function(){fi||(fi=setInterval(re.fx.tick,re.fx.interval))},re.fx.stop=function(){clearInterval(fi),fi=null},re.fx.speeds={slow:600,fast:200,_default:400},re.fn.delay=function(t,e){return t=re.fx?re.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,i){var n=setTimeout(e,t);i.stop=function(){clearTimeout(n)}})},function(){var t,e,i,n,r;e=fe.createElement("div"),e.setAttribute("className","t"),e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=e.getElementsByTagName("a")[0],i=fe.createElement("select"),r=i.appendChild(fe.createElement("option")),t=e.getElementsByTagName("input")[0],n.style.cssText="top:1px",ie.getSetAttribute="t"!==e.className,ie.style=/top/.test(n.getAttribute("style")),ie.hrefNormalized="/a"===n.getAttribute("href"),ie.checkOn=!!t.value,ie.optSelected=r.selected,ie.enctype=!!fe.createElement("form").enctype,i.disabled=!0,ie.optDisabled=!r.disabled,t=fe.createElement("input"),t.setAttribute("value",""),ie.input=""===t.getAttribute("value"),t.value="t",t.setAttribute("type","radio"),ie.radioValue="t"===t.value}();var _i=/\r/g;re.fn.extend({val:function(t){var e,i,n,r=this[0];{if(arguments.length)return n=re.isFunction(t),this.each(function(i){var r;1===this.nodeType&&(r=n?t.call(this,i,re(this).val()):t,null==r?r="":"number"==typeof r?r+="":re.isArray(r)&&(r=re.map(r,function(t){return null==t?"":t+""})),e=re.valHooks[this.type]||re.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))});if(r)return e=re.valHooks[r.type]||re.valHooks[r.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(i=e.get(r,"value"))?i:(i=r.value,"string"==typeof i?i.replace(_i,""):null==i?"":i)}}}),re.extend({valHooks:{option:{get:function(t){var e=re.find.attr(t,"value");return null!=e?e:re.trim(re.text(t))}},select:{get:function(t){for(var e,i,n=t.options,r=t.selectedIndex,s="select-one"===t.type||0>r,o=s?null:[],a=s?r+1:n.length,l=0>r?a:s?r:0;a>l;l++)if(i=n[l],!(!i.selected&&l!==r||(ie.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&re.nodeName(i.parentNode,"optgroup"))){if(e=re(i).val(),s)return e;o.push(e)}return o},set:function(t,e){for(var i,n,r=t.options,s=re.makeArray(e),o=r.length;o--;)if(n=r[o],re.inArray(re.valHooks.option.get(n),s)>=0)try{n.selected=i=!0}catch(a){n.scrollHeight}else n.selected=!1;return i||(t.selectedIndex=-1),r}}}}),re.each(["radio","checkbox"],function(){re.valHooks[this]={set:function(t,e){return re.isArray(e)?t.checked=re.inArray(re(t).val(),e)>=0:void 0}},ie.checkOn||(re.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var wi,xi,ki=re.expr.attrHandle,Ci=/^(?:checked|selected)$/i,Ai=ie.getSetAttribute,Ti=ie.input;re.fn.extend({attr:function(t,e){return De(this,re.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){re.removeAttr(this,t)})}}),re.extend({attr:function(t,e,i){var n,r,s=t.nodeType;if(t&&3!==s&&8!==s&&2!==s)return typeof t.getAttribute===ke?re.prop(t,e,i):(1===s&&re.isXMLDoc(t)||(e=e.toLowerCase(),n=re.attrHooks[e]||(re.expr.match.bool.test(e)?xi:wi)),void 0===i?n&&"get"in n&&null!==(r=n.get(t,e))?r:(r=re.find.attr(t,e),null==r?void 0:r):null!==i?n&&"set"in n&&void 0!==(r=n.set(t,i,e))?r:(t.setAttribute(e,i+""),i):void re.removeAttr(t,e))},removeAttr:function(t,e){var i,n,r=0,s=e&&e.match(ye);if(s&&1===t.nodeType)for(;i=s[r++];)n=re.propFix[i]||i,re.expr.match.bool.test(i)?Ti&&Ai||!Ci.test(i)?t[n]=!1:t[re.camelCase("default-"+i)]=t[n]=!1:re.attr(t,i,""),t.removeAttribute(Ai?i:n)},attrHooks:{type:{set:function(t,e){if(!ie.radioValue&&"radio"===e&&re.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}}}),xi={set:function(t,e,i){return e===!1?re.removeAttr(t,i):Ti&&Ai||!Ci.test(i)?t.setAttribute(!Ai&&re.propFix[i]||i,i):t[re.camelCase("default-"+i)]=t[i]=!0,i}},re.each(re.expr.match.bool.source.match(/\w+/g),function(t,e){var i=ki[e]||re.find.attr;ki[e]=Ti&&Ai||!Ci.test(e)?function(t,e,n){var r,s;return n||(s=ki[e],ki[e]=r,r=null!=i(t,e,n)?e.toLowerCase():null,ki[e]=s),r}:function(t,e,i){return i?void 0:t[re.camelCase("default-"+e)]?e.toLowerCase():null}}),Ti&&Ai||(re.attrHooks.value={set:function(t,e,i){return re.nodeName(t,"input")?void(t.defaultValue=e):wi&&wi.set(t,e,i)}}),Ai||(wi={set:function(t,e,i){var n=t.getAttributeNode(i);return n||t.setAttributeNode(n=t.ownerDocument.createAttribute(i)),n.value=e+="","value"===i||e===t.getAttribute(i)?e:void 0}},ki.id=ki.name=ki.coords=function(t,e,i){var n;return i?void 0:(n=t.getAttributeNode(e))&&""!==n.value?n.value:null},re.valHooks.button={get:function(t,e){var i=t.getAttributeNode(e);return i&&i.specified?i.value:void 0},set:wi.set},re.attrHooks.contenteditable={set:function(t,e,i){wi.set(t,""===e?!1:e,i)}},re.each(["width","height"],function(t,e){re.attrHooks[e]={set:function(t,i){return""===i?(t.setAttribute(e,"auto"),i):void 0}}})),ie.style||(re.attrHooks.style={get:function(t){return t.style.cssText||void 0},set:function(t,e){return t.style.cssText=e+""}});var Si=/^(?:input|select|textarea|button|object)$/i,Mi=/^(?:a|area)$/i;re.fn.extend({prop:function(t,e){return De(this,re.prop,t,e,arguments.length>1)},removeProp:function(t){return t=re.propFix[t]||t,this.each(function(){try{this[t]=void 0,delete this[t]}catch(e){}})}}),re.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(t,e,i){var n,r,s,o=t.nodeType;if(t&&3!==o&&8!==o&&2!==o)return s=1!==o||!re.isXMLDoc(t),s&&(e=re.propFix[e]||e,r=re.propHooks[e]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:t[e]=i:r&&"get"in r&&null!==(n=r.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=re.find.attr(t,"tabindex");return e?parseInt(e,10):Si.test(t.nodeName)||Mi.test(t.nodeName)&&t.href?0:-1}}}}),ie.hrefNormalized||re.each(["href","src"],function(t,e){re.propHooks[e]={get:function(t){return t.getAttribute(e,4)}}}),ie.optSelected||(re.propHooks.selected={get:function(t){var e=t.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null}}),re.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){re.propFix[this.toLowerCase()]=this}),ie.enctype||(re.propFix.enctype="encoding");var Di=/[\t\r\n\f]/g;re.fn.extend({addClass:function(t){var e,i,n,r,s,o,a=0,l=this.length,c="string"==typeof t&&t;if(re.isFunction(t))return this.each(function(e){re(this).addClass(t.call(this,e,this.className))});if(c)for(e=(t||"").match(ye)||[];l>a;a++)if(i=this[a],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Di," "):" ")){for(s=0;r=e[s++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");o=re.trim(n),i.className!==o&&(i.className=o)
}return this},removeClass:function(t){var e,i,n,r,s,o,a=0,l=this.length,c=0===arguments.length||"string"==typeof t&&t;if(re.isFunction(t))return this.each(function(e){re(this).removeClass(t.call(this,e,this.className))});if(c)for(e=(t||"").match(ye)||[];l>a;a++)if(i=this[a],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Di," "):"")){for(s=0;r=e[s++];)for(;n.indexOf(" "+r+" ")>=0;)n=n.replace(" "+r+" "," ");o=t?re.trim(n):"",i.className!==o&&(i.className=o)}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):this.each(re.isFunction(t)?function(i){re(this).toggleClass(t.call(this,i,this.className,e),e)}:function(){if("string"===i)for(var e,n=0,r=re(this),s=t.match(ye)||[];e=s[n++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else(i===ke||"boolean"===i)&&(this.className&&re._data(this,"__className__",this.className),this.className=this.className||t===!1?"":re._data(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(Di," ").indexOf(e)>=0)return!0;return!1}}),re.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){re.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),re.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}});var $i=re.now(),Ei=/\?/,Pi=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;re.parseJSON=function(e){if(t.JSON&&t.JSON.parse)return t.JSON.parse(e+"");var i,n=null,r=re.trim(e+"");return r&&!re.trim(r.replace(Pi,function(t,e,r,s){return i&&e&&(n=0),0===n?t:(i=r||e,n+=!s-!r,"")}))?Function("return "+r)():re.error("Invalid JSON: "+e)},re.parseXML=function(e){var i,n;if(!e||"string"!=typeof e)return null;try{t.DOMParser?(n=new DOMParser,i=n.parseFromString(e,"text/xml")):(i=new ActiveXObject("Microsoft.XMLDOM"),i.async="false",i.loadXML(e))}catch(r){i=void 0}return i&&i.documentElement&&!i.getElementsByTagName("parsererror").length||re.error("Invalid XML: "+e),i};var Ii,Ni,Fi=/#.*$/,Oi=/([?&])_=[^&]*/,Bi=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,zi=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ri=/^(?:GET|HEAD)$/,Li=/^\/\//,Hi=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Wi={},ji={},qi="*/".concat("*");try{Ni=location.href}catch(Vi){Ni=fe.createElement("a"),Ni.href="",Ni=Ni.href}Ii=Hi.exec(Ni.toLowerCase())||[],re.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ni,type:"GET",isLocal:zi.test(Ii[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":qi,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":re.parseJSON,"text xml":re.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?H(H(t,re.ajaxSettings),e):H(re.ajaxSettings,t)},ajaxPrefilter:R(Wi),ajaxTransport:R(ji),ajax:function(t,e){function i(t,e,i,n){var r,u,v,b,_,x=e;2!==y&&(y=2,a&&clearTimeout(a),c=void 0,o=n||"",w.readyState=t>0?4:0,r=t>=200&&300>t||304===t,i&&(b=W(h,w,i)),b=j(h,b,w,r),r?(h.ifModified&&(_=w.getResponseHeader("Last-Modified"),_&&(re.lastModified[s]=_),_=w.getResponseHeader("etag"),_&&(re.etag[s]=_)),204===t||"HEAD"===h.type?x="nocontent":304===t?x="notmodified":(x=b.state,u=b.data,v=b.error,r=!v)):(v=x,(t||!x)&&(x="error",0>t&&(t=0))),w.status=t,w.statusText=(e||x)+"",r?f.resolveWith(d,[u,x,w]):f.rejectWith(d,[w,x,v]),w.statusCode(m),m=void 0,l&&p.trigger(r?"ajaxSuccess":"ajaxError",[w,h,r?u:v]),g.fireWith(d,[w,x]),l&&(p.trigger("ajaxComplete",[w,h]),--re.active||re.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,r,s,o,a,l,c,u,h=re.ajaxSetup({},e),d=h.context||h,p=h.context&&(d.nodeType||d.jquery)?re(d):re.event,f=re.Deferred(),g=re.Callbacks("once memory"),m=h.statusCode||{},v={},b={},y=0,_="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(2===y){if(!u)for(u={};e=Bi.exec(o);)u[e[1].toLowerCase()]=e[2];e=u[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===y?o:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return y||(t=b[i]=b[i]||t,v[t]=e),this},overrideMimeType:function(t){return y||(h.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>y)for(e in t)m[e]=[m[e],t[e]];else w.always(t[w.status]);return this},abort:function(t){var e=t||_;return c&&c.abort(e),i(0,e),this}};if(f.promise(w).complete=g.add,w.success=w.done,w.error=w.fail,h.url=((t||h.url||Ni)+"").replace(Fi,"").replace(Li,Ii[1]+"//"),h.type=e.method||e.type||h.method||h.type,h.dataTypes=re.trim(h.dataType||"*").toLowerCase().match(ye)||[""],null==h.crossDomain&&(n=Hi.exec(h.url.toLowerCase()),h.crossDomain=!(!n||n[1]===Ii[1]&&n[2]===Ii[2]&&(n[3]||("http:"===n[1]?"80":"443"))===(Ii[3]||("http:"===Ii[1]?"80":"443")))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=re.param(h.data,h.traditional)),L(Wi,h,e,w),2===y)return w;l=re.event&&h.global,l&&0===re.active++&&re.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!Ri.test(h.type),s=h.url,h.hasContent||(h.data&&(s=h.url+=(Ei.test(s)?"&":"?")+h.data,delete h.data),h.cache===!1&&(h.url=Oi.test(s)?s.replace(Oi,"$1_="+$i++):s+(Ei.test(s)?"&":"?")+"_="+$i++)),h.ifModified&&(re.lastModified[s]&&w.setRequestHeader("If-Modified-Since",re.lastModified[s]),re.etag[s]&&w.setRequestHeader("If-None-Match",re.etag[s])),(h.data&&h.hasContent&&h.contentType!==!1||e.contentType)&&w.setRequestHeader("Content-Type",h.contentType),w.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+qi+"; q=0.01":""):h.accepts["*"]);for(r in h.headers)w.setRequestHeader(r,h.headers[r]);if(h.beforeSend&&(h.beforeSend.call(d,w,h)===!1||2===y))return w.abort();_="abort";for(r in{success:1,error:1,complete:1})w[r](h[r]);if(c=L(ji,h,e,w)){w.readyState=1,l&&p.trigger("ajaxSend",[w,h]),h.async&&h.timeout>0&&(a=setTimeout(function(){w.abort("timeout")},h.timeout));try{y=1,c.send(v,i)}catch(x){if(!(2>y))throw x;i(-1,x)}}else i(-1,"No Transport");return w},getJSON:function(t,e,i){return re.get(t,e,i,"json")},getScript:function(t,e){return re.get(t,void 0,e,"script")}}),re.each(["get","post"],function(t,e){re[e]=function(t,i,n,r){return re.isFunction(i)&&(r=r||n,n=i,i=void 0),re.ajax({url:t,type:e,dataType:r,data:i,success:n})}}),re._evalUrl=function(t){return re.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},re.fn.extend({wrapAll:function(t){if(re.isFunction(t))return this.each(function(e){re(this).wrapAll(t.call(this,e))});if(this[0]){var e=re(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;)t=t.firstChild;return t}).append(this)}return this},wrapInner:function(t){return this.each(re.isFunction(t)?function(e){re(this).wrapInner(t.call(this,e))}:function(){var e=re(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=re.isFunction(t);return this.each(function(i){re(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(){return this.parent().each(function(){re.nodeName(this,"body")||re(this).replaceWith(this.childNodes)}).end()}}),re.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0||!ie.reliableHiddenOffsets()&&"none"===(t.style&&t.style.display||re.css(t,"display"))},re.expr.filters.visible=function(t){return!re.expr.filters.hidden(t)};var Ui=/%20/g,Yi=/\[\]$/,Gi=/\r?\n/g,Ki=/^(?:submit|button|image|reset|file)$/i,Ji=/^(?:input|select|textarea|keygen)/i;re.param=function(t,e){var i,n=[],r=function(t,e){e=re.isFunction(e)?e():null==e?"":e,n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=re.ajaxSettings&&re.ajaxSettings.traditional),re.isArray(t)||t.jquery&&!re.isPlainObject(t))re.each(t,function(){r(this.name,this.value)});else for(i in t)q(i,t[i],e,r);return n.join("&").replace(Ui,"+")},re.fn.extend({serialize:function(){return re.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=re.prop(this,"elements");return t?re.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!re(this).is(":disabled")&&Ji.test(this.nodeName)&&!Ki.test(t)&&(this.checked||!$e.test(t))}).map(function(t,e){var i=re(this).val();return null==i?null:re.isArray(i)?re.map(i,function(t){return{name:e.name,value:t.replace(Gi,"\r\n")}}):{name:e.name,value:i.replace(Gi,"\r\n")}}).get()}}),re.ajaxSettings.xhr=void 0!==t.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&V()||U()}:V;var Xi=0,Qi={},Zi=re.ajaxSettings.xhr();t.attachEvent&&t.attachEvent("onunload",function(){for(var t in Qi)Qi[t](void 0,!0)}),ie.cors=!!Zi&&"withCredentials"in Zi,Zi=ie.ajax=!!Zi,Zi&&re.ajaxTransport(function(t){if(!t.crossDomain||ie.cors){var e;return{send:function(i,n){var r,s=t.xhr(),o=++Xi;if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(r in t.xhrFields)s[r]=t.xhrFields[r];t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(r in i)void 0!==i[r]&&s.setRequestHeader(r,i[r]+"");s.send(t.hasContent&&t.data||null),e=function(i,r){var a,l,c;if(e&&(r||4===s.readyState))if(delete Qi[o],e=void 0,s.onreadystatechange=re.noop,r)4!==s.readyState&&s.abort();else{c={},a=s.status,"string"==typeof s.responseText&&(c.text=s.responseText);try{l=s.statusText}catch(u){l=""}a||!t.isLocal||t.crossDomain?1223===a&&(a=204):a=c.text?200:404}c&&n(a,l,c,s.getAllResponseHeaders())},t.async?4===s.readyState?setTimeout(e):s.onreadystatechange=Qi[o]=e:e()},abort:function(){e&&e(void 0,!0)}}}}),re.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return re.globalEval(t),t}}}),re.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)}),re.ajaxTransport("script",function(t){if(t.crossDomain){var e,i=fe.head||re("head")[0]||fe.documentElement;return{send:function(n,r){e=fe.createElement("script"),e.async=!0,t.scriptCharset&&(e.charset=t.scriptCharset),e.src=t.url,e.onload=e.onreadystatechange=function(t,i){(i||!e.readyState||/loaded|complete/.test(e.readyState))&&(e.onload=e.onreadystatechange=null,e.parentNode&&e.parentNode.removeChild(e),e=null,i||r(200,"success"))},i.insertBefore(e,i.firstChild)},abort:function(){e&&e.onload(void 0,!0)}}}});var tn=[],en=/(=)\?(?=&|$)|\?\?/;re.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=tn.pop()||re.expando+"_"+$i++;return this[t]=!0,t}}),re.ajaxPrefilter("json jsonp",function(e,i,n){var r,s,o,a=e.jsonp!==!1&&(en.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&en.test(e.data)&&"data");return a||"jsonp"===e.dataTypes[0]?(r=e.jsonpCallback=re.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(en,"$1"+r):e.jsonp!==!1&&(e.url+=(Ei.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||re.error(r+" was not called"),o[0]},e.dataTypes[0]="json",s=t[r],t[r]=function(){o=arguments},n.always(function(){t[r]=s,e[r]&&(e.jsonpCallback=i.jsonpCallback,tn.push(r)),o&&re.isFunction(s)&&s(o[0]),o=s=void 0}),"script"):void 0}),re.parseHTML=function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||fe;var n=he.exec(t),r=!i&&[];return n?[e.createElement(n[1])]:(n=re.buildFragment([t],e,r),r&&r.length&&re(r).remove(),re.merge([],n.childNodes))};var nn=re.fn.load;re.fn.load=function(t,e,i){if("string"!=typeof t&&nn)return nn.apply(this,arguments);var n,r,s,o=this,a=t.indexOf(" ");return a>=0&&(n=re.trim(t.slice(a,t.length)),t=t.slice(0,a)),re.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(s="POST"),o.length>0&&re.ajax({url:t,type:s,dataType:"html",data:e}).done(function(t){r=arguments,o.html(n?re("<div>").append(re.parseHTML(t)).find(n):t)}).complete(i&&function(t,e){o.each(i,r||[t.responseText,e,t])}),this},re.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){re.fn[e]=function(t){return this.on(e,t)}}),re.expr.filters.animated=function(t){return re.grep(re.timers,function(e){return t===e.elem}).length};var rn=t.document.documentElement;re.offset={setOffset:function(t,e,i){var n,r,s,o,a,l,c,u=re.css(t,"position"),h=re(t),d={};"static"===u&&(t.style.position="relative"),a=h.offset(),s=re.css(t,"top"),l=re.css(t,"left"),c=("absolute"===u||"fixed"===u)&&re.inArray("auto",[s,l])>-1,c?(n=h.position(),o=n.top,r=n.left):(o=parseFloat(s)||0,r=parseFloat(l)||0),re.isFunction(e)&&(e=e.call(t,i,a)),null!=e.top&&(d.top=e.top-a.top+o),null!=e.left&&(d.left=e.left-a.left+r),"using"in e?e.using.call(t,d):h.css(d)}},re.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){re.offset.setOffset(this,t,e)});var e,i,n={top:0,left:0},r=this[0],s=r&&r.ownerDocument;if(s)return e=s.documentElement,re.contains(e,r)?(typeof r.getBoundingClientRect!==ke&&(n=r.getBoundingClientRect()),i=Y(s),{top:n.top+(i.pageYOffset||e.scrollTop)-(e.clientTop||0),left:n.left+(i.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}):n},position:function(){if(this[0]){var t,e,i={top:0,left:0},n=this[0];return"fixed"===re.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),re.nodeName(t[0],"html")||(i=t.offset()),i.top+=re.css(t[0],"borderTopWidth",!0),i.left+=re.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-re.css(n,"marginTop",!0),left:e.left-i.left-re.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||rn;t&&!re.nodeName(t,"html")&&"static"===re.css(t,"position");)t=t.offsetParent;return t||rn})}}),re.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var i=/Y/.test(e);re.fn[t]=function(n){return De(this,function(t,n,r){var s=Y(t);return void 0===r?s?e in s?s[e]:s.document.documentElement[n]:t[n]:void(s?s.scrollTo(i?re(s).scrollLeft():r,i?r:re(s).scrollTop()):t[n]=r)},t,n,arguments.length,null)}}),re.each(["top","left"],function(t,e){re.cssHooks[e]=T(ie.pixelPosition,function(t,i){return i?(i=ei(t,e),ni.test(i)?re(t).position()[e]+"px":i):void 0})}),re.each({Height:"height",Width:"width"},function(t,e){re.each({padding:"inner"+t,content:e,"":"outer"+t},function(i,n){re.fn[n]=function(n,r){var s=arguments.length&&(i||"boolean"!=typeof n),o=i||(n===!0||r===!0?"margin":"border");return De(this,function(e,i,n){var r;return re.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+t],r["scroll"+t],e.body["offset"+t],r["offset"+t],r["client"+t])):void 0===n?re.css(e,i,o):re.style(e,i,n,o)},e,s?n:void 0,s,null)}})}),re.fn.size=function(){return this.length},re.fn.andSelf=re.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return re});var sn=t.jQuery,on=t.$;return re.noConflict=function(e){return t.$===re&&(t.$=on),e&&t.jQuery===re&&(t.jQuery=sn),re},typeof e===ke&&(t.jQuery=t.$=re),re}),function(t,e){function i(e,i){var r,s,o,a=e.nodeName.toLowerCase();return"area"===a?(r=e.parentNode,s=r.name,e.href&&s&&"map"===r.nodeName.toLowerCase()?(o=t("img[usemap=#"+s+"]")[0],!!o&&n(o)):!1):(/input|select|textarea|button|object/.test(a)?!e.disabled:"a"===a?e.href||i:i)&&n(e)}function n(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}var r=0,s=/^ui-id-\d+$/;t.ui=t.ui||{},t.extend(t.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({focus:function(e){return function(i,n){return"number"==typeof i?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),n&&n.call(e)},i)}):e.apply(this,arguments)}}(t.fn.focus),scrollParent:function(){var e;return e=t.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(t.css(this,"position"))&&/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!e.length?t(document):e},zIndex:function(i){if(i!==e)return this.css("zIndex",i);if(this.length)for(var n,r,s=t(this[0]);s.length&&s[0]!==document;){if(n=s.css("position"),("absolute"===n||"relative"===n||"fixed"===n)&&(r=parseInt(s.css("zIndex"),10),!isNaN(r)&&0!==r))return r;s=s.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++r)})},removeUniqueId:function(){return this.each(function(){s.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,n){return!!t.data(e,n[3])},focusable:function(e){return i(e,!isNaN(t.attr(e,"tabindex")))},tabbable:function(e){var n=t.attr(e,"tabindex"),r=isNaN(n);return(r||n>=0)&&i(e,!r)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(i,n){function r(e,i,n,r){return t.each(s,function(){i-=parseFloat(t.css(e,"padding"+this))||0,n&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),r&&(i-=parseFloat(t.css(e,"margin"+this))||0)}),i}var s="Width"===n?["Left","Right"]:["Top","Bottom"],o=n.toLowerCase(),a={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+n]=function(i){return i===e?a["inner"+n].call(this):this.each(function(){t(this).css(o,r(this,i)+"px")})},t.fn["outer"+n]=function(e,i){return"number"!=typeof e?a["outer"+n].call(this,e):this.each(function(){t(this).css(o,r(this,e,!0,i)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(i){return arguments.length?e.call(this,t.camelCase(i)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.support.selectstart="onselectstart"in document.createElement("div"),t.fn.extend({disableSelection:function(){return this.bind((t.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(t){t.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),t.extend(t.ui,{plugin:{add:function(e,i,n){var r,s=t.ui[e].prototype;for(r in n)s.plugins[r]=s.plugins[r]||[],s.plugins[r].push([i,n[r]])},call:function(t,e,i){var n,r=t.plugins[e];if(r&&t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType)for(n=0;n<r.length;n++)t.options[r[n][0]]&&r[n][1].apply(t.element,i)}},hasScroll:function(e,i){if("hidden"===t(e).css("overflow"))return!1;var n=i&&"left"===i?"scrollLeft":"scrollTop",r=!1;return e[n]>0?!0:(e[n]=1,r=e[n]>0,e[n]=0,r)}})}(jQuery),function(t,e){var i=0,n=Array.prototype.slice,r=t.cleanData;t.cleanData=function(e){for(var i,n=0;null!=(i=e[n]);n++)try{t(i).triggerHandler("remove")}catch(s){}r(e)},t.widget=function(e,i,n){var r,s,o,a,l={},c=e.split(".")[0];e=e.split(".")[1],r=c+"-"+e,n||(n=i,i=t.Widget),t.expr[":"][r.toLowerCase()]=function(e){return!!t.data(e,r)},t[c]=t[c]||{},s=t[c][e],o=t[c][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new o(t,e)},t.extend(o,s,{version:n.version,_proto:t.extend({},n),_childConstructors:[]}),a=new i,a.options=t.widget.extend({},a.options),t.each(n,function(e,n){return t.isFunction(n)?void(l[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},r=function(t){return i.prototype[e].apply(this,t)};return function(){var e,i=this._super,s=this._superApply;return this._super=t,this._superApply=r,e=n.apply(this,arguments),this._super=i,this._superApply=s,e}}()):void(l[e]=n)}),o.prototype=t.widget.extend(a,{widgetEventPrefix:s?a.widgetEventPrefix||e:e},l,{constructor:o,namespace:c,widgetName:e,widgetFullName:r}),s?(t.each(s._childConstructors,function(e,i){var n=i.prototype;t.widget(n.namespace+"."+n.widgetName,o,i._proto)}),delete s._childConstructors):i._childConstructors.push(o),t.widget.bridge(e,o)},t.widget.extend=function(i){for(var r,s,o=n.call(arguments,1),a=0,l=o.length;l>a;a++)for(r in o[a])s=o[a][r],o[a].hasOwnProperty(r)&&s!==e&&(i[r]=t.isPlainObject(s)?t.isPlainObject(i[r])?t.widget.extend({},i[r],s):t.widget.extend({},s):s);return i},t.widget.bridge=function(i,r){var s=r.prototype.widgetFullName||i;t.fn[i]=function(o){var a="string"==typeof o,l=n.call(arguments,1),c=this;return o=!a&&l.length?t.widget.extend.apply(null,[o].concat(l)):o,this.each(a?function(){var n,r=t.data(this,s);return r?t.isFunction(r[o])&&"_"!==o.charAt(0)?(n=r[o].apply(r,l),n!==r&&n!==e?(c=n&&n.jquery?c.pushStack(n.get()):n,!1):void 0):t.error("no such method '"+o+"' for "+i+" widget instance"):t.error("cannot call methods on "+i+" prior to initialization; attempted to call method '"+o+"'")}:function(){var e=t.data(this,s);e?e.option(o||{})._init():t.data(this,s,new r(o,this))}),c}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,n){n=t(n||this.defaultElement||this)[0],this.element=t(n),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=t(),this.hoverable=t(),this.focusable=t(),n!==this&&(t.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===n&&this.destroy()}}),this.document=t(n.style?n.ownerDocument:n.document||n),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(i,n){var r,s,o,a=i;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof i)if(a={},r=i.split("."),i=r.shift(),r.length){for(s=a[i]=t.widget.extend({},this.options[i]),o=0;o<r.length-1;o++)s[r[o]]=s[r[o]]||{},s=s[r[o]];if(i=r.pop(),1===arguments.length)return s[i]===e?null:s[i];s[i]=n}else{if(1===arguments.length)return this.options[i]===e?null:this.options[i];a[i]=n}return this._setOptions(a),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!e).attr("aria-disabled",e),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(e,i,n){var r,s=this;"boolean"!=typeof e&&(n=i,i=e,e=!1),n?(i=r=t(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,r=this.widget()),t.each(n,function(n,o){function a(){return e||s.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof o?s[o]:o).apply(s,arguments):void 0}"string"!=typeof o&&(a.guid=o.guid=o.guid||a.guid||t.guid++);var l=n.match(/^(\w+)\s*(.*)$/),c=l[1]+s.eventNamespace,u=l[2];u?r.delegate(u,c,a):i.bind(c,a)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e)},_delay:function(t,e){function i(){return("string"==typeof t?n[t]:t).apply(n,arguments)}var n=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,n){var r,s,o=this.options[e];if(n=n||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],s=i.originalEvent)for(r in s)r in i||(i[r]=s[r]);return this.element.trigger(i,n),!(t.isFunction(o)&&o.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(n,r,s){"string"==typeof r&&(r={effect:r});var o,a=r?r===!0||"number"==typeof r?i:r.effect||i:e;r=r||{},"number"==typeof r&&(r={duration:r}),o=!t.isEmptyObject(r),r.complete=s,r.delay&&n.delay(r.delay),o&&t.effects&&t.effects.effect[a]?n[e](r):a!==e&&n[a]?n[a](r.duration,r.easing,s):n.queue(function(i){t(this)[e](),s&&s.call(n[0]),i()})}})}(jQuery),function(t){var e=!1;t(document).mouseup(function(){e=!1}),t.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(i){return!0===t.data(i.target,e.widgetName+".preventClickEvent")?(t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&t(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!e){this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var n=this,r=1===i.which,s="string"==typeof this.options.cancel&&i.target.nodeName?t(i.target).closest(this.options.cancel).length:!1;return r&&!s&&this._mouseCapture(i)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){n.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?(i.preventDefault(),!0):(!0===t.data(i.target,this.widgetName+".preventClickEvent")&&t.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return n._mouseMove(t)},this._mouseUpDelegate=function(t){return n._mouseUp(t)},t(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),e=!0,!0)):!0}},_mouseMove:function(e){return t.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button?this._mouseUp(e):this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return t(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(t){t.widget("ui.draggable",t.ui.mouse,{version:"1.10.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(e){var i=this.options;return this.helper||i.disabled||t(e.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(e),this.handle?(t(i.iframeFix===!0?"iframe":i.iframeFix).each(function(){t("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(t(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_mouseDrag:function(e,i){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),!i){var n=this._uiHash();if(this._trigger("drag",e,n)===!1)return this._mouseUp({}),!1;
this.position=n.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i=this,n=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(n=t.ui.ddmanager.drop(this,e)),this.dropped&&(n=this.dropped,this.dropped=!1),"original"!==this.options.helper||t.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||this.options.revert===!0||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",e)!==!1&&i._clear()}):this._trigger("stop",e)!==!1&&this._clear(),!1):!1},_mouseUp:function(e){return t("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return this.options.handle?!!t(e.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(e){var i=this.options,n=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.element.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,n,r=this.options;return r.containment?"window"===r.containment?void(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===r.containment?void(this.containment=[0,0,t(document).width()-this.helperProportions.width-this.margins.left,(t(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):r.containment.constructor===Array?void(this.containment=r.containment):("parent"===r.containment&&(r.containment=this.helper[0].parentNode),i=t(r.containment),n=i[0],void(n&&(e="hidden"!==i.css("overflow"),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(e?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=i))):void(this.containment=null)},_convertPositionTo:function(e,i){i||(i=this.position);var n="absolute"===e?1:-1,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:r.scrollTop(),left:r.scrollLeft()}),{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*n}},_generatePosition:function(e){var i,n,r,s,o=this.options,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=e.pageX,c=e.pageY;return this.offset.scroll||(this.offset.scroll={top:a.scrollTop(),left:a.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(n=this.relative_container.offset(),i=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(c=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(c=i[3]+this.offset.click.top)),o.grid&&(r=o.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,c=i?r-this.offset.click.top>=i[1]||r-this.offset.click.top>i[3]?r:r-this.offset.click.top>=i[1]?r-o.grid[1]:r+o.grid[1]:r,s=o.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,l=i?s-this.offset.click.left>=i[0]||s-this.offset.click.left>i[2]?s:s-this.offset.click.left>=i[0]?s-o.grid[0]:s+o.grid[0]:s)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(e,i,n){return n=n||this._uiHash(),t.ui.plugin.call(this,e,[i,n]),"drag"===e&&(this.positionAbs=this._convertPositionTo("absolute")),t.Widget.prototype._trigger.call(this,e,i,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i){var n=t(this).data("ui-draggable"),r=n.options,s=t.extend({},i,{item:n.element});n.sortables=[],t(r.connectToSortable).each(function(){var i=t.data(this,"ui-sortable");i&&!i.options.disabled&&(n.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger("activate",e,s))})},stop:function(e,i){var n=t(this).data("ui-draggable"),r=t.extend({},i,{item:n.element});t.each(n.sortables,function(){this.instance.isOver?(this.instance.isOver=0,n.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(e),this.instance.options.helper=this.instance.options._helper,"original"===n.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",e,r))})},drag:function(e,i){var n=t(this).data("ui-draggable"),r=this;t.each(n.sortables,function(){var s=!1,o=this;this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(s=!0,t.each(n.sortables,function(){return this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this!==o&&this.instance._intersectsWith(this.instance.containerCache)&&t.contains(o.instance.element[0],this.instance.element[0])&&(s=!1),s})),s?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=t(r).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},e.target=this.instance.currentItem[0],this.instance._mouseCapture(e,!0),this.instance._mouseStart(e,!0,!0),this.instance.offset.click.top=n.offset.click.top,this.instance.offset.click.left=n.offset.click.left,this.instance.offset.parent.left-=n.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=n.offset.parent.top-this.instance.offset.parent.top,n._trigger("toSortable",e),n.dropped=this.instance.element,n.currentItem=n.element,this.instance.fromOutside=n),this.instance.currentItem&&this.instance._mouseDrag(e)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",e,this.instance._uiHash(this.instance)),this.instance._mouseStop(e,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),n._trigger("fromSortable",e),n.dropped=!1)})}}),t.ui.plugin.add("draggable","cursor",{start:function(){var e=t("body"),i=t(this).data("ui-draggable").options;e.css("cursor")&&(i._cursor=e.css("cursor")),e.css("cursor",i.cursor)},stop:function(){var e=t(this).data("ui-draggable").options;e._cursor&&t("body").css("cursor",e._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,i){var n=t(i.helper),r=t(this).data("ui-draggable").options;n.css("opacity")&&(r._opacity=n.css("opacity")),n.css("opacity",r.opacity)},stop:function(e,i){var n=t(this).data("ui-draggable").options;n._opacity&&t(i.helper).css("opacity",n._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(){var e=t(this).data("ui-draggable");e.scrollParent[0]!==document&&"HTML"!==e.scrollParent[0].tagName&&(e.overflowOffset=e.scrollParent.offset())},drag:function(e){var i=t(this).data("ui-draggable"),n=i.options,r=!1;i.scrollParent[0]!==document&&"HTML"!==i.scrollParent[0].tagName?(n.axis&&"x"===n.axis||(i.overflowOffset.top+i.scrollParent[0].offsetHeight-e.pageY<n.scrollSensitivity?i.scrollParent[0].scrollTop=r=i.scrollParent[0].scrollTop+n.scrollSpeed:e.pageY-i.overflowOffset.top<n.scrollSensitivity&&(i.scrollParent[0].scrollTop=r=i.scrollParent[0].scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(i.overflowOffset.left+i.scrollParent[0].offsetWidth-e.pageX<n.scrollSensitivity?i.scrollParent[0].scrollLeft=r=i.scrollParent[0].scrollLeft+n.scrollSpeed:e.pageX-i.overflowOffset.left<n.scrollSensitivity&&(i.scrollParent[0].scrollLeft=r=i.scrollParent[0].scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(e.pageY-t(document).scrollTop()<n.scrollSensitivity?r=t(document).scrollTop(t(document).scrollTop()-n.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<n.scrollSensitivity&&(r=t(document).scrollTop(t(document).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(e.pageX-t(document).scrollLeft()<n.scrollSensitivity?r=t(document).scrollLeft(t(document).scrollLeft()-n.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<n.scrollSensitivity&&(r=t(document).scrollLeft(t(document).scrollLeft()+n.scrollSpeed)))),r!==!1&&t.ui.ddmanager&&!n.dropBehaviour&&t.ui.ddmanager.prepareOffsets(i,e)}}),t.ui.plugin.add("draggable","snap",{start:function(){var e=t(this).data("ui-draggable"),i=e.options;e.snapElements=[],t(i.snap.constructor!==String?i.snap.items||":data(ui-draggable)":i.snap).each(function(){var i=t(this),n=i.offset();this!==e.element[0]&&e.snapElements.push({item:this,width:i.outerWidth(),height:i.outerHeight(),top:n.top,left:n.left})})},drag:function(e,i){var n,r,s,o,a,l,c,u,h,d,p=t(this).data("ui-draggable"),f=p.options,g=f.snapTolerance,m=i.offset.left,v=m+p.helperProportions.width,b=i.offset.top,y=b+p.helperProportions.height;for(h=p.snapElements.length-1;h>=0;h--)a=p.snapElements[h].left,l=a+p.snapElements[h].width,c=p.snapElements[h].top,u=c+p.snapElements[h].height,a-g>v||m>l+g||c-g>y||b>u+g||!t.contains(p.snapElements[h].item.ownerDocument,p.snapElements[h].item)?(p.snapElements[h].snapping&&p.options.snap.release&&p.options.snap.release.call(p.element,e,t.extend(p._uiHash(),{snapItem:p.snapElements[h].item})),p.snapElements[h].snapping=!1):("inner"!==f.snapMode&&(n=Math.abs(c-y)<=g,r=Math.abs(u-b)<=g,s=Math.abs(a-v)<=g,o=Math.abs(l-m)<=g,n&&(i.position.top=p._convertPositionTo("relative",{top:c-p.helperProportions.height,left:0}).top-p.margins.top),r&&(i.position.top=p._convertPositionTo("relative",{top:u,left:0}).top-p.margins.top),s&&(i.position.left=p._convertPositionTo("relative",{top:0,left:a-p.helperProportions.width}).left-p.margins.left),o&&(i.position.left=p._convertPositionTo("relative",{top:0,left:l}).left-p.margins.left)),d=n||r||s||o,"outer"!==f.snapMode&&(n=Math.abs(c-b)<=g,r=Math.abs(u-y)<=g,s=Math.abs(a-m)<=g,o=Math.abs(l-v)<=g,n&&(i.position.top=p._convertPositionTo("relative",{top:c,left:0}).top-p.margins.top),r&&(i.position.top=p._convertPositionTo("relative",{top:u-p.helperProportions.height,left:0}).top-p.margins.top),s&&(i.position.left=p._convertPositionTo("relative",{top:0,left:a}).left-p.margins.left),o&&(i.position.left=p._convertPositionTo("relative",{top:0,left:l-p.helperProportions.width}).left-p.margins.left)),!p.snapElements[h].snapping&&(n||r||s||o||d)&&p.options.snap.snap&&p.options.snap.snap.call(p.element,e,t.extend(p._uiHash(),{snapItem:p.snapElements[h].item})),p.snapElements[h].snapping=n||r||s||o||d)}}),t.ui.plugin.add("draggable","stack",{start:function(){var e,i=this.data("ui-draggable").options,n=t.makeArray(t(i.stack)).sort(function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)});n.length&&(e=parseInt(t(n[0]).css("zIndex"),10)||0,t(n).each(function(i){t(this).css("zIndex",e+i)}),this.css("zIndex",e+n.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,i){var n=t(i.helper),r=t(this).data("ui-draggable").options;n.css("zIndex")&&(r._zIndex=n.css("zIndex")),n.css("zIndex",r.zIndex)},stop:function(e,i){var n=t(this).data("ui-draggable").options;n._zIndex&&t(i.helper).css("zIndex",n._zIndex)}})}(jQuery),function(t){function e(t,e,i){return t>e&&e+i>t}t.widget("ui.droppable",{version:"1.10.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,i=this.options,n=i.accept;this.isover=!1,this.isout=!0,this.accept=t.isFunction(n)?n:function(t){return t.is(n)},this.proportions=function(){return arguments.length?void(e=arguments[0]):e?e:e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},t.ui.ddmanager.droppables[i.scope]=t.ui.ddmanager.droppables[i.scope]||[],t.ui.ddmanager.droppables[i.scope].push(this),i.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var e=0,i=t.ui.ddmanager.droppables[this.options.scope];e<i.length;e++)i[e]===this&&i.splice(e,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,i){"accept"===e&&(this.accept=t.isFunction(i)?i:function(t){return t.is(i)}),t.Widget.prototype._setOption.apply(this,arguments)},_activate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",e,this.ui(i))},_deactivate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",e,this.ui(i))},_over:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(i)))},_out:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(i)))},_drop:function(e,i){var n=i||t.ui.ddmanager.current,r=!1;return n&&(n.currentItem||n.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var e=t.data(this,"ui-droppable");return e.options.greedy&&!e.options.disabled&&e.options.scope===n.options.scope&&e.accept.call(e.element[0],n.currentItem||n.element)&&t.ui.intersect(n,t.extend(e,{offset:e.element.offset()}),e.options.tolerance)?(r=!0,!1):void 0}),r?!1:this.accept.call(this.element[0],n.currentItem||n.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(n)),this.element):!1):!1},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}}}),t.ui.intersect=function(t,i,n){if(!i.offset)return!1;var r,s,o=(t.positionAbs||t.position.absolute).left,a=(t.positionAbs||t.position.absolute).top,l=o+t.helperProportions.width,c=a+t.helperProportions.height,u=i.offset.left,h=i.offset.top,d=u+i.proportions().width,p=h+i.proportions().height;switch(n){case"fit":return o>=u&&d>=l&&a>=h&&p>=c;case"intersect":return u<o+t.helperProportions.width/2&&l-t.helperProportions.width/2<d&&h<a+t.helperProportions.height/2&&c-t.helperProportions.height/2<p;case"pointer":return r=(t.positionAbs||t.position.absolute).left+(t.clickOffset||t.offset.click).left,s=(t.positionAbs||t.position.absolute).top+(t.clickOffset||t.offset.click).top,e(s,h,i.proportions().height)&&e(r,u,i.proportions().width);case"touch":return(a>=h&&p>=a||c>=h&&p>=c||h>a&&c>p)&&(o>=u&&d>=o||l>=u&&d>=l||u>o&&l>d);default:return!1}},t.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(e,i){var n,r,s=t.ui.ddmanager.droppables[e.options.scope]||[],o=i?i.type:null,a=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(n=0;n<s.length;n++)if(!(s[n].options.disabled||e&&!s[n].accept.call(s[n].element[0],e.currentItem||e.element))){for(r=0;r<a.length;r++)if(a[r]===s[n].element[0]){s[n].proportions().height=0;continue t}s[n].visible="none"!==s[n].element.css("display"),s[n].visible&&("mousedown"===o&&s[n]._activate.call(s[n],i),s[n].offset=s[n].element.offset(),s[n].proportions({width:s[n].element[0].offsetWidth,height:s[n].element[0].offsetHeight}))}},drop:function(e,i){var n=!1;return t.each((t.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&t.ui.intersect(e,this,this.options.tolerance)&&(n=this._drop.call(this,i)||n),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),n},dragStart:function(e,i){e.element.parentsUntil("body").bind("scroll.droppable",function(){e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)})},drag:function(e,i){e.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(e,i),t.each(t.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var n,r,s,o=t.ui.intersect(e,this,this.options.tolerance),a=!o&&this.isover?"isout":o&&!this.isover?"isover":null;a&&(this.options.greedy&&(r=this.options.scope,s=this.element.parents(":data(ui-droppable)").filter(function(){return t.data(this,"ui-droppable").options.scope===r}),s.length&&(n=t.data(s[0],"ui-droppable"),n.greedyChild="isover"===a)),n&&"isover"===a&&(n.isover=!1,n.isout=!0,n._out.call(n,i)),this[a]=!0,this["isout"===a?"isover":"isout"]=!1,this["isover"===a?"_over":"_out"].call(this,i),n&&"isout"===a&&(n.isout=!1,n.isover=!0,n._over.call(n,i)))}})},dragStop:function(e,i){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)}}}(jQuery),function(t){function e(t){return parseInt(t,10)||0}function i(t){return!isNaN(parseInt(t,10))}t.widget("ui.resizable",t.ui.mouse,{version:"1.10.4",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var e,i,n,r,s,o=this,a=this.options;if(this.element.addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!a.aspectRatio,aspectRatio:a.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:a.helper||a.ghost||a.animate?a.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(t("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=a.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),e=this.handles.split(","),this.handles={},i=0;i<e.length;i++)n=t.trim(e[i]),s="ui-resizable-"+n,r=t("<div class='ui-resizable-handle "+s+"'></div>"),r.css({zIndex:a.zIndex}),"se"===n&&r.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[n]=".ui-resizable-"+n,this.element.append(r);this._renderAxis=function(e){var i,n,r,s;e=e||this.element;for(i in this.handles)this.handles[i].constructor===String&&(this.handles[i]=t(this.handles[i],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(n=t(this.handles[i],this.element),s=/sw|ne|nw|se|n|s/.test(i)?n.outerHeight():n.outerWidth(),r=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),e.css(r,s),this._proportionallyResize()),t(this.handles[i]).length},this._renderAxis(this.element),this._handles=t(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(r=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=r&&r[1]?r[1]:"se")}),a.autoHide&&(this._handles.hide(),t(this.element).addClass("ui-resizable-autohide").mouseenter(function(){a.disabled||(t(this).removeClass("ui-resizable-autohide"),o._handles.show())}).mouseleave(function(){a.disabled||o.resizing||(t(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e,i=function(e){t(e).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(e){var i,n,r=!1;for(i in this.handles)n=t(this.handles[i])[0],(n===e.target||t.contains(n,e.target))&&(r=!0);return!this.options.disabled&&r},_mouseStart:function(i){var n,r,s,o=this.options,a=this.element.position(),l=this.element;return this.resizing=!0,/absolute/.test(l.css("position"))?l.css({position:"absolute",top:l.css("top"),left:l.css("left")}):l.is(".ui-draggable")&&l.css({position:"absolute",top:a.top,left:a.left}),this._renderProxy(),n=e(this.helper.css("left")),r=e(this.helper.css("top")),o.containment&&(n+=t(o.containment).scrollLeft()||0,r+=t(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:n,top:r},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:l.width(),height:l.height()},this.originalSize=this._helper?{width:l.outerWidth(),height:l.outerHeight()}:{width:l.width(),height:l.height()},this.originalPosition={left:n,top:r},this.sizeDiff={width:l.outerWidth()-l.width(),height:l.outerHeight()-l.height()},this.originalMousePosition={left:i.pageX,top:i.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,s=t(".ui-resizable-"+this.axis).css("cursor"),t("body").css("cursor","auto"===s?this.axis+"-resize":s),l.addClass("ui-resizable-resizing"),this._propagate("start",i),!0},_mouseDrag:function(e){var i,n=this.helper,r={},s=this.originalMousePosition,o=this.axis,a=this.position.top,l=this.position.left,c=this.size.width,u=this.size.height,h=e.pageX-s.left||0,d=e.pageY-s.top||0,p=this._change[o];return p?(i=p.apply(this,[e,h,d]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(i=this._updateRatio(i,e)),i=this._respectSize(i,e),this._updateCache(i),this._propagate("resize",e),this.position.top!==a&&(r.top=this.position.top+"px"),this.position.left!==l&&(r.left=this.position.left+"px"),this.size.width!==c&&(r.width=this.size.width+"px"),this.size.height!==u&&(r.height=this.size.height+"px"),n.css(r),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),t.isEmptyObject(r)||this._trigger("resize",e,this.ui()),!1):!1},_mouseStop:function(e){this.resizing=!1;var i,n,r,s,o,a,l,c=this.options,u=this;return this._helper&&(i=this._proportionallyResizeElements,n=i.length&&/textarea/i.test(i[0].nodeName),r=n&&t.ui.hasScroll(i[0],"left")?0:u.sizeDiff.height,s=n?0:u.sizeDiff.width,o={width:u.helper.width()-s,height:u.helper.height()-r},a=parseInt(u.element.css("left"),10)+(u.position.left-u.originalPosition.left)||null,l=parseInt(u.element.css("top"),10)+(u.position.top-u.originalPosition.top)||null,c.animate||this.element.css(t.extend(o,{top:l,left:a})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!c.animate&&this._proportionallyResize()),t("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(t){var e,n,r,s,o,a=this.options;o={minWidth:i(a.minWidth)?a.minWidth:0,maxWidth:i(a.maxWidth)?a.maxWidth:1/0,minHeight:i(a.minHeight)?a.minHeight:0,maxHeight:i(a.maxHeight)?a.maxHeight:1/0},(this._aspectRatio||t)&&(e=o.minHeight*this.aspectRatio,r=o.minWidth/this.aspectRatio,n=o.maxHeight*this.aspectRatio,s=o.maxWidth/this.aspectRatio,e>o.minWidth&&(o.minWidth=e),r>o.minHeight&&(o.minHeight=r),n<o.maxWidth&&(o.maxWidth=n),s<o.maxHeight&&(o.maxHeight=s)),this._vBoundaries=o},_updateCache:function(t){this.offset=this.helper.offset(),i(t.left)&&(this.position.left=t.left),i(t.top)&&(this.position.top=t.top),i(t.height)&&(this.size.height=t.height),i(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,n=this.size,r=this.axis;return i(t.height)?t.width=t.height*this.aspectRatio:i(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===r&&(t.left=e.left+(n.width-t.width),t.top=null),"nw"===r&&(t.top=e.top+(n.height-t.height),t.left=e.left+(n.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,n=this.axis,r=i(t.width)&&e.maxWidth&&e.maxWidth<t.width,s=i(t.height)&&e.maxHeight&&e.maxHeight<t.height,o=i(t.width)&&e.minWidth&&e.minWidth>t.width,a=i(t.height)&&e.minHeight&&e.minHeight>t.height,l=this.originalPosition.left+this.originalSize.width,c=this.position.top+this.size.height,u=/sw|nw|w/.test(n),h=/nw|ne|n/.test(n);return o&&(t.width=e.minWidth),a&&(t.height=e.minHeight),r&&(t.width=e.maxWidth),s&&(t.height=e.maxHeight),o&&u&&(t.left=l-e.minWidth),r&&u&&(t.left=l-e.maxWidth),a&&h&&(t.top=c-e.minHeight),s&&h&&(t.top=c-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var t,e,i,n,r,s=this.helper||this.element;for(t=0;t<this._proportionallyResizeElements.length;t++){if(r=this._proportionallyResizeElements[t],!this.borderDif)for(this.borderDif=[],i=[r.css("borderTopWidth"),r.css("borderRightWidth"),r.css("borderBottomWidth"),r.css("borderLeftWidth")],n=[r.css("paddingTop"),r.css("paddingRight"),r.css("paddingBottom"),r.css("paddingLeft")],e=0;e<i.length;e++)this.borderDif[e]=(parseInt(i[e],10)||0)+(parseInt(n[e],10)||0);r.css({height:s.height()-this.borderDif[0]-this.borderDif[2]||0,width:s.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var e=this.element,i=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||t("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=this.originalSize,n=this.originalPosition;return{left:n.left+e,width:i.width-e}},n:function(t,e,i){var n=this.originalSize,r=this.originalPosition;return{top:r.top+i,height:n.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(e,i,n){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,i,n]))},sw:function(e,i,n){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,i,n]))},ne:function(e,i,n){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,i,n]))
},nw:function(e,i,n){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,i,n]))}},_propagate:function(e,i){t.ui.plugin.call(this,e,[i,this.ui()]),"resize"!==e&&this._trigger(e,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add("resizable","animate",{stop:function(e){var i=t(this).data("ui-resizable"),n=i.options,r=i._proportionallyResizeElements,s=r.length&&/textarea/i.test(r[0].nodeName),o=s&&t.ui.hasScroll(r[0],"left")?0:i.sizeDiff.height,a=s?0:i.sizeDiff.width,l={width:i.size.width-a,height:i.size.height-o},c=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,u=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(t.extend(l,u&&c?{top:u,left:c}:{}),{duration:n.animateDuration,easing:n.animateEasing,step:function(){var n={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};r&&r.length&&t(r[0]).css({width:n.width,height:n.height}),i._updateCache(n),i._propagate("resize",e)}})}}),t.ui.plugin.add("resizable","containment",{start:function(){var i,n,r,s,o,a,l,c=t(this).data("ui-resizable"),u=c.options,h=c.element,d=u.containment,p=d instanceof t?d.get(0):/parent/.test(d)?h.parent().get(0):d;p&&(c.containerElement=t(p),/document/.test(d)||d===document?(c.containerOffset={left:0,top:0},c.containerPosition={left:0,top:0},c.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight}):(i=t(p),n=[],t(["Top","Right","Left","Bottom"]).each(function(t,r){n[t]=e(i.css("padding"+r))}),c.containerOffset=i.offset(),c.containerPosition=i.position(),c.containerSize={height:i.innerHeight()-n[3],width:i.innerWidth()-n[1]},r=c.containerOffset,s=c.containerSize.height,o=c.containerSize.width,a=t.ui.hasScroll(p,"left")?p.scrollWidth:o,l=t.ui.hasScroll(p)?p.scrollHeight:s,c.parentData={element:p,left:r.left,top:r.top,width:a,height:l}))},resize:function(e){var i,n,r,s,o=t(this).data("ui-resizable"),a=o.options,l=o.containerOffset,c=o.position,u=o._aspectRatio||e.shiftKey,h={top:0,left:0},d=o.containerElement;d[0]!==document&&/static/.test(d.css("position"))&&(h=l),c.left<(o._helper?l.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-l.left:o.position.left-h.left),u&&(o.size.height=o.size.width/o.aspectRatio),o.position.left=a.helper?l.left:0),c.top<(o._helper?l.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-l.top:o.position.top),u&&(o.size.width=o.size.height*o.aspectRatio),o.position.top=o._helper?l.top:0),o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top,i=Math.abs((o._helper?o.offset.left-h.left:o.offset.left-h.left)+o.sizeDiff.width),n=Math.abs((o._helper?o.offset.top-h.top:o.offset.top-l.top)+o.sizeDiff.height),r=o.containerElement.get(0)===o.element.parent().get(0),s=/relative|absolute/.test(o.containerElement.css("position")),r&&s&&(i-=Math.abs(o.parentData.left)),i+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-i,u&&(o.size.height=o.size.width/o.aspectRatio)),n+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-n,u&&(o.size.width=o.size.height*o.aspectRatio))},stop:function(){var e=t(this).data("ui-resizable"),i=e.options,n=e.containerOffset,r=e.containerPosition,s=e.containerElement,o=t(e.helper),a=o.offset(),l=o.outerWidth()-e.sizeDiff.width,c=o.outerHeight()-e.sizeDiff.height;e._helper&&!i.animate&&/relative/.test(s.css("position"))&&t(this).css({left:a.left-r.left-n.left,width:l,height:c}),e._helper&&!i.animate&&/static/.test(s.css("position"))&&t(this).css({left:a.left-r.left-n.left,width:l,height:c})}}),t.ui.plugin.add("resizable","alsoResize",{start:function(){var e=t(this).data("ui-resizable"),i=e.options,n=function(e){t(e).each(function(){var e=t(this);e.data("ui-resizable-alsoresize",{width:parseInt(e.width(),10),height:parseInt(e.height(),10),left:parseInt(e.css("left"),10),top:parseInt(e.css("top"),10)})})};"object"!=typeof i.alsoResize||i.alsoResize.parentNode?n(i.alsoResize):i.alsoResize.length?(i.alsoResize=i.alsoResize[0],n(i.alsoResize)):t.each(i.alsoResize,function(t){n(t)})},resize:function(e,i){var n=t(this).data("ui-resizable"),r=n.options,s=n.originalSize,o=n.originalPosition,a={height:n.size.height-s.height||0,width:n.size.width-s.width||0,top:n.position.top-o.top||0,left:n.position.left-o.left||0},l=function(e,n){t(e).each(function(){var e=t(this),r=t(this).data("ui-resizable-alsoresize"),s={},o=n&&n.length?n:e.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];t.each(o,function(t,e){var i=(r[e]||0)+(a[e]||0);i&&i>=0&&(s[e]=i||null)}),e.css(s)})};"object"!=typeof r.alsoResize||r.alsoResize.nodeType?l(r.alsoResize):t.each(r.alsoResize,function(t,e){l(t,e)})},stop:function(){t(this).removeData("resizable-alsoresize")}}),t.ui.plugin.add("resizable","ghost",{start:function(){var e=t(this).data("ui-resizable"),i=e.options,n=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:n.height,width:n.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),e.ghost.appendTo(e.helper)},resize:function(){var e=t(this).data("ui-resizable");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=t(this).data("ui-resizable");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(){var e=t(this).data("ui-resizable"),i=e.options,n=e.size,r=e.originalSize,s=e.originalPosition,o=e.axis,a="number"==typeof i.grid?[i.grid,i.grid]:i.grid,l=a[0]||1,c=a[1]||1,u=Math.round((n.width-r.width)/l)*l,h=Math.round((n.height-r.height)/c)*c,d=r.width+u,p=r.height+h,f=i.maxWidth&&i.maxWidth<d,g=i.maxHeight&&i.maxHeight<p,m=i.minWidth&&i.minWidth>d,v=i.minHeight&&i.minHeight>p;i.grid=a,m&&(d+=l),v&&(p+=c),f&&(d-=l),g&&(p-=c),/^(se|s|e)$/.test(o)?(e.size.width=d,e.size.height=p):/^(ne)$/.test(o)?(e.size.width=d,e.size.height=p,e.position.top=s.top-h):/^(sw)$/.test(o)?(e.size.width=d,e.size.height=p,e.position.left=s.left-u):(p-c>0?(e.size.height=p,e.position.top=s.top-h):(e.size.height=c,e.position.top=s.top+r.height-c),d-l>0?(e.size.width=d,e.position.left=s.left-u):(e.size.width=l,e.position.left=s.left+r.width-l))}})}(jQuery),function(t){t.widget("ui.selectable",t.ui.mouse,{version:"1.10.4",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e,i=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){e=t(i.options.filter,i.element[0]),e.addClass("ui-selectee"),e.each(function(){var e=t(this),i=e.offset();t.data(this,"selectable-item",{element:this,$element:e,left:i.left,top:i.top,right:i.left+e.outerWidth(),bottom:i.top+e.outerHeight(),startselected:!1,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=e.addClass("ui-selectee"),this._mouseInit(),this.helper=t("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(e){var i=this,n=this.options;this.opos=[e.pageX,e.pageY],this.options.disabled||(this.selectees=t(n.filter,this.element[0]),this._trigger("start",e),t(n.appendTo).append(this.helper),this.helper.css({left:e.pageX,top:e.pageY,width:0,height:0}),n.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var n=t.data(this,"selectable-item");n.startselected=!0,e.metaKey||e.ctrlKey||(n.$element.removeClass("ui-selected"),n.selected=!1,n.$element.addClass("ui-unselecting"),n.unselecting=!0,i._trigger("unselecting",e,{unselecting:n.element}))}),t(e.target).parents().addBack().each(function(){var n,r=t.data(this,"selectable-item");return r?(n=!e.metaKey&&!e.ctrlKey||!r.$element.hasClass("ui-selected"),r.$element.removeClass(n?"ui-unselecting":"ui-selected").addClass(n?"ui-selecting":"ui-unselecting"),r.unselecting=!n,r.selecting=n,r.selected=n,n?i._trigger("selecting",e,{selecting:r.element}):i._trigger("unselecting",e,{unselecting:r.element}),!1):void 0}))},_mouseDrag:function(e){if(this.dragged=!0,!this.options.disabled){var i,n=this,r=this.options,s=this.opos[0],o=this.opos[1],a=e.pageX,l=e.pageY;return s>a&&(i=a,a=s,s=i),o>l&&(i=l,l=o,o=i),this.helper.css({left:s,top:o,width:a-s,height:l-o}),this.selectees.each(function(){var i=t.data(this,"selectable-item"),c=!1;i&&i.element!==n.element[0]&&("touch"===r.tolerance?c=!(i.left>a||i.right<s||i.top>l||i.bottom<o):"fit"===r.tolerance&&(c=i.left>s&&i.right<a&&i.top>o&&i.bottom<l),c?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,n._trigger("selecting",e,{selecting:i.element}))):(i.selecting&&((e.metaKey||e.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),n._trigger("unselecting",e,{unselecting:i.element}))),i.selected&&(e.metaKey||e.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,n._trigger("unselecting",e,{unselecting:i.element})))))}),!1}},_mouseStop:function(e){var i=this;return this.dragged=!1,t(".ui-unselecting",this.element[0]).each(function(){var n=t.data(this,"selectable-item");n.$element.removeClass("ui-unselecting"),n.unselecting=!1,n.startselected=!1,i._trigger("unselected",e,{unselected:n.element})}),t(".ui-selecting",this.element[0]).each(function(){var n=t.data(this,"selectable-item");n.$element.removeClass("ui-selecting").addClass("ui-selected"),n.selecting=!1,n.selected=!0,n.startselected=!0,i._trigger("selected",e,{selected:n.element})}),this._trigger("stop",e),this.helper.remove(),!1}})}(jQuery),function(t){function e(t,e,i){return t>e&&e+i>t}function i(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))}t.widget("ui.sortable",t.ui.mouse,{version:"1.10.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var t=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===t.axis||i(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_setOption:function(e,i){"disabled"===e?(this.options[e]=i,this.widget().toggleClass("ui-sortable-disabled",!!i)):t.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(e,i){var n=null,r=!1,s=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(e),t(e.target).parents().each(function(){return t.data(this,s.widgetName+"-item")===s?(n=t(this),!1):void 0}),t.data(e.target,s.widgetName+"-item")===s&&(n=t(e.target)),n&&(!this.options.handle||i||(t(this.options.handle,n).find("*").addBack().each(function(){this===e.target&&(r=!0)}),r))?(this.currentItem=n,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(e,i,n){var r,s,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(s=this.document.find("body"),this.storedCursor=s.css("cursor"),s.css("cursor",o.cursor),this.storedStylesheet=t("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(s)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!n)for(r=this.containers.length-1;r>=0;r--)this.containers[r]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var i,n,r,s,o=this.options,a=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+o.scrollSpeed:e.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+o.scrollSpeed:e.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(e.pageY-t(document).scrollTop()<o.scrollSensitivity?a=t(document).scrollTop(t(document).scrollTop()-o.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<o.scrollSensitivity&&(a=t(document).scrollTop(t(document).scrollTop()+o.scrollSpeed)),e.pageX-t(document).scrollLeft()<o.scrollSensitivity?a=t(document).scrollLeft(t(document).scrollLeft()-o.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<o.scrollSensitivity&&(a=t(document).scrollLeft(t(document).scrollLeft()+o.scrollSpeed))),a!==!1&&t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(n=this.items[i],r=n.item[0],s=this._intersectsWithPointer(n),s&&n.instance===this.currentContainer&&r!==this.currentItem[0]&&this.placeholder[1===s?"next":"prev"]()[0]!==r&&!t.contains(this.placeholder[0],r)&&("semi-dynamic"===this.options.type?!t.contains(this.element[0],r):!0)){if(this.direction=1===s?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(n))break;this._rearrange(e,n),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var n=this,r=this.placeholder.offset(),s=this.options.axis,o={};s&&"x"!==s||(o.left=r.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),s&&"y"!==s||(o.top=r.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){n._clear(e)})}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);i&&n.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))}),!n.length&&e.key&&n.push(e.key+"="),n.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},i.each(function(){n.push(t(e.item||this).attr(e.attribute||"id")||"")}),n},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,n=this.positionAbs.top,r=n+this.helperProportions.height,s=t.left,o=s+t.width,a=t.top,l=a+t.height,c=this.offset.click.top,u=this.offset.click.left,h="x"===this.options.axis||n+c>a&&l>n+c,d="y"===this.options.axis||e+u>s&&o>e+u,p=h&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?p:s<e+this.helperProportions.width/2&&i-this.helperProportions.width/2<o&&a<n+this.helperProportions.height/2&&r-this.helperProportions.height/2<l},_intersectsWithPointer:function(t){var i="x"===this.options.axis||e(this.positionAbs.top+this.offset.click.top,t.top,t.height),n="y"===this.options.axis||e(this.positionAbs.left+this.offset.click.left,t.left,t.width),r=i&&n,s=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return r?this.floating?o&&"right"===o||"down"===s?2:1:s&&("down"===s?2:1):!1},_intersectsWithSides:function(t){var i=e(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),n=e(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),r=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return this.floating&&s?"right"===s&&n||"left"===s&&!n:r&&("down"===r&&i||"up"===r&&!i)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){function i(){a.push(this)}var n,r,s,o,a=[],l=[],c=this._connectWith();if(c&&e)for(n=c.length-1;n>=0;n--)for(s=t(c[n]),r=s.length-1;r>=0;r--)o=t.data(s[r],this.widgetFullName),o&&o!==this&&!o.options.disabled&&l.push([t.isFunction(o.options.items)?o.options.items.call(o.element):t(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(l.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=l.length-1;n>=0;n--)l[n][0].each(i);return t(a)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var i=0;i<e.length;i++)if(e[i]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var i,n,r,s,o,a,l,c,u=this.items,h=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(i=d.length-1;i>=0;i--)for(r=t(d[i]),n=r.length-1;n>=0;n--)s=t.data(r[n],this.widgetFullName),s&&s!==this&&!s.options.disabled&&(h.push([t.isFunction(s.options.items)?s.options.items.call(s.element[0],e,{item:this.currentItem}):t(s.options.items,s.element),s]),this.containers.push(s));for(i=h.length-1;i>=0;i--)for(o=h[i][1],a=h[i][0],n=0,c=a.length;c>n;n++)l=t(a[n]),l.data(this.widgetName+"-item",o),u.push({item:l,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,n,r,s;for(i=this.items.length-1;i>=0;i--)n=this.items[i],n.instance!==this.currentContainer&&this.currentContainer&&n.item[0]!==this.currentItem[0]||(r=this.options.toleranceElement?t(this.options.toleranceElement,n.item):n.item,e||(n.width=r.outerWidth(),n.height=r.outerHeight()),s=r.offset(),n.left=s.left,n.top=s.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)s=this.containers[i].element.offset(),this.containers[i].containerCache.left=s.left,this.containers[i].containerCache.top=s.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var i,n=e.options;n.placeholder&&n.placeholder.constructor!==String||(i=n.placeholder,n.placeholder={element:function(){var n=e.currentItem[0].nodeName.toLowerCase(),r=t("<"+n+">",e.document[0]).addClass(i||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===n?e.currentItem.children().each(function(){t("<td>&#160;</td>",e.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(r)}):"img"===n&&r.attr("src",e.currentItem.attr("src")),i||r.css("visibility","hidden"),r},update:function(t,r){(!i||n.forcePlaceholderSize)&&(r.height()||r.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),r.width()||r.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(n.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),n.placeholder.update(e,e.placeholder)},_contactContainers:function(n){var r,s,o,a,l,c,u,h,d,p,f=null,g=null;for(r=this.containers.length-1;r>=0;r--)if(!t.contains(this.currentItem[0],this.containers[r].element[0]))if(this._intersectsWith(this.containers[r].containerCache)){if(f&&t.contains(this.containers[r].element[0],f.element[0]))continue;f=this.containers[r],g=r}else this.containers[r].containerCache.over&&(this.containers[r]._trigger("out",n,this._uiHash(this)),this.containers[r].containerCache.over=0);if(f)if(1===this.containers.length)this.containers[g].containerCache.over||(this.containers[g]._trigger("over",n,this._uiHash(this)),this.containers[g].containerCache.over=1);else{for(o=1e4,a=null,p=f.floating||i(this.currentItem),l=p?"left":"top",c=p?"width":"height",u=this.positionAbs[l]+this.offset.click[l],s=this.items.length-1;s>=0;s--)t.contains(this.containers[g].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(!p||e(this.positionAbs.top+this.offset.click.top,this.items[s].top,this.items[s].height))&&(h=this.items[s].item.offset()[l],d=!1,Math.abs(h-u)>Math.abs(h+this.items[s][c]-u)&&(d=!0,h+=this.items[s][c]),Math.abs(h-u)<o&&(o=Math.abs(h-u),a=this.items[s],this.direction=d?"up":"down"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[g])return;a?this._rearrange(n,a,null,!0):this._rearrange(n,null,this.containers[g].element,!0),this._trigger("change",n,this._uiHash()),this.containers[g]._trigger("change",n,this._uiHash(this)),this.currentContainer=this.containers[g],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[g]._trigger("over",n,this._uiHash(this)),this.containers[g].containerCache.over=1}},_createHelper:function(e){var i=this.options,n=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return n.parents("body").length||t("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(n[0]),n[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!n[0].style.width||i.forceHelperSize)&&n.width(this.currentItem.width()),(!n[0].style.height||i.forceHelperSize)&&n.height(this.currentItem.height()),n},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,n,r=this.options;"parent"===r.containment&&(r.containment=this.helper[0].parentNode),("document"===r.containment||"window"===r.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,t("document"===r.containment?document:window).width()-this.helperProportions.width-this.margins.left,(t("document"===r.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(r.containment)||(e=t(r.containment)[0],i=t(r.containment).offset(),n="hidden"!==t(e).css("overflow"),this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(n?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(n?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,i){i||(i=this.position);var n="absolute"===e?1:-1,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(r[0].tagName);return{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:r.scrollTop())*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:r.scrollLeft())*n}},_generatePosition:function(e){var i,n,r=this.options,s=e.pageX,o=e.pageY,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(a[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),r.grid&&(i=this.originalPageY+Math.round((o-this.originalPageY)/r.grid[1])*r.grid[1],o=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-r.grid[1]:i+r.grid[1]:i,n=this.originalPageX+Math.round((s-this.originalPageX)/r.grid[0])*r.grid[0],s=this.containment?n-this.offset.click.left>=this.containment[0]&&n-this.offset.click.left<=this.containment[2]?n:n-this.offset.click.left>=this.containment[0]?n-r.grid[0]:n+r.grid[0]:n)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:a.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:a.scrollLeft())}},_rearrange:function(t,e,i,n){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;
var r=this.counter;this._delay(function(){r===this.counter&&this.refreshPositions(!n)})},_clear:function(t,e){function i(t,e,i){return function(n){i._trigger(t,n,e._uiHash(e))}}this.reverting=!1;var n,r=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)("auto"===this._storedCSS[n]||"static"===this._storedCSS[n])&&(this._storedCSS[n]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&r.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||r.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(r.push(function(t){this._trigger("remove",t,this._uiHash())}),r.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),r.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;n>=0;n--)e||r.push(i("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(r.push(i("out",this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!e){for(this._trigger("beforeStop",t,this._uiHash()),n=0;n<r.length;n++)r[n].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!1}if(e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!e){for(n=0;n<r.length;n++)r[n].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){t.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}})}(jQuery),function(t,e){var i="ui-effects-";t.effects={effect:{}},function(t,e){function i(t,e,i){var n=h[e.type]||{};return null==t?i||!e.def?null:e.def:(t=n.floor?~~t:parseFloat(t),isNaN(t)?e.def:n.mod?(t+n.mod)%n.mod:0>t?0:n.max<t?n.max:t)}function n(e){var i=c(),n=i._rgba=[];return e=e.toLowerCase(),f(l,function(t,r){var s,o=r.re.exec(e),a=o&&r.parse(o),l=r.space||"rgba";return a?(s=i[l](a),i[u[l].cache]=s[u[l].cache],n=i._rgba=s._rgba,!1):void 0}),n.length?("0,0,0,0"===n.join()&&t.extend(n,s.transparent),i):s[e]}function r(t,e,i){return i=(i+1)%1,1>6*i?t+(e-t)*i*6:1>2*i?e:2>3*i?t+(e-t)*(2/3-i)*6:t}var s,o="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",a=/^([\-+])=\s*(\d+\.?\d*)/,l=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],c=t.Color=function(e,i,n,r){return new t.Color.fn.parse(e,i,n,r)},u={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},h={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},d=c.support={},p=t("<p>")[0],f=t.each;p.style.cssText="background-color:rgba(1,1,1,.5)",d.rgba=p.style.backgroundColor.indexOf("rgba")>-1,f(u,function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}}),c.fn=t.extend(c.prototype,{parse:function(r,o,a,l){if(r===e)return this._rgba=[null,null,null,null],this;(r.jquery||r.nodeType)&&(r=t(r).css(o),o=e);var h=this,d=t.type(r),p=this._rgba=[];return o!==e&&(r=[r,o,a,l],d="array"),"string"===d?this.parse(n(r)||s._default):"array"===d?(f(u.rgba.props,function(t,e){p[e.idx]=i(r[e.idx],e)}),this):"object"===d?(r instanceof c?f(u,function(t,e){r[e.cache]&&(h[e.cache]=r[e.cache].slice())}):f(u,function(e,n){var s=n.cache;f(n.props,function(t,e){if(!h[s]&&n.to){if("alpha"===t||null==r[t])return;h[s]=n.to(h._rgba)}h[s][e.idx]=i(r[t],e,!0)}),h[s]&&t.inArray(null,h[s].slice(0,3))<0&&(h[s][3]=1,n.from&&(h._rgba=n.from(h[s])))}),this):void 0},is:function(t){var e=c(t),i=!0,n=this;return f(u,function(t,r){var s,o=e[r.cache];return o&&(s=n[r.cache]||r.to&&r.to(n._rgba)||[],f(r.props,function(t,e){return null!=o[e.idx]?i=o[e.idx]===s[e.idx]:void 0})),i}),i},_space:function(){var t=[],e=this;return f(u,function(i,n){e[n.cache]&&t.push(i)}),t.pop()},transition:function(t,e){var n=c(t),r=n._space(),s=u[r],o=0===this.alpha()?c("transparent"):this,a=o[s.cache]||s.to(o._rgba),l=a.slice();return n=n[s.cache],f(s.props,function(t,r){var s=r.idx,o=a[s],c=n[s],u=h[r.type]||{};null!==c&&(null===o?l[s]=c:(u.mod&&(c-o>u.mod/2?o+=u.mod:o-c>u.mod/2&&(o-=u.mod)),l[s]=i((c-o)*e+o,r)))}),this[r](l)},blend:function(e){if(1===this._rgba[3])return this;var i=this._rgba.slice(),n=i.pop(),r=c(e)._rgba;return c(t.map(i,function(t,e){return(1-n)*r[e]+n*t}))},toRgbaString:function(){var e="rgba(",i=t.map(this._rgba,function(t,e){return null==t?e>2?1:0:t});return 1===i[3]&&(i.pop(),e="rgb("),e+i.join()+")"},toHslaString:function(){var e="hsla(",i=t.map(this.hsla(),function(t,e){return null==t&&(t=e>2?1:0),e&&3>e&&(t=Math.round(100*t)+"%"),t});return 1===i[3]&&(i.pop(),e="hsl("),e+i.join()+")"},toHexString:function(e){var i=this._rgba.slice(),n=i.pop();return e&&i.push(~~(255*n)),"#"+t.map(i,function(t){return t=(t||0).toString(16),1===t.length?"0"+t:t}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),c.fn.parse.prototype=c.fn,u.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e,i,n=t[0]/255,r=t[1]/255,s=t[2]/255,o=t[3],a=Math.max(n,r,s),l=Math.min(n,r,s),c=a-l,u=a+l,h=.5*u;return e=l===a?0:n===a?60*(r-s)/c+360:r===a?60*(s-n)/c+120:60*(n-r)/c+240,i=0===c?0:.5>=h?c/u:c/(2-u),[Math.round(e)%360,i,h,null==o?1:o]},u.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,i=t[1],n=t[2],s=t[3],o=.5>=n?n*(1+i):n+i-n*i,a=2*n-o;return[Math.round(255*r(a,o,e+1/3)),Math.round(255*r(a,o,e)),Math.round(255*r(a,o,e-1/3)),s]},f(u,function(n,r){var s=r.props,o=r.cache,l=r.to,u=r.from;c.fn[n]=function(n){if(l&&!this[o]&&(this[o]=l(this._rgba)),n===e)return this[o].slice();var r,a=t.type(n),h="array"===a||"object"===a?n:arguments,d=this[o].slice();return f(s,function(t,e){var n=h["object"===a?t:e.idx];null==n&&(n=d[e.idx]),d[e.idx]=i(n,e)}),u?(r=c(u(d)),r[o]=d,r):c(d)},f(s,function(e,i){c.fn[e]||(c.fn[e]=function(r){var s,o=t.type(r),l="alpha"===e?this._hsla?"hsla":"rgba":n,c=this[l](),u=c[i.idx];return"undefined"===o?u:("function"===o&&(r=r.call(this,u),o=t.type(r)),null==r&&i.empty?this:("string"===o&&(s=a.exec(r),s&&(r=u+parseFloat(s[2])*("+"===s[1]?1:-1))),c[i.idx]=r,this[l](c)))})})}),c.hook=function(e){var i=e.split(" ");f(i,function(e,i){t.cssHooks[i]={set:function(e,r){var s,o,a="";if("transparent"!==r&&("string"!==t.type(r)||(s=n(r)))){if(r=c(s||r),!d.rgba&&1!==r._rgba[3]){for(o="backgroundColor"===i?e.parentNode:e;(""===a||"transparent"===a)&&o&&o.style;)try{a=t.css(o,"backgroundColor"),o=o.parentNode}catch(l){}r=r.blend(a&&"transparent"!==a?a:"_default")}r=r.toRgbaString()}try{e.style[i]=r}catch(l){}}},t.fx.step[i]=function(e){e.colorInit||(e.start=c(e.elem,i),e.end=c(e.end),e.colorInit=!0),t.cssHooks[i].set(e.elem,e.start.transition(e.end,e.pos))}})},c.hook(o),t.cssHooks.borderColor={expand:function(t){var e={};return f(["Top","Right","Bottom","Left"],function(i,n){e["border"+n+"Color"]=t}),e}},s=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function i(e){var i,n,r=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,s={};if(r&&r.length&&r[0]&&r[r[0]])for(n=r.length;n--;)i=r[n],"string"==typeof r[i]&&(s[t.camelCase(i)]=r[i]);else for(i in r)"string"==typeof r[i]&&(s[i]=r[i]);return s}function n(e,i){var n,r,o={};for(n in i)r=i[n],e[n]!==r&&(s[n]||(t.fx.step[n]||!isNaN(parseFloat(r)))&&(o[n]=r));return o}var r=["add","remove","toggle"],s={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};t.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,i){t.fx.step[i]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(jQuery.style(t.elem,i,t.end),t.setAttr=!0)}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.effects.animateClass=function(e,s,o,a){var l=t.speed(s,o,a);return this.queue(function(){var s,o=t(this),a=o.attr("class")||"",c=l.children?o.find("*").addBack():o;c=c.map(function(){var e=t(this);return{el:e,start:i(this)}}),s=function(){t.each(r,function(t,i){e[i]&&o[i+"Class"](e[i])})},s(),c=c.map(function(){return this.end=i(this.el[0]),this.diff=n(this.start,this.end),this}),o.attr("class",a),c=c.map(function(){var e=this,i=t.Deferred(),n=t.extend({},l,{queue:!1,complete:function(){i.resolve(e)}});return this.el.animate(this.diff,n),i.promise()}),t.when.apply(t,c.get()).done(function(){s(),t.each(arguments,function(){var e=this.el;t.each(this.diff,function(t){e.css(t,"")})}),l.complete.call(o[0])})})},t.fn.extend({addClass:function(e){return function(i,n,r,s){return n?t.effects.animateClass.call(this,{add:i},n,r,s):e.apply(this,arguments)}}(t.fn.addClass),removeClass:function(e){return function(i,n,r,s){return arguments.length>1?t.effects.animateClass.call(this,{remove:i},n,r,s):e.apply(this,arguments)}}(t.fn.removeClass),toggleClass:function(i){return function(n,r,s,o,a){return"boolean"==typeof r||r===e?s?t.effects.animateClass.call(this,r?{add:n}:{remove:n},s,o,a):i.apply(this,arguments):t.effects.animateClass.call(this,{toggle:n},r,s,o)}}(t.fn.toggleClass),switchClass:function(e,i,n,r,s){return t.effects.animateClass.call(this,{add:i,remove:e},n,r,s)}})}(),function(){function n(e,i,n,r){return t.isPlainObject(e)&&(i=e,e=e.effect),e={effect:e},null==i&&(i={}),t.isFunction(i)&&(r=i,n=null,i={}),("number"==typeof i||t.fx.speeds[i])&&(r=n,n=i,i={}),t.isFunction(n)&&(r=n,n=null),i&&t.extend(e,i),n=n||i.duration,e.duration=t.fx.off?0:"number"==typeof n?n:n in t.fx.speeds?t.fx.speeds[n]:t.fx.speeds._default,e.complete=r||i.complete,e}function r(e){return!e||"number"==typeof e||t.fx.speeds[e]?!0:"string"!=typeof e||t.effects.effect[e]?t.isFunction(e)?!0:"object"!=typeof e||e.effect?!1:!0:!0}t.extend(t.effects,{version:"1.10.4",save:function(t,e){for(var n=0;n<e.length;n++)null!==e[n]&&t.data(i+e[n],t[0].style[e[n]])},restore:function(t,n){var r,s;for(s=0;s<n.length;s++)null!==n[s]&&(r=t.data(i+n[s]),r===e&&(r=""),t.css(n[s],r))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},getBaseline:function(t,e){var i,n;switch(t[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=t[0]/e.height}switch(t[1]){case"left":n=0;break;case"center":n=.5;break;case"right":n=1;break;default:n=t[1]/e.width}return{x:n,y:i}},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var i={width:e.outerWidth(!0),height:e.outerHeight(!0),"float":e.css("float")},n=t("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),r={width:e.width(),height:e.height()},s=document.activeElement;try{s.id}catch(o){s=document.body}return e.wrap(n),(e[0]===s||t.contains(e[0],s))&&t(s).focus(),n=e.parent(),"static"===e.css("position")?(n.css({position:"relative"}),e.css({position:"relative"})):(t.extend(i,{position:e.css("position"),zIndex:e.css("z-index")}),t.each(["top","left","bottom","right"],function(t,n){i[n]=e.css(n),isNaN(parseInt(i[n],10))&&(i[n]="auto")}),e.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),e.css(r),n.css(i).show()},removeWrapper:function(e){var i=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===i||t.contains(e[0],i))&&t(i).focus()),e},setTransition:function(e,i,n,r){return r=r||{},t.each(i,function(t,i){var s=e.cssUnit(i);s[0]>0&&(r[i]=s[0]*n+s[1])}),r}}),t.fn.extend({effect:function(){function e(e){function n(){t.isFunction(s)&&s.call(r[0]),t.isFunction(e)&&e()}var r=t(this),s=i.complete,a=i.mode;(r.is(":hidden")?"hide"===a:"show"===a)?(r[a](),n()):o.call(r[0],i,n)}var i=n.apply(this,arguments),r=i.mode,s=i.queue,o=t.effects.effect[i.effect];return t.fx.off||!o?r?this[r](i.duration,i.complete):this.each(function(){i.complete&&i.complete.call(this)}):s===!1?this.each(e):this.queue(s||"fx",e)},show:function(t){return function(e){if(r(e))return t.apply(this,arguments);var i=n.apply(this,arguments);return i.mode="show",this.effect.call(this,i)}}(t.fn.show),hide:function(t){return function(e){if(r(e))return t.apply(this,arguments);var i=n.apply(this,arguments);return i.mode="hide",this.effect.call(this,i)}}(t.fn.hide),toggle:function(t){return function(e){if(r(e)||"boolean"==typeof e)return t.apply(this,arguments);var i=n.apply(this,arguments);return i.mode="toggle",this.effect.call(this,i)}}(t.fn.toggle),cssUnit:function(e){var i=this.css(e),n=[];return t.each(["em","px","%","pt"],function(t,e){i.indexOf(e)>0&&(n=[parseFloat(i),e])}),n}})}(),function(){var e={};t.each(["Quad","Cubic","Quart","Quint","Expo"],function(t,i){e[i]=function(e){return Math.pow(e,t+2)}}),t.extend(e,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,i=4;t<((e=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*e-2)/22-t,2)}}),t.each(e,function(e,i){t.easing["easeIn"+e]=i,t.easing["easeOut"+e]=function(t){return 1-i(1-t)},t.easing["easeInOut"+e]=function(t){return.5>t?i(2*t)/2:1-i(-2*t+2)/2}})}()}(jQuery),function(t){var e=0,i={},n={};i.height=i.paddingTop=i.paddingBottom=i.borderTopWidth=i.borderBottomWidth="hide",n.height=n.paddingTop=n.paddingBottom=n.borderTopWidth=n.borderBottomWidth="show",t.widget("ui.accordion",{version:"1.10.4",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var e=this.options;this.prevShow=this.prevHide=t(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),e.collapsible||e.active!==!1&&null!=e.active||(e.active=0),this._processPanels(),e.active<0&&(e.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():t(),content:this.active.length?this.active.next():t()}},_createIcons:function(){var e=this.options.icons;e&&(t("<span>").addClass("ui-accordion-header-icon ui-icon "+e.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(e.header).addClass(e.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var t;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),t=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),"content"!==this.options.heightStyle&&t.css("height","")},_setOption:function(t,e){return"active"===t?void this._activate(e):("event"===t&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(e)),this._super(t,e),"collapsible"!==t||e||this.options.active!==!1||this._activate(0),"icons"===t&&(this._destroyIcons(),e&&this._createIcons()),void("disabled"===t&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!e)))},_keydown:function(e){if(!e.altKey&&!e.ctrlKey){var i=t.ui.keyCode,n=this.headers.length,r=this.headers.index(e.target),s=!1;switch(e.keyCode){case i.RIGHT:case i.DOWN:s=this.headers[(r+1)%n];break;case i.LEFT:case i.UP:s=this.headers[(r-1+n)%n];break;case i.SPACE:case i.ENTER:this._eventHandler(e);break;case i.HOME:s=this.headers[0];break;case i.END:s=this.headers[n-1]}s&&(t(e.target).attr("tabIndex",-1),t(s).attr("tabIndex",0),s.focus(),e.preventDefault())}},_panelKeyDown:function(e){e.keyCode===t.ui.keyCode.UP&&e.ctrlKey&&t(e.currentTarget).prev().focus()},refresh:function(){var e=this.options;this._processPanels(),e.active===!1&&e.collapsible===!0||!this.headers.length?(e.active=!1,this.active=t()):e.active===!1?this._activate(0):this.active.length&&!t.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(e.active=!1,this.active=t()):this._activate(Math.max(0,e.active-1)):e.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var i,n=this.options,r=n.heightStyle,s=this.element.parent(),o=this.accordionId="ui-accordion-"+(this.element.attr("id")||++e);this.active=this._findActive(n.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(e){var i=t(this),n=i.attr("id"),r=i.next(),s=r.attr("id");n||(n=o+"-header-"+e,i.attr("id",n)),s||(s=o+"-panel-"+e,r.attr("id",s)),i.attr("aria-controls",s),r.attr("aria-labelledby",n)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(n.event),"fill"===r?(i=s.height(),this.element.siblings(":visible").each(function(){var e=t(this),n=e.css("position");"absolute"!==n&&"fixed"!==n&&(i-=e.outerHeight(!0))}),this.headers.each(function(){i-=t(this).outerHeight(!0)}),this.headers.next().each(function(){t(this).height(Math.max(0,i-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===r&&(i=0,this.headers.next().each(function(){i=Math.max(i,t(this).css("height","").height())}).height(i))},_activate:function(e){var i=this._findActive(e)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return"number"==typeof e?this.headers.eq(e):t()},_setupEvents:function(e){var i={keydown:"_keydown"};e&&t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(e){var i=this.options,n=this.active,r=t(e.currentTarget),s=r[0]===n[0],o=s&&i.collapsible,a=o?t():r.next(),l=n.next(),c={oldHeader:n,oldPanel:l,newHeader:o?t():r,newPanel:a};e.preventDefault(),s&&!i.collapsible||this._trigger("beforeActivate",e,c)===!1||(i.active=o?!1:this.headers.index(r),this.active=s?t():r,this._toggle(c),n.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&n.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),s||(r.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&r.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),r.next().addClass("ui-accordion-content-active")))},_toggle:function(e){var i=e.newPanel,n=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=n,this.options.animate?this._animate(i,n,e):(n.hide(),i.show(),this._toggleComplete(e)),n.attr({"aria-hidden":"true"}),n.prev().attr("aria-selected","false"),i.length&&n.length?n.prev().attr({tabIndex:-1,"aria-expanded":"false"}):i.length&&this.headers.filter(function(){return 0===t(this).attr("tabIndex")}).attr("tabIndex",-1),i.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(t,e,r){var s,o,a,l=this,c=0,u=t.length&&(!e.length||t.index()<e.index()),h=this.options.animate||{},d=u&&h.down||h,p=function(){l._toggleComplete(r)};return"number"==typeof d&&(a=d),"string"==typeof d&&(o=d),o=o||d.easing||h.easing,a=a||d.duration||h.duration,e.length?t.length?(s=t.show().outerHeight(),e.animate(i,{duration:a,easing:o,step:function(t,e){e.now=Math.round(t)}}),void t.hide().animate(n,{duration:a,easing:o,complete:p,step:function(t,i){i.now=Math.round(t),"height"!==i.prop?c+=i.now:"content"!==l.options.heightStyle&&(i.now=Math.round(s-e.outerHeight()-c),c=0)}})):e.animate(i,a,o,p):t.animate(n,a,o,p)},_toggleComplete:function(t){var e=t.oldPanel;e.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),e.length&&(e.parent()[0].className=e.parent()[0].className),this._trigger("activate",null,t)}})}(jQuery),function(t){t.widget("ui.autocomplete",{version:"1.10.4",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var e,i,n,r=this.element[0].nodeName.toLowerCase(),s="textarea"===r,o="input"===r;this.isMultiLine=s?!0:o?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[s||o?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(r){if(this.element.prop("readOnly"))return e=!0,n=!0,void(i=!0);e=!1,n=!1,i=!1;var s=t.ui.keyCode;switch(r.keyCode){case s.PAGE_UP:e=!0,this._move("previousPage",r);break;case s.PAGE_DOWN:e=!0,this._move("nextPage",r);break;case s.UP:e=!0,this._keyEvent("previous",r);break;case s.DOWN:e=!0,this._keyEvent("next",r);break;case s.ENTER:case s.NUMPAD_ENTER:this.menu.active&&(e=!0,r.preventDefault(),this.menu.select(r));break;case s.TAB:this.menu.active&&this.menu.select(r);break;case s.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(r),r.preventDefault());break;default:i=!0,this._searchTimeout(r)}},keypress:function(n){if(e)return e=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&n.preventDefault());if(!i){var r=t.ui.keyCode;switch(n.keyCode){case r.PAGE_UP:this._move("previousPage",n);break;case r.PAGE_DOWN:this._move("nextPage",n);break;case r.UP:this._keyEvent("previous",n);break;case r.DOWN:this._keyEvent("next",n)}}},input:function(t){return n?(n=!1,void t.preventDefault()):void this._searchTimeout(t)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(t),void this._change(t))}}),this._initSource(),this.menu=t("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];t(e.target).closest(".ui-menu-item").length||this._delay(function(){var e=this;this.document.one("mousedown",function(n){n.target===e.element[0]||n.target===i||t.contains(i,n.target)||e.close()})})},menufocus:function(e,i){if(this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){t(e.target).trigger(e.originalEvent)});var n=i.item.data("ui-autocomplete-item");!1!==this._trigger("focus",e,{item:n})?e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(n.value):this.liveRegion.text(n.value)},menuselect:function(t,e){var i=e.item.data("ui-autocomplete-item"),n=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n,this.selectedItem=i})),!1!==this._trigger("select",t,{item:i})&&this._value(i.value),this.term=this._value(),this.close(t),this.selectedItem=i}}),this.liveRegion=t("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(this._appendTo()),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e||(e=this.element.closest(".ui-front")),e.length||(e=this.document[0].body),e},_initSource:function(){var e,i,n=this;t.isArray(this.options.source)?(e=this.options.source,this.source=function(i,n){n(t.ui.autocomplete.filter(e,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(e,r){n.xhr&&n.xhr.abort(),n.xhr=t.ajax({url:i,data:e,dataType:"json",success:function(t){r(t)},error:function(){r([])}})}):this.source=this.options.source},_searchTimeout:function(t){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,t))},this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):this._trigger("search",e)!==!1?this._search(t):void 0},_search:function(t){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var e=++this.requestIndex;return t.proxy(function(t){e===this.requestIndex&&this.__response(t),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(t){t&&(t=this._normalize(t)),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:t.map(e,function(e){return"string"==typeof e?{label:e,value:e}:t.extend({label:e.label||e.value,value:e.value||e.label},e)})},_suggest:function(e){var i=this.menu.element.empty();this._renderMenu(i,e),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(t.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,i){var n=this;t.each(i,function(t,i){n._renderItemData(e,i)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",e)},_renderItem:function(e,i){return t("<li>").append(t("<a>").text(i.label)).appendTo(e)},_move:function(t,e){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this._value(this.term),void this.menu.blur()):void this.menu[t](e):void this.search(null,e)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(t,e),e.preventDefault())}}),t.extend(t.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,i){var n=new RegExp(t.ui.autocomplete.escapeRegex(i),"i");return t.grep(e,function(t){return n.test(t.label||t.value||t)})}}),t.widget("ui.autocomplete",t.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(t){return t+(t>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var e;this._superApply(arguments),this.options.disabled||this.cancelSearch||(e=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.text(e))}})}(jQuery),function(t){var e,i="ui-button ui-widget ui-state-default ui-corner-all",n="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",r=function(){var e=t(this);setTimeout(function(){e.find(":ui-button").button("refresh")},1)},s=function(e){var i=e.name,n=e.form,r=t([]);return i&&(i=i.replace(/'/g,"\\'"),r=n?t(n).find("[name='"+i+"']"):t("[name='"+i+"']",e.ownerDocument).filter(function(){return!this.form})),r};t.widget("ui.button",{version:"1.10.4",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,r),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");
var n=this,o=this.options,a="checkbox"===this.type||"radio"===this.type,l=a?"":"ui-state-active";null===o.label&&(o.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(i).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){o.disabled||this===e&&t(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){o.disabled||t(this).removeClass(l)}).bind("click"+this.eventNamespace,function(t){o.disabled&&(t.preventDefault(),t.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),a&&this.element.bind("change"+this.eventNamespace,function(){n.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return o.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(o.disabled)return!1;t(this).addClass("ui-state-active"),n.buttonElement.attr("aria-pressed","true");var e=n.element[0];s(e).not(e).map(function(){return t(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return o.disabled?!1:(t(this).addClass("ui-state-active"),e=this,void n.document.one("mouseup",function(){e=null}))}).bind("mouseup"+this.eventNamespace,function(){return o.disabled?!1:void t(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(e){return o.disabled?!1:void((e.keyCode===t.ui.keyCode.SPACE||e.keyCode===t.ui.keyCode.ENTER)&&t(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){t(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(e){e.keyCode===t.ui.keyCode.SPACE&&t(this).click()})),this._setOption("disabled",o.disabled),this._resetButton()},_determineButtonType:function(){var t,e,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(t=this.element.parents().last(),e="label[for='"+this.element.attr("id")+"']",this.buttonElement=t.find(e),this.buttonElement.length||(t=t.length?t.siblings():this.element.siblings(),this.buttonElement=t.filter(e),this.buttonElement.length||(this.buttonElement=t.find(e))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(i+" ui-state-active "+n).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(t,e){return this._super(t,e),"disabled"===t?(this.element.prop("disabled",!!e),void(e&&this.buttonElement.removeClass("ui-state-focus"))):void this._resetButton()},refresh:function(){var e=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");e!==this.options.disabled&&this._setOption("disabled",e),"radio"===this.type?s(this.element[0]).each(function(){t(this).is(":checked")?t(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):t(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var e=this.buttonElement.removeClass(n),i=t("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(e.empty()).text(),r=this.options.icons,s=r.primary&&r.secondary,o=[];r.primary||r.secondary?(this.options.text&&o.push("ui-button-text-icon"+(s?"s":r.primary?"-primary":"-secondary")),r.primary&&e.prepend("<span class='ui-button-icon-primary ui-icon "+r.primary+"'></span>"),r.secondary&&e.append("<span class='ui-button-icon-secondary ui-icon "+r.secondary+"'></span>"),this.options.text||(o.push(s?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||e.attr("title",t.trim(i)))):o.push("ui-button-text-only"),e.addClass(o.join(" "))}}),t.widget("ui.buttonset",{version:"1.10.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(t,e){"disabled"===t&&this.buttons.button("option",t,e),this._super(t,e)},refresh:function(){var e="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return t(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(e?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(e?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return t(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function(t,e){function i(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},t.extend(this._defaults,this.regional[""]),this.dpDiv=n(t("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function n(e){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(i,"mouseout",function(){t(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",function(){t.datepicker._isDisabledDatepicker(s.inline?e.parent()[0]:s.input[0])||(t(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),t(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).addClass("ui-datepicker-next-hover"))})}function r(e,i){t.extend(e,i);for(var n in i)null==i[n]&&(e[n]=i[n]);return e}t.extend(t.ui,{datepicker:{version:"1.10.4"}});var s,o="datepicker";t.extend(i.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return r(this._defaults,t||{}),this},_attachDatepicker:function(e,i){var n,r,s;n=e.nodeName.toLowerCase(),r="div"===n||"span"===n,e.id||(this.uuid+=1,e.id="dp"+this.uuid),s=this._newInst(t(e),r),s.settings=t.extend({},i||{}),"input"===n?this._connectDatepicker(e,s):r&&this._inlineDatepicker(e,s)},_newInst:function(e,i){var r=e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:r,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?n(t("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,i){var n=t(e);i.append=t([]),i.trigger=t([]),n.hasClass(this.markerClassName)||(this._attachments(n,i),n.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),t.data(e,o,i),i.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,i){var n,r,s,o=this._get(i,"appendText"),a=this._get(i,"isRTL");i.append&&i.append.remove(),o&&(i.append=t("<span class='"+this._appendClass+"'>"+o+"</span>"),e[a?"before":"after"](i.append)),e.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),n=this._get(i,"showOn"),("focus"===n||"both"===n)&&e.focus(this._showDatepicker),("button"===n||"both"===n)&&(r=this._get(i,"buttonText"),s=this._get(i,"buttonImage"),i.trigger=t(this._get(i,"buttonImageOnly")?t("<img/>").addClass(this._triggerClass).attr({src:s,alt:r,title:r}):t("<button type='button'></button>").addClass(this._triggerClass).html(s?t("<img/>").attr({src:s,alt:r,title:r}):r)),e[a?"before":"after"](i.trigger),i.trigger.click(function(){return t.datepicker._datepickerShowing&&t.datepicker._lastInput===e[0]?t.datepicker._hideDatepicker():t.datepicker._datepickerShowing&&t.datepicker._lastInput!==e[0]?(t.datepicker._hideDatepicker(),t.datepicker._showDatepicker(e[0])):t.datepicker._showDatepicker(e[0]),!1}))},_autoSize:function(t){if(this._get(t,"autoSize")&&!t.inline){var e,i,n,r,s=new Date(2009,11,20),o=this._get(t,"dateFormat");o.match(/[DM]/)&&(e=function(t){for(i=0,n=0,r=0;r<t.length;r++)t[r].length>i&&(i=t[r].length,n=r);return n},s.setMonth(e(this._get(t,o.match(/MM/)?"monthNames":"monthNamesShort"))),s.setDate(e(this._get(t,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-s.getDay())),t.input.attr("size",this._formatDate(t,s).length)}},_inlineDatepicker:function(e,i){var n=t(e);n.hasClass(this.markerClassName)||(n.addClass(this.markerClassName).append(i.dpDiv),t.data(e,o,i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(e),i.dpDiv.css("display","block"))},_dialogDatepicker:function(e,i,n,s,a){var l,c,u,h,d,p=this._dialogInst;return p||(this.uuid+=1,l="dp"+this.uuid,this._dialogInput=t("<input type='text' id='"+l+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),t("body").append(this._dialogInput),p=this._dialogInst=this._newInst(this._dialogInput,!1),p.settings={},t.data(this._dialogInput[0],o,p)),r(p.settings,s||{}),i=i&&i.constructor===Date?this._formatDate(p,i):i,this._dialogInput.val(i),this._pos=a?a.length?a:[a.pageX,a.pageY]:null,this._pos||(c=document.documentElement.clientWidth,u=document.documentElement.clientHeight,h=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[c/2-100+h,u/2-150+d]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),p.settings.onSelect=n,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),t.blockUI&&t.blockUI(this.dpDiv),t.data(this._dialogInput[0],o,p),this},_destroyDatepicker:function(e){var i,n=t(e),r=t.data(e,o);n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),t.removeData(e,o),"input"===i?(r.append.remove(),r.trigger.remove(),n.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&n.removeClass(this.markerClassName).empty())},_enableDatepicker:function(e){var i,n,r=t(e),s=t.data(e,o);r.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!1,s.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(n=r.children("."+this._inlineClass),n.children().removeClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}))},_disableDatepicker:function(e){var i,n,r=t(e),s=t.data(e,o);r.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!0,s.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(n=r.children("."+this._inlineClass),n.children().addClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;e<this._disabledInputs.length;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(e){try{return t.data(e,o)}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(i,n,s){var o,a,l,c,u=this._getInst(i);return 2===arguments.length&&"string"==typeof n?"defaults"===n?t.extend({},t.datepicker._defaults):u?"all"===n?t.extend({},u.settings):this._get(u,n):null:(o=n||{},"string"==typeof n&&(o={},o[n]=s),void(u&&(this._curInst===u&&this._hideDatepicker(),a=this._getDateDatepicker(i,!0),l=this._getMinMaxDate(u,"min"),c=this._getMinMaxDate(u,"max"),r(u.settings,o),null!==l&&o.dateFormat!==e&&o.minDate===e&&(u.settings.minDate=this._formatDate(u,l)),null!==c&&o.dateFormat!==e&&o.maxDate===e&&(u.settings.maxDate=this._formatDate(u,c)),"disabled"in o&&(o.disabled?this._disableDatepicker(i):this._enableDatepicker(i)),this._attachments(t(i),u),this._autoSize(u),this._setDate(u,a),this._updateAlternate(u),this._updateDatepicker(u))))},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(e){var i,n,r,s=t.datepicker._getInst(e.target),o=!0,a=s.dpDiv.is(".ui-datepicker-rtl");if(s._keyEvent=!0,t.datepicker._datepickerShowing)switch(e.keyCode){case 9:t.datepicker._hideDatepicker(),o=!1;break;case 13:return r=t("td."+t.datepicker._dayOverClass+":not(."+t.datepicker._currentClass+")",s.dpDiv),r[0]&&t.datepicker._selectDay(e.target,s.selectedMonth,s.selectedYear,r[0]),i=t.datepicker._get(s,"onSelect"),i?(n=t.datepicker._formatDate(s),i.apply(s.input?s.input[0]:null,[n,s])):t.datepicker._hideDatepicker(),!1;case 27:t.datepicker._hideDatepicker();break;case 33:t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(s,"stepBigMonths"):-t.datepicker._get(s,"stepMonths"),"M");break;case 34:t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(s,"stepBigMonths"):+t.datepicker._get(s,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&t.datepicker._clearDate(e.target),o=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&t.datepicker._gotoToday(e.target),o=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,a?1:-1,"D"),o=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(s,"stepBigMonths"):-t.datepicker._get(s,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,-7,"D"),o=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,a?-1:1,"D"),o=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(s,"stepBigMonths"):+t.datepicker._get(s,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,7,"D"),o=e.ctrlKey||e.metaKey;break;default:o=!1}else 36===e.keyCode&&e.ctrlKey?t.datepicker._showDatepicker(this):o=!1;o&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var i,n,r=t.datepicker._getInst(e.target);return t.datepicker._get(r,"constrainInput")?(i=t.datepicker._possibleChars(t.datepicker._get(r,"dateFormat")),n=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||" ">n||!i||i.indexOf(n)>-1):void 0},_doKeyUp:function(e){var i,n=t.datepicker._getInst(e.target);if(n.input.val()!==n.lastVal)try{i=t.datepicker.parseDate(t.datepicker._get(n,"dateFormat"),n.input?n.input.val():null,t.datepicker._getFormatConfig(n)),i&&(t.datepicker._setDateFromField(n),t.datepicker._updateAlternate(n),t.datepicker._updateDatepicker(n))}catch(r){}return!0},_showDatepicker:function(e){if(e=e.target||e,"input"!==e.nodeName.toLowerCase()&&(e=t("input",e.parentNode)[0]),!t.datepicker._isDisabledDatepicker(e)&&t.datepicker._lastInput!==e){var i,n,s,o,a,l,c;i=t.datepicker._getInst(e),t.datepicker._curInst&&t.datepicker._curInst!==i&&(t.datepicker._curInst.dpDiv.stop(!0,!0),i&&t.datepicker._datepickerShowing&&t.datepicker._hideDatepicker(t.datepicker._curInst.input[0])),n=t.datepicker._get(i,"beforeShow"),s=n?n.apply(e,[e,i]):{},s!==!1&&(r(i.settings,s),i.lastVal=null,t.datepicker._lastInput=e,t.datepicker._setDateFromField(i),t.datepicker._inDialog&&(e.value=""),t.datepicker._pos||(t.datepicker._pos=t.datepicker._findPos(e),t.datepicker._pos[1]+=e.offsetHeight),o=!1,t(e).parents().each(function(){return o|="fixed"===t(this).css("position"),!o}),a={left:t.datepicker._pos[0],top:t.datepicker._pos[1]},t.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),t.datepicker._updateDatepicker(i),a=t.datepicker._checkOffset(i,a,o),i.dpDiv.css({position:t.datepicker._inDialog&&t.blockUI?"static":o?"fixed":"absolute",display:"none",left:a.left+"px",top:a.top+"px"}),i.inline||(l=t.datepicker._get(i,"showAnim"),c=t.datepicker._get(i,"duration"),i.dpDiv.zIndex(t(e).zIndex()+1),t.datepicker._datepickerShowing=!0,t.effects&&t.effects.effect[l]?i.dpDiv.show(l,t.datepicker._get(i,"showOptions"),c):i.dpDiv[l||"show"](l?c:null),t.datepicker._shouldFocusInput(i)&&i.input.focus(),t.datepicker._curInst=i))}},_updateDatepicker:function(e){this.maxRows=4,s=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e),e.dpDiv.find("."+this._dayOverClass+" a").mouseover();var i,n=this._getNumberOfMonths(e),r=n[1],o=17;e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),r>1&&e.dpDiv.addClass("ui-datepicker-multi-"+r).css("width",o*r+"em"),e.dpDiv[(1!==n[0]||1!==n[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===t.datepicker._curInst&&t.datepicker._datepickerShowing&&t.datepicker._shouldFocusInput(e)&&e.input.focus(),e.yearshtml&&(i=e.yearshtml,setTimeout(function(){i===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),i=e.yearshtml=null},0))},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(e,i,n){var r=e.dpDiv.outerWidth(),s=e.dpDiv.outerHeight(),o=e.input?e.input.outerWidth():0,a=e.input?e.input.outerHeight():0,l=document.documentElement.clientWidth+(n?0:t(document).scrollLeft()),c=document.documentElement.clientHeight+(n?0:t(document).scrollTop());return i.left-=this._get(e,"isRTL")?r-o:0,i.left-=n&&i.left===e.input.offset().left?t(document).scrollLeft():0,i.top-=n&&i.top===e.input.offset().top+a?t(document).scrollTop():0,i.left-=Math.min(i.left,i.left+r>l&&l>r?Math.abs(i.left+r-l):0),i.top-=Math.min(i.top,i.top+s>c&&c>s?Math.abs(s+a):0),i},_findPos:function(e){for(var i,n=this._getInst(e),r=this._get(n,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||t.expr.filters.hidden(e));)e=e[r?"previousSibling":"nextSibling"];return i=t(e).offset(),[i.left,i.top]},_hideDatepicker:function(e){var i,n,r,s,a=this._curInst;!a||e&&a!==t.data(e,o)||this._datepickerShowing&&(i=this._get(a,"showAnim"),n=this._get(a,"duration"),r=function(){t.datepicker._tidyDialog(a)},t.effects&&(t.effects.effect[i]||t.effects[i])?a.dpDiv.hide(i,t.datepicker._get(a,"showOptions"),n,r):a.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?n:null,r),i||r(),this._datepickerShowing=!1,s=this._get(a,"onClose"),s&&s.apply(a.input?a.input[0]:null,[a.input?a.input.val():"",a]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),t.blockUI&&(t.unblockUI(),t("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(t.datepicker._curInst){var i=t(e.target),n=t.datepicker._getInst(i[0]);(i[0].id!==t.datepicker._mainDivId&&0===i.parents("#"+t.datepicker._mainDivId).length&&!i.hasClass(t.datepicker.markerClassName)&&!i.closest("."+t.datepicker._triggerClass).length&&t.datepicker._datepickerShowing&&(!t.datepicker._inDialog||!t.blockUI)||i.hasClass(t.datepicker.markerClassName)&&t.datepicker._curInst!==n)&&t.datepicker._hideDatepicker()}},_adjustDate:function(e,i,n){var r=t(e),s=this._getInst(r[0]);this._isDisabledDatepicker(r[0])||(this._adjustInstDate(s,i+("M"===n?this._get(s,"showCurrentAtPos"):0),n),this._updateDatepicker(s))},_gotoToday:function(e){var i,n=t(e),r=this._getInst(n[0]);this._get(r,"gotoCurrent")&&r.currentDay?(r.selectedDay=r.currentDay,r.drawMonth=r.selectedMonth=r.currentMonth,r.drawYear=r.selectedYear=r.currentYear):(i=new Date,r.selectedDay=i.getDate(),r.drawMonth=r.selectedMonth=i.getMonth(),r.drawYear=r.selectedYear=i.getFullYear()),this._notifyChange(r),this._adjustDate(n)},_selectMonthYear:function(e,i,n){var r=t(e),s=this._getInst(r[0]);s["selected"+("M"===n?"Month":"Year")]=s["draw"+("M"===n?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(s),this._adjustDate(r)},_selectDay:function(e,i,n,r){var s,o=t(e);t(r).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(s=this._getInst(o[0]),s.selectedDay=s.currentDay=t("a",r).html(),s.selectedMonth=s.currentMonth=i,s.selectedYear=s.currentYear=n,this._selectDate(e,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear)))},_clearDate:function(e){var i=t(e);this._selectDate(i,"")},_selectDate:function(e,i){var n,r=t(e),s=this._getInst(r[0]);i=null!=i?i:this._formatDate(s),s.input&&s.input.val(i),this._updateAlternate(s),n=this._get(s,"onSelect"),n?n.apply(s.input?s.input[0]:null,[i,s]):s.input&&s.input.trigger("change"),s.inline?this._updateDatepicker(s):(this._hideDatepicker(),this._lastInput=s.input[0],"object"!=typeof s.input[0]&&s.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var i,n,r,s=this._get(e,"altField");s&&(i=this._get(e,"altFormat")||this._get(e,"dateFormat"),n=this._getDate(e),r=this.formatDate(i,n,this._getFormatConfig(e)),t(s).each(function(){t(this).val(r)}))},noWeekends:function(t){var e=t.getDay();return[e>0&&6>e,""]},iso8601Week:function(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1},parseDate:function(e,i,n){if(null==e||null==i)throw"Invalid arguments";if(i="object"==typeof i?i.toString():i+"",""===i)return null;var r,s,o,a,l=0,c=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff,u="string"!=typeof c?c:(new Date).getFullYear()%100+parseInt(c,10),h=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,d=(n?n.dayNames:null)||this._defaults.dayNames,p=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,f=(n?n.monthNames:null)||this._defaults.monthNames,g=-1,m=-1,v=-1,b=-1,y=!1,_=function(t){var i=r+1<e.length&&e.charAt(r+1)===t;return i&&r++,i},w=function(t){var e=_(t),n="@"===t?14:"!"===t?20:"y"===t&&e?4:"o"===t?3:2,r=new RegExp("^\\d{1,"+n+"}"),s=i.substring(l).match(r);if(!s)throw"Missing number at position "+l;return l+=s[0].length,parseInt(s[0],10)},x=function(e,n,r){var s=-1,o=t.map(_(e)?r:n,function(t,e){return[[e,t]]}).sort(function(t,e){return-(t[1].length-e[1].length)});if(t.each(o,function(t,e){var n=e[1];return i.substr(l,n.length).toLowerCase()===n.toLowerCase()?(s=e[0],l+=n.length,!1):void 0}),-1!==s)return s+1;throw"Unknown name at position "+l},k=function(){if(i.charAt(l)!==e.charAt(r))throw"Unexpected literal at position "+l;l++};for(r=0;r<e.length;r++)if(y)"'"!==e.charAt(r)||_("'")?k():y=!1;else switch(e.charAt(r)){case"d":v=w("d");break;case"D":x("D",h,d);break;case"o":b=w("o");break;case"m":m=w("m");break;case"M":m=x("M",p,f);break;case"y":g=w("y");break;case"@":a=new Date(w("@")),g=a.getFullYear(),m=a.getMonth()+1,v=a.getDate();break;case"!":a=new Date((w("!")-this._ticksTo1970)/1e4),g=a.getFullYear(),m=a.getMonth()+1,v=a.getDate();break;case"'":_("'")?k():y=!0;break;default:k()}if(l<i.length&&(o=i.substr(l),!/^\s+/.test(o)))throw"Extra/unparsed characters found in date: "+o;if(-1===g?g=(new Date).getFullYear():100>g&&(g+=(new Date).getFullYear()-(new Date).getFullYear()%100+(u>=g?0:-100)),b>-1)for(m=1,v=b;;){if(s=this._getDaysInMonth(g,m-1),s>=v)break;m++,v-=s}if(a=this._daylightSavingAdjust(new Date(g,m-1,v)),a.getFullYear()!==g||a.getMonth()+1!==m||a.getDate()!==v)throw"Invalid date";return a},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(t,e,i){if(!e)return"";var n,r=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,s=(i?i.dayNames:null)||this._defaults.dayNames,o=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,a=(i?i.monthNames:null)||this._defaults.monthNames,l=function(e){var i=n+1<t.length&&t.charAt(n+1)===e;return i&&n++,i},c=function(t,e,i){var n=""+e;if(l(t))for(;n.length<i;)n="0"+n;return n},u=function(t,e,i,n){return l(t)?n[e]:i[e]},h="",d=!1;if(e)for(n=0;n<t.length;n++)if(d)"'"!==t.charAt(n)||l("'")?h+=t.charAt(n):d=!1;else switch(t.charAt(n)){case"d":h+=c("d",e.getDate(),2);break;case"D":h+=u("D",e.getDay(),r,s);break;case"o":h+=c("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":h+=c("m",e.getMonth()+1,2);break;case"M":h+=u("M",e.getMonth(),o,a);break;case"y":h+=l("y")?e.getFullYear():(e.getYear()%100<10?"0":"")+e.getYear()%100;break;case"@":h+=e.getTime();break;case"!":h+=1e4*e.getTime()+this._ticksTo1970;break;case"'":l("'")?h+="'":d=!0;break;default:h+=t.charAt(n)}return h},_possibleChars:function(t){var e,i="",n=!1,r=function(i){var n=e+1<t.length&&t.charAt(e+1)===i;return n&&e++,n};for(e=0;e<t.length;e++)if(n)"'"!==t.charAt(e)||r("'")?i+=t.charAt(e):n=!1;else switch(t.charAt(e)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":r("'")?i+="'":n=!0;break;default:i+=t.charAt(e)}return i},_get:function(t,i){return t.settings[i]!==e?t.settings[i]:this._defaults[i]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,"dateFormat"),n=t.lastVal=t.input?t.input.val():null,r=this._getDefaultDate(t),s=r,o=this._getFormatConfig(t);try{s=this.parseDate(i,n,o)||r}catch(a){n=e?"":n}t.selectedDay=s.getDate(),t.drawMonth=t.selectedMonth=s.getMonth(),t.drawYear=t.selectedYear=s.getFullYear(),t.currentDay=n?s.getDate():0,t.currentMonth=n?s.getMonth():0,t.currentYear=n?s.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(e,i,n){var r=function(t){var e=new Date;return e.setDate(e.getDate()+t),e},s=function(i){try{return t.datepicker.parseDate(t.datepicker._get(e,"dateFormat"),i,t.datepicker._getFormatConfig(e))}catch(n){}for(var r=(i.toLowerCase().match(/^c/)?t.datepicker._getDate(e):null)||new Date,s=r.getFullYear(),o=r.getMonth(),a=r.getDate(),l=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,c=l.exec(i);c;){switch(c[2]||"d"){case"d":case"D":a+=parseInt(c[1],10);break;case"w":case"W":a+=7*parseInt(c[1],10);break;case"m":case"M":o+=parseInt(c[1],10),a=Math.min(a,t.datepicker._getDaysInMonth(s,o));break;case"y":case"Y":s+=parseInt(c[1],10),a=Math.min(a,t.datepicker._getDaysInMonth(s,o))}c=l.exec(i)}return new Date(s,o,a)},o=null==i||""===i?n:"string"==typeof i?s(i):"number"==typeof i?isNaN(i)?n:r(i):new Date(i.getTime());return o=o&&"Invalid Date"===o.toString()?n:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(t){return t?(t.setHours(t.getHours()>12?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var n=!e,r=t.selectedMonth,s=t.selectedYear,o=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=o.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=o.getMonth(),t.drawYear=t.selectedYear=t.currentYear=o.getFullYear(),r===t.selectedMonth&&s===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(n?"":this._formatDate(t))},_getDate:function(t){var e=!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return e},_attachHandlers:function(e){var i=this._get(e,"stepMonths"),n="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){t.datepicker._adjustDate(n,-i,"M")},next:function(){t.datepicker._adjustDate(n,+i,"M")},hide:function(){t.datepicker._hideDatepicker()},today:function(){t.datepicker._gotoToday(n)},selectDay:function(){return t.datepicker._selectDay(n,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return t.datepicker._selectMonthYear(n,this,"M"),!1},selectYear:function(){return t.datepicker._selectMonthYear(n,this,"Y"),!1}};t(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(t){var e,i,n,r,s,o,a,l,c,u,h,d,p,f,g,m,v,b,y,_,w,x,k,C,A,T,S,M,D,$,E,P,I,N,F,O,B,z,R,L=new Date,H=this._daylightSavingAdjust(new Date(L.getFullYear(),L.getMonth(),L.getDate())),W=this._get(t,"isRTL"),j=this._get(t,"showButtonPanel"),q=this._get(t,"hideIfNoPrevNext"),V=this._get(t,"navigationAsDateFormat"),U=this._getNumberOfMonths(t),Y=this._get(t,"showCurrentAtPos"),G=this._get(t,"stepMonths"),K=1!==U[0]||1!==U[1],J=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),X=this._getMinMaxDate(t,"min"),Q=this._getMinMaxDate(t,"max"),Z=t.drawMonth-Y,te=t.drawYear;
if(0>Z&&(Z+=12,te--),Q)for(e=this._daylightSavingAdjust(new Date(Q.getFullYear(),Q.getMonth()-U[0]*U[1]+1,Q.getDate())),e=X&&X>e?X:e;this._daylightSavingAdjust(new Date(te,Z,1))>e;)Z--,0>Z&&(Z=11,te--);for(t.drawMonth=Z,t.drawYear=te,i=this._get(t,"prevText"),i=V?this.formatDate(i,this._daylightSavingAdjust(new Date(te,Z-G,1)),this._getFormatConfig(t)):i,n=this._canAdjustMonth(t,-1,te,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(W?"e":"w")+"'>"+i+"</span></a>":q?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(W?"e":"w")+"'>"+i+"</span></a>",r=this._get(t,"nextText"),r=V?this.formatDate(r,this._daylightSavingAdjust(new Date(te,Z+G,1)),this._getFormatConfig(t)):r,s=this._canAdjustMonth(t,1,te,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+r+"'><span class='ui-icon ui-icon-circle-triangle-"+(W?"w":"e")+"'>"+r+"</span></a>":q?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+r+"'><span class='ui-icon ui-icon-circle-triangle-"+(W?"w":"e")+"'>"+r+"</span></a>",o=this._get(t,"currentText"),a=this._get(t,"gotoCurrent")&&t.currentDay?J:H,o=V?this.formatDate(o,a,this._getFormatConfig(t)):o,l=t.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(t,"closeText")+"</button>",c=j?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(W?l:"")+(this._isInRange(t,a)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(W?"":l)+"</div>":"",u=parseInt(this._get(t,"firstDay"),10),u=isNaN(u)?0:u,h=this._get(t,"showWeek"),d=this._get(t,"dayNames"),p=this._get(t,"dayNamesMin"),f=this._get(t,"monthNames"),g=this._get(t,"monthNamesShort"),m=this._get(t,"beforeShowDay"),v=this._get(t,"showOtherMonths"),b=this._get(t,"selectOtherMonths"),y=this._getDefaultDate(t),_="",x=0;x<U[0];x++){for(k="",this.maxRows=4,C=0;C<U[1];C++){if(A=this._daylightSavingAdjust(new Date(te,Z,t.selectedDay)),T=" ui-corner-all",S="",K){if(S+="<div class='ui-datepicker-group",U[1]>1)switch(C){case 0:S+=" ui-datepicker-group-first",T=" ui-corner-"+(W?"right":"left");break;case U[1]-1:S+=" ui-datepicker-group-last",T=" ui-corner-"+(W?"left":"right");break;default:S+=" ui-datepicker-group-middle",T=""}S+="'>"}for(S+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+T+"'>"+(/all|left/.test(T)&&0===x?W?s:n:"")+(/all|right/.test(T)&&0===x?W?n:s:"")+this._generateMonthYearHeader(t,Z,te,X,Q,x>0||C>0,f,g)+"</div><table class='ui-datepicker-calendar'><thead><tr>",M=h?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",w=0;7>w;w++)D=(w+u)%7,M+="<th"+((w+u+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+d[D]+"'>"+p[D]+"</span></th>";for(S+=M+"</tr></thead><tbody>",$=this._getDaysInMonth(te,Z),te===t.selectedYear&&Z===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,$)),E=(this._getFirstDayOfMonth(te,Z)-u+7)%7,P=Math.ceil((E+$)/7),I=K&&this.maxRows>P?this.maxRows:P,this.maxRows=I,N=this._daylightSavingAdjust(new Date(te,Z,1-E)),F=0;I>F;F++){for(S+="<tr>",O=h?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(N)+"</td>":"",w=0;7>w;w++)B=m?m.apply(t.input?t.input[0]:null,[N]):[!0,""],z=N.getMonth()!==Z,R=z&&!b||!B[0]||X&&X>N||Q&&N>Q,O+="<td class='"+((w+u+6)%7>=5?" ui-datepicker-week-end":"")+(z?" ui-datepicker-other-month":"")+(N.getTime()===A.getTime()&&Z===t.selectedMonth&&t._keyEvent||y.getTime()===N.getTime()&&y.getTime()===A.getTime()?" "+this._dayOverClass:"")+(R?" "+this._unselectableClass+" ui-state-disabled":"")+(z&&!v?"":" "+B[1]+(N.getTime()===J.getTime()?" "+this._currentClass:"")+(N.getTime()===H.getTime()?" ui-datepicker-today":""))+"'"+(z&&!v||!B[2]?"":" title='"+B[2].replace(/'/g,"&#39;")+"'")+(R?"":" data-handler='selectDay' data-event='click' data-month='"+N.getMonth()+"' data-year='"+N.getFullYear()+"'")+">"+(z&&!v?"&#xa0;":R?"<span class='ui-state-default'>"+N.getDate()+"</span>":"<a class='ui-state-default"+(N.getTime()===H.getTime()?" ui-state-highlight":"")+(N.getTime()===J.getTime()?" ui-state-active":"")+(z?" ui-priority-secondary":"")+"' href='#'>"+N.getDate()+"</a>")+"</td>",N.setDate(N.getDate()+1),N=this._daylightSavingAdjust(N);S+=O+"</tr>"}Z++,Z>11&&(Z=0,te++),S+="</tbody></table>"+(K?"</div>"+(U[0]>0&&C===U[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),k+=S}_+=k}return _+=c,t._keyEvent=!1,_},_generateMonthYearHeader:function(t,e,i,n,r,s,o,a){var l,c,u,h,d,p,f,g,m=this._get(t,"changeMonth"),v=this._get(t,"changeYear"),b=this._get(t,"showMonthAfterYear"),y="<div class='ui-datepicker-title'>",_="";if(s||!m)_+="<span class='ui-datepicker-month'>"+o[e]+"</span>";else{for(l=n&&n.getFullYear()===i,c=r&&r.getFullYear()===i,_+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",u=0;12>u;u++)(!l||u>=n.getMonth())&&(!c||u<=r.getMonth())&&(_+="<option value='"+u+"'"+(u===e?" selected='selected'":"")+">"+a[u]+"</option>");_+="</select>"}if(b||(y+=_+(!s&&m&&v?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",s||!v)y+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(h=this._get(t,"yearRange").split(":"),d=(new Date).getFullYear(),p=function(t){var e=t.match(/c[+\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\-].*/)?d+parseInt(t,10):parseInt(t,10);return isNaN(e)?d:e},f=p(h[0]),g=Math.max(f,p(h[1]||"")),f=n?Math.max(f,n.getFullYear()):f,g=r?Math.min(g,r.getFullYear()):g,t.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";g>=f;f++)t.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";t.yearshtml+="</select>",y+=t.yearshtml,t.yearshtml=null}return y+=this._get(t,"yearSuffix"),b&&(y+=(!s&&m&&v?"":"&#xa0;")+_),y+="</div>"},_adjustInstDate:function(t,e,i){var n=t.drawYear+("Y"===i?e:0),r=t.drawMonth+("M"===i?e:0),s=Math.min(t.selectedDay,this._getDaysInMonth(n,r))+("D"===i?e:0),o=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(n,r,s)));t.selectedDay=o.getDate(),t.drawMonth=t.selectedMonth=o.getMonth(),t.drawYear=t.selectedYear=o.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),n=this._getMinMaxDate(t,"max"),r=i&&i>e?i:e;return n&&r>n?n:r},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,n){var r=this._getNumberOfMonths(t),s=this._daylightSavingAdjust(new Date(i,n+(0>e?e:r[0]*r[1]),1));return 0>e&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(t,s)},_isInRange:function(t,e){var i,n,r=this._getMinMaxDate(t,"min"),s=this._getMinMaxDate(t,"max"),o=null,a=null,l=this._get(t,"yearRange");return l&&(i=l.split(":"),n=(new Date).getFullYear(),o=parseInt(i[0],10),a=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(o+=n),i[1].match(/[+\-].*/)&&(a+=n)),(!r||e.getTime()>=r.getTime())&&(!s||e.getTime()<=s.getTime())&&(!o||e.getFullYear()>=o)&&(!a||e.getFullYear()<=a)},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),{shortYearCutoff:e,dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,n){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var r=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(n,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),r,this._getFormatConfig(t))}}),t.fn.datepicker=function(e){if(!this.length)return this;t.datepicker.initialized||(t(document).mousedown(t.datepicker._checkExternalClick),t.datepicker.initialized=!0),0===t("#"+t.datepicker._mainDivId).length&&t("body").append(t.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!==e&&"getDate"!==e&&"widget"!==e?"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof e?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this].concat(i)):t.datepicker._attachDatepicker(this,e)}):t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i))},t.datepicker=new i,t.datepicker.initialized=!1,t.datepicker.uuid=(new Date).getTime(),t.datepicker.version="1.10.4"}(jQuery),function(t){var e={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},i={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};t.widget("ui.dialog",{version:"1.10.4",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var i=t(this).css(e).offset().top;0>i&&t(this).css("top",e.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&t.fn.draggable&&this._makeDraggable(),this.options.resizable&&t.fn.resizable&&this._makeResizable(),this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var e=this.options.appendTo;return e&&(e.jquery||e.nodeType)?t(e):this.document.find(e||"body").eq(0)},_destroy:function(){var t,e=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),t=e.parent.children().eq(e.index),t.length&&t[0]!==this.element[0]?t.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog},disable:t.noop,enable:t.noop,close:function(e){var i,n=this;if(this._isOpen&&this._trigger("beforeClose",e)!==!1){if(this._isOpen=!1,this._destroyOverlay(),!this.opener.filter(":focusable").focus().length)try{i=this.document[0].activeElement,i&&"body"!==i.nodeName.toLowerCase()&&t(i).blur()}catch(r){}this._hide(this.uiDialog,this.options.hide,function(){n._trigger("close",e)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,e){var i=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return i&&!e&&this._trigger("focus",t),i},open:function(){var e=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=t(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){e._focusTabbable(),e._trigger("focus")}),void this._trigger("open"))},_focusTabbable:function(){var t=this.element.find("[autofocus]");t.length||(t=this.element.find(":tabbable")),t.length||(t=this.uiDialogButtonPane.find(":tabbable")),t.length||(t=this.uiDialogTitlebarClose.filter(":tabbable")),t.length||(t=this.uiDialog),t.eq(0).focus()},_keepFocus:function(e){function i(){var e=this.document[0].activeElement,i=this.uiDialog[0]===e||t.contains(this.uiDialog[0],e);i||this._focusTabbable()}e.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=t("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(e){if(this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===t.ui.keyCode.ESCAPE)return e.preventDefault(),void this.close(e);if(e.keyCode===t.ui.keyCode.TAB){var i=this.uiDialog.find(":tabbable"),n=i.filter(":first"),r=i.filter(":last");e.target!==r[0]&&e.target!==this.uiDialog[0]||e.shiftKey?e.target!==n[0]&&e.target!==this.uiDialog[0]||!e.shiftKey||(r.focus(1),e.preventDefault()):(n.focus(1),e.preventDefault())}},mousedown:function(t){this._moveToTop(t)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var e;this.uiDialogTitlebar=t("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(e){t(e.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=t("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(t){t.preventDefault(),this.close(t)}}),e=t("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(e),this.uiDialog.attr({"aria-labelledby":e.attr("id")})},_title:function(t){this.options.title||t.html("&#160;"),t.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=t("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=t("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var e=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),t.isEmptyObject(i)||t.isArray(i)&&!i.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(t.each(i,function(i,n){var r,s;n=t.isFunction(n)?{click:n,text:i}:n,n=t.extend({type:"button"},n),r=n.click,n.click=function(){r.apply(e.element[0],arguments)},s={icons:n.icons,text:n.showText},delete n.icons,delete n.showText,t("<button></button>",n).button(s).appendTo(e.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function e(t){return{position:t.position,offset:t.offset}}var i=this,n=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(n,r){t(this).addClass("ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",n,e(r))},drag:function(t,n){i._trigger("drag",t,e(n))},stop:function(r,s){n.position=[s.position.left-i.document.scrollLeft(),s.position.top-i.document.scrollTop()],t(this).removeClass("ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",r,e(s))}})},_makeResizable:function(){function e(t){return{originalPosition:t.originalPosition,originalSize:t.originalSize,position:t.position,size:t.size}}var i=this,n=this.options,r=n.resizable,s=this.uiDialog.css("position"),o="string"==typeof r?r:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:n.maxWidth,maxHeight:n.maxHeight,minWidth:n.minWidth,minHeight:this._minHeight(),handles:o,start:function(n,r){t(this).addClass("ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",n,e(r))},resize:function(t,n){i._trigger("resize",t,e(n))},stop:function(r,s){n.height=t(this).height(),n.width=t(this).width(),t(this).removeClass("ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",r,e(s))}}).css("position",s)},_minHeight:function(){var t=this.options;return"auto"===t.height?t.minHeight:Math.min(t.minHeight,t.height)},_position:function(){var t=this.uiDialog.is(":visible");t||this.uiDialog.show(),this.uiDialog.position(this.options.position),t||this.uiDialog.hide()},_setOptions:function(n){var r=this,s=!1,o={};t.each(n,function(t,n){r._setOption(t,n),t in e&&(s=!0),t in i&&(o[t]=n)}),s&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",o)},_setOption:function(t,e){var i,n,r=this.uiDialog;"dialogClass"===t&&r.removeClass(this.options.dialogClass).addClass(e),"disabled"!==t&&(this._super(t,e),"appendTo"===t&&this.uiDialog.appendTo(this._appendTo()),"buttons"===t&&this._createButtons(),"closeText"===t&&this.uiDialogTitlebarClose.button({label:""+e}),"draggable"===t&&(i=r.is(":data(ui-draggable)"),i&&!e&&r.draggable("destroy"),!i&&e&&this._makeDraggable()),"position"===t&&this._position(),"resizable"===t&&(n=r.is(":data(ui-resizable)"),n&&!e&&r.resizable("destroy"),n&&"string"==typeof e&&r.resizable("option","handles",e),n||e===!1||this._makeResizable()),"title"===t&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var t,e,i,n=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),n.minWidth>n.width&&(n.width=n.minWidth),t=this.uiDialog.css({height:"auto",width:n.width}).outerHeight(),e=Math.max(0,n.minHeight-t),i="number"==typeof n.maxHeight?Math.max(0,n.maxHeight-t):"none","auto"===n.height?this.element.css({minHeight:e,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,n.height-t)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var e=t(this);return t("<div>").css({position:"absolute",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(e){return t(e.target).closest(".ui-dialog").length?!0:!!t(e.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var e=this,i=this.widgetFullName;t.ui.dialog.overlayInstances||this._delay(function(){t.ui.dialog.overlayInstances&&this.document.bind("focusin.dialog",function(n){e._allowInteraction(n)||(n.preventDefault(),t(".ui-dialog:visible:last .ui-dialog-content").data(i)._focusTabbable())})}),this.overlay=t("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),t.ui.dialog.overlayInstances++}},_destroyOverlay:function(){this.options.modal&&this.overlay&&(t.ui.dialog.overlayInstances--,t.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),this.overlay.remove(),this.overlay=null)}}),t.ui.dialog.overlayInstances=0,t.uiBackCompat!==!1&&t.widget("ui.dialog",t.ui.dialog,{_position:function(){var e,i=this.options.position,n=[],r=[0,0];i?(("string"==typeof i||"object"==typeof i&&"0"in i)&&(n=i.split?i.split(" "):[i[0],i[1]],1===n.length&&(n[1]=n[0]),t.each(["left","top"],function(t,e){+n[t]===n[t]&&(r[t]=n[t],n[t]=e)}),i={my:n[0]+(r[0]<0?r[0]:"+"+r[0])+" "+n[1]+(r[1]<0?r[1]:"+"+r[1]),at:n.join(" ")}),i=t.extend({},t.ui.dialog.prototype.options.position,i)):i=t.ui.dialog.prototype.options.position,e=this.uiDialog.is(":visible"),e||this.uiDialog.show(),this.uiDialog.position(i),e||this.uiDialog.hide()}})}(jQuery),function(t){var e=/up|down|vertical/,i=/up|left|vertical|horizontal/;t.effects.effect.blind=function(n,r){var s,o,a,l=t(this),c=["position","top","bottom","left","right","height","width"],u=t.effects.setMode(l,n.mode||"hide"),h=n.direction||"up",d=e.test(h),p=d?"height":"width",f=d?"top":"left",g=i.test(h),m={},v="show"===u;l.parent().is(".ui-effects-wrapper")?t.effects.save(l.parent(),c):t.effects.save(l,c),l.show(),s=t.effects.createWrapper(l).css({overflow:"hidden"}),o=s[p](),a=parseFloat(s.css(f))||0,m[p]=v?o:0,g||(l.css(d?"bottom":"right",0).css(d?"top":"left","auto").css({position:"absolute"}),m[f]=v?a:o+a),v&&(s.css(p,0),g||s.css(f,a+o)),s.animate(m,{duration:n.duration,easing:n.easing,queue:!1,complete:function(){"hide"===u&&l.hide(),t.effects.restore(l,c),t.effects.removeWrapper(l),r()}})}}(jQuery),function(t){t.effects.effect.bounce=function(e,i){var n,r,s,o=t(this),a=["position","top","bottom","left","right","height","width"],l=t.effects.setMode(o,e.mode||"effect"),c="hide"===l,u="show"===l,h=e.direction||"up",d=e.distance,p=e.times||5,f=2*p+(u||c?1:0),g=e.duration/f,m=e.easing,v="up"===h||"down"===h?"top":"left",b="up"===h||"left"===h,y=o.queue(),_=y.length;for((u||c)&&a.push("opacity"),t.effects.save(o,a),o.show(),t.effects.createWrapper(o),d||(d=o["top"===v?"outerHeight":"outerWidth"]()/3),u&&(s={opacity:1},s[v]=0,o.css("opacity",0).css(v,b?2*-d:2*d).animate(s,g,m)),c&&(d/=Math.pow(2,p-1)),s={},s[v]=0,n=0;p>n;n++)r={},r[v]=(b?"-=":"+=")+d,o.animate(r,g,m).animate(s,g,m),d=c?2*d:d/2;c&&(r={opacity:0},r[v]=(b?"-=":"+=")+d,o.animate(r,g,m)),o.queue(function(){c&&o.hide(),t.effects.restore(o,a),t.effects.removeWrapper(o),i()}),_>1&&y.splice.apply(y,[1,0].concat(y.splice(_,f+1))),o.dequeue()}}(jQuery),function(t){t.effects.effect.clip=function(e,i){var n,r,s,o=t(this),a=["position","top","bottom","left","right","height","width"],l=t.effects.setMode(o,e.mode||"hide"),c="show"===l,u=e.direction||"vertical",h="vertical"===u,d=h?"height":"width",p=h?"top":"left",f={};t.effects.save(o,a),o.show(),n=t.effects.createWrapper(o).css({overflow:"hidden"}),r="IMG"===o[0].tagName?n:o,s=r[d](),c&&(r.css(d,0),r.css(p,s/2)),f[d]=c?s:0,f[p]=c?0:s/2,r.animate(f,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){c||o.hide(),t.effects.restore(o,a),t.effects.removeWrapper(o),i()}})}}(jQuery),function(t){t.effects.effect.drop=function(e,i){var n,r=t(this),s=["position","top","bottom","left","right","opacity","height","width"],o=t.effects.setMode(r,e.mode||"hide"),a="show"===o,l=e.direction||"left",c="up"===l||"down"===l?"top":"left",u="up"===l||"left"===l?"pos":"neg",h={opacity:a?1:0};t.effects.save(r,s),r.show(),t.effects.createWrapper(r),n=e.distance||r["top"===c?"outerHeight":"outerWidth"](!0)/2,a&&r.css("opacity",0).css(c,"pos"===u?-n:n),h[c]=(a?"pos"===u?"+=":"-=":"pos"===u?"-=":"+=")+n,r.animate(h,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===o&&r.hide(),t.effects.restore(r,s),t.effects.removeWrapper(r),i()}})}}(jQuery),function(t){t.effects.effect.explode=function(e,i){function n(){y.push(this),y.length===h*d&&r()}function r(){p.css({visibility:"visible"}),t(y).remove(),g||p.hide(),i()}var s,o,a,l,c,u,h=e.pieces?Math.round(Math.sqrt(e.pieces)):3,d=h,p=t(this),f=t.effects.setMode(p,e.mode||"hide"),g="show"===f,m=p.show().css("visibility","hidden").offset(),v=Math.ceil(p.outerWidth()/d),b=Math.ceil(p.outerHeight()/h),y=[];for(s=0;h>s;s++)for(l=m.top+s*b,u=s-(h-1)/2,o=0;d>o;o++)a=m.left+o*v,c=o-(d-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-o*v,top:-s*b}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:v,height:b,left:a+(g?c*v:0),top:l+(g?u*b:0),opacity:g?0:1}).animate({left:a+(g?0:c*v),top:l+(g?0:u*b),opacity:g?1:0},e.duration||500,e.easing,n)}}(jQuery),function(t){t.effects.effect.fade=function(e,i){var n=t(this),r=t.effects.setMode(n,e.mode||"toggle");n.animate({opacity:r},{queue:!1,duration:e.duration,easing:e.easing,complete:i})}}(jQuery),function(t){t.effects.effect.fold=function(e,i){var n,r,s=t(this),o=["position","top","bottom","left","right","height","width"],a=t.effects.setMode(s,e.mode||"hide"),l="show"===a,c="hide"===a,u=e.size||15,h=/([0-9]+)%/.exec(u),d=!!e.horizFirst,p=l!==d,f=p?["width","height"]:["height","width"],g=e.duration/2,m={},v={};t.effects.save(s,o),s.show(),n=t.effects.createWrapper(s).css({overflow:"hidden"}),r=p?[n.width(),n.height()]:[n.height(),n.width()],h&&(u=parseInt(h[1],10)/100*r[c?0:1]),l&&n.css(d?{height:0,width:u}:{height:u,width:0}),m[f[0]]=l?r[0]:u,v[f[1]]=l?r[1]:0,n.animate(m,g,e.easing).animate(v,g,e.easing,function(){c&&s.hide(),t.effects.restore(s,o),t.effects.removeWrapper(s),i()})}}(jQuery),function(t){t.effects.effect.highlight=function(e,i){var n=t(this),r=["backgroundImage","backgroundColor","opacity"],s=t.effects.setMode(n,e.mode||"show"),o={backgroundColor:n.css("backgroundColor")};"hide"===s&&(o.opacity=0),t.effects.save(n,r),n.show().css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(o,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===s&&n.hide(),t.effects.restore(n,r),i()}})}}(jQuery),function(t){t.effects.effect.pulsate=function(e,i){var n,r=t(this),s=t.effects.setMode(r,e.mode||"show"),o="show"===s,a="hide"===s,l=o||"hide"===s,c=2*(e.times||5)+(l?1:0),u=e.duration/c,h=0,d=r.queue(),p=d.length;for((o||!r.is(":visible"))&&(r.css("opacity",0).show(),h=1),n=1;c>n;n++)r.animate({opacity:h},u,e.easing),h=1-h;r.animate({opacity:h},u,e.easing),r.queue(function(){a&&r.hide(),i()}),p>1&&d.splice.apply(d,[1,0].concat(d.splice(p,c+1))),r.dequeue()}}(jQuery),function(t){t.effects.effect.puff=function(e,i){var n=t(this),r=t.effects.setMode(n,e.mode||"hide"),s="hide"===r,o=parseInt(e.percent,10)||150,a=o/100,l={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()};t.extend(e,{effect:"scale",queue:!1,fade:!0,mode:r,complete:i,percent:s?o:100,from:s?l:{height:l.height*a,width:l.width*a,outerHeight:l.outerHeight*a,outerWidth:l.outerWidth*a}}),n.effect(e)},t.effects.effect.scale=function(e,i){var n=t(this),r=t.extend(!0,{},e),s=t.effects.setMode(n,e.mode||"effect"),o=parseInt(e.percent,10)||(0===parseInt(e.percent,10)?0:"hide"===s?0:100),a=e.direction||"both",l=e.origin,c={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()},u={y:"horizontal"!==a?o/100:1,x:"vertical"!==a?o/100:1};r.effect="size",r.queue=!1,r.complete=i,"effect"!==s&&(r.origin=l||["middle","center"],r.restore=!0),r.from=e.from||("show"===s?{height:0,width:0,outerHeight:0,outerWidth:0}:c),r.to={height:c.height*u.y,width:c.width*u.x,outerHeight:c.outerHeight*u.y,outerWidth:c.outerWidth*u.x},r.fade&&("show"===s&&(r.from.opacity=0,r.to.opacity=1),"hide"===s&&(r.from.opacity=1,r.to.opacity=0)),n.effect(r)},t.effects.effect.size=function(e,i){var n,r,s,o=t(this),a=["position","top","bottom","left","right","width","height","overflow","opacity"],l=["position","top","bottom","left","right","overflow","opacity"],c=["width","height","overflow"],u=["fontSize"],h=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],d=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=t.effects.setMode(o,e.mode||"effect"),f=e.restore||"effect"!==p,g=e.scale||"both",m=e.origin||["middle","center"],v=o.css("position"),b=f?a:l,y={height:0,width:0,outerHeight:0,outerWidth:0};"show"===p&&o.show(),n={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},"toggle"===e.mode&&"show"===p?(o.from=e.to||y,o.to=e.from||n):(o.from=e.from||("show"===p?y:n),o.to=e.to||("hide"===p?y:n)),s={from:{y:o.from.height/n.height,x:o.from.width/n.width},to:{y:o.to.height/n.height,x:o.to.width/n.width}},("box"===g||"both"===g)&&(s.from.y!==s.to.y&&(b=b.concat(h),o.from=t.effects.setTransition(o,h,s.from.y,o.from),o.to=t.effects.setTransition(o,h,s.to.y,o.to)),s.from.x!==s.to.x&&(b=b.concat(d),o.from=t.effects.setTransition(o,d,s.from.x,o.from),o.to=t.effects.setTransition(o,d,s.to.x,o.to))),("content"===g||"both"===g)&&s.from.y!==s.to.y&&(b=b.concat(u).concat(c),o.from=t.effects.setTransition(o,u,s.from.y,o.from),o.to=t.effects.setTransition(o,u,s.to.y,o.to)),t.effects.save(o,b),o.show(),t.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),m&&(r=t.effects.getBaseline(m,n),o.from.top=(n.outerHeight-o.outerHeight())*r.y,o.from.left=(n.outerWidth-o.outerWidth())*r.x,o.to.top=(n.outerHeight-o.to.outerHeight)*r.y,o.to.left=(n.outerWidth-o.to.outerWidth)*r.x),o.css(o.from),("content"===g||"both"===g)&&(h=h.concat(["marginTop","marginBottom"]).concat(u),d=d.concat(["marginLeft","marginRight"]),c=a.concat(h).concat(d),o.find("*[width]").each(function(){var i=t(this),n={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};f&&t.effects.save(i,c),i.from={height:n.height*s.from.y,width:n.width*s.from.x,outerHeight:n.outerHeight*s.from.y,outerWidth:n.outerWidth*s.from.x},i.to={height:n.height*s.to.y,width:n.width*s.to.x,outerHeight:n.height*s.to.y,outerWidth:n.width*s.to.x},s.from.y!==s.to.y&&(i.from=t.effects.setTransition(i,h,s.from.y,i.from),i.to=t.effects.setTransition(i,h,s.to.y,i.to)),s.from.x!==s.to.x&&(i.from=t.effects.setTransition(i,d,s.from.x,i.from),i.to=t.effects.setTransition(i,d,s.to.x,i.to)),i.css(i.from),i.animate(i.to,e.duration,e.easing,function(){f&&t.effects.restore(i,c)})})),o.animate(o.to,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){0===o.to.opacity&&o.css("opacity",o.from.opacity),"hide"===p&&o.hide(),t.effects.restore(o,b),f||("static"===v?o.css({position:"relative",top:o.to.top,left:o.to.left}):t.each(["top","left"],function(t,e){o.css(e,function(e,i){var n=parseInt(i,10),r=t?o.to.left:o.to.top;return"auto"===i?r+"px":n+r+"px"})})),t.effects.removeWrapper(o),i()}})}}(jQuery),function(t){t.effects.effect.shake=function(e,i){var n,r=t(this),s=["position","top","bottom","left","right","height","width"],o=t.effects.setMode(r,e.mode||"effect"),a=e.direction||"left",l=e.distance||20,c=e.times||3,u=2*c+1,h=Math.round(e.duration/u),d="up"===a||"down"===a?"top":"left",p="up"===a||"left"===a,f={},g={},m={},v=r.queue(),b=v.length;for(t.effects.save(r,s),r.show(),t.effects.createWrapper(r),f[d]=(p?"-=":"+=")+l,g[d]=(p?"+=":"-=")+2*l,m[d]=(p?"-=":"+=")+2*l,r.animate(f,h,e.easing),n=1;c>n;n++)r.animate(g,h,e.easing).animate(m,h,e.easing);r.animate(g,h,e.easing).animate(f,h/2,e.easing).queue(function(){"hide"===o&&r.hide(),t.effects.restore(r,s),t.effects.removeWrapper(r),i()}),b>1&&v.splice.apply(v,[1,0].concat(v.splice(b,u+1))),r.dequeue()}}(jQuery),function(t){t.effects.effect.slide=function(e,i){var n,r=t(this),s=["position","top","bottom","left","right","width","height"],o=t.effects.setMode(r,e.mode||"show"),a="show"===o,l=e.direction||"left",c="up"===l||"down"===l?"top":"left",u="up"===l||"left"===l,h={};t.effects.save(r,s),r.show(),n=e.distance||r["top"===c?"outerHeight":"outerWidth"](!0),t.effects.createWrapper(r).css({overflow:"hidden"}),a&&r.css(c,u?isNaN(n)?"-"+n:-n:n),h[c]=(a?u?"+=":"-=":u?"-=":"+=")+n,r.animate(h,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===o&&r.hide(),t.effects.restore(r,s),t.effects.removeWrapper(r),i()}})}}(jQuery),function(t){t.effects.effect.transfer=function(e,i){var n=t(this),r=t(e.to),s="fixed"===r.css("position"),o=t("body"),a=s?o.scrollTop():0,l=s?o.scrollLeft():0,c=r.offset(),u={top:c.top-a,left:c.left-l,height:r.innerHeight(),width:r.innerWidth()},h=n.offset(),d=t("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(e.className).css({top:h.top-a,left:h.left-l,height:n.innerHeight(),width:n.innerWidth(),position:s?"fixed":"absolute"}).animate(u,e.duration,e.easing,function(){d.remove(),i()
})}}(jQuery),function(t){t.widget("ui.menu",{version:"1.10.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,t.proxy(function(t){this.options.disabled&&t.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(t){t.preventDefault()},"click .ui-state-disabled > a":function(t){t.preventDefault()},"click .ui-menu-item:has(a)":function(e){var i=t(e.target).closest(".ui-menu-item");!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(e),e.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(e):!this.element.is(":focus")&&t(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){var i=t(e.currentTarget);i.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(e,i)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var i=this.active||this.element.children(".ui-menu-item").eq(0);e||this.focus(t,i)},blur:function(e){this._delay(function(){t.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){t(e.target).closest(".ui-menu").length||this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var e=t(this);e.data("ui-menu-submenu-carat")&&e.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(e){function i(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var n,r,s,o,a,l=!0;switch(e.keyCode){case t.ui.keyCode.PAGE_UP:this.previousPage(e);break;case t.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case t.ui.keyCode.HOME:this._move("first","first",e);break;case t.ui.keyCode.END:this._move("last","last",e);break;case t.ui.keyCode.UP:this.previous(e);break;case t.ui.keyCode.DOWN:this.next(e);break;case t.ui.keyCode.LEFT:this.collapse(e);break;case t.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case t.ui.keyCode.ENTER:case t.ui.keyCode.SPACE:this._activate(e);break;case t.ui.keyCode.ESCAPE:this.collapse(e);break;default:l=!1,r=this.previousFilter||"",s=String.fromCharCode(e.keyCode),o=!1,clearTimeout(this.filterTimer),s===r?o=!0:s=r+s,a=new RegExp("^"+i(s),"i"),n=this.activeMenu.children(".ui-menu-item").filter(function(){return a.test(t(this).children("a").text())}),n=o&&-1!==n.index(this.active.next())?this.active.nextAll(".ui-menu-item"):n,n.length||(s=String.fromCharCode(e.keyCode),a=new RegExp("^"+i(s),"i"),n=this.activeMenu.children(".ui-menu-item").filter(function(){return a.test(t(this).children("a").text())})),n.length?(this.focus(e,n),n.length>1?(this.previousFilter=s,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}l&&e.preventDefault()},_activate:function(t){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(t):this.select(t))},refresh:function(){var e,i=this.options.icons.submenu,n=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),n.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=t(this),n=e.prev("a"),r=t("<span>").addClass("ui-menu-icon ui-icon "+i).data("ui-menu-submenu-carat",!0);n.attr("aria-haspopup","true").prepend(r),e.attr("aria-labelledby",n.attr("id"))}),e=n.add(this.element),e.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),e.children(":not(.ui-menu-item)").each(function(){var e=t(this);/[^\-\u2014\u2013\s]/.test(e.text())||e.addClass("ui-widget-content ui-menu-divider")}),e.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!t.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){"icons"===t&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(e.submenu),this._super(t,e)},focus:function(t,e){var i,n;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),n=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",n.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=e.children(".ui-menu"),i.length&&t&&/^mouse/.test(t.type)&&this._startOpening(i),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(e){var i,n,r,s,o,a;this._hasScroll()&&(i=parseFloat(t.css(this.activeMenu[0],"borderTopWidth"))||0,n=parseFloat(t.css(this.activeMenu[0],"paddingTop"))||0,r=e.offset().top-this.activeMenu.offset().top-i-n,s=this.activeMenu.scrollTop(),o=this.activeMenu.height(),a=e.height(),0>r?this.activeMenu.scrollTop(s+r):r+a>o&&this.activeMenu.scrollTop(s+r-o+a))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",t,{item:this.active}))},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(t)},this.delay))},_open:function(e){var i=t.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(e,i){clearTimeout(this.timer),this.timer=this._delay(function(){var n=i?this.element:t(e&&e.target).closest(this.element.find(".ui-menu"));n.length||(n=this.element),this._close(n),this.blur(e),this.activeMenu=n},this.delay)},_close:function(t){t||(t=this.active?this.active.parent():this.element),t.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(t,e)}))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,i){var n;this.active&&(n="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),n&&n.length&&this.active||(n=this.activeMenu.children(".ui-menu-item")[e]()),this.focus(i,n)},nextPage:function(e){var i,n,r;return this.active?void(this.isLastItem()||(this._hasScroll()?(n=this.active.offset().top,r=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=t(this),i.offset().top-n-r<0}),this.focus(e,i)):this.focus(e,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]()))):void this.next(e)},previousPage:function(e){var i,n,r;return this.active?void(this.isFirstItem()||(this._hasScroll()?(n=this.active.offset().top,r=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=t(this),i.offset().top-n+r>0}),this.focus(e,i)):this.focus(e,this.activeMenu.children(".ui-menu-item").first()))):void this.next(e)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||t(e.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,i)}})}(jQuery),function(t,e){function i(t,e,i){return[parseFloat(t[0])*(p.test(t[0])?e/100:1),parseFloat(t[1])*(p.test(t[1])?i/100:1)]}function n(e,i){return parseInt(t.css(e,i),10)||0}function r(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}t.ui=t.ui||{};var s,o=Math.max,a=Math.abs,l=Math.round,c=/left|center|right/,u=/top|center|bottom/,h=/[\+\-]\d+(\.[\d]+)?%?/,d=/^\w+/,p=/%$/,f=t.fn.position;t.position={scrollbarWidth:function(){if(s!==e)return s;var i,n,r=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=r.children()[0];return t("body").append(r),i=o.offsetWidth,r.css("overflow","scroll"),n=o.offsetWidth,i===n&&(n=r[0].clientWidth),r.remove(),s=i-n},getScrollInfo:function(e){var i=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),n=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),r="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth,s="scroll"===n||"auto"===n&&e.height<e.element[0].scrollHeight;return{width:s?t.position.scrollbarWidth():0,height:r?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),n=t.isWindow(i[0]),r=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:n,isDocument:r,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:n?i.width():i.outerWidth(),height:n?i.height():i.outerHeight()}}},t.fn.position=function(e){if(!e||!e.of)return f.apply(this,arguments);e=t.extend({},e);var s,p,g,m,v,b,y=t(e.of),_=t.position.getWithinInfo(e.within),w=t.position.getScrollInfo(_),x=(e.collision||"flip").split(" "),k={};return b=r(y),y[0].preventDefault&&(e.at="left top"),p=b.width,g=b.height,m=b.offset,v=t.extend({},m),t.each(["my","at"],function(){var t,i,n=(e[this]||"").split(" ");1===n.length&&(n=c.test(n[0])?n.concat(["center"]):u.test(n[0])?["center"].concat(n):["center","center"]),n[0]=c.test(n[0])?n[0]:"center",n[1]=u.test(n[1])?n[1]:"center",t=h.exec(n[0]),i=h.exec(n[1]),k[this]=[t?t[0]:0,i?i[0]:0],e[this]=[d.exec(n[0])[0],d.exec(n[1])[0]]}),1===x.length&&(x[1]=x[0]),"right"===e.at[0]?v.left+=p:"center"===e.at[0]&&(v.left+=p/2),"bottom"===e.at[1]?v.top+=g:"center"===e.at[1]&&(v.top+=g/2),s=i(k.at,p,g),v.left+=s[0],v.top+=s[1],this.each(function(){var r,c,u=t(this),h=u.outerWidth(),d=u.outerHeight(),f=n(this,"marginLeft"),b=n(this,"marginTop"),C=h+f+n(this,"marginRight")+w.width,A=d+b+n(this,"marginBottom")+w.height,T=t.extend({},v),S=i(k.my,u.outerWidth(),u.outerHeight());"right"===e.my[0]?T.left-=h:"center"===e.my[0]&&(T.left-=h/2),"bottom"===e.my[1]?T.top-=d:"center"===e.my[1]&&(T.top-=d/2),T.left+=S[0],T.top+=S[1],t.support.offsetFractions||(T.left=l(T.left),T.top=l(T.top)),r={marginLeft:f,marginTop:b},t.each(["left","top"],function(i,n){t.ui.position[x[i]]&&t.ui.position[x[i]][n](T,{targetWidth:p,targetHeight:g,elemWidth:h,elemHeight:d,collisionPosition:r,collisionWidth:C,collisionHeight:A,offset:[s[0]+S[0],s[1]+S[1]],my:e.my,at:e.at,within:_,elem:u})}),e.using&&(c=function(t){var i=m.left-T.left,n=i+p-h,r=m.top-T.top,s=r+g-d,l={target:{element:y,left:m.left,top:m.top,width:p,height:g},element:{element:u,left:T.left,top:T.top,width:h,height:d},horizontal:0>n?"left":i>0?"right":"center",vertical:0>s?"top":r>0?"bottom":"middle"};h>p&&a(i+n)<p&&(l.horizontal="center"),d>g&&a(r+s)<g&&(l.vertical="middle"),l.important=o(a(i),a(n))>o(a(r),a(s))?"horizontal":"vertical",e.using.call(this,t,l)}),u.offset(t.extend(T,{using:c}))})},t.ui.position={fit:{left:function(t,e){var i,n=e.within,r=n.isWindow?n.scrollLeft:n.offset.left,s=n.width,a=t.left-e.collisionPosition.marginLeft,l=r-a,c=a+e.collisionWidth-s-r;e.collisionWidth>s?l>0&&0>=c?(i=t.left+l+e.collisionWidth-s-r,t.left+=l-i):t.left=c>0&&0>=l?r:l>c?r+s-e.collisionWidth:r:l>0?t.left+=l:c>0?t.left-=c:t.left=o(t.left-a,t.left)},top:function(t,e){var i,n=e.within,r=n.isWindow?n.scrollTop:n.offset.top,s=e.within.height,a=t.top-e.collisionPosition.marginTop,l=r-a,c=a+e.collisionHeight-s-r;e.collisionHeight>s?l>0&&0>=c?(i=t.top+l+e.collisionHeight-s-r,t.top+=l-i):t.top=c>0&&0>=l?r:l>c?r+s-e.collisionHeight:r:l>0?t.top+=l:c>0?t.top-=c:t.top=o(t.top-a,t.top)}},flip:{left:function(t,e){var i,n,r=e.within,s=r.offset.left+r.scrollLeft,o=r.width,l=r.isWindow?r.scrollLeft:r.offset.left,c=t.left-e.collisionPosition.marginLeft,u=c-l,h=c+e.collisionWidth-o-l,d="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];0>u?(i=t.left+d+p+f+e.collisionWidth-o-s,(0>i||i<a(u))&&(t.left+=d+p+f)):h>0&&(n=t.left-e.collisionPosition.marginLeft+d+p+f-l,(n>0||a(n)<h)&&(t.left+=d+p+f))},top:function(t,e){var i,n,r=e.within,s=r.offset.top+r.scrollTop,o=r.height,l=r.isWindow?r.scrollTop:r.offset.top,c=t.top-e.collisionPosition.marginTop,u=c-l,h=c+e.collisionHeight-o-l,d="top"===e.my[1],p=d?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,f="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,g=-2*e.offset[1];0>u?(n=t.top+p+f+g+e.collisionHeight-o-s,t.top+p+f+g>u&&(0>n||n<a(u))&&(t.top+=p+f+g)):h>0&&(i=t.top-e.collisionPosition.marginTop+p+f+g-l,t.top+p+f+g>h&&(i>0||a(i)<h)&&(t.top+=p+f+g))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}},function(){var e,i,n,r,s,o=document.getElementsByTagName("body")[0],a=document.createElement("div");e=document.createElement(o?"div":"body"),n={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&t.extend(n,{position:"absolute",left:"-1000px",top:"-1000px"});for(s in n)e.style[s]=n[s];e.appendChild(a),i=o||document.documentElement,i.insertBefore(e,i.firstChild),a.style.cssText="position: absolute; left: 10.7432222px;",r=t(a).offset().left,t.support.offsetFractions=r>10&&11>r,e.innerHTML="",i.removeChild(e)}()}(jQuery),function(t,e){t.widget("ui.progressbar",{version:"1.10.4",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=t("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(t){return t===e?this.options.value:(this.options.value=this._constrainedValue(t),void this._refreshValue())},_constrainedValue:function(t){return t===e&&(t=this.options.value),this.indeterminate=t===!1,"number"!=typeof t&&(t=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,t))},_setOptions:function(t){var e=t.value;delete t.value,this._super(t),this.options.value=this._constrainedValue(e),this._refreshValue()},_setOption:function(t,e){"max"===t&&(e=Math.max(this.min,e)),this._super(t,e)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).toggleClass("ui-corner-right",e===this.options.max).width(i.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=t("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":e}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),e===this.options.max&&this._trigger("complete")}})}(jQuery),function(t){var e=5;t.widget("ui.slider",t.ui.mouse,{version:"1.10.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,i,n=this.options,r=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),s="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",o=[];for(i=n.values&&n.values.length||1,r.length>i&&(r.slice(i).remove(),r=r.slice(0,i)),e=r.length;i>e;e++)o.push(s);this.handles=r.add(t(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(e){t(this).data("ui-slider-handle-index",e)})},_createRange:function(){var e=this.options,i="";e.range?(e.range===!0&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:t.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=t("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===e.range||"max"===e.range?" ui-slider-range-"+e.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){var t=this.handles.add(this.range).filter("a");this._off(t),this._on(t,this._handleEvents),this._hoverable(t),this._focusable(t)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(e){var i,n,r,s,o,a,l,c,u=this,h=this.options;return h.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(i),r=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var i=Math.abs(n-u.values(e));(r>i||r===i&&(e===u._lastChangedValue||u.values(e)===h.min))&&(r=i,s=t(this),o=e)}),a=this._start(e,o),a===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,s.addClass("ui-state-active").focus(),l=s.offset(),c=!t(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=c?{left:0,top:0}:{left:e.pageX-l.left-s.width()/2,top:e.pageY-l.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,o,n),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,n,r,s;return"horizontal"===this.orientation?(e=this.elementSize.width,i=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,i=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),n=i/e,n>1&&(n=1),0>n&&(n=0),"vertical"===this.orientation&&(n=1-n),r=this._valueMax()-this._valueMin(),s=this._valueMin()+n*r,this._trimAlignValue(s)},_start:function(t,e){var i={handle:this.handles[e],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("start",t,i)},_slide:function(t,e,i){var n,r,s;this.options.values&&this.options.values.length?(n=this.values(e?0:1),2===this.options.values.length&&this.options.range===!0&&(0===e&&i>n||1===e&&n>i)&&(i=n),i!==this.values(e)&&(r=this.values(),r[e]=i,s=this._trigger("slide",t,{handle:this.handles[e],value:i,values:r}),n=this.values(e?0:1),s!==!1&&this.values(e,i))):i!==this.value()&&(s=this._trigger("slide",t,{handle:this.handles[e],value:i}),s!==!1&&this.value(i))},_stop:function(t,e){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("stop",t,i)},_change:function(t,e){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._lastChangedValue=e,this._trigger("change",t,i)}},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),void this._change(null,0)):this._value()},values:function(e,i){var n,r,s;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(i),this._refreshValue(),void this._change(null,e);if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(e):this.value();for(n=this.options.values,r=arguments[0],s=0;s<n.length;s+=1)n[s]=this._trimAlignValue(r[s]),this._change(null,s);this._refreshValue()},_setOption:function(e,i){var n,r=0;switch("range"===e&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),t.isArray(this.options.values)&&(r=this.options.values.length),t.Widget.prototype._setOption.apply(this,arguments),e){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),n=0;r>n;n+=1)this._change(null,n);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,i,n;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),n=0;n<i.length;n+=1)i[n]=this._trimAlignValue(i[n]);return i}return[]},_trimAlignValue:function(t){if(t<=this._valueMin())return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,i=(t-this._valueMin())%e,n=t-i;return 2*Math.abs(i)>=e&&(n+=i>0?e:-e),parseFloat(n.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var e,i,n,r,s,o=this.options.range,a=this.options,l=this,c=this._animateOff?!1:a.animate,u={};this.options.values&&this.options.values.length?this.handles.each(function(n){i=(l.values(n)-l._valueMin())/(l._valueMax()-l._valueMin())*100,u["horizontal"===l.orientation?"left":"bottom"]=i+"%",t(this).stop(1,1)[c?"animate":"css"](u,a.animate),l.options.range===!0&&("horizontal"===l.orientation?(0===n&&l.range.stop(1,1)[c?"animate":"css"]({left:i+"%"},a.animate),1===n&&l.range[c?"animate":"css"]({width:i-e+"%"},{queue:!1,duration:a.animate})):(0===n&&l.range.stop(1,1)[c?"animate":"css"]({bottom:i+"%"},a.animate),1===n&&l.range[c?"animate":"css"]({height:i-e+"%"},{queue:!1,duration:a.animate}))),e=i}):(n=this.value(),r=this._valueMin(),s=this._valueMax(),i=s!==r?(n-r)/(s-r)*100:0,u["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[c?"animate":"css"](u,a.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:i+"%"},a.animate),"max"===o&&"horizontal"===this.orientation&&this.range[c?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:a.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:i+"%"},a.animate),"max"===o&&"vertical"===this.orientation&&this.range[c?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:a.animate}))},_handleEvents:{keydown:function(i){var n,r,s,o,a=t(i.target).data("ui-slider-handle-index");switch(i.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(i.preventDefault(),!this._keySliding&&(this._keySliding=!0,t(i.target).addClass("ui-state-active"),n=this._start(i,a),n===!1))return}switch(o=this.options.step,r=s=this.options.values&&this.options.values.length?this.values(a):this.value(),i.keyCode){case t.ui.keyCode.HOME:s=this._valueMin();break;case t.ui.keyCode.END:s=this._valueMax();break;case t.ui.keyCode.PAGE_UP:s=this._trimAlignValue(r+(this._valueMax()-this._valueMin())/e);break;case t.ui.keyCode.PAGE_DOWN:s=this._trimAlignValue(r-(this._valueMax()-this._valueMin())/e);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(r===this._valueMax())return;s=this._trimAlignValue(r+o);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(r===this._valueMin())return;s=this._trimAlignValue(r-o)}this._slide(i,a,s)},click:function(t){t.preventDefault()},keyup:function(e){var i=t(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,i),this._change(e,i),t(e.target).removeClass("ui-state-active"))}}})}(jQuery),function(t){function e(t){return function(){var e=this.element.val();t.apply(this,arguments),this._refresh(),e!==this.element.val()&&this._trigger("change")}}t.widget("ui.spinner",{version:"1.10.4",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var e={},i=this.element;return t.each(["min","max","step"],function(t,n){var r=i.attr(n);void 0!==r&&r.length&&(e[n]=r)}),e},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",t)))},mousewheel:function(t,e){if(e){if(!this.spinning&&!this._start(t))return!1;this._spin((e>0?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(t)},100),t.preventDefault()}},"mousedown .ui-spinner-button":function(e){function i(){var t=this.element[0]===this.document[0].activeElement;t||(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n}))}var n;n=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),e.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(e)!==!1&&this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){return t(e.currentTarget).hasClass("ui-state-active")?this._start(e)===!1?!1:void this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var t=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=t.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*t.height())&&t.height()>0&&t.height(t.height()),this.options.disabled&&this.disable()},_keydown:function(e){var i=this.options,n=t.ui.keyCode;switch(e.keyCode){case n.UP:return this._repeat(null,1,e),!0;case n.DOWN:return this._repeat(null,-1,e),!0;case n.PAGE_UP:return this._repeat(null,i.page,e),!0;case n.PAGE_DOWN:return this._repeat(null,-i.page,e),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(t){return this.spinning||this._trigger("start",t)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(t,e,i){t=t||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,e,i)},t),this._spin(e*this.options.step,i)},_spin:function(t,e){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+t*this._increment(this.counter)),this.spinning&&this._trigger("spin",e,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(e){var i=this.options.incremental;return i?t.isFunction(i)?i(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=t.toString(),i=e.indexOf(".");
return-1===i?0:e.length-i-1},_adjustValue:function(t){var e,i,n=this.options;return e=null!==n.min?n.min:0,i=t-e,i=Math.round(i/n.step)*n.step,t=e+i,t=parseFloat(t.toFixed(this._precision())),null!==n.max&&t>n.max?n.max:null!==n.min&&t<n.min?n.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",t))},_setOption:function(t,e){if("culture"===t||"numberFormat"===t){var i=this._parse(this.element.val());return this.options[t]=e,void this.element.val(this._format(i))}("max"===t||"min"===t||"step"===t)&&"string"==typeof e&&(e=this._parse(e)),"icons"===t&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(e.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(e.down)),this._super(t,e),"disabled"===t&&(e?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:e(function(t){this._super(t),this._value(this.element.val())}),_parse:function(t){return"string"==typeof t&&""!==t&&(t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t),""===t||isNaN(t)?null:t},_format:function(t){return""===t?"":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(t,e){var i;""!==t&&(i=this._parse(t),null!==i&&(e||(i=this._adjustValue(i)),t=this._format(i))),this.element.val(t),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:e(function(t){this._stepUp(t)}),_stepUp:function(t){this._start()&&(this._spin((t||1)*this.options.step),this._stop())},stepDown:e(function(t){this._stepDown(t)}),_stepDown:function(t){this._start()&&(this._spin((t||1)*-this.options.step),this._stop())},pageUp:e(function(t){this._stepUp((t||1)*this.options.page)}),pageDown:e(function(t){this._stepDown((t||1)*this.options.page)}),value:function(t){return arguments.length?void e(this._value).call(this,t):this._parse(this.element.val())},widget:function(){return this.uiSpinner}})}(jQuery),function(t,e){function i(){return++r}function n(t){return t=t.cloneNode(!1),t.hash.length>1&&decodeURIComponent(t.href.replace(s,""))===decodeURIComponent(location.href.replace(s,""))}var r=0,s=/#.*$/;t.widget("ui.tabs",{version:"1.10.4",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var e=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(e){t(this).is(".ui-state-disabled")&&e.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){t(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),i.active=this._initialActive(),t.isArray(i.disabled)&&(i.disabled=t.unique(i.disabled.concat(t.map(this.tabs.filter(".ui-state-disabled"),function(t){return e.tabs.index(t)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(i.active):t(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var e=this.options.active,i=this.options.collapsible,n=location.hash.substring(1);return null===e&&(n&&this.tabs.each(function(i,r){return t(r).attr("aria-controls")===n?(e=i,!1):void 0}),null===e&&(e=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===e||-1===e)&&(e=this.tabs.length?0:!1)),e!==!1&&(e=this.tabs.index(this.tabs.eq(e)),-1===e&&(e=i?!1:0)),!i&&e===!1&&this.anchors.length&&(e=0),e},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):t()}},_tabKeydown:function(e){var i=t(this.document[0].activeElement).closest("li"),n=this.tabs.index(i),r=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:n++;break;case t.ui.keyCode.UP:case t.ui.keyCode.LEFT:r=!1,n--;break;case t.ui.keyCode.END:n=this.anchors.length-1;break;case t.ui.keyCode.HOME:n=0;break;case t.ui.keyCode.SPACE:return e.preventDefault(),clearTimeout(this.activating),void this._activate(n);case t.ui.keyCode.ENTER:return e.preventDefault(),clearTimeout(this.activating),void this._activate(n===this.options.active?!1:n);default:return}e.preventDefault(),clearTimeout(this.activating),n=this._focusNextTab(n,r),e.ctrlKey||(i.attr("aria-selected","false"),this.tabs.eq(n).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",n)},this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===t.ui.keyCode.UP&&(e.preventDefault(),this.active.focus())},_handlePageNav:function(e){return e.altKey&&e.keyCode===t.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):e.altKey&&e.keyCode===t.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(e,i){function n(){return e>r&&(e=0),0>e&&(e=r),e}for(var r=this.tabs.length-1;-1!==t.inArray(n(),this.options.disabled);)e=i?e+1:e-1;return e},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).focus(),t},_setOption:function(t,e){return"active"===t?void this._activate(e):"disabled"===t?void this._setupDisabled(e):(this._super(t,e),"collapsible"===t&&(this.element.toggleClass("ui-tabs-collapsible",e),e||this.options.active!==!1||this._activate(0)),"event"===t&&this._setupEvents(e),void("heightStyle"===t&&this._setupHeightStyle(e)))},_tabId:function(t){return t.attr("aria-controls")||"ui-tabs-"+i()},_sanitizeSelector:function(t){return t?t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,i=this.tablist.children(":has(a[href])");e.disabled=t.map(i.filter(".ui-state-disabled"),function(t){return i.index(t)}),this._processTabs(),e.active!==!1&&this.anchors.length?this.active.length&&!t.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=t()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=t()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var e=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return t("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=t(),this.anchors.each(function(i,r){var s,o,a,l=t(r).uniqueId().attr("id"),c=t(r).closest("li"),u=c.attr("aria-controls");n(r)?(s=r.hash,o=e.element.find(e._sanitizeSelector(s))):(a=e._tabId(c),s="#"+a,o=e.element.find(s),o.length||(o=e._createPanel(a),o.insertAfter(e.panels[i-1]||e.tablist)),o.attr("aria-live","polite")),o.length&&(e.panels=e.panels.add(o)),u&&c.data("ui-tabs-aria-controls",u),c.attr({"aria-controls":s.substring(1),"aria-labelledby":l}),o.attr("aria-labelledby",l)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(e){return t("<div>").attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(e){t.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1);for(var i,n=0;i=this.tabs[n];n++)e===!0||-1!==t.inArray(n,e)?t(i).addClass("ui-state-disabled").attr("aria-disabled","true"):t(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=e},_setupEvents:function(e){var i={click:function(t){t.preventDefault()}};e&&t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var i,n=this.element.parent();"fill"===e?(i=n.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var e=t(this),n=e.css("position");"absolute"!==n&&"fixed"!==n&&(i-=e.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=t(this).outerHeight(!0)}),this.panels.each(function(){t(this).height(Math.max(0,i-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===e&&(i=0,this.panels.each(function(){i=Math.max(i,t(this).height("").height())}).height(i))},_eventHandler:function(e){var i=this.options,n=this.active,r=t(e.currentTarget),s=r.closest("li"),o=s[0]===n[0],a=o&&i.collapsible,l=a?t():this._getPanelForTab(s),c=n.length?this._getPanelForTab(n):t(),u={oldTab:n,oldPanel:c,newTab:a?t():s,newPanel:l};e.preventDefault(),s.hasClass("ui-state-disabled")||s.hasClass("ui-tabs-loading")||this.running||o&&!i.collapsible||this._trigger("beforeActivate",e,u)===!1||(i.active=a?!1:this.tabs.index(s),this.active=o?t():s,this.xhr&&this.xhr.abort(),c.length||l.length||t.error("jQuery UI Tabs: Mismatching fragment identifier."),l.length&&this.load(this.tabs.index(s),e),this._toggle(e,u))},_toggle:function(e,i){function n(){s.running=!1,s._trigger("activate",e,i)}function r(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&s.options.show?s._show(o,s.options.show,n):(o.show(),n())}var s=this,o=i.newPanel,a=i.oldPanel;this.running=!0,a.length&&this.options.hide?this._hide(a,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),r()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),a.hide(),r()),a.attr({"aria-expanded":"false","aria-hidden":"true"}),i.oldTab.attr("aria-selected","false"),o.length&&a.length?i.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return 0===t(this).attr("tabIndex")}).attr("tabIndex",-1),o.attr({"aria-expanded":"true","aria-hidden":"false"}),i.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(e){var i,n=this._findActive(e);n[0]!==this.active[0]&&(n.length||(n=this.active),i=n.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return e===!1?t():this.tabs.eq(e)},_getIndex:function(t){return"string"==typeof t&&(t=this.anchors.index(this.anchors.filter("[href$='"+t+"']"))),t},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){t.data(this,"ui-tabs-destroy")?t(this).remove():t(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var e=t(this),i=e.data("ui-tabs-aria-controls");i?e.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(i){var n=this.options.disabled;n!==!1&&(i===e?n=!1:(i=this._getIndex(i),n=t.isArray(n)?t.map(n,function(t){return t!==i?t:null}):t.map(this.tabs,function(t,e){return e!==i?e:null})),this._setupDisabled(n))},disable:function(i){var n=this.options.disabled;if(n!==!0){if(i===e)n=!0;else{if(i=this._getIndex(i),-1!==t.inArray(i,n))return;n=t.isArray(n)?t.merge([i],n).sort():[i]}this._setupDisabled(n)}},load:function(e,i){e=this._getIndex(e);var r=this,s=this.tabs.eq(e),o=s.find(".ui-tabs-anchor"),a=this._getPanelForTab(s),l={tab:s,panel:a};n(o[0])||(this.xhr=t.ajax(this._ajaxSettings(o,i,l)),this.xhr&&"canceled"!==this.xhr.statusText&&(s.addClass("ui-tabs-loading"),a.attr("aria-busy","true"),this.xhr.success(function(t){setTimeout(function(){a.html(t),r._trigger("load",i,l)},1)}).complete(function(t,e){setTimeout(function(){"abort"===e&&r.panels.stop(!1,!0),s.removeClass("ui-tabs-loading"),a.removeAttr("aria-busy"),t===r.xhr&&delete r.xhr},1)})))},_ajaxSettings:function(e,i,n){var r=this;return{url:e.attr("href"),beforeSend:function(e,s){return r._trigger("beforeLoad",i,t.extend({jqXHR:e,ajaxSettings:s},n))}}},_getPanelForTab:function(e){var i=t(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}})}(jQuery),function(t){function e(e,i){var n=(e.attr("aria-describedby")||"").split(/\s+/);n.push(i),e.data("ui-tooltip-id",i).attr("aria-describedby",t.trim(n.join(" ")))}function i(e){var i=e.data("ui-tooltip-id"),n=(e.attr("aria-describedby")||"").split(/\s+/),r=t.inArray(i,n);-1!==r&&n.splice(r,1),e.removeData("ui-tooltip-id"),n=t.trim(n.join(" ")),n?e.attr("aria-describedby",n):e.removeAttr("aria-describedby")}var n=0;t.widget("ui.tooltip",{version:"1.10.4",options:{content:function(){var e=t(this).attr("title")||"";return t("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(e,i){var n=this;return"disabled"===e?(this[i?"_disable":"_enable"](),void(this.options[e]=i)):(this._super(e,i),void("content"===e&&t.each(this.tooltips,function(t,e){n._updateContent(e)})))},_disable:function(){var e=this;t.each(this.tooltips,function(i,n){var r=t.Event("blur");r.target=r.currentTarget=n[0],e.close(r,!0)}),this.element.find(this.options.items).addBack().each(function(){var e=t(this);e.is("[title]")&&e.data("ui-tooltip-title",e.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var e=t(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))})},open:function(e){var i=this,n=t(e?e.target:this.element).closest(this.options.items);n.length&&!n.data("ui-tooltip-id")&&(n.attr("title")&&n.data("ui-tooltip-title",n.attr("title")),n.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&n.parents().each(function(){var e,n=t(this);n.data("ui-tooltip-open")&&(e=t.Event("blur"),e.target=e.currentTarget=this,i.close(e,!0)),n.attr("title")&&(n.uniqueId(),i.parents[this.id]={element:this,title:n.attr("title")},n.attr("title",""))}),this._updateContent(n,e))},_updateContent:function(t,e){var i,n=this.options.content,r=this,s=e?e.type:null;return"string"==typeof n?this._open(e,t,n):(i=n.call(t[0],function(i){t.data("ui-tooltip-open")&&r._delay(function(){e&&(e.type=s),this._open(e,t,i)})}),void(i&&this._open(e,t,i)))},_open:function(i,n,r){function s(t){c.of=t,o.is(":hidden")||o.position(c)}var o,a,l,c=t.extend({},this.options.position);if(r){if(o=this._find(n),o.length)return void o.find(".ui-tooltip-content").html(r);n.is("[title]")&&(i&&"mouseover"===i.type?n.attr("title",""):n.removeAttr("title")),o=this._tooltip(n),e(n,o.attr("id")),o.find(".ui-tooltip-content").html(r),this.options.track&&i&&/^mouse/.test(i.type)?(this._on(this.document,{mousemove:s}),s(i)):o.position(t.extend({of:n},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.show&&this.options.show.delay&&(l=this.delayedShow=setInterval(function(){o.is(":visible")&&(s(c.of),clearInterval(l))},t.fx.interval)),this._trigger("open",i,{tooltip:o}),a={keyup:function(e){if(e.keyCode===t.ui.keyCode.ESCAPE){var i=t.Event(e);i.currentTarget=n[0],this.close(i,!0)}},remove:function(){this._removeTooltip(o)}},i&&"mouseover"!==i.type||(a.mouseleave="close"),i&&"focusin"!==i.type||(a.focusout="close"),this._on(!0,n,a)}},close:function(e){var n=this,r=t(e?e.currentTarget:this.element),s=this._find(r);this.closing||(clearInterval(this.delayedShow),r.data("ui-tooltip-title")&&r.attr("title",r.data("ui-tooltip-title")),i(r),s.stop(!0),this._hide(s,this.options.hide,function(){n._removeTooltip(t(this))}),r.removeData("ui-tooltip-open"),this._off(r,"mouseleave focusout keyup"),r[0]!==this.element[0]&&this._off(r,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&t.each(this.parents,function(e,i){t(i.element).attr("title",i.title),delete n.parents[e]}),this.closing=!0,this._trigger("close",e,{tooltip:s}),this.closing=!1)},_tooltip:function(e){var i="ui-tooltip-"+n++,r=t("<div>").attr({id:i,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return t("<div>").addClass("ui-tooltip-content").appendTo(r),r.appendTo(this.document[0].body),this.tooltips[i]=e,r},_find:function(e){var i=e.data("ui-tooltip-id");return i?t("#"+i):t()},_removeTooltip:function(t){t.remove(),delete this.tooltips[t.attr("id")]},_destroy:function(){var e=this;t.each(this.tooltips,function(i,n){var r=t.Event("blur");r.target=r.currentTarget=n[0],e.close(r,!0),t("#"+i).remove(),n.data("ui-tooltip-title")&&(n.attr("title",n.data("ui-tooltip-title")),n.removeData("ui-tooltip-title"))})}})}(jQuery),function(t,e){if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(i,n,r){t.Backbone=e(t,r,i,n)});else if("undefined"!=typeof exports){var i=require("underscore");e(t,exports,i)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(this,function(t,e,i,n){{var r=t.Backbone,s=[],o=(s.push,s.slice);s.splice}e.VERSION="1.1.1",e.$=n,e.noConflict=function(){return t.Backbone=r,this},e.emulateHTTP=!1,e.emulateJSON=!1;var a=e.Events={on:function(t,e,i){if(!c(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var n=this._events[t]||(this._events[t]=[]);return n.push({callback:e,context:i,ctx:i||this}),this},once:function(t,e,n){if(!c(this,"once",t,[e,n])||!e)return this;var r=this,s=i.once(function(){r.off(t,s),e.apply(this,arguments)});return s._callback=e,this.on(t,s,n)},off:function(t,e,n){var r,s,o,a,l,u,h,d;if(!this._events||!c(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events=void 0,this;for(a=t?[t]:i.keys(this._events),l=0,u=a.length;u>l;l++)if(t=a[l],o=this._events[t]){if(this._events[t]=r=[],e||n)for(h=0,d=o.length;d>h;h++)s=o[h],(e&&e!==s.callback&&e!==s.callback._callback||n&&n!==s.context)&&r.push(s);r.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=o.call(arguments,1);if(!c(this,"trigger",t,e))return this;var i=this._events[t],n=this._events.all;return i&&u(i,e),n&&u(n,arguments),this},stopListening:function(t,e,n){var r=this._listeningTo;if(!r)return this;var s=!e&&!n;n||"object"!=typeof e||(n=this),t&&((r={})[t._listenId]=t);for(var o in r)t=r[o],t.off(e,n,this),(s||i.isEmpty(t._events))&&delete this._listeningTo[o];return this}},l=/\s+/,c=function(t,e,i,n){if(!i)return!0;if("object"==typeof i){for(var r in i)t[e].apply(t,[r,i[r]].concat(n));return!1}if(l.test(i)){for(var s=i.split(l),o=0,a=s.length;a>o;o++)t[e].apply(t,[s[o]].concat(n));return!1}return!0},u=function(t,e){var i,n=-1,r=t.length,s=e[0],o=e[1],a=e[2];switch(e.length){case 0:for(;++n<r;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<r;)(i=t[n]).callback.call(i.ctx,s);return;case 2:for(;++n<r;)(i=t[n]).callback.call(i.ctx,s,o);return;case 3:for(;++n<r;)(i=t[n]).callback.call(i.ctx,s,o,a);return;default:for(;++n<r;)(i=t[n]).callback.apply(i.ctx,e);return}},h={listenTo:"on",listenToOnce:"once"};i.each(h,function(t,e){a[e]=function(e,n,r){var s=this._listeningTo||(this._listeningTo={}),o=e._listenId||(e._listenId=i.uniqueId("l"));return s[o]=e,r||"object"!=typeof n||(r=this),e[t](n,r,this),this}}),a.bind=a.on,a.unbind=a.off,i.extend(e,a);var d=e.Model=function(t,e){var n=t||{};e||(e={}),this.cid=i.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{}),n=i.defaults({},n,i.result(this,"defaults")),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};i.extend(d.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return i.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return i.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,n){var r,s,o,a,l,c,u,h;if(null==t)return this;if("object"==typeof t?(s=t,n=e):(s={})[t]=e,n||(n={}),!this._validate(s,n))return!1;o=n.unset,l=n.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=i.clone(this.attributes),this.changed={}),h=this.attributes,u=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(r in s)e=s[r],i.isEqual(h[r],e)||a.push(r),i.isEqual(u[r],e)?delete this.changed[r]:this.changed[r]=e,o?delete h[r]:h[r]=e;if(!l){a.length&&(this._pending=n);for(var d=0,p=a.length;p>d;d++)this.trigger("change:"+a[d],this,h[a[d]],n)}if(c)return this;if(!l)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,i.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,i.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!i.isEmpty(this.changed):i.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?i.clone(this.changed):!1;var e,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var s in t)i.isEqual(r[s],e=t[s])||((n||(n={}))[s]=e);return n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(t){t=t?i.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,n=t.success;return t.success=function(i){return e.set(e.parse(i,t),t)?(n&&n(e,i,t),void e.trigger("sync",e,i,t)):!1},B(this,t),this.sync("read",this,t)},save:function(t,e,n){var r,s,o,a=this.attributes;if(null==t||"object"==typeof t?(r=t,n=e):(r={})[t]=e,n=i.extend({validate:!0},n),r&&!n.wait){if(!this.set(r,n))return!1}else if(!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=i.extend({},a,r)),void 0===n.parse&&(n.parse=!0);var l=this,c=n.success;return n.success=function(t){l.attributes=a;var e=l.parse(t,n);return n.wait&&(e=i.extend(r||{},e)),i.isObject(e)&&!l.set(e,n)?!1:(c&&c(l,t,n),void l.trigger("sync",l,t,n))},B(this,n),s=this.isNew()?"create":n.patch?"patch":"update","patch"===s&&(n.attrs=r),o=this.sync(s,this,n),r&&n.wait&&(this.attributes=a),o},destroy:function(t){t=t?i.clone(t):{};var e=this,n=t.success,r=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(i){(t.wait||e.isNew())&&r(),n&&n(e,i,t),e.isNew()||e.trigger("sync",e,i,t)},this.isNew())return t.success(),!1;B(this,t);var s=this.sync("delete",this,t);return t.wait||r(),s},url:function(){var t=i.result(this,"urlRoot")||i.result(this.collection,"url")||O();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},i.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=i.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return n?(this.trigger("invalid",this,n,i.extend(e,{validationError:n})),!1):!0}});var p=["keys","values","pairs","invert","pick","omit"];i.each(p,function(t){d.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.attributes),i[t].apply(i,e)}});var f=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,i.extend({silent:!0},e))},g={add:!0,remove:!0,merge:!0},m={add:!0,remove:!1};i.extend(f.prototype,a,{model:d,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,i.extend({merge:!1},e,m))},remove:function(t,e){var n=!i.isArray(t);t=n?[t]:i.clone(t),e||(e={});var r,s,o,a;for(r=0,s=t.length;s>r;r++)a=t[r]=this.get(t[r]),a&&(delete this._byId[a.id],delete this._byId[a.cid],o=this.indexOf(a),this.models.splice(o,1),this.length--,e.silent||(e.index=o,a.trigger("remove",a,this,e)),this._removeReference(a,e));return n?t[0]:t},set:function(t,e){e=i.defaults({},e,g),e.parse&&(t=this.parse(t,e));var n=!i.isArray(t);t=n?t?[t]:[]:i.clone(t);var r,s,o,a,l,c,u,h=e.at,p=this.model,f=this.comparator&&null==h&&e.sort!==!1,m=i.isString(this.comparator)?this.comparator:null,v=[],b=[],y={},_=e.add,w=e.merge,x=e.remove,k=!f&&_&&x?[]:!1;for(r=0,s=t.length;s>r;r++){if(l=t[r]||{},o=l instanceof d?a=l:l[p.prototype.idAttribute||"id"],c=this.get(o))x&&(y[c.cid]=!0),w&&(l=l===a?a.attributes:l,e.parse&&(l=c.parse(l,e)),c.set(l,e),f&&!u&&c.hasChanged(m)&&(u=!0)),t[r]=c;else if(_){if(a=t[r]=this._prepareModel(l,e),!a)continue;v.push(a),this._addReference(a,e)}a=c||a,!k||!a.isNew()&&y[a.id]||k.push(a),y[a.id]=!0}if(x){for(r=0,s=this.length;s>r;++r)y[(a=this.models[r]).cid]||b.push(a);b.length&&this.remove(b,e)}if(v.length||k&&k.length)if(f&&(u=!0),this.length+=v.length,null!=h)for(r=0,s=v.length;s>r;r++)this.models.splice(h+r,0,v[r]);else{k&&(this.models.length=0);var C=k||v;for(r=0,s=C.length;s>r;r++)this.models.push(C[r])}if(u&&this.sort({silent:!0}),!e.silent){for(r=0,s=v.length;s>r;r++)(a=v[r]).trigger("add",a,this,e);(u||k&&k.length)&&this.trigger("sort",this,e)}return n?t[0]:t},reset:function(t,e){e||(e={});for(var n=0,r=this.models.length;r>n;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,i.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,i.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,i.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return o.apply(this.models,arguments)},get:function(t){return null==t?void 0:this._byId[t]||this._byId[t.id]||this._byId[t.cid]},at:function(t){return this.models[t]},where:function(t,e){return i.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return i.invoke(this.models,"get",t)},fetch:function(t){t=t?i.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,n=this;return t.success=function(i){var r=t.reset?"reset":"set";n[r](i,t),e&&e(n,i,t),n.trigger("sync",n,i,t)},B(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?i.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var n=this,r=e.success;return e.success=function(t,i){e.wait&&n.add(t,e),r&&r(t,i,e)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof d)return t;e=e?i.clone(e):{},e.collection=this;var n=new this.model(t,e);return n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_addReference:function(t){this._byId[t.cid]=t,null!=t.id&&(this._byId[t.id]=t),t.collection||(t.collection=this),t.on("all",this._onModelEvent,this)},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,n),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];i.each(v,function(t){f.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.models),i[t].apply(i,e)}});var b=["groupBy","countBy","sortBy","indexBy"];i.each(b,function(t){f.prototype[t]=function(e,n){var r=i.isFunction(e)?e:function(t){return t.get(e)};return i[t](this.models,r,n)}});var y=e.View=function(t){this.cid=i.uniqueId("view"),t||(t={}),i.extend(this,i.pick(t,w)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},_=/^(\S+)\s*(.*)$/,w=["model","collection","el","id","attributes","className","tagName","events"];i.extend(y.prototype,a,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,i){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=i.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var n=t[e];if(i.isFunction(n)||(n=this[t[e]]),n){var r=e.match(_),s=r[1],o=r[2];n=i.bind(n,this),s+=".delegateEvents"+this.cid,""===o?this.$el.on(s,n):this.$el.on(s,o,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var t=i.extend({},i.result(this,"attributes"));this.id&&(t.id=i.result(this,"id")),this.className&&(t["class"]=i.result(this,"className"));var n=e.$("<"+i.result(this,"tagName")+">").attr(t);this.setElement(n,!1)}}}),e.sync=function(t,n,r){var s=k[t];i.defaults(r||(r={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var o={type:s,dataType:"json"};if(r.url||(o.url=i.result(n,"url")||O()),null!=r.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(o.contentType="application/json",o.data=JSON.stringify(r.attrs||n.toJSON(r))),r.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),r.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){o.type="POST",r.emulateJSON&&(o.data._method=s);
var a=r.beforeSend;r.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",s),a?a.apply(this,arguments):void 0}}"GET"===o.type||r.emulateJSON||(o.processData=!1),"PATCH"===o.type&&x&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=r.xhr=e.ajax(i.extend(o,r));return n.trigger("request",n,l,r),l};var x=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),k={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var C=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},A=/\((.*?)\)/g,T=/(\(\?)?:\w+/g,S=/\*\w+/g,M=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(C.prototype,a,{initialize:function(){},route:function(t,n,r){i.isRegExp(t)||(t=this._routeToRegExp(t)),i.isFunction(n)&&(r=n,n=""),r||(r=this[n]);var s=this;return e.history.route(t,function(i){var o=s._extractParameters(t,i);s.execute(r,o),s.trigger.apply(s,["route:"+n].concat(o)),s.trigger("route",n,o),e.history.trigger("route",s,n,o)}),this},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var t,e=i.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(M,"\\$&").replace(A,"(?:$1)?").replace(T,function(t,e){return e?t:"([^/?]+)"}).replace(S,"([^?]*?)"),new RegExp("^"+t+"(?:\\?(.*))?$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return i.map(n,function(t,e){return e===n.length-1?t||null:t?decodeURIComponent(t):null})}});var D=e.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},$=/^[#\/]|\s+$/g,E=/^\/+|\/+$/g,P=/msie [\w.]+/,I=/\/$/,N=/#.*$/;D.started=!1,i.extend(D.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=decodeURI(this.location.pathname+this.location.search);var i=this.root.replace(I,"");t.indexOf(i)||(t=t.slice(i.length))}else t=this.getHash();return t.replace($,"")},start:function(t){if(D.started)throw new Error("Backbone.history has already been started");D.started=!0,this.options=i.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),r=document.documentMode,s=P.exec(navigator.userAgent.toLowerCase())&&(!r||7>=r);if(this.root=("/"+this.root+"/").replace(E,"/"),s&&this._wantsHashChange){var o=e.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=o.hide().appendTo("body")[0].contentWindow,this.navigate(n)}this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&a.hash&&(this.fragment=this.getHash().replace($,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),D.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(t){return t=this.fragment=this.getFragment(t),i.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(t,e){if(!D.started)return!1;e&&e!==!0||(e={trigger:!!e});var i=this.root+(t=this.getFragment(t||""));if(t=t.replace(N,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),e.history=new D;var F=function(t,e){var n,r=this;n=t&&i.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},i.extend(n,r,e);var s=function(){this.constructor=n};return s.prototype=r.prototype,n.prototype=new s,t&&i.extend(n.prototype,t),n.__super__=r.prototype,n};d.extend=f.extend=C.extend=y.extend=D.extend=F;var O=function(){throw new Error('A "url" property or function must be specified')},B=function(t,e){var i=e.error;e.error=function(n){i&&i(t,n,e),t.trigger("error",t,n,e)}};return e}),jQuery.base64=function(){function t(t,e){var i=s.indexOf(t.charAt(e));if(-1===i)throw"Cannot decode base64";return i}function e(e){var i,n,s=0,o=e.length,a=[];if(e=String(e),0===o)return e;if(o%4!==0)throw"Cannot decode base64";for(e.charAt(o-1)===r&&(s=1,e.charAt(o-2)===r&&(s=2),o-=4),i=0;o>i;i+=4)n=t(e,i)<<18|t(e,i+1)<<12|t(e,i+2)<<6|t(e,i+3),a.push(String.fromCharCode(n>>16,n>>8&255,255&n));switch(s){case 1:n=t(e,i)<<18|t(e,i+1)<<12|t(e,i+2)<<6,a.push(String.fromCharCode(n>>16,n>>8&255));break;case 2:n=t(e,i)<<18|t(e,i+1)<<12,a.push(String.fromCharCode(n>>16))}return a.join("")}function i(t,e){var i=t.charCodeAt(e);if(i>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return i}function n(t){if(1!==arguments.length)throw"SyntaxError: exactly one argument required";t=String(t);var e,n,o=[],a=t.length-t.length%3;if(0===t.length)return t;for(e=0;a>e;e+=3)n=i(t,e)<<16|i(t,e+1)<<8|i(t,e+2),o.push(s.charAt(n>>18)),o.push(s.charAt(n>>12&63)),o.push(s.charAt(n>>6&63)),o.push(s.charAt(63&n));switch(t.length-a){case 1:n=i(t,e)<<16,o.push(s.charAt(n>>18)+s.charAt(n>>12&63)+r+r);break;case 2:n=i(t,e)<<16|i(t,e+1)<<8,o.push(s.charAt(n>>18)+s.charAt(n>>12&63)+s.charAt(n>>6&63)+r)}return o.join("")}var r="=",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o="1.0";return{decode:e,encode:n,VERSION:o}}(jQuery),define("jquery_b64",["jquery"],function(){}),define("models/m_mount",["underscore","backbone"],function(t,e){return MMount=e.Model.extend({defaults:{id:null,label:"",url:"",username:"",token:"",locality:"local",active:!1,version:"",apiminversion:""}}),MMount}),function(t,e){"object"==typeof exports&&t.require?module.exports=e(require("underscore"),require("backbone")):"function"==typeof define&&define.amd?define("sessionstorage",["underscore","backbone"],function(i,n){return e(i||t._,n||t.Backbone)}):e(_,Backbone)}(this,function(t,e){function i(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function n(){return i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i()}return e.SessionStorage=window.Store=function(t){if(!this.sessionStorage)throw"Backbone.sessionStorage: Environment does not support sessionStorage.";this.name=t;var e=this.sessionStorage().getItem(this.name);this.records=e&&e.split(",")||[]},t.extend(e.SessionStorage.prototype,{save:function(){this.sessionStorage().setItem(this.name,this.records.join(","))},create:function(t){return t.id||(t.id=n(),t.set(t.idAttribute,t.id)),this.sessionStorage().setItem(this.name+"-"+t.id,JSON.stringify(t)),this.records.push(t.id.toString()),this.save(),this.find(t)},update:function(e){return this.sessionStorage().setItem(this.name+"-"+e.id,JSON.stringify(e)),t.include(this.records,e.id.toString())||this.records.push(e.id.toString()),this.save(),this.find(e)},find:function(t){return this.jsonData(this.sessionStorage().getItem(this.name+"-"+t.id))},findAll:function(){return(t.chain||t)(this.records).map(function(t){return this.jsonData(this.sessionStorage().getItem(this.name+"-"+t))},this).compact().value()},destroy:function(e){return e.isNew()?!1:(this.sessionStorage().removeItem(this.name+"-"+e.id),this.records=t.reject(this.records,function(t){return t===e.id.toString()}),this.save(),e)},sessionStorage:function(){return sessionStorage},jsonData:function(t){return t&&JSON.parse(t)},_clear:function(){var e=this.sessionStorage(),i=new RegExp("^"+this.name+"-");e.removeItem(this.name),(t.chain||t)(e).keys().filter(function(t){return i.test(t)}).each(function(t){e.removeItem(t)}),this.records.length=0},_storageSize:function(){return this.sessionStorage().length}}),e.SessionStorage.sync=window.Store.sync=e.localSync=function(t,i,n){var r,s,o,a=i.sessionStorage||i.collection.sessionStorage;try{switch(t){case"read":r=void 0!=i.id?a.find(i):a.findAll();break;case"create":r=a.create(i);break;case"update":r=a.update(i);break;case"delete":r=a.destroy(i)}}catch(l){s=22===l.code&&0===a._storageSize()?"Private browsing is unsupported":l.message}return r?(n&&n.success&&("0.9.10"===e.VERSION?n.success(i,r,n):n.success(r)),o&&o.resolve(r)):(s=s?s:"Record Not Found",n&&n.error&&("0.9.10"===e.VERSION?n.error(i,s,n):n.error(s)),o&&o.reject(s)),n&&n.complete&&n.complete(r),o&&o.promise()},e.ajaxSync=e.sync,e.getSyncMethod=function(t){return t.sessionStorage||t.collection&&t.collection.sessionStorage?e.localSync:e.ajaxSync},e.sync=function(t,i,n){return e.getSyncMethod(i).apply(this,[t,i,n])},e.SessionStorage}),define("c_mount_local",["underscore","backbone","models/m_mount","bipclient","sessionstorage"],function(t,e,i){return MountLocalCollection=e.Collection.extend({model:i,sessionStorage:new e.SessionStorage("bipio-mounts"),initialize:function(){t.bindAll(this,"activate")},activate:function(e){var i=this.get(e);return i.set("active",!i.get("active")),t.each(this.models,function(t){t.id!==e&&t.set("active",!1),t.save()}),i}}),MountLocalCollection}),define("bipclient",["jquery","jquery_b64","backbone","c_mount_local"],function(t,e,i){function n(t){this._evListeners=[],this.type=t}n.prototype={on:function(t){this._evListeners.push(t)},unbind:function(t){var e;e=this._evListeners.indexOf(t),e>-1&&this._evListeners.splice(e,1)},trigger:function(){var t,e=this._evListeners,i=e.length;for(t=0;i>t;++t)e[t].apply(null,arguments)}};var r=i.View.extend({el:"#confirm-modal",events:{"click #btn-nav-ok":"cb"},initialize:function(e){this.cb=e.cb,_.bindAll(this,"cb","close"),e.title||(e.title="Warning"),t("h2",this.$el).html(e.title),e.body||(e.body="Any Unsaved Changes Will Be Lost"),t(".modal-body",this.$el).html(e.body),e.confirm||(e.confirm="Continue"),t("#btn-nav-ok",this.$el).html(e.confirm)},close:function(){this.$el.modal("hide")},render:function(){this.$el.modal("show"),s.centerModal(t(".modal",this.$el))}}),s={_collections:{bip:void 0,channel:void 0,domain:void 0,pod:void 0,bip_descriptions:void 0},_functionPods:["flow","math","templater","time","crypto","dataviz"],_containerActions:["syndication.subscribe","syndication.list","syndication.feed","flow.counter","flow.delta"],_parsableActions:["flow.text2json","flow.xml2json","scriptr.run_script","flow.generator"],_auth:null,_transformCache:{},_params:void 0,_token:void 0,_createToken:void 0,_mounted:!1,_plans:{},setCollection:function(t,e){this._collections[t]=e},getCollection:function(t){return this._collections[t]},find:{bip:function(t){return s.getCollection("bip").get(t)},channel:function(t){return s.getCollection("channel").get(t)},domain:function(t){return s.getCollection("domain").get(t)},share:function(t){return s.getCollection("bip_share").get(t)},pod:function(t){return s.getCollection("pod").get(t)}},isParsable:function(t){return-1!==this._parsableActions.indexOf(t)},getParamNames:function(t){var e=t.toString().replace(/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,""),i=e.slice(e.indexOf("(")+1,e.indexOf(")")).match(/([^\s,]+)/g);return null===i&&(i=[]),i},decorateChannels:function(){var t=this;this._collections.pod.length>0&&this._collections.channel.length>0&&this._collections.channel.each(function(e){e.attributes._emitter="invoke"!==t._collections.pod.getActionSchema(e.get("action")).trigger})},getChannel:function(t){var e=this._collections.channel.get(t);return e&&(e._action=this._collections.pod.getActionSchema(e.get("action")),e._action.imports.properties||(e._action.imports.properties={}),e._action.exports.properties||(e._action.exports.properties={}),e._action.config.properties||(e._action.config.properties={})),e},setCredentials:function(e,i,n){var r=this;e||i||n?(this._params.endpoint_override=n,r._mounted=!0,t.ajaxSetup({xhrFields:{withCredentials:!0},crossDomain:!0,beforeSend:function(n){return n.setRequestHeader("Authorization","Basic "+t.base64.encode(e+":"+i)),n}})):(r._mounted=!1,this._params.endpoint_override=null,t.ajaxSetup({xhrFields:{withCredentials:!0},crossDomain:!0,beforeSend:function(t){return t.setRequestHeader("Authorization","Basic "+r._auth.api_token_web),t}}))},getUserPlan:function(){return this._plans[userSettings.account_level]},selectPlanRoute:function(t,e){var i="/plans?reason="+t;e&&(i+="&msg="+e),window.location=i},bipsExceedPlan:function(){var t=this.getUserPlan();return t&&Object.keys(this._plans).length?this.getCollection("bip").length>=t.num_bips:!1},init:function(){var e=this,i=t.Deferred();this._params=BIPClientParams;var r="/auth/who";return t.ajax({url:r,success:function(n){e._auth=JSON.parse(n),e._token=e._auth.api_token,e.setCredentials(),t.ajax({url:e.getEndpoint()+"/login",success:function(){window.postMessage(JSON.stringify(["client_loaded"]),window.location.origin),i.resolve()},error:function(){i.reject()}})},error:function(){i.reject()}}),this.authStatusChangeEvent=new n("auth_status"),window.addEventListener("bip.authstatus.change",function(t){var i=t.detail;e.authStatusChange(i.provider,i.status),"accepted"===i.status?e.growl(i.provider+" pod enabled"):"denied"===i.status?e.growl(i.provider+" pod disabled"):e.growl("Access Denied","error")}),this._request(null,s.getEndpoint()+"/rpc/permissions/plans","GET",function(i){var n;e._plans=i,n=e.getUserPlan(),_.each(i,function(t,e){t.name=e}),n&&"user"===n.name&&t("#upgrade-button").show()},function(){},!0),i},authStatusChange:function(t,e,i){var n=this._collections.pod.get(t),r=this;n.attributes.auth.status=e,n.trigger("change"),i&&i(n),this._collections.pod.fetch({success:function(){r.authStatusChangeEvent.trigger({provider:t,newstatus:e})}})},logout:function(){t.ajax({url:this.getEndpoint()+"/logout"})},callHTTPBip:function(e,i,n,r){var s=e.get("_repr"),o={},a=e.get("config"),l=BIPClientParams.endpoint.replace("http://",""),c=l.split(":");s=s.replace(c[0]+"/",l+"/");for(var u in i)i.hasOwnProperty(u)&&(i[u]||delete i[u]);a.auth&&"basic"===a.auth&&(s=s.replace(/^(http(s?):\/\/)/,"$1"+a.username+":"+a.password+"@")),o.Authorization="Basic "+this._auth.api_token_web;var h=BIPClientParams.endpoint+"/rpc/pod/http/request/proxy?url="+s;t.ajax({type:r||"GET",url:h,data:JSON.stringify(i),contentType:"application/json",headers:o,success:function(){n(!1)},error:function(t){n(t.responseText)}})},callRPCAccount:function(e,i){var n=this,r={type:"GET",contentType:"application/json",dataType:"json",url:e,headers:{Authorization:"Basic "+this._auth.api_token_web},success:function(t){i&&i(t)},error:function(t,e,i){var r=i;try{r=JSON.parse(t.responseText).message}catch(s){r=r.message?r.message:i}n.growl(r,"error")}};return t.ajax(r)},openRenderer:function(e,i){var n,r=this.getCollection("channel").get(e);r&&(n=_.findWhere(r.get("_links"),{name:i})._href,window.open(n.replace(/^(http(s?):\/\/)/,"$1"+t.base64.decode(this._auth.api_token_web)+"@")))},getRendererURI:function(e,i){var n,r=this.getCollection("channel").get(e);return r&&(n=_.findWhere(r.get("_links"),{name:i})._href.replace(/^(http(s?):\/\/)/,"$1"+t.base64.decode(this._auth.api_token_web)+"@")),n},getEndpoint:function(){return this._params.endpoint_override?this._params.endpoint_override:this._params.endpoint},_request:function(e,i,n,r,s,o){var e=null==e?e:JSON.stringify(e);o=void 0==o||1==o?!0:!1;var a={type:n,contentType:"application/json",dataType:"json",url:i,success:function(t){void 0!=r&&r(t,e)},error:function(t,i,n){void 0!==s&&s(t.status,i,n,e)}};null!==e&&(a.data=e),t.ajax(a)},getResourceURL:function(t,e){var i=s.getEndpoint()+"/rest/"+t;return void 0!=e.id&&(i+="/"+e.id),i},getPodDescriptions:function(){return s.getEndpoint()+"/rpc/describe/pod"},getBipDescriptions:function(){return s.getEndpoint()+"/rpc/describe/bip"},defEnumeratorUnpack:function(t){var e,i,n,r=[],s=t.definitions;for(i in t.properties)if(n={id:i,label:t.properties[i].title||t.properties[i].description,data:[]},t.properties[i].oneOf){for(var o=0;o<t.properties[i].oneOf.length;o++)if(e=t.properties[i].oneOf[o],e.$ref&&/^#\/definitions\//.test(e.$ref)){var a=e.$ref.replace("#/definitions/","");if(d=s[a],d&&d["enum"])for(var l=0;l<d["enum"].length;l++)n.data.push({label:d.enum_label[l],value:d["enum"][l]})}r.push(n)}return r},getExports:function(t,e){var i,n;if("channel"===t||"trigger"===t){if(n=this.getCollection("channel").get(e),i=this.getCollection("pod").getActionSchema(n.get("action")).exports,"trigger"===t){var r=this.getCollection("bip_descriptions").get(t).get("exports");i.definitions||(i.definitions=r.definitions),_.each(r.definitions,function(t,e){i.definitions[e]=t}),i.properties||(i.definitions=r.properties),_.each(r.properties,function(t,e){i.properties[e]=t})}}else"http"===t?(i=this.getCollection("bip_descriptions").get(t).get("exports"),i.id=t,(((i.properties._bip||{}).properties||{})._rep||{}).title="URL"):(i=this.getCollection("bip_descriptions").get(t).get("exports"),i.id=t);return"smtp"===t&&((((i.properties._bip||{}).properties||{})._rep||{}).title="Email Address"),JSON.parse(JSON.stringify(i))},getTransformHint:function(t,e,i,n){var r=e+"_"+i,o=this;this._transformCache[r]?n(!1,this._transformCache[r],t):this._request(null,s.getEndpoint()+"/rpc/bip/get_transform_hint?from="+e+"&to="+i,"GET",function(e){o._transformCache[r]=e.transform,n(!1,o._transformCache[r],t)},function(){n(!0,{},t)})},getResourceName:function(e,i,n,r,o,a){a||(a="rest");var l,c=s.getEndpoint()+"/"+a+"/"+e,u="";if(void 0==i&&(i=1),void 0==n&&(n=10),void 0==r&&(r="recent"),l={page:i,page_size:n,order_by:r},void 0!=o){for(key in o)""!=u&&(u+=","),u+=key+":"+o[key];l.filter=u}return c+"?"+t.param(l)},getSettingsUrl:function(){return this.getResourceURL("account_option",{id:this.getSettings().id})},getSettingsId:function(){return BIPClientParams.settings.id},getSettings:function(){return userSettings},domainVerify:function(t,e){this._request(null,s.getEndpoint()+"/rpc/domain/confirm/"+t,"GET",function(t){e(!1,t)},function(t,i,n){e(!0,n)},!0)},triggerBip:function(t){this._request(null,s.getEndpoint()+"/rpc/bip/trigger/"+t,"GET",function(){s.growl("Trigger Complete"),s.getCollection("bip").fetch()},function(t,e,i){s.growl(i||"Not Runnable","error")},!0)},share:function(t,e){this._request(t,s.getEndpoint()+"/rpc/bip/share","POST",function(t){e(!1,t)},function(t,i,n){409==t?e(!0,"Share URL Is Already In Use"):e(!0,n)},!0)},getShareURL:function(t){return s.getEndpoint()+"/rpc/bip/share/list?filter=id:"+t},unShare:function(t,e){this._request(null,s.getEndpoint()+"/rpc/bip/unshare/"+t,"GET",function(t){e(!1,t)},function(t,i,n){e(!0,n)},!0)},incShare:function(t){this._request(null,s.getEndpoint()+"/rpc/bip/share/inc/"+t,"GET",function(){},function(){},!0)},getShares:function(){this._request(null,s.getEndpoint()+"/rpc/bip/share/"+model.id,"GET",function(t){cb(!1,t)},function(t,e,i){cb(!0,i)},!0)},errParse:function(e){var i={};if(e.responseText){var n=t.parseJSON(e.responseText);n.errors&&(i.status=n.status,i.msg=n.errors.name.message)}return i},growl:function(e,i){i=i||"success",t.bootstrapGrowl(("error"===i?'<i class="icon-exclamation-sign"></i> ':"")+e.replace(/\n/g,"<br/>"),{ele:"body",offset:{right:Math.floor(t(window).width()-t(".user button").offset().left-t(".user button").outerWidth()),top:62},type:i||"success",delay:3e3,width:385,allow_dismiss:!1,align:"right"})},flattenObject:function(t,e,i,n,r){n=n||{},r=r||"",delmiter=e||"/";for(var s in t)if(i||t.hasOwnProperty(s)){var o=t[s];o&&this.isObject(o)?this.flattenObject(o,e,i,n,r+s+e):n[r+s]=o}return n},deepClone:function(t){var e=_.clone(t);return _.each(e,function(t,i){_.isObject(t)&&(e[i]=s.deepClone(t))}),e},htmlEncode:function(e){return t("<div/>").text(e).html()},htmlDecode:function(e){return t("<div/>").html(e).text()},rotateLeft:function(t,e){return[].concat(t.splice(e,t.length)).concat(t)},distributeManifest:function(t,e){for(var i,n=Array.apply(null,new Array(e)).map(Object.prototype.valueOf,{}),r=t.normedManifest.length,s=360,o=0,a=s/n.length,l=s/r,c=0;r>c;c++)i=Math.floor(o/a),n[i]=t.normedManifest[c],o+=l,o>s&&(o=45);return 5==r&&(n=this.rotateLeft(n,1)),t.normedManifest=n,t},selectContents:function(t){var e=t.currentTarget;return document.createRange?(rangeToSelect=document.createRange(),rangeToSelect.selectNode(e),curSelect=window.getSelection(),curSelect.addRange(rangeToSelect),!1):document.body&&document.body.createTextRange?(range=document.body.createTextRange(),range.moveToElementText(e),range.select(),!1):void 0},signIn:function(e,i,n){var r={type:"POST",contentType:"application/json",dataType:"json",data:JSON.stringify({username:e,password:i}),url:"/auth",success:function(){n()},error:function(){n("Please Retry")}};t.ajax(r)},confirmNavModal:function(t){var e=new r(t);e.render()},regUUID:/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/gi,isUUID:function(t){return/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/i.test(t)},_getPtr:function(t){if(this.isUUID(t))t=this.find.channel(t).get("action");else{var e=t.split(".");t=e[0]+"."+e[1]}return t.toLowerCase()},isFunctionPod:function(t){t=this._getPtr(t);var e=t.split("."),i=-1!==this._functionPods.indexOf(e[0]);return"flow"===e[0]&&"generator"===e[1]?!1:i},isContainerAction:function(t){return t=this._getPtr(t),-1!==this._containerActions.indexOf(t)},realClone:function(t){return JSON.parse(JSON.stringify(t))},centerModal:function(t){t.removeAttr("height");var e=t.height();t.addClass("center-absolute").height(e)},_setEmptyFlag:function(t){var e=!t.val().replace(/\s*/,""),i=t.parent();e?i.attr("empty",!0):(i.removeAttr("empty"),t.removeClass("invalid"))},bindEmptyInputStyles:function(e){var i=this;t("[required] input",e).parent().removeAttr("empty"),t('[required] input:text[value=""]',e).parent().attr("empty",!0),t("[required] input",e).bind("propertychange keyup input paste",function(){i._setEmptyFlag(t(this))})},schema2JSON:function(t){var e;if("object"===t.type){e={};for(var i in t.properties)0!==i.indexOf("_")&&(e[i]=arguments.callee.call(this,t.properties[i]));return e}return"array"===t.type?(e=[],e.push(arguments.callee.call(this,t.items)),e):"number"===t.type?0:"boolean"===t.type?!0:"string"===t.type?"":{}},ucFirst:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},getReqParam:function(t){var e,i,n=decodeURIComponent(window.location.search.substring(1)),r=n.split("&");for(i=0;i<r.length;i++)if(e=r[i].split("="),e[0]===t)return void 0===e[1]?!0:e[1]},isTruthy:function(t){var e=Number(t);return isNaN(e)?"true"===t||!0===t:!!e},isFalsy:function(t){var e=Number(t);return isNaN(e)?"false"===t||!1===t:!e},isBool:function(t){return _.isBoolean(t)||this.isTruthy(t)||this.isFalsy(t)},getSiteURL:function(){return BIPClientParams.proto+"://"+BIPClientParams.hostname}};return t("#logout-btn").on("click",function(t){s.logout(t)}),s}),define("models/m_bip",["underscore","backbone","bipclient"],function(t,e,i){return t.extend(e.Model.prototype,e.Validator),MBip=e.Model.extend({get:function(t){if("function"==typeof this[t])return this[t]();if("_repr"===t){if(""===this.attributes._repr)return this.getTypeRepr(this.attributes.type)}else if("action"===t)return"bip."+this.attributes.type;return e.Model.prototype.get.call(this,t)},getTypeRepr:function(t){var e="";switch(t||this.get("type")){case"http":if(this.get("config")&&this.get("config").channel_id){var n=i.getCollection("channel").get(this.get("config").channel_id).getPod().get("name");e="Incoming "+n+" Web Hook"}else e="Incoming Web Hook";break;case"smtp":e="Incoming Email";break;case"trigger":e="Event Source"}return e},getIcon:function(){var t=this.get("icon"),e=this.get("type");return!t&&this.get("config")&&this.get("config").channel_id&&(t=i.getCollection("channel").get(this.get("config").channel_id).getIcon()),t?t:"/static/img/channels/32/color/bip_"+e+".png"},getManifest:function(e,n){var r,s,o,a,l,c=this.toJSON(),u=i.getCollection("pod"),h=i.getCollection("channel");c.type_description=this.get("_repr"),c.type_icon=this.getIcon(),c.normedManifest=[];for(var d in c.hub)c.hub.hasOwnProperty(d)&&t.each(c.hub[d].edges,function(t){r=h.get(t),r?(tokens=r.get("action").split("."),action=r.getAction(),o=r.getIcon(),a=r.getPod().get("title"),l=r.get("name")):(tokens=t.split("."),s=u.get(tokens[0]),action=s.getAction(tokens[1]),o=s.getIcon(),a=s.get("title"),l=action.title),c.normedManifest.push({pod:tokens[0],action:tokens[1],icon:o,title:a,description:l})});return n?i.distributeManifest(c,n):c},getExportsSchema:function(){var t=this.get("exports");return t&&Object.keys(t).length?t:i.getCollection("bip_descriptions").get("http").get("exports")},getAuthHeader:function(){var t="",e=this.get("config");return"token"===e.auth?t="Authorization: Basic "+i._auth.api_token_web:"basic"===e.auth&&(t="Authorization: Basic "+$.base64.encode(e.username+":"+e.password)),t},getCurlStr:function(t){var e,n=this.getAuthHeader();return t=(t||JSON.stringify(i.schema2JSON(this.getExportsSchema()))).replace(/"/g,'\\"'),e='curl -X POST -d "'+t+'" -H "Content-Type:application/json"'+(n?' -H "'+n+'"':"")+" "+this.get("_repr")},removeEdge:function(e){var i=this.get("hub"),n=t.pluck(i,"edges"),r=t.pluck(i,"transforms");delete i[e],t.each(r,function(t){t&&delete t[e]}),t.each(n,function(t){var i=t.indexOf(e);-1!==i&&t.splice(i,1)})},getChannelIds:function(){var e=[],i=this.toJSON();"trigger"===i.type&&i.config.channel_id&&""!==i.config.channel_id&&e.push(i.config.channel_id);for(var n in i.hub)i.hub.hasOwnProperty(n)&&i.hub[n].edges&&(e=e.concat(i.hub[n].edges));return"http"===i.type&&$.isPlainObject(i.config.renderer)&&i.config.renderer.channel_id&&i.config.renderer.renderer&&e.push(i.config.renderer.channel_id),t.uniq(e)},defaults:function(){var t;return userSettings?(userSettings.bip_config&&"[object Array]"!==Object.prototype.toString.call(userSettings.bip_config)?userSettings.bip_hub&&(t={}):t={},{id:null,name:"",domain_id:userSettings.bip_domain_id,type:userSettings.bip_type,config:t,hub:userSettings.bip_hub,icon:null,note:"",end_life:userSettings.bip_end_life,paused:0,schedule:{},_repr:""}):{}},validation:{"hub.source.edges":{fn:function(t,e,n){var r=this,s={},o=[],a=t&&t.length>0;if(haveRenderer=n.config.renderer&&n.config.renderer.renderer,haveRenderer&&!a||a){if(t)for(var l=0,c=t.length;c>l;l++){if(i.isContainerAction(t[l])&&!i.isUUID(t[l]))return r.trigger("channel:invalid",t[l],"Needs Configuration"),i.find.channel(t[l]).get("name")+" Needs Configuration";var u=i.getCollection("channel").get(t[l]),h=u.getAction(),d=h.imports&&h.imports.required;if(d)for(var p=0,f=d.length;f>p;p++)n.hub.source.transforms&&n.hub.source.transforms[t[l]]||o.push(d[p]);if(o.length>0){var g=u.attributes.name;s[g]=o,r.trigger("channel:invalid",t[l],"Missing Fields : "+o.join(",<br/>"))}this.mapEdges(s,t[l],n.hub)}if(Object.keys(s).length>0){var m="Missing Required Fields";return m}return""}return"This Bip needs some actions before it can be saved"}},note:[{required:!1},{maxLength:1024,msg:"note cannot exceed 1024 characters"}],"config.channel_id":{fn:function(t,e,n){var r,s,o,a="",l=this;if(t&&(r=t,s=i.find.channel(r),o=s.getAction(),!i.isUUID(t)&&o.config.required))if(n.config.config&&!i.isContainerAction(t)){for(var c=0;c<o.config.required.length;c++)if(!n.config.config[o.config.required[c]]){a="Missing Required Fields";break}}else a="Missing Required Fields";return a&&l.trigger("channel:invalid","source",a),a}},"end_life.imp":{fn:function(t){var e;return""===t||0===t||!isNaN(Number(t))&&parseInt(t)%1===0||(e="Expiry Impressions must be a whole number greater than 0"),e}},"end_life.time":{fn:function(){var t;return t}}},url:function(){var t=this;return i.getResourceURL("bip",t)},mapEdges:function(t,e,n){if(n[e])for(var r=n[e].edges,s=0,o=r.length;o>s;s++){var a=i.getCollection("channel").get(r[s]),l=a.getAction(),c=l.imports&&l.imports.required;if(c)for(var u=0,h=c.length;h>u;u++){var d=[];if(n[e].transforms&&n[e].transforms[r[s]]&&""!=n[e].transforms[r[s]][c[u]]&&null!=n[e].transforms[r[s]][c[u]]||(d.push(c[u]),this.trigger("channel:invalid",r[s],c[u]+" is required")),d.length>0){var p=a.attributes.name;t[p]=d}}n[r[s]]&&this.mapEdges(t,r[s],n)}},hubReplace:function(e,n){var r={},s=i.deepClone(this.get("hub"));if("trigger"===this.get("type")){var o=this.get("config");o.channel_id&&e===o.channel_id&&(o.channel_id=n)}t.each(s,function(s,o){if(s.edges){var a=s.edges.indexOf(e);-1!==a&&s.edges.splice(a,1,n),s.edges=t.uniq(s.edges)}s.transforms&&t.each(s.transforms,function(r,o){var a,l,c=i.deepClone(r);e===o?(l=s.transforms[n]=c,delete s.transforms[o]):l=s.transforms[o]=c,t.each(l,function(t,i){a=new RegExp("\\[%s*?"+e,"g"),l[i]=t.replace(a,"[%"+n)})}),e===o?r[n]=s:r[o]=s}),this.set("hub",r)},_cidIsTrigger:function(t){var e=this.get("config");return e&&e.channel_id&&e.channel_id===t},_setHubAttributeForCid:function(e,i,n){var r=this,s=this.get("hub"),e=r._cidIsTrigger(e)?"source":e;s[e]||(s[e]={edges:[],transforms:{}}),t.each(s,function(t,r){e===r&&(t[i]=n)})},_getAttributeForCid:function(e,i){var n,e=this._cidIsTrigger(e)?"source":e;return self=this,t.each(this.get("hub"),function(t,r){e===r&&(n=t[i]||n)}),n},getExportsForCid:function(t){return this._getAttributeForCid(t,"exports")},setExportsForCid:function(t,e){this._setHubAttributeForCid(t,"exports",e)},setTitleForCid:function(t,e){this._setHubAttributeForCid(t,"title",e)},getTitleForCid:function(t){return this._getAttributeForCid(t,"title")||i.getCollection("channel").get(t).get("name")}}),MBip}),define("c_bip",["underscore","backbone","models/m_bip","bipclient"],function(t,e,i,n){var r=e.Collection.extend({model:i,page:1,page_size:10,total:0,num_pages:1,sortBy:"recent",searchBy:"",initialize:function(e){t.bindAll(this,"parse","url","nextPage","prevPage","pageInfo","sort","search","factory","factoryDefault"),e||n.setCollection("bip",this)},url:function(){var t;return $.isPlainObject(this.searchBy)?t=this.searchBy:""!==this.searchBy&&(t={name:this.searchBy}),n.getResourceName("bip",1,0,this.sortBy)},factory:function(t){return new this.model(t)},factoryDefault:function(e){return e||(e={}),e.domain_id=userSettings.bip_domain_id,e.end_life=t.clone(userSettings.bip_end_life),e.end_life.action=userSettings.bip_expire_behaviour,e.hub={source:{edges:[]}},e.config||(e.config={}),"http"===e.type&&(e.config.auth="token"),this.factory(e)},factoryClone:function(t){var e=n.getCollection("bip").get(t),i=e?JSON.parse(JSON.stringify(e.toJSON())):{};return this.factory(i)},parse:function(e){this.page=e.page,this.page_size=this.page_size,this.total=e.total,this.num_pages=e.num_pages;for(var i=0;i<e.data.length;i++)e.data[i].note=t.unescape(e.data[i].note);return e.data},nextPage:function(){var t=this.page+1;this.page=t>this.num_pages?this.page:t
},prevPage:function(){var t=this.page-1;this.page=1>=t?1:t},pageInfo:function(){return{page_current:this.page,page_total:this.num_pages,page_size:this.page_size,page_displayed_total:this.page*this.page_size-this.total,result_total:this.total}},sort:function(t,e){return this.sortBy=t,this.fetch({success:e})},search:function(t){(!this.searchBy||""===this.searchBy&&t&&1!=this.page)&&(this.page=1),this.searchBy=t},getFilteredModels:function(){var e,i=this,r=i.searchBy?t.pluck(n.getCollection("channel").getFilteredModels(i.searchBy),"id"):[];return e=this.models.filter(function(e){var n,s,o=!1;if(i._filter){if(o=i._filter.match.test(e.get(i._filter.attr)),!o)return!1}else e.get("app_id");return""!==i.searchBy?(n=e.get("_repr")+e.get("note")+e.get("name"),o=new RegExp(i.searchBy,"gi").test(n),o||(s=e.getChannelIds(),t.intersection(s,r).length&&(o=!0))):o=!0,o}),this.total=e.length,this.num_pages=Math.ceil(this.total/this.page_size),e}});return r}),define("apps/outbox/views/v_outbox",["underscore","backbone","bipclient","c_bip"],function(t,e,i){var n=e.View.extend({el:"#outbox-container",tplControls:t.template($("#tpl-outbox-controls").html()),modalView:null,editor:null,lsPrefix:"BIP_OUTBOX_",testMode:!1,model:null,initialize:function(e,n){var r=this;this.model=null,t.bindAll(this,"render","_renderEndpoints","_buttonHandler","_obGet","_obSet"),this.collection=i.getCollection("bip");var s;if("test"===e&&n){s=n;var o=i.find.bip(n);o&&(i.growl("Testing "+o.get("name")),this.model=o),this.testMode=!0}this.collection.bind("reset",function(){r._renderEndpoints(r.collection.where({type:"http"}))}),this._renderEndpoints(this.collection.where({type:"http"}),s)},events:{"click button":"_buttonHandler"},_obSet:function(t,e){e=e?e.replace(/<(\/?)script>/g,""):"",localStorage.setItem(this.lsPrefix+t,e)},_obGet:function(t){return localStorage.getItem(this.lsPrefix+t)},render:function(){var t=this,e=this.testMode?"t":this._obGet("MODE"),n=this._obGet("BODY"),r=$("#outbox-body");this.testMode&&(r.height(Math.floor($("body").height()/2)),n=JSON.stringify(i.schema2JSON(this.model.getExportsSchema()),!0,4),this._curlView=new CurlView(this.model),this._curlView.render()),this.testMode?($("#outbox-title").parents(".row:first").remove(),$("#outbox-json-parse").prop("checked",!0)):($("#outbox-title").val(this._obGet("TITLE")),$("#outbox-json-parse").prop("checked",t._obGet("PARSE_JSON")),e||(e="h",this._obSet("MODE",e)),$("#outbox-title").on("blur",function(){t._obSet("TITLE",$(this).val())}),$("textarea, .editable").on("blur",function(){t._obSet("BODY",$("#outbox-body").redactor("code.get")),t._obSet("MODE",$("#outbox-body").redactor("core.getObject").opts.visual?"h":"t"),t._obSet("PARSE_JSON",$("#outbox-json-parse").is(":checked"))}));var s={focus:!0,visual:"h"===e};if(this.testMode){var o;s.codeKeydownCallback=function(){clearTimeout(o),o=setTimeout(function(){var e=r.redactor("code.get");try{e=JSON.stringify(JSON.parse(e))}catch(i){e=e.replace(/\n/g,"")}t._curlView.render(e)},100)}}r.redactor(s),null!==n&&r.redactor("insert.set",n,!1)},_setCodeBody:function(){var t=$("#outbox-body"),e=JSON.stringify(i.schema2JSON(this.model.getExportsSchema()),!0,4);null!==e&&t.redactor("insert.set",e,!1)},_buttonHandler:function(t){var e=$("#outbox-bip-id",this.$el);if(t.preventDefault(),"outbox-send"==t.currentTarget.id){var n,r=this.collection.get(e.find(":selected").attr("value")),s={title:$("#outbox-title").val()},o=$("#outbox-body").text();if((o||!$("#outbox-body").redactor("core.getObject").opts.visual)&&(s.body=$("#outbox-body").redactor("code.get")),!$("#outbox-body").redactor("core.getObject").opts.visual&&$("#outbox-json-parse").is(":checked"))try{n=JSON.parse($("#outbox-body").redactor("code.get")),s=n}catch(a){return void i.growl(a,"error")}r&&(r.get("paused")?i.growl("Cannot Test A Paused Bip","warning"):(this._obSet("HOOK",r.get("id")),i.callHTTPBip(r,s,function(t){var e="Server Error";if(t){try{e=JSON.parse(t),e.message&&(e=e.message)}catch(n){}i.growl(e,"error")}else i.growl("Message Sent")},"POST")))}},_renderEndpoints:function(e,n){var r,s=this,o=n||this._obGet("HOOK");0!==e.length&&($("#outbox-controls").html(this.tplControls()),r=$("#outbox-bip-id",this.$el),r.empty(),t.each(e,function(t){r.append('<option value="'+t.get("id")+'" '+(o===t.get("id")?'selected="selected"':"")+">"+t.get("name")+"</option>")}),r.select2({containerCss:{width:"200px"}}).on("change",function(t){s._curlView&&(s._curlView.setModel(i.find.bip(t.val)),s._curlView.render(),s._setCodeBody())}))}});return n}),define("apps/outbox/index",["underscore","backbone","bipclient","apps/outbox/views/v_outbox"],function(t,e,i,n){var r=e.View.extend({el:"#outbox-container",appID:"outbox",container:null,router:null,obView:null,initialize:function(){t.bindAll(this,"render")},shutdown:function(){},render:function(e,i){var r=t.template($("#tpl-layouts-"+this.appID).html());this.container.html(r()),this.obView=new n(e,i),this.obView.render()},appInfo:function(t,e){var i=this,n={name:this.appID,title:"Outbox",ready:function(e){t.route(i.appID,i.appID,function(){i.render.apply(i,arguments)}),t.route(i.appID+"/test/:id",i.appID,function(t){i.render("test",t)}),e()}};return this.container=e,this.router=t,n}});return r}),define("apps/pods/views/v_channel_config",["underscore","backbone","bipclient"],function(t,e,i){var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},s=e.View.extend({tplActionEntity:t.template($("#tpl-action-entity").html()),initialize:function(){t.bindAll(this,"serialize","_htmlEnumDef","_decodeEntities","_attachChannelOptions","_isTruthy","_processQueue","_renderFromQueue","_unpackValues")},_rpcQueues:{},_unpackValues:function(e,i){var n,r=[];e=e||[];var s,o=i.key.split("/"),a=e;if(o.length>1){for(var l=0;l<o.length;l++)l===o.length-1?s=o[l]:a="*"===o[l]?t.values(a):a[o[l]];e=a}else s=i.key;if(i.value){var c={};if(c[s]=i.value,0===t.where(e,c).length){var u={};if($.isArray(i.value)){n=i.value;for(var l=0;l<i.value.length;l++)t.filter(e,function(t){return t[s]===i.value[l]}).length||(u[s]=i.value[l],r.push(u))}else u[s]=i.value,r.push(u)}}return[s,e.concat(r),n]},_renderFromQueue:function(e,n){var s=this,o=$("#channel_"+n.podName+"-"+n.actionName+"-"+n.configItem);o.empty();var a,l,c=this._unpackValues(e,n),u=c[0],h=c[1],d=c[2],p=[],f={dropdownAutoWidth:!0,data:[],sortResults:function(t){return t.sort().reverse()}},g=i.find.pod(n.podName).getAction(n.actionName).imports.required,m=g&&-1!==g.indexOf(n.configItem);m||(f.allowClear=!0,f.placeholder="None Selected"),o.attr("multiple")&&(f.multiple=!0);for(var v,b=0;b<h.length;b++)r=h[b],l=u?r[u]:r,p.push(l),d?(a=-1!==d.indexOf(l),a&&(v||(v=[]),v.push(l))):(a=n.value==l,a&&(v=l)),f.data.push({id:l,text:r[n.label?n.label:u]||l});if(o.select2(f).select2("val",v),!o.siblings(".btn-refresh").length){var y=$('<button data-loading-text="Loading..." class="btn-refresh btn btn-mini"><i class="icon-refresh"></i> Refresh</button>');o.parent().prepend("&nbsp;&nbsp;").prepend(y),function(e,i){y.on("click",function(){var n=$(this),r=e.select2("val");return n.button("loading"),s._processQueue(i,function(i,o){n.button("reset");var a,l=s._unpackValues(i,o),c=l[0],i=l[1],u=(l[2],e.data("select2").opts.data);u.length=0,t.each(i,function(t){a=c?t[c]:t,u.push({id:a,text:t[o.label?o.label:c]||a})}),e.select2("val",r)},!0),!1})}(o,n)}this.trigger("attribute:rendered",n.configItem,p)},_processQueue:function(t,e,n){var r=this;if(!this._rpcQueues[t.href]||n){var s={results:null,req:i.callRPCAccount(t.href,function(t){s.results=t})};r._rpcQueues[t.href]=s}!function(t){r._rpcQueues[t.href].results&&!n?e(r._rpcQueues[t.href].results,t):r._rpcQueues[t.href].req.then(function(i){e(i,t)})}(t)},_htmlEnumDef:function(t,e,n,r,s,o,a){var l,c,u,h,d,p,f,g,m,v=this,b="",y=r.config,_={href:"",key:"",label:"",value:r.config[t],podName:a,actionName:o,configItem:t},w=!1;e.oneOf?m=e.oneOf:e.anyOf&&(w=!0,m=e.anyOf);for(var x=0;x<m.length;x++)if(l=m[x],l.$ref){f=0===l.$ref.indexOf("#")?n:i.getCollection("pod").get(a).toJSON(),g=l.$ref.replace(/^#\//,"").split("#"),c=g[0].split("/"),c[0]||c.shift();for(var k=0;k<c.length;k++)if(u=u?u[c[k]]:f[c[k]],u&&u._href&&(_.href=u._href),k===c.length-1)if(/^{.*}$/.test(c[k]))_.key=c[k].replace(/[{}]/g,""),h="config#"+(s?s+"/"+t:t),b+="<div "+(w?"multiple":"")+' name="'+h+'" id="channel_'+a+"-"+o+"-"+t+'"></div>';else if(u&&u["enum"]){h="config#"+(s?s+"/"+t:t),b+='<div id="config-group-'+t+'" class="btn-group" data-toggle="buttons-radio">',b+='<input type="hidden" name="'+h+'" id="'+h+'" value="'+(_.value||u["default"]||"")+'" />';for(var k=0;k<u["enum"].length;k++)p=y[t]?y[t]:u["default"],d=u.enum_label&&u.enum_label[k]?u.enum_label[k]:u["enum"][k],b+='<button type="button" name="'+h+'"class="btn btn-mini btn-primary '+(p&&p==u["enum"][k]?'active"':"")+'" data-selection="'+u["enum"][k]+'">'+(d||"")+"</button>";b+="</div>"}else h="config#"+(s?s+"/"+t:t),b+="<div "+(w?"multiple":"")+' name="'+h+'" id="channel_'+a+"-"+o+"-"+t+'"></div>';2===g.length&&(_.key=g[g.length-1].replace(/[{}]/g,""),h="config#"+(s?s+"/"+t:t),b+='<div  name="'+h+'" id="channel_'+a+"-"+o+"-"+t+'"></div>')}return e.label&&e.label.$ref&&(_.label=e.label.$ref.split("/").pop().replace(/[{}]/g,"")),i.find.pod(a).isAuthed()&&_.href&&setTimeout(function(){v._processQueue(_,v._renderFromQueue)},100),b},_encodeEntities:function(t){return String(t).replace(/[&<>"'\/]/g,function(t){return n[t]})},_decodeEntities:function(){function t(t){return t&&"string"==typeof t&&(t=t.replace(/<script[^>]*>([\S\s]*?)<\/script>/gim,""),t=t.replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gim,""),e.innerHTML=t,t=e.textContent,e.textContent=""),t}var e=document.createElement("div");return t}(),_isTruthy:function(t){var e=Number(t);return isNaN(e)?"true"===t||!0===t:!!e},_attachChannelOptions:function(t,e,i,n,r){var s,e=e.toJSON?e.toJSON():e,o=t.config&&t.config.properties?t.config.properties:{},a="";for(key in o)if(!r||r&&-1!==r.indexOf(key))if(s=t.config.properties[key],s._html="",a=void 0!==s["default"]?s["default"]:"","string"===s.type)s._html=s.oneOf?this._htmlEnumDef(key,s,t,e,null,i,n):'<input class="channel-config-item input full-width" id="channel_'+key+'" value="'+(e.config[key]||a)+'" type="text" name="config#'+key+'" placeholder="'+(s["default"]||"")+'"/>';else if("integer"===s.type||"number"===s.type)s._html=s.oneOf?this._htmlEnumDef(key,s,t,e,null,i,n):'<input class="channel-config-item input input-small" id="channel_'+key+'" value="'+(e.config[key]||a)+'" type="text" name="config#'+key+'" placeholder="'+(s["default"]||"")+'"/>';else if("object"==s.type){s._html="";for(objKey in s.properties)s._html+='<span class="label">'+objKey+"</span>",s._html+=this._htmlEnumDef(objKey,s,t,e,key,i,n)}else if("text"==s.type||"mixed"==s.type)s._html='<textarea name="config#'+key+'" placeholder="'+(s["default"]||"")+'">'+(e.config[key]||"")+"</textarea>";else if("boolean"==s.type){var l="config#"+key,c=e.config,u=this._isTruthy(void 0!==c[key]&&""!==c[key]?c[key]:s["default"]);s._html+='<div id="config-group-'+l+'" class="btn-group" data-toggle="buttons-radio">',s._html+='<input type="hidden" name="'+l+'" value="'+(u||"")+'" />',s._html+='<button type="button" value="1" name="config#'+key+'"class="btn btn-mini btn-primary '+(u?"active":"")+'" data-selection="1">ON</button>',s._html+='<button type="button" value="0" name="config#'+key+'"class="btn btn-mini btn-primary '+(u?"":"active")+'" data-selection="0">OFF</button>',s._html+="</div>"}else"array"===s.type&&(s._html=this._htmlEnumDef(key,s,t,e,null,i,n));return t},_updateChannelOptions:function(e){var i=this._attachChannelOptions(e.getAction(),e,e.getAction().name,e.getPodName()),n=e.get("config");i&&i.config&&i.config.properties&&t.each(i.config.properties,function(t,e){var i=t._html,r=$(i).attr("id");-1!==i.indexOf("<div")?$(r).select2(e,n[e]):-1!==i.indexOf("btn-group")?$("#"+r+" button[data-selection="+n[e]+"]").click():(elName=$(i).attr("name"),$("[name="+elName+"]").replaceWith(i))})},render:function(t,e,i,n,r,s){return this.tplActionEntity({name:t.get("name")+"."+e,podName:t.get("name"),actionName:e,id:t.get("name")+"-"+e,schema:this._attachChannelOptions(i,n,e,t.get("name"),s),active_class:r})},serialize:function(e){e||(e="#share-form");var i,n,r,s,o,a,l={},c=$(e).serializeArray();t.each($(e+" div.select2-offscreen"),function(t){c.push({name:$(t).attr("name"),value:$(t).val()})});for(var u=0;u<c.length;u++)if(r=c[u].value,o=c[u].name.split("#"),a=$("#group-"+o[1]+" .transform-override"),a.length||!a.hasClass("active"))if(o.length>1){s=o[0],l[s]||(l[s]={}),n=l[s],i=o[1].split("/");for(var h=0;h<i.length;h++)s=i[h],h===i.length-1?n[s]=r:(n[s]||(n[s]={}),n=n[s])}else s=c[u].name,l[s]=r;return l}});return s}),define("apps/bipio/views/v_bip_share",["underscore","backbone","bipclient","apps/pods/views/v_channel_config"],function(t,e,i,n){return BipShareView=e.View.extend({el:"#bip-share",tplBipShare:t.template($("#tpl-bipio-share").html()),tplBipShareCfg:t.template($("#tpl-bipio-share-cfg").html()),tplShareConfigEntity:t.template($("#tpl-bipio-share-cfg-entity").html()),model:null,configView:null,events:{},initialize:function(){t.bindAll(this,"share"),this.collection=i.getCollection("bip")},_isProtected:function(t,e){var n=i.find.channel(t);return n.getAction().config&&n.getAction().config.properties&&n.getAction().config.properties[e]&&n.getAction().config.properties[e].oneOf&&n.getAction().config.properties[e].oneOf[0].$ref&&0===n.getAction().config.properties[e].oneOf[0].$ref.indexOf("/rpcs")?!0:!1},_scrub:function(e){var i=this,n=e.hub;return t.each(n,function(e){e.transforms&&t.each(e.transforms,function(e,n){t.each(e,function(t,r){i._isProtected(n,r)&&delete e[r]})})}),"trigger"===e.type&&e.config.config&&t.each(e.config.config,function(t,n){i._isProtected(e.config.channel_id,n)&&delete e.config.config[n]}),e},share:function(e){var r,s,o,a,l,c,u,h={title:e.getTypeRepr(),icon:e.getIcon(),exports:e.get("exports"),name:e.get("name"),note:e.get("note"),schedule:e.get("schedule"),username:userSettings.username,slug:e.get("name").toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-")},d=this;if(l=this.tplBipShare(h),this.$el.html(l),c=$("#share-modal",this.$el),u=$("h2",c),"trigger"===e.get("type")){r=i.getCollection("channel").get(e.get("config").channel_id),s=r.getPod(),o=r.getAction(),a=o.config.properties;var p={},f={};if(t.each(r.get("config"),function(t,e){a[e]&&"string"===a[e].type&&t&&!a[e].oneOf&&(p[e]=t,f[e]=a[e])}),Object.keys(p).length){this.channelConfigView=new n,this.channelConfigView.tplActionEntity=this.tplShareConfigEntity;var g=$(this.tplBipShareCfg({icon:r.getIcon(),description:s.get("title")+" - "+o.title}));$("#share-trigger-config",this.$el).html(g);var m={name:o.name,title:o.title,trigger:o.trigger,config:{properties:f,definitions:o.definitions}},v=this.channelConfigView.render(s,o.name,m,i.getCollection("channel").newModel({action:r.get("action"),config:p}),"active",Object.keys(p));$(".action-list",this.$el).html(v)}}$("#confirm-share",c).click(function(){d.end()}),c.on("shown",function(){i.centerModal($(".modal",c))}),c.modal("show").on("hidden",function(){c.remove(),$("#confirm-share",c).unbind("click")});var b=$("#share_slug");b.on("keyup",function(){d._updateRepr($(this).val())}),d._updateRepr(b.val()),$("#share_slug_preview").prepend(this._getURLBase()),$("#share_slug_repr").on("click",i.selectContents),this.model=e},_getURLBase:function(){return i.getSiteURL()+"/share/"+userSettings.username},_updateRepr:function(t){var e=$("#share_slug_repr");t=t.trim(),t?(e.addClass("alert-neutral"),e.removeClass("alert-danger"),$("#confirm-share").prop("disabled",!1)):(e.addClass("alert-danger"),e.removeClass("alert-neutral"),$("#confirm-share").prop("disabled",!0)),e.html(this._getURLBase()+"/"+$("#share_slug").val())},end:function(){var e=this._scrub(i.deepClone(this.model.toJSON()));if(e.note=$("#share_note").val(),e.slug=$("#share_slug").val().length&&$("#share_slug").val().match(/^[a-zA-Z0-9_\-]*$/)?$("#share_slug").val():e.name.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-"),"trigger"===e.type&&(i.isUUID(e.config.channel_id)&&(e.config.config=i.getCollection("channel").get(e.config.channel_id).toJSON().config),this.channelConfigView)){var n=this.channelConfigView.serialize().config;t.each(n,function(t,i){e.config.config[i]=t})}i.share(e,function(t,e){t?i.growl(e,"error"):i.growl("Thanks For Sharing!"),i.getCollection("bip_shares").fetch()}),$("#share-modal",this.$el).modal("hide")}}),BipShareView}),define("apps/bipio/views/v_bip_list",["underscore","backbone","bipclient","apps/bipio/views/v_bip_share"],function(t,e,i,n){var r=e.View.extend({el:"#bip-list-widget",tplWidget:t.template($("#tpl-bipio-list").html()),tplListEntity:t.template($("#tpl-bipio-list-entity").html()),tplListEntityCompact:t.template($("#tpl-bipio-list-entity-compact").html()),tplBipPreview:t.template($("#tpl-bipio-bip-preview").html()),tplPaginate:t.template($("#tpl-pagination").html()),_router:null,_activeModal:null,events:{"click .pause-action":"pauseAction","click .share-action":"shareAction","click .dup-action":"dupAction","click .test-action":"testAction","click .edit-action":"editAction","click .delete-action":"deleteAction","click .trigger-action":"triggerAction","click .error-action":"logsAction"},initialize:function(e,n){t.bindAll(this,"renderRows","next","previous","search"),this.collection=i.getCollection("bip"),this.collection.bind("reset",this.renderRows),this.el=$(this.el,e),this._router=n,this.container=e,this.deleteModal=$("#bipio-delete-modal")},render:function(t,e){var n=this.tplWidget(),r=this;this.el.html(n),r.renderRows(null,null,t,e),$("#bip-search-form").val(i.getCollection("bip").searchBy),$("#bip-search-form").on("keyup",r.search)},renderRows:function(t,e,n,r){var s,o,a,l,c=this,u=$(this.el),h=(i.getCollection("channel"),r||this.collection.getFilteredModels()),d=0;s=$("#list-bip-container",u);var p=$("#list-control"),f=$("#list-helper");this.collection.length?(p.show(),f.hide()):(p.hide(),f.show()),o=$("#bip-list",s),o.empty(),n||(d=(this.collection.page-1)*this.collection.page_size,l=d+this.collection.page_size),h.slice(d,l).forEach(function(t){var e,r=i.deepClone(t.toJSON());if(r.baseRoute=c.baseRoute,r.end_life&&r.end_life.time){var s=1e3*r.end_life.time;isNaN(s)||(r.end_life.time=s)}e=$(n?c.tplListEntityCompact(r):c.tplListEntity(r)),$(".bip-preview",e).html(c.tplBipPreview(t.getManifest(!0,8))),o.append(e)}),$(".bip-list-item").removeClass("defocused"),n||(a=$(".bip-list-pagination",this.container),a.html(c.tplPaginate(c.collection.pageInfo())),$("a.prev",a).on("click",this.previous),$("a.next",a).on("click",this.next)),$(".tooltipped").tooltip()},pauseAction:function(t){var e=$(t.currentTarget),n=e.attr("data-action"),r=this,s=e.closest(".bip-select").attr("data-model-id"),o=this.collection.get(s);e.button("loading"),o.save({paused:"play"==n?!1:!0},{patch:!0,success:function(){e.button("reset"),i.growl("<strong>"+o.get("name")+"</strong> is "+("play"===n?"Active":"Paused")),r.renderRows()}})},shareAction:function(t){var e=$(t.currentTarget).closest(".bip-select").attr("data-model-id"),i=this.collection.get(e),r=new n;r.share(i)},dupAction:function(t){var e=$(t.currentTarget).closest(".bip-select").attr("data-model-id");this._router.navigate("/bipio/"+e+"/dup",{trigger:!0})},editAction:function(t){var e=$(t.currentTarget).closest(".bip-select").attr("data-model-id");this._router.navigate("/bipio/"+e,{trigger:!0})},logsAction:function(t){var e=$(t.currentTarget).closest(".bip-select").attr("data-model-id");this._router.navigate("/bipio/"+e+"/logs",{trigger:!0})},testAction:function(t){var e=$(t.currentTarget).closest(".bip-select").attr("data-model-id");this._router.navigate("#outbox/test/"+e,{trigger:!0})},triggerAction:function(t){var e=$(t.currentTarget).closest(".bip-select").attr("data-model-id");i.triggerBip(e)},deleteAction:function(t){var e=$(t.currentTarget).closest(".bip-select").attr("data-model-id");$(".btn-success",this.deleteModal).attr("data-bip-id",e),this.deleteModal.modal(),i.centerModal($(".modal",this.deleteModal))},previous:function(t){return t.preventDefault(),$(t.currentTarget).hasClass("disabled")?void 0:(this.collection.prevPage(),this.renderRows(),!1)},next:function(t){return t.preventDefault(),$(t.currentTarget).hasClass("disabled")?void 0:(this.collection.nextPage(),this.renderRows(),!1)},search:function(t){var e=$(t.currentTarget).val();this.collection.search(e),this.renderRows()}});return r}),!function(){function t(t,e){return e>t?-1:t>e?1:t>=e?0:0/0}function e(t){return null===t?0/0:+t}function i(t){return!isNaN(t)}function n(t){return{left:function(e,i,n,r){for(arguments.length<3&&(n=0),arguments.length<4&&(r=e.length);r>n;){var s=n+r>>>1;t(e[s],i)<0?n=s+1:r=s}return n},right:function(e,i,n,r){for(arguments.length<3&&(n=0),arguments.length<4&&(r=e.length);r>n;){var s=n+r>>>1;t(e[s],i)>0?r=s:n=s+1}return n}}}function r(t){return t.length}function s(t){for(var e=1;t*e%1;)e*=10;return e}function o(t,e){for(var i in e)Object.defineProperty(t.prototype,i,{value:e[i],enumerable:!1})}function a(){this._=Object.create(null)}function l(t){return(t+="")===ua||t[0]===ha?ha+t:t}function c(t){return(t+="")[0]===ha?t.slice(1):t}function u(t){return l(t)in this._}function h(t){return(t=l(t))in this._&&delete this._[t]}function d(){var t=[];for(var e in this._)t.push(c(e));return t}function p(){var t=0;for(var e in this._)++t;return t}function f(){for(var t in this._)return!1;return!0}function g(){this._=Object.create(null)}function m(t,e,i){return function(){var n=i.apply(e,arguments);return n===e?t:n}}function v(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.slice(1);for(var i=0,n=da.length;n>i;++i){var r=da[i]+e;if(r in t)return r}}function b(){}function y(){}function _(t){function e(){for(var e,n=i,r=-1,s=n.length;++r<s;)(e=n[r].on)&&e.apply(this,arguments);return t}var i=[],n=new a;return e.on=function(e,r){var s,o=n.get(e);return arguments.length<2?o&&o.on:(o&&(o.on=null,i=i.slice(0,s=i.indexOf(o)).concat(i.slice(s+1)),n.remove(e)),r&&i.push(n.set(e,{on:r})),t)},e}function w(){Ko.event.preventDefault()}function x(){for(var t,e=Ko.event;t=e.sourceEvent;)e=t;return e}function k(t){for(var e=new y,i=0,n=arguments.length;++i<n;)e[arguments[i]]=_(e);return e.of=function(i,n){return function(r){try{var s=r.sourceEvent=Ko.event;r.target=t,Ko.event=r,e[r.type].apply(i,n)}finally{Ko.event=s}}},e}function C(t){return fa(t,ya),t}function A(t){return"function"==typeof t?t:function(){return ga(t,this)}}function T(t){return"function"==typeof t?t:function(){return ma(t,this)}}function S(t,e){function i(){this.removeAttribute(t)}function n(){this.removeAttributeNS(t.space,t.local)}function r(){this.setAttribute(t,e)}function s(){this.setAttributeNS(t.space,t.local,e)}function o(){var i=e.apply(this,arguments);null==i?this.removeAttribute(t):this.setAttribute(t,i)}function a(){var i=e.apply(this,arguments);null==i?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,i)}return t=Ko.ns.qualify(t),null==e?t.local?n:i:"function"==typeof e?t.local?a:o:t.local?s:r}function M(t){return t.trim().replace(/\s+/g," ")}function D(t){return new RegExp("(?:^|\\s+)"+Ko.requote(t)+"(?:\\s+|$)","g")}function $(t){return(t+"").trim().split(/^|\s+/)}function E(t,e){function i(){for(var i=-1;++i<r;)t[i](this,e)}function n(){for(var i=-1,n=e.apply(this,arguments);++i<r;)t[i](this,n)}t=$(t).map(P);var r=t.length;return"function"==typeof e?n:i}function P(t){var e=D(t);return function(i,n){if(r=i.classList)return n?r.add(t):r.remove(t);var r=i.getAttribute("class")||"";n?(e.lastIndex=0,e.test(r)||i.setAttribute("class",M(r+" "+t))):i.setAttribute("class",M(r.replace(e," ")))}}function I(t,e,i){function n(){this.style.removeProperty(t)}function r(){this.style.setProperty(t,e,i)}function s(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(t):this.style.setProperty(t,n,i)}return null==e?n:"function"==typeof e?s:r}function N(t,e){function i(){delete this[t]}function n(){this[t]=e}function r(){var i=e.apply(this,arguments);null==i?delete this[t]:this[t]=i}return null==e?i:"function"==typeof e?r:n}function F(t){return"function"==typeof t?t:(t=Ko.ns.qualify(t)).local?function(){return this.ownerDocument.createElementNS(t.space,t.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,t)}}function O(t){return{__data__:t}}function B(t){return function(){return ba(this,t)}}function z(e){return arguments.length||(e=t),function(t,i){return t&&i?e(t.__data__,i.__data__):!t-!i}}function R(t,e){for(var i=0,n=t.length;n>i;i++)for(var r,s=t[i],o=0,a=s.length;a>o;o++)(r=s[o])&&e(r,o,i);return t}function L(t){return fa(t,wa),t}function H(t){var e,i;return function(n,r,s){var o,a=t[s].update,l=a.length;for(s!=i&&(i=s,e=0),r>=e&&(e=r+1);!(o=a[e])&&++e<l;);return o}}function W(){var t=this.__transition__;t&&++t.active}function j(t,e,i){function n(){var e=this[o];e&&(this.removeEventListener(t,e,e.$),delete this[o])}function r(){var r=l(e,Xo(arguments));n.call(this),this.addEventListener(t,this[o]=r,r.$=i),r._=e}function s(){var e,i=new RegExp("^__on([^.]+)"+Ko.requote(t)+"$");for(var n in this)if(e=n.match(i)){var r=this[n];this.removeEventListener(e[1],r,r.$),delete this[n]}}var o="__on"+t,a=t.indexOf("."),l=q;a>0&&(t=t.slice(0,a));var c=ka.get(t);return c&&(t=c,l=V),a?e?r:n:e?b:s}function q(t,e){return function(i){var n=Ko.event;Ko.event=i,e[0]=this.__data__;try{t.apply(this,e)}finally{Ko.event=n}}}function V(t,e){var i=q(t,e);return function(t){var e=this,n=t.relatedTarget;n&&(n===e||8&n.compareDocumentPosition(e))||i.call(e,t)}}function U(){var t=".dragsuppress-"+ ++Aa,e="click"+t,i=Ko.select(ta).on("touchmove"+t,w).on("dragstart"+t,w).on("selectstart"+t,w);if(Ca){var n=Zo.style,r=n[Ca];n[Ca]="none"}return function(s){function o(){i.on(e,null)}i.on(t,null),Ca&&(n[Ca]=r),s&&(i.on(e,function(){w(),o()},!0),setTimeout(o,0))}}function Y(t,e){e.changedTouches&&(e=e.changedTouches[0]);var i=t.ownerSVGElement||t;if(i.createSVGPoint){var n=i.createSVGPoint();if(0>Ta&&(ta.scrollX||ta.scrollY)){i=Ko.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var r=i[0][0].getScreenCTM();Ta=!(r.f||r.e),i.remove()}return Ta?(n.x=e.pageX,n.y=e.pageY):(n.x=e.clientX,n.y=e.clientY),n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}function G(){return Ko.event.changedTouches[0].identifier}function K(){return Ko.event.target}function J(){return ta}function X(t){return t>0?1:0>t?-1:0}function Q(t,e,i){return(e[0]-t[0])*(i[1]-t[1])-(e[1]-t[1])*(i[0]-t[0])}function Z(t){return t>1?0:-1>t?Sa:Math.acos(t)}function te(t){return t>1?Da:-1>t?-Da:Math.asin(t)}function ee(t){return((t=Math.exp(t))-1/t)/2}function ie(t){return((t=Math.exp(t))+1/t)/2}function ne(t){return((t=Math.exp(2*t))-1)/(t+1)}function re(t){return(t=Math.sin(t/2))*t}function se(){}function oe(t,e,i){return this instanceof oe?(this.h=+t,this.s=+e,void(this.l=+i)):arguments.length<2?t instanceof oe?new oe(t.h,t.s,t.l):_e(""+t,we,oe):new oe(t,e,i)}function ae(t,e,i){function n(t){return t>360?t-=360:0>t&&(t+=360),60>t?s+(o-s)*t/60:180>t?o:240>t?s+(o-s)*(240-t)/60:s}function r(t){return Math.round(255*n(t))}var s,o;return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)?0:0>e?0:e>1?1:e,i=0>i?0:i>1?1:i,o=.5>=i?i*(1+e):i+e-i*e,s=2*i-o,new me(r(t+120),r(t),r(t-120))}function le(t,e,i){return this instanceof le?(this.h=+t,this.c=+e,void(this.l=+i)):arguments.length<2?t instanceof le?new le(t.h,t.c,t.l):t instanceof ue?de(t.l,t.a,t.b):de((t=xe((t=Ko.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new le(t,e,i)}function ce(t,e,i){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),new ue(i,Math.cos(t*=Pa)*e,Math.sin(t)*e)}function ue(t,e,i){return this instanceof ue?(this.l=+t,this.a=+e,void(this.b=+i)):arguments.length<2?t instanceof ue?new ue(t.l,t.a,t.b):t instanceof le?ce(t.h,t.c,t.l):xe((t=me(t)).r,t.g,t.b):new ue(t,e,i)}function he(t,e,i){var n=(t+16)/116,r=n+e/500,s=n-i/200;return r=pe(r)*ja,n=pe(n)*qa,s=pe(s)*Va,new me(ge(3.2404542*r-1.5371385*n-.4985314*s),ge(-.969266*r+1.8760108*n+.041556*s),ge(.0556434*r-.2040259*n+1.0572252*s))}function de(t,e,i){return t>0?new le(Math.atan2(i,e)*Ia,Math.sqrt(e*e+i*i),t):new le(0/0,0/0,t)}function pe(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function fe(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function ge(t){return Math.round(255*(.00304>=t?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function me(t,e,i){return this instanceof me?(this.r=~~t,this.g=~~e,void(this.b=~~i)):arguments.length<2?t instanceof me?new me(t.r,t.g,t.b):_e(""+t,me,ae):new me(t,e,i)}function ve(t){return new me(t>>16,t>>8&255,255&t)}function be(t){return ve(t)+""}function ye(t){return 16>t?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function _e(t,e,i){var n,r,s,o=0,a=0,l=0;if(n=/([a-z]+)\((.*)\)/i.exec(t))switch(r=n[2].split(","),n[1]){case"hsl":return i(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return e(Ce(r[0]),Ce(r[1]),Ce(r[2]))}return(s=Ga.get(t))?e(s.r,s.g,s.b):(null==t||"#"!==t.charAt(0)||isNaN(s=parseInt(t.slice(1),16))||(4===t.length?(o=(3840&s)>>4,o=o>>4|o,a=240&s,a=a>>4|a,l=15&s,l=l<<4|l):7===t.length&&(o=(16711680&s)>>16,a=(65280&s)>>8,l=255&s)),e(o,a,l))}function we(t,e,i){var n,r,s=Math.min(t/=255,e/=255,i/=255),o=Math.max(t,e,i),a=o-s,l=(o+s)/2;return a?(r=.5>l?a/(o+s):a/(2-o-s),n=t==o?(e-i)/a+(i>e?6:0):e==o?(i-t)/a+2:(t-e)/a+4,n*=60):(n=0/0,r=l>0&&1>l?0:n),new oe(n,r,l)}function xe(t,e,i){t=ke(t),e=ke(e),i=ke(i);var n=fe((.4124564*t+.3575761*e+.1804375*i)/ja),r=fe((.2126729*t+.7151522*e+.072175*i)/qa),s=fe((.0193339*t+.119192*e+.9503041*i)/Va);return ue(116*r-16,500*(n-r),200*(r-s))}function ke(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Ce(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}function Ae(t){return"function"==typeof t?t:function(){return t}}function Te(t){return t}function Se(t){return function(e,i,n){return 2===arguments.length&&"function"==typeof i&&(n=i,i=null),Me(e,i,t,n)}}function Me(t,e,i,n){function r(){var t,e=l.status;if(!e&&$e(l)||e>=200&&300>e||304===e){try{t=i.call(s,l)}catch(n){return void o.error.call(s,n)}o.load.call(s,t)}else o.error.call(s,l)}var s={},o=Ko.dispatch("beforesend","progress","load","error"),a={},l=new XMLHttpRequest,c=null;return!ta.XDomainRequest||"withCredentials"in l||!/^(http(s)?:)?\/\//.test(t)||(l=new XDomainRequest),"onload"in l?l.onload=l.onerror=r:l.onreadystatechange=function(){l.readyState>3&&r()},l.onprogress=function(t){var e=Ko.event;Ko.event=t;try{o.progress.call(s,l)}finally{Ko.event=e}},s.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?a[t]:(null==e?delete a[t]:a[t]=e+"",s)},s.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",s):e},s.responseType=function(t){return arguments.length?(c=t,s):c},s.response=function(t){return i=t,s},["get","post"].forEach(function(t){s[t]=function(){return s.send.apply(s,[t].concat(Xo(arguments)))}}),s.send=function(i,n,r){if(2===arguments.length&&"function"==typeof n&&(r=n,n=null),l.open(i,t,!0),null==e||"accept"in a||(a.accept=e+",*/*"),l.setRequestHeader)for(var u in a)l.setRequestHeader(u,a[u]);return null!=e&&l.overrideMimeType&&l.overrideMimeType(e),null!=c&&(l.responseType=c),null!=r&&s.on("error",r).on("load",function(t){r(null,t)}),o.beforesend.call(s,l),l.send(null==n?null:n),s},s.abort=function(){return l.abort(),s},Ko.rebind(s,o,"on"),null==n?s:s.get(De(n))}function De(t){return 1===t.length?function(e,i){t(null==e?i:null)}:t}function $e(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}function Ee(){var t=Pe(),e=Ie()-t;e>24?(isFinite(e)&&(clearTimeout(Qa),Qa=setTimeout(Ee,e)),Xa=0):(Xa=1,tl(Ee))}function Pe(){var t=Date.now();for(Za=Ka;Za;)t>=Za.t&&(Za.f=Za.c(t-Za.t)),Za=Za.n;
return t}function Ie(){for(var t,e=Ka,i=1/0;e;)e.f?e=t?t.n=e.n:Ka=e.n:(e.t<i&&(i=e.t),e=(t=e).n);return Ja=t,i}function Ne(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}function Fe(t,e){var i=Math.pow(10,3*ca(8-e));return{scale:e>8?function(t){return t/i}:function(t){return t*i},symbol:t}}function Oe(t){var e=t.decimal,i=t.thousands,n=t.grouping,r=t.currency,s=n&&i?function(t,e){for(var r=t.length,s=[],o=0,a=n[0],l=0;r>0&&a>0&&(l+a+1>e&&(a=Math.max(1,e-l)),s.push(t.substring(r-=a,r+a)),!((l+=a+1)>e));)a=n[o=(o+1)%n.length];return s.reverse().join(i)}:Te;return function(t){var i=il.exec(t),n=i[1]||" ",o=i[2]||">",a=i[3]||"-",l=i[4]||"",c=i[5],u=+i[6],h=i[7],d=i[8],p=i[9],f=1,g="",m="",v=!1,b=!0;switch(d&&(d=+d.substring(1)),(c||"0"===n&&"="===o)&&(c=n="0",o="="),p){case"n":h=!0,p="g";break;case"%":f=100,m="%",p="f";break;case"p":f=100,m="%",p="r";break;case"b":case"o":case"x":case"X":"#"===l&&(g="0"+p.toLowerCase());case"c":b=!1;case"d":v=!0,d=0;break;case"s":f=-1,p="r"}"$"===l&&(g=r[0],m=r[1]),"r"!=p||d||(p="g"),null!=d&&("g"==p?d=Math.max(1,Math.min(21,d)):("e"==p||"f"==p)&&(d=Math.max(0,Math.min(20,d)))),p=nl.get(p)||Be;var y=c&&h;return function(t){var i=m;if(v&&t%1)return"";var r=0>t||0===t&&0>1/t?(t=-t,"-"):"-"===a?"":a;if(0>f){var l=Ko.formatPrefix(t,d);t=l.scale(t),i=l.symbol+m}else t*=f;t=p(t,d);var _,w,x=t.lastIndexOf(".");if(0>x){var k=b?t.lastIndexOf("e"):-1;0>k?(_=t,w=""):(_=t.substring(0,k),w=t.substring(k))}else _=t.substring(0,x),w=e+t.substring(x+1);!c&&h&&(_=s(_,1/0));var C=g.length+_.length+w.length+(y?0:r.length),A=u>C?new Array(C=u-C+1).join(n):"";return y&&(_=s(A+_,A.length?u-w.length:1/0)),r+=g,t=_+w,("<"===o?r+t+A:">"===o?A+r+t:"^"===o?A.substring(0,C>>=1)+r+t+A.substring(C):r+(y?t:A+t))+i}}}function Be(t){return t+""}function ze(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Re(t,e,i){function n(e){var i=t(e),n=s(i,1);return n-e>e-i?i:n}function r(i){return e(i=t(new sl(i-1)),1),i}function s(t,i){return e(t=new sl(+t),i),t}function o(t,n,s){var o=r(t),a=[];if(s>1)for(;n>o;)i(o)%s||a.push(new Date(+o)),e(o,1);else for(;n>o;)a.push(new Date(+o)),e(o,1);return a}function a(t,e,i){try{sl=ze;var n=new ze;return n._=t,o(n,e,i)}finally{sl=Date}}t.floor=t,t.round=n,t.ceil=r,t.offset=s,t.range=o;var l=t.utc=Le(t);return l.floor=l,l.round=Le(n),l.ceil=Le(r),l.offset=Le(s),l.range=a,t}function Le(t){return function(e,i){try{sl=ze;var n=new ze;return n._=e,t(n,i)._}finally{sl=Date}}}function He(t){function e(t){function e(e){for(var i,r,s,o=[],a=-1,l=0;++a<n;)37===t.charCodeAt(a)&&(o.push(t.slice(l,a)),null!=(r=al[i=t.charAt(++a)])&&(i=t.charAt(++a)),(s=M[i])&&(i=s(e,null==r?"e"===i?" ":"0":r)),o.push(i),l=a+1);return o.push(t.slice(l,a)),o.join("")}var n=t.length;return e.parse=function(e){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},r=i(n,t,e,0);if(r!=e.length)return null;"p"in n&&(n.H=n.H%12+12*n.p);var s=null!=n.Z&&sl!==ze,o=new(s?ze:sl);return"j"in n?o.setFullYear(n.y,0,n.j):"w"in n&&("W"in n||"U"in n)?(o.setFullYear(n.y,0,1),o.setFullYear(n.y,0,"W"in n?(n.w+6)%7+7*n.W-(o.getDay()+5)%7:n.w+7*n.U-(o.getDay()+6)%7)):o.setFullYear(n.y,n.m,n.d),o.setHours(n.H+(n.Z/100|0),n.M+n.Z%100,n.S,n.L),s?o._:o},e.toString=function(){return t},e}function i(t,e,i,n){for(var r,s,o,a=0,l=e.length,c=i.length;l>a;){if(n>=c)return-1;if(r=e.charCodeAt(a++),37===r){if(o=e.charAt(a++),s=D[o in al?e.charAt(a++):o],!s||(n=s(t,i,n))<0)return-1}else if(r!=i.charCodeAt(n++))return-1}return n}function n(t,e,i){x.lastIndex=0;var n=x.exec(e.slice(i));return n?(t.w=k.get(n[0].toLowerCase()),i+n[0].length):-1}function r(t,e,i){_.lastIndex=0;var n=_.exec(e.slice(i));return n?(t.w=w.get(n[0].toLowerCase()),i+n[0].length):-1}function s(t,e,i){T.lastIndex=0;var n=T.exec(e.slice(i));return n?(t.m=S.get(n[0].toLowerCase()),i+n[0].length):-1}function o(t,e,i){C.lastIndex=0;var n=C.exec(e.slice(i));return n?(t.m=A.get(n[0].toLowerCase()),i+n[0].length):-1}function a(t,e,n){return i(t,M.c.toString(),e,n)}function l(t,e,n){return i(t,M.x.toString(),e,n)}function c(t,e,n){return i(t,M.X.toString(),e,n)}function u(t,e,i){var n=y.get(e.slice(i,i+=2).toLowerCase());return null==n?-1:(t.p=n,i)}var h=t.dateTime,d=t.date,p=t.time,f=t.periods,g=t.days,m=t.shortDays,v=t.months,b=t.shortMonths;e.utc=function(t){function i(t){try{sl=ze;var e=new sl;return e._=t,n(e)}finally{sl=Date}}var n=e(t);return i.parse=function(t){try{sl=ze;var e=n.parse(t);return e&&e._}finally{sl=Date}},i.toString=n.toString,i},e.multi=e.utc.multi=ai;var y=Ko.map(),_=je(g),w=qe(g),x=je(m),k=qe(m),C=je(v),A=qe(v),T=je(b),S=qe(b);f.forEach(function(t,e){y.set(t.toLowerCase(),e)});var M={a:function(t){return m[t.getDay()]},A:function(t){return g[t.getDay()]},b:function(t){return b[t.getMonth()]},B:function(t){return v[t.getMonth()]},c:e(h),d:function(t,e){return We(t.getDate(),e,2)},e:function(t,e){return We(t.getDate(),e,2)},H:function(t,e){return We(t.getHours(),e,2)},I:function(t,e){return We(t.getHours()%12||12,e,2)},j:function(t,e){return We(1+rl.dayOfYear(t),e,3)},L:function(t,e){return We(t.getMilliseconds(),e,3)},m:function(t,e){return We(t.getMonth()+1,e,2)},M:function(t,e){return We(t.getMinutes(),e,2)},p:function(t){return f[+(t.getHours()>=12)]},S:function(t,e){return We(t.getSeconds(),e,2)},U:function(t,e){return We(rl.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return We(rl.mondayOfYear(t),e,2)},x:e(d),X:e(p),y:function(t,e){return We(t.getFullYear()%100,e,2)},Y:function(t,e){return We(t.getFullYear()%1e4,e,4)},Z:si,"%":function(){return"%"}},D={a:n,A:r,b:s,B:o,c:a,d:Ze,e:Ze,H:ei,I:ei,j:ti,L:ri,m:Qe,M:ii,p:u,S:ni,U:Ue,w:Ve,W:Ye,x:l,X:c,y:Ke,Y:Ge,Z:Je,"%":oi};return e}function We(t,e,i){var n=0>t?"-":"",r=(n?-t:t)+"",s=r.length;return n+(i>s?new Array(i-s+1).join(e)+r:r)}function je(t){return new RegExp("^(?:"+t.map(Ko.requote).join("|")+")","i")}function qe(t){for(var e=new a,i=-1,n=t.length;++i<n;)e.set(t[i].toLowerCase(),i);return e}function Ve(t,e,i){ll.lastIndex=0;var n=ll.exec(e.slice(i,i+1));return n?(t.w=+n[0],i+n[0].length):-1}function Ue(t,e,i){ll.lastIndex=0;var n=ll.exec(e.slice(i));return n?(t.U=+n[0],i+n[0].length):-1}function Ye(t,e,i){ll.lastIndex=0;var n=ll.exec(e.slice(i));return n?(t.W=+n[0],i+n[0].length):-1}function Ge(t,e,i){ll.lastIndex=0;var n=ll.exec(e.slice(i,i+4));return n?(t.y=+n[0],i+n[0].length):-1}function Ke(t,e,i){ll.lastIndex=0;var n=ll.exec(e.slice(i,i+2));return n?(t.y=Xe(+n[0]),i+n[0].length):-1}function Je(t,e,i){return/^[+-]\d{4}$/.test(e=e.slice(i,i+5))?(t.Z=-e,i+5):-1}function Xe(t){return t+(t>68?1900:2e3)}function Qe(t,e,i){ll.lastIndex=0;var n=ll.exec(e.slice(i,i+2));return n?(t.m=n[0]-1,i+n[0].length):-1}function Ze(t,e,i){ll.lastIndex=0;var n=ll.exec(e.slice(i,i+2));return n?(t.d=+n[0],i+n[0].length):-1}function ti(t,e,i){ll.lastIndex=0;var n=ll.exec(e.slice(i,i+3));return n?(t.j=+n[0],i+n[0].length):-1}function ei(t,e,i){ll.lastIndex=0;var n=ll.exec(e.slice(i,i+2));return n?(t.H=+n[0],i+n[0].length):-1}function ii(t,e,i){ll.lastIndex=0;var n=ll.exec(e.slice(i,i+2));return n?(t.M=+n[0],i+n[0].length):-1}function ni(t,e,i){ll.lastIndex=0;var n=ll.exec(e.slice(i,i+2));return n?(t.S=+n[0],i+n[0].length):-1}function ri(t,e,i){ll.lastIndex=0;var n=ll.exec(e.slice(i,i+3));return n?(t.L=+n[0],i+n[0].length):-1}function si(t){var e=t.getTimezoneOffset(),i=e>0?"-":"+",n=ca(e)/60|0,r=ca(e)%60;return i+We(n,"0",2)+We(r,"0",2)}function oi(t,e,i){cl.lastIndex=0;var n=cl.exec(e.slice(i,i+1));return n?i+n[0].length:-1}function ai(t){for(var e=t.length,i=-1;++i<e;)t[i][0]=this(t[i][0]);return function(e){for(var i=0,n=t[i];!n[1](e);)n=t[++i];return n[0](e)}}function li(){}function ci(t,e,i){var n=i.s=t+e,r=n-t,s=n-r;i.t=t-s+(e-r)}function ui(t,e){t&&pl.hasOwnProperty(t.type)&&pl[t.type](t,e)}function hi(t,e,i){var n,r=-1,s=t.length-i;for(e.lineStart();++r<s;)n=t[r],e.point(n[0],n[1],n[2]);e.lineEnd()}function di(t,e){var i=-1,n=t.length;for(e.polygonStart();++i<n;)hi(t[i],e,1);e.polygonEnd()}function pi(){function t(t,e){t*=Pa,e=e*Pa/2+Sa/4;var i=t-n,o=i>=0?1:-1,a=o*i,l=Math.cos(e),c=Math.sin(e),u=s*c,h=r*l+u*Math.cos(a),d=u*o*Math.sin(a);gl.add(Math.atan2(d,h)),n=t,r=l,s=c}var e,i,n,r,s;ml.point=function(o,a){ml.point=t,n=(e=o)*Pa,r=Math.cos(a=(i=a)*Pa/2+Sa/4),s=Math.sin(a)},ml.lineEnd=function(){t(e,i)}}function fi(t){var e=t[0],i=t[1],n=Math.cos(i);return[n*Math.cos(e),n*Math.sin(e),Math.sin(i)]}function gi(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function mi(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function vi(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function bi(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function yi(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function _i(t){return[Math.atan2(t[1],t[0]),te(t[2])]}function wi(t,e){return ca(t[0]-e[0])<$a&&ca(t[1]-e[1])<$a}function xi(t,e){t*=Pa;var i=Math.cos(e*=Pa);ki(i*Math.cos(t),i*Math.sin(t),Math.sin(e))}function ki(t,e,i){++vl,yl+=(t-yl)/vl,_l+=(e-_l)/vl,wl+=(i-wl)/vl}function Ci(){function t(t,r){t*=Pa;var s=Math.cos(r*=Pa),o=s*Math.cos(t),a=s*Math.sin(t),l=Math.sin(r),c=Math.atan2(Math.sqrt((c=i*l-n*a)*c+(c=n*o-e*l)*c+(c=e*a-i*o)*c),e*o+i*a+n*l);bl+=c,xl+=c*(e+(e=o)),kl+=c*(i+(i=a)),Cl+=c*(n+(n=l)),ki(e,i,n)}var e,i,n;Ml.point=function(r,s){r*=Pa;var o=Math.cos(s*=Pa);e=o*Math.cos(r),i=o*Math.sin(r),n=Math.sin(s),Ml.point=t,ki(e,i,n)}}function Ai(){Ml.point=xi}function Ti(){function t(t,e){t*=Pa;var i=Math.cos(e*=Pa),o=i*Math.cos(t),a=i*Math.sin(t),l=Math.sin(e),c=r*l-s*a,u=s*o-n*l,h=n*a-r*o,d=Math.sqrt(c*c+u*u+h*h),p=n*o+r*a+s*l,f=d&&-Z(p)/d,g=Math.atan2(d,p);Al+=f*c,Tl+=f*u,Sl+=f*h,bl+=g,xl+=g*(n+(n=o)),kl+=g*(r+(r=a)),Cl+=g*(s+(s=l)),ki(n,r,s)}var e,i,n,r,s;Ml.point=function(o,a){e=o,i=a,Ml.point=t,o*=Pa;var l=Math.cos(a*=Pa);n=l*Math.cos(o),r=l*Math.sin(o),s=Math.sin(a),ki(n,r,s)},Ml.lineEnd=function(){t(e,i),Ml.lineEnd=Ai,Ml.point=xi}}function Si(){return!0}function Mi(t,e,i,n,r){var s=[],o=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,i=t[0],n=t[e];if(wi(i,n)){r.lineStart();for(var a=0;e>a;++a)r.point((i=t[a])[0],i[1]);return void r.lineEnd()}var l=new $i(i,t,null,!0),c=new $i(i,null,l,!1);l.o=c,s.push(l),o.push(c),l=new $i(n,t,null,!1),c=new $i(n,null,l,!0),l.o=c,s.push(l),o.push(c)}}),o.sort(e),Di(s),Di(o),s.length){for(var a=0,l=i,c=o.length;c>a;++a)o[a].e=l=!l;for(var u,h,d=s[0];;){for(var p=d,f=!0;p.v;)if((p=p.n)===d)return;u=p.z,r.lineStart();do{if(p.v=p.o.v=!0,p.e){if(f)for(var a=0,c=u.length;c>a;++a)r.point((h=u[a])[0],h[1]);else n(p.x,p.n.x,1,r);p=p.n}else{if(f){u=p.p.z;for(var a=u.length-1;a>=0;--a)r.point((h=u[a])[0],h[1])}else n(p.x,p.p.x,-1,r);p=p.p}p=p.o,u=p.z,f=!f}while(!p.v);r.lineEnd()}}}function Di(t){if(e=t.length){for(var e,i,n=0,r=t[0];++n<e;)r.n=i=t[n],i.p=r,r=i;r.n=i=t[0],i.p=r}}function $i(t,e,i,n){this.x=t,this.z=e,this.o=i,this.e=n,this.v=!1,this.n=this.p=null}function Ei(t,e,i,n){return function(r,s){function o(e,i){var n=r(e,i);t(e=n[0],i=n[1])&&s.point(e,i)}function a(t,e){var i=r(t,e);m.point(i[0],i[1])}function l(){b.point=a,m.lineStart()}function c(){b.point=o,m.lineEnd()}function u(t,e){g.push([t,e]);var i=r(t,e);_.point(i[0],i[1])}function h(){_.lineStart(),g=[]}function d(){u(g[0][0],g[0][1]),_.lineEnd();var t,e=_.clean(),i=y.buffer(),n=i.length;if(g.pop(),f.push(g),g=null,n)if(1&e){t=i[0];var r,n=t.length-1,o=-1;if(n>0){for(w||(s.polygonStart(),w=!0),s.lineStart();++o<n;)s.point((r=t[o])[0],r[1]);s.lineEnd()}}else n>1&&2&e&&i.push(i.pop().concat(i.shift())),p.push(i.filter(Pi))}var p,f,g,m=e(s),v=r.invert(n[0],n[1]),b={point:o,lineStart:l,lineEnd:c,polygonStart:function(){b.point=u,b.lineStart=h,b.lineEnd=d,p=[],f=[]},polygonEnd:function(){b.point=o,b.lineStart=l,b.lineEnd=c,p=Ko.merge(p);var t=zi(v,f);p.length?(w||(s.polygonStart(),w=!0),Mi(p,Ni,t,i,s)):t&&(w||(s.polygonStart(),w=!0),s.lineStart(),i(null,null,1,s),s.lineEnd()),w&&(s.polygonEnd(),w=!1),p=f=null},sphere:function(){s.polygonStart(),s.lineStart(),i(null,null,1,s),s.lineEnd(),s.polygonEnd()}},y=Ii(),_=e(y),w=!1;return b}}function Pi(t){return t.length>1}function Ii(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,i){t.push([e,i])},lineEnd:b,buffer:function(){var i=e;return e=[],t=null,i},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function Ni(t,e){return((t=t.x)[0]<0?t[1]-Da-$a:Da-t[1])-((e=e.x)[0]<0?e[1]-Da-$a:Da-e[1])}function Fi(t){var e,i=0/0,n=0/0,r=0/0;return{lineStart:function(){t.lineStart(),e=1},point:function(s,o){var a=s>0?Sa:-Sa,l=ca(s-i);ca(l-Sa)<$a?(t.point(i,n=(n+o)/2>0?Da:-Da),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(a,n),t.point(s,n),e=0):r!==a&&l>=Sa&&(ca(i-r)<$a&&(i-=r*$a),ca(s-a)<$a&&(s-=a*$a),n=Oi(i,n,s,o),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(a,n),e=0),t.point(i=s,n=o),r=a},lineEnd:function(){t.lineEnd(),i=n=0/0},clean:function(){return 2-e}}}function Oi(t,e,i,n){var r,s,o=Math.sin(t-i);return ca(o)>$a?Math.atan((Math.sin(e)*(s=Math.cos(n))*Math.sin(i)-Math.sin(n)*(r=Math.cos(e))*Math.sin(t))/(r*s*o)):(e+n)/2}function Bi(t,e,i,n){var r;if(null==t)r=i*Da,n.point(-Sa,r),n.point(0,r),n.point(Sa,r),n.point(Sa,0),n.point(Sa,-r),n.point(0,-r),n.point(-Sa,-r),n.point(-Sa,0),n.point(-Sa,r);else if(ca(t[0]-e[0])>$a){var s=t[0]<e[0]?Sa:-Sa;r=i*s/2,n.point(-s,r),n.point(0,r),n.point(s,r)}else n.point(e[0],e[1])}function zi(t,e){var i=t[0],n=t[1],r=[Math.sin(i),-Math.cos(i),0],s=0,o=0;gl.reset();for(var a=0,l=e.length;l>a;++a){var c=e[a],u=c.length;if(u)for(var h=c[0],d=h[0],p=h[1]/2+Sa/4,f=Math.sin(p),g=Math.cos(p),m=1;;){m===u&&(m=0),t=c[m];var v=t[0],b=t[1]/2+Sa/4,y=Math.sin(b),_=Math.cos(b),w=v-d,x=w>=0?1:-1,k=x*w,C=k>Sa,A=f*y;if(gl.add(Math.atan2(A*x*Math.sin(k),g*_+A*Math.cos(k))),s+=C?w+x*Ma:w,C^d>=i^v>=i){var T=mi(fi(h),fi(t));yi(T);var S=mi(r,T);yi(S);var M=(C^w>=0?-1:1)*te(S[2]);(n>M||n===M&&(T[0]||T[1]))&&(o+=C^w>=0?1:-1)}if(!m++)break;d=v,f=y,g=_,h=t}}return(-$a>s||$a>s&&0>gl)^1&o}function Ri(t){function e(t,e){return Math.cos(t)*Math.cos(e)>s}function i(t){var i,s,l,c,u;return{lineStart:function(){c=l=!1,u=1},point:function(h,d){var p,f=[h,d],g=e(h,d),m=o?g?0:r(h,d):g?r(h+(0>h?Sa:-Sa),d):0;if(!i&&(c=l=g)&&t.lineStart(),g!==l&&(p=n(i,f),(wi(i,p)||wi(f,p))&&(f[0]+=$a,f[1]+=$a,g=e(f[0],f[1]))),g!==l)u=0,g?(t.lineStart(),p=n(f,i),t.point(p[0],p[1])):(p=n(i,f),t.point(p[0],p[1]),t.lineEnd()),i=p;else if(a&&i&&o^g){var v;m&s||!(v=n(f,i,!0))||(u=0,o?(t.lineStart(),t.point(v[0][0],v[0][1]),t.point(v[1][0],v[1][1]),t.lineEnd()):(t.point(v[1][0],v[1][1]),t.lineEnd(),t.lineStart(),t.point(v[0][0],v[0][1])))}!g||i&&wi(i,f)||t.point(f[0],f[1]),i=f,l=g,s=m},lineEnd:function(){l&&t.lineEnd(),i=null},clean:function(){return u|(c&&l)<<1}}}function n(t,e,i){var n=fi(t),r=fi(e),o=[1,0,0],a=mi(n,r),l=gi(a,a),c=a[0],u=l-c*c;if(!u)return!i&&t;var h=s*l/u,d=-s*c/u,p=mi(o,a),f=bi(o,h),g=bi(a,d);vi(f,g);var m=p,v=gi(f,m),b=gi(m,m),y=v*v-b*(gi(f,f)-1);if(!(0>y)){var _=Math.sqrt(y),w=bi(m,(-v-_)/b);if(vi(w,f),w=_i(w),!i)return w;var x,k=t[0],C=e[0],A=t[1],T=e[1];k>C&&(x=k,k=C,C=x);var S=C-k,M=ca(S-Sa)<$a,D=M||$a>S;if(!M&&A>T&&(x=A,A=T,T=x),D?M?A+T>0^w[1]<(ca(w[0]-k)<$a?A:T):A<=w[1]&&w[1]<=T:S>Sa^(k<=w[0]&&w[0]<=C)){var $=bi(m,(-v+_)/b);return vi($,f),[w,_i($)]}}}function r(e,i){var n=o?t:Sa-t,r=0;return-n>e?r|=1:e>n&&(r|=2),-n>i?r|=4:i>n&&(r|=8),r}var s=Math.cos(t),o=s>0,a=ca(s)>$a,l=fn(t,6*Pa);return Ei(e,i,l,o?[0,-t]:[-Sa,t-Sa])}function Li(t,e,i,n){return function(r){var s,o=r.a,a=r.b,l=o.x,c=o.y,u=a.x,h=a.y,d=0,p=1,f=u-l,g=h-c;if(s=t-l,f||!(s>0)){if(s/=f,0>f){if(d>s)return;p>s&&(p=s)}else if(f>0){if(s>p)return;s>d&&(d=s)}if(s=i-l,f||!(0>s)){if(s/=f,0>f){if(s>p)return;s>d&&(d=s)}else if(f>0){if(d>s)return;p>s&&(p=s)}if(s=e-c,g||!(s>0)){if(s/=g,0>g){if(d>s)return;p>s&&(p=s)}else if(g>0){if(s>p)return;s>d&&(d=s)}if(s=n-c,g||!(0>s)){if(s/=g,0>g){if(s>p)return;s>d&&(d=s)}else if(g>0){if(d>s)return;p>s&&(p=s)}return d>0&&(r.a={x:l+d*f,y:c+d*g}),1>p&&(r.b={x:l+p*f,y:c+p*g}),r}}}}}}function Hi(t,e,i,n){function r(n,r){return ca(n[0]-t)<$a?r>0?0:3:ca(n[0]-i)<$a?r>0?2:1:ca(n[1]-e)<$a?r>0?1:0:r>0?3:2}function s(t,e){return o(t.x,e.x)}function o(t,e){var i=r(t,1),n=r(e,1);return i!==n?i-n:0===i?e[1]-t[1]:1===i?t[0]-e[0]:2===i?t[1]-e[1]:e[0]-t[0]}return function(a){function l(t){for(var e=0,i=m.length,n=t[1],r=0;i>r;++r)for(var s,o=1,a=m[r],l=a.length,c=a[0];l>o;++o)s=a[o],c[1]<=n?s[1]>n&&Q(c,s,t)>0&&++e:s[1]<=n&&Q(c,s,t)<0&&--e,c=s;return 0!==e}function c(s,a,l,c){var u=0,h=0;if(null==s||(u=r(s,l))!==(h=r(a,l))||o(s,a)<0^l>0){do c.point(0===u||3===u?t:i,u>1?n:e);while((u=(u+l+4)%4)!==h)}else c.point(a[0],a[1])}function u(r,s){return r>=t&&i>=r&&s>=e&&n>=s}function h(t,e){u(t,e)&&a.point(t,e)}function d(){D.point=f,m&&m.push(v=[]),C=!0,k=!1,w=x=0/0}function p(){g&&(f(b,y),_&&k&&S.rejoin(),g.push(S.buffer())),D.point=h,k&&a.lineEnd()}function f(t,e){t=Math.max(-$l,Math.min($l,t)),e=Math.max(-$l,Math.min($l,e));var i=u(t,e);if(m&&v.push([t,e]),C)b=t,y=e,_=i,C=!1,i&&(a.lineStart(),a.point(t,e));else if(i&&k)a.point(t,e);else{var n={a:{x:w,y:x},b:{x:t,y:e}};M(n)?(k||(a.lineStart(),a.point(n.a.x,n.a.y)),a.point(n.b.x,n.b.y),i||a.lineEnd(),A=!1):i&&(a.lineStart(),a.point(t,e),A=!1)}w=t,x=e,k=i}var g,m,v,b,y,_,w,x,k,C,A,T=a,S=Ii(),M=Li(t,e,i,n),D={point:h,lineStart:d,lineEnd:p,polygonStart:function(){a=S,g=[],m=[],A=!0},polygonEnd:function(){a=T,g=Ko.merge(g);var e=l([t,n]),i=A&&e,r=g.length;(i||r)&&(a.polygonStart(),i&&(a.lineStart(),c(null,null,1,a),a.lineEnd()),r&&Mi(g,s,e,c,a),a.polygonEnd()),g=m=v=null}};return D}}function Wi(t,e){function i(i,n){return i=t(i,n),e(i[0],i[1])}return t.invert&&e.invert&&(i.invert=function(i,n){return i=e.invert(i,n),i&&t.invert(i[0],i[1])}),i}function ji(t){var e=0,i=Sa/3,n=on(t),r=n(e,i);return r.parallels=function(t){return arguments.length?n(e=t[0]*Sa/180,i=t[1]*Sa/180):[e/Sa*180,i/Sa*180]},r}function qi(t,e){function i(t,e){var i=Math.sqrt(s-2*r*Math.sin(e))/r;return[i*Math.sin(t*=r),o-i*Math.cos(t)]}var n=Math.sin(t),r=(n+Math.sin(e))/2,s=1+n*(2*r-n),o=Math.sqrt(s)/r;return i.invert=function(t,e){var i=o-e;return[Math.atan2(t,i)/r,te((s-(t*t+i*i)*r*r)/(2*r))]},i}function Vi(){function t(t,e){Pl+=r*t-n*e,n=t,r=e}var e,i,n,r;Bl.point=function(s,o){Bl.point=t,e=n=s,i=r=o},Bl.lineEnd=function(){t(e,i)}}function Ui(t,e){Il>t&&(Il=t),t>Fl&&(Fl=t),Nl>e&&(Nl=e),e>Ol&&(Ol=e)}function Yi(){function t(t,e){o.push("M",t,",",e,s)}function e(t,e){o.push("M",t,",",e),a.point=i}function i(t,e){o.push("L",t,",",e)}function n(){a.point=t}function r(){o.push("Z")}var s=Gi(4.5),o=[],a={point:t,lineStart:function(){a.point=e},lineEnd:n,polygonStart:function(){a.lineEnd=r},polygonEnd:function(){a.lineEnd=n,a.point=t},pointRadius:function(t){return s=Gi(t),a},result:function(){if(o.length){var t=o.join("");return o=[],t}}};return a}function Gi(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Ki(t,e){yl+=t,_l+=e,++wl}function Ji(){function t(t,n){var r=t-e,s=n-i,o=Math.sqrt(r*r+s*s);xl+=o*(e+t)/2,kl+=o*(i+n)/2,Cl+=o,Ki(e=t,i=n)}var e,i;Rl.point=function(n,r){Rl.point=t,Ki(e=n,i=r)}}function Xi(){Rl.point=Ki}function Qi(){function t(t,e){var i=t-n,s=e-r,o=Math.sqrt(i*i+s*s);xl+=o*(n+t)/2,kl+=o*(r+e)/2,Cl+=o,o=r*t-n*e,Al+=o*(n+t),Tl+=o*(r+e),Sl+=3*o,Ki(n=t,r=e)}var e,i,n,r;Rl.point=function(s,o){Rl.point=t,Ki(e=n=s,i=r=o)},Rl.lineEnd=function(){t(e,i)}}function Zi(t){function e(e,i){t.moveTo(e,i),t.arc(e,i,o,0,Ma)}function i(e,i){t.moveTo(e,i),a.point=n}function n(e,i){t.lineTo(e,i)}function r(){a.point=e}function s(){t.closePath()}var o=4.5,a={point:e,lineStart:function(){a.point=i},lineEnd:r,polygonStart:function(){a.lineEnd=s},polygonEnd:function(){a.lineEnd=r,a.point=e},pointRadius:function(t){return o=t,a},result:b};return a}function tn(t){function e(t){return(a?n:i)(t)}function i(e){return rn(e,function(i,n){i=t(i,n),e.point(i[0],i[1])})}function n(e){function i(i,n){i=t(i,n),e.point(i[0],i[1])}function n(){y=0/0,C.point=s,e.lineStart()}function s(i,n){var s=fi([i,n]),o=t(i,n);r(y,_,b,w,x,k,y=o[0],_=o[1],b=i,w=s[0],x=s[1],k=s[2],a,e),e.point(y,_)}function o(){C.point=i,e.lineEnd()}function l(){n(),C.point=c,C.lineEnd=u}function c(t,e){s(h=t,d=e),p=y,f=_,g=w,m=x,v=k,C.point=s}function u(){r(y,_,b,w,x,k,p,f,h,g,m,v,a,e),C.lineEnd=o,o()}var h,d,p,f,g,m,v,b,y,_,w,x,k,C={point:i,lineStart:n,lineEnd:o,polygonStart:function(){e.polygonStart(),C.lineStart=l},polygonEnd:function(){e.polygonEnd(),C.lineStart=n}};return C}function r(e,i,n,a,l,c,u,h,d,p,f,g,m,v){var b=u-e,y=h-i,_=b*b+y*y;if(_>4*s&&m--){var w=a+p,x=l+f,k=c+g,C=Math.sqrt(w*w+x*x+k*k),A=Math.asin(k/=C),T=ca(ca(k)-1)<$a||ca(n-d)<$a?(n+d)/2:Math.atan2(x,w),S=t(T,A),M=S[0],D=S[1],$=M-e,E=D-i,P=y*$-b*E;(P*P/_>s||ca((b*$+y*E)/_-.5)>.3||o>a*p+l*f+c*g)&&(r(e,i,n,a,l,c,M,D,T,w/=C,x/=C,k,m,v),v.point(M,D),r(M,D,T,w,x,k,u,h,d,p,f,g,m,v))}}var s=.5,o=Math.cos(30*Pa),a=16;return e.precision=function(t){return arguments.length?(a=(s=t*t)>0&&16,e):Math.sqrt(s)},e}function en(t){var e=tn(function(e,i){return t([e*Ia,i*Ia])});return function(t){return an(e(t))}}function nn(t){this.stream=t}function rn(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function sn(t){return on(function(){return t})()}function on(t){function e(t){return t=a(t[0]*Pa,t[1]*Pa),[t[0]*d+l,c-t[1]*d]}function i(t){return t=a.invert((t[0]-l)/d,(c-t[1])/d),t&&[t[0]*Ia,t[1]*Ia]}function n(){a=Wi(o=un(v,b,y),s);var t=s(g,m);return l=p-t[0]*d,c=f+t[1]*d,r()}function r(){return u&&(u.valid=!1,u=null),e}var s,o,a,l,c,u,h=tn(function(t,e){return t=s(t,e),[t[0]*d+l,c-t[1]*d]}),d=150,p=480,f=250,g=0,m=0,v=0,b=0,y=0,_=Dl,w=Te,x=null,k=null;return e.stream=function(t){return u&&(u.valid=!1),u=an(_(o,h(w(t)))),u.valid=!0,u},e.clipAngle=function(t){return arguments.length?(_=null==t?(x=t,Dl):Ri((x=+t)*Pa),r()):x},e.clipExtent=function(t){return arguments.length?(k=t,w=t?Hi(t[0][0],t[0][1],t[1][0],t[1][1]):Te,r()):k},e.scale=function(t){return arguments.length?(d=+t,n()):d},e.translate=function(t){return arguments.length?(p=+t[0],f=+t[1],n()):[p,f]},e.center=function(t){return arguments.length?(g=t[0]%360*Pa,m=t[1]%360*Pa,n()):[g*Ia,m*Ia]},e.rotate=function(t){return arguments.length?(v=t[0]%360*Pa,b=t[1]%360*Pa,y=t.length>2?t[2]%360*Pa:0,n()):[v*Ia,b*Ia,y*Ia]},Ko.rebind(e,h,"precision"),function(){return s=t.apply(this,arguments),e.invert=s.invert&&i,n()}}function an(t){return rn(t,function(e,i){t.point(e*Pa,i*Pa)})}function ln(t,e){return[t,e]}function cn(t,e){return[t>Sa?t-Ma:-Sa>t?t+Ma:t,e]}function un(t,e,i){return t?e||i?Wi(dn(t),pn(e,i)):dn(t):e||i?pn(e,i):cn}function hn(t){return function(e,i){return e+=t,[e>Sa?e-Ma:-Sa>e?e+Ma:e,i]}}function dn(t){var e=hn(t);return e.invert=hn(-t),e}function pn(t,e){function i(t,e){var i=Math.cos(e),a=Math.cos(t)*i,l=Math.sin(t)*i,c=Math.sin(e),u=c*n+a*r;return[Math.atan2(l*s-u*o,a*n-c*r),te(u*s+l*o)]}var n=Math.cos(t),r=Math.sin(t),s=Math.cos(e),o=Math.sin(e);return i.invert=function(t,e){var i=Math.cos(e),a=Math.cos(t)*i,l=Math.sin(t)*i,c=Math.sin(e),u=c*s-l*o;return[Math.atan2(l*s+c*o,a*n+u*r),te(u*n-a*r)]},i}function fn(t,e){var i=Math.cos(t),n=Math.sin(t);return function(r,s,o,a){var l=o*e;null!=r?(r=gn(i,r),s=gn(i,s),(o>0?s>r:r>s)&&(r+=o*Ma)):(r=t+o*Ma,s=t-.5*l);for(var c,u=r;o>0?u>s:s>u;u-=l)a.point((c=_i([i,-n*Math.cos(u),-n*Math.sin(u)]))[0],c[1])}}function gn(t,e){var i=fi(e);i[0]-=t,yi(i);var n=Z(-i[1]);return((-i[2]<0?-n:n)+2*Math.PI-$a)%(2*Math.PI)}function mn(t,e,i){var n=Ko.range(t,e-$a,i).concat(e);return function(t){return n.map(function(e){return[t,e]})}}function vn(t,e,i){var n=Ko.range(t,e-$a,i).concat(e);return function(t){return n.map(function(e){return[e,t]})}}function bn(t){return t.source}function yn(t){return t.target}function _n(t,e,i,n){var r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),l=r*Math.cos(t),c=r*Math.sin(t),u=o*Math.cos(i),h=o*Math.sin(i),d=2*Math.asin(Math.sqrt(re(n-e)+r*o*re(i-t))),p=1/Math.sin(d),f=d?function(t){var e=Math.sin(t*=d)*p,i=Math.sin(d-t)*p,n=i*l+e*u,r=i*c+e*h,o=i*s+e*a;return[Math.atan2(r,n)*Ia,Math.atan2(o,Math.sqrt(n*n+r*r))*Ia]}:function(){return[t*Ia,e*Ia]};return f.distance=d,f}function wn(){function t(t,r){var s=Math.sin(r*=Pa),o=Math.cos(r),a=ca((t*=Pa)-e),l=Math.cos(a);Ll+=Math.atan2(Math.sqrt((a=o*Math.sin(a))*a+(a=n*s-i*o*l)*a),i*s+n*o*l),e=t,i=s,n=o}var e,i,n;Hl.point=function(r,s){e=r*Pa,i=Math.sin(s*=Pa),n=Math.cos(s),Hl.point=t},Hl.lineEnd=function(){Hl.point=Hl.lineEnd=b}}function xn(t,e){function i(e,i){var n=Math.cos(e),r=Math.cos(i),s=t(n*r);return[s*r*Math.sin(e),s*Math.sin(i)]}return i.invert=function(t,i){var n=Math.sqrt(t*t+i*i),r=e(n),s=Math.sin(r),o=Math.cos(r);return[Math.atan2(t*s,n*o),Math.asin(n&&i*s/n)]},i}function kn(t,e){function i(t,e){o>0?-Da+$a>e&&(e=-Da+$a):e>Da-$a&&(e=Da-$a);var i=o/Math.pow(r(e),s);return[i*Math.sin(s*t),o-i*Math.cos(s*t)]}var n=Math.cos(t),r=function(t){return Math.tan(Sa/4+t/2)},s=t===e?Math.sin(t):Math.log(n/Math.cos(e))/Math.log(r(e)/r(t)),o=n*Math.pow(r(t),s)/s;return s?(i.invert=function(t,e){var i=o-e,n=X(s)*Math.sqrt(t*t+i*i);return[Math.atan2(t,i)/s,2*Math.atan(Math.pow(o/n,1/s))-Da]},i):An}function Cn(t,e){function i(t,e){var i=s-e;return[i*Math.sin(r*t),s-i*Math.cos(r*t)]}var n=Math.cos(t),r=t===e?Math.sin(t):(n-Math.cos(e))/(e-t),s=n/r+t;return ca(r)<$a?ln:(i.invert=function(t,e){var i=s-e;return[Math.atan2(t,i)/r,s-X(r)*Math.sqrt(t*t+i*i)]},i)}function An(t,e){return[t,Math.log(Math.tan(Sa/4+e/2))]}function Tn(t){var e,i=sn(t),n=i.scale,r=i.translate,s=i.clipExtent;return i.scale=function(){var t=n.apply(i,arguments);return t===i?e?i.clipExtent(null):i:t},i.translate=function(){var t=r.apply(i,arguments);return t===i?e?i.clipExtent(null):i:t},i.clipExtent=function(t){var o=s.apply(i,arguments);if(o===i){if(e=null==t){var a=Sa*n(),l=r();s([[l[0]-a,l[1]-a],[l[0]+a,l[1]+a]])}}else e&&(o=null);return o},i.clipExtent(null)}function Sn(t,e){return[Math.log(Math.tan(Sa/4+e/2)),-t]}function Mn(t){return t[0]}function Dn(t){return t[1]}function $n(t){for(var e=t.length,i=[0,1],n=2,r=2;e>r;r++){for(;n>1&&Q(t[i[n-2]],t[i[n-1]],t[r])<=0;)--n;i[n++]=r}return i.slice(0,n)}function En(t,e){return t[0]-e[0]||t[1]-e[1]}function Pn(t,e,i){return(i[0]-e[0])*(t[1]-e[1])<(i[1]-e[1])*(t[0]-e[0])}function In(t,e,i,n){var r=t[0],s=i[0],o=e[0]-r,a=n[0]-s,l=t[1],c=i[1],u=e[1]-l,h=n[1]-c,d=(a*(l-c)-h*(r-s))/(h*o-a*u);return[r+d*o,l+d*u]}function Nn(t){var e=t[0],i=t[t.length-1];return!(e[0]-i[0]||e[1]-i[1])}function Fn(){ir(this),this.edge=this.site=this.circle=null}function On(t){var e=Zl.pop()||new Fn;return e.site=t,e}function Bn(t){Yn(t),Jl.remove(t),Zl.push(t),ir(t)}function zn(t){var e=t.circle,i=e.x,n=e.cy,r={x:i,y:n},s=t.P,o=t.N,a=[t];Bn(t);for(var l=s;l.circle&&ca(i-l.circle.x)<$a&&ca(n-l.circle.cy)<$a;)s=l.P,a.unshift(l),Bn(l),l=s;a.unshift(l),Yn(l);for(var c=o;c.circle&&ca(i-c.circle.x)<$a&&ca(n-c.circle.cy)<$a;)o=c.N,a.push(c),Bn(c),c=o;a.push(c),Yn(c);var u,h=a.length;for(u=1;h>u;++u)c=a[u],l=a[u-1],Zn(c.edge,l.site,c.site,r);l=a[0],c=a[h-1],c.edge=Xn(l.site,c.site,null,r),Un(l),Un(c)}function Rn(t){for(var e,i,n,r,s=t.x,o=t.y,a=Jl._;a;)if(n=Ln(a,o)-s,n>$a)a=a.L;else{if(r=s-Hn(a,o),!(r>$a)){n>-$a?(e=a.P,i=a):r>-$a?(e=a,i=a.N):e=i=a;break}if(!a.R){e=a;break}a=a.R}var l=On(t);if(Jl.insert(e,l),e||i){if(e===i)return Yn(e),i=On(e.site),Jl.insert(l,i),l.edge=i.edge=Xn(e.site,l.site),Un(e),void Un(i);if(!i)return void(l.edge=Xn(e.site,l.site));Yn(e),Yn(i);var c=e.site,u=c.x,h=c.y,d=t.x-u,p=t.y-h,f=i.site,g=f.x-u,m=f.y-h,v=2*(d*m-p*g),b=d*d+p*p,y=g*g+m*m,_={x:(m*b-p*y)/v+u,y:(d*y-g*b)/v+h};Zn(i.edge,c,f,_),l.edge=Xn(c,t,null,_),i.edge=Xn(t,f,null,_),Un(e),Un(i)}}function Ln(t,e){var i=t.site,n=i.x,r=i.y,s=r-e;if(!s)return n;var o=t.P;if(!o)return-1/0;i=o.site;var a=i.x,l=i.y,c=l-e;if(!c)return a;var u=a-n,h=1/s-1/c,d=u/c;return h?(-d+Math.sqrt(d*d-2*h*(u*u/(-2*c)-l+c/2+r-s/2)))/h+n:(n+a)/2}function Hn(t,e){var i=t.N;if(i)return Ln(i,e);var n=t.site;return n.y===e?n.x:1/0}function Wn(t){this.site=t,this.edges=[]}function jn(t){for(var e,i,n,r,s,o,a,l,c,u,h=t[0][0],d=t[1][0],p=t[0][1],f=t[1][1],g=Kl,m=g.length;m--;)if(s=g[m],s&&s.prepare())for(a=s.edges,l=a.length,o=0;l>o;)u=a[o].end(),n=u.x,r=u.y,c=a[++o%l].start(),e=c.x,i=c.y,(ca(n-e)>$a||ca(r-i)>$a)&&(a.splice(o,0,new tr(Qn(s.site,u,ca(n-h)<$a&&f-r>$a?{x:h,y:ca(e-h)<$a?i:f}:ca(r-f)<$a&&d-n>$a?{x:ca(i-f)<$a?e:d,y:f}:ca(n-d)<$a&&r-p>$a?{x:d,y:ca(e-d)<$a?i:p}:ca(r-p)<$a&&n-h>$a?{x:ca(i-p)<$a?e:h,y:p}:null),s.site,null)),++l)}function qn(t,e){return e.angle-t.angle}function Vn(){ir(this),this.x=this.y=this.arc=this.site=this.cy=null}function Un(t){var e=t.P,i=t.N;if(e&&i){var n=e.site,r=t.site,s=i.site;if(n!==s){var o=r.x,a=r.y,l=n.x-o,c=n.y-a,u=s.x-o,h=s.y-a,d=2*(l*h-c*u);if(!(d>=-Ea)){var p=l*l+c*c,f=u*u+h*h,g=(h*p-c*f)/d,m=(l*f-u*p)/d,h=m+a,v=tc.pop()||new Vn;v.arc=t,v.site=r,v.x=g+o,v.y=h+Math.sqrt(g*g+m*m),v.cy=h,t.circle=v;for(var b=null,y=Ql._;y;)if(v.y<y.y||v.y===y.y&&v.x<=y.x){if(!y.L){b=y.P;break}y=y.L}else{if(!y.R){b=y;break}y=y.R}Ql.insert(b,v),b||(Xl=v)}}}}function Yn(t){var e=t.circle;e&&(e.P||(Xl=e.N),Ql.remove(e),tc.push(e),ir(e),t.circle=null)}function Gn(t){for(var e,i=Gl,n=Li(t[0][0],t[0][1],t[1][0],t[1][1]),r=i.length;r--;)e=i[r],(!Kn(e,t)||!n(e)||ca(e.a.x-e.b.x)<$a&&ca(e.a.y-e.b.y)<$a)&&(e.a=e.b=null,i.splice(r,1))}function Kn(t,e){var i=t.b;if(i)return!0;var n,r,s=t.a,o=e[0][0],a=e[1][0],l=e[0][1],c=e[1][1],u=t.l,h=t.r,d=u.x,p=u.y,f=h.x,g=h.y,m=(d+f)/2,v=(p+g)/2;if(g===p){if(o>m||m>=a)return;if(d>f){if(s){if(s.y>=c)return}else s={x:m,y:l};i={x:m,y:c}}else{if(s){if(s.y<l)return}else s={x:m,y:c};i={x:m,y:l}}}else if(n=(d-f)/(g-p),r=v-n*m,-1>n||n>1)if(d>f){if(s){if(s.y>=c)return}else s={x:(l-r)/n,y:l};i={x:(c-r)/n,y:c}}else{if(s){if(s.y<l)return}else s={x:(c-r)/n,y:c};i={x:(l-r)/n,y:l}}else if(g>p){if(s){if(s.x>=a)return}else s={x:o,y:n*o+r};i={x:a,y:n*a+r}}else{if(s){if(s.x<o)return}else s={x:a,y:n*a+r};i={x:o,y:n*o+r}}return t.a=s,t.b=i,!0}function Jn(t,e){this.l=t,this.r=e,this.a=this.b=null}function Xn(t,e,i,n){var r=new Jn(t,e);return Gl.push(r),i&&Zn(r,t,e,i),n&&Zn(r,e,t,n),Kl[t.i].edges.push(new tr(r,t,e)),Kl[e.i].edges.push(new tr(r,e,t)),r}function Qn(t,e,i){var n=new Jn(t,null);return n.a=e,n.b=i,Gl.push(n),n}function Zn(t,e,i,n){t.a||t.b?t.l===i?t.b=n:t.a=n:(t.a=n,t.l=e,t.r=i)}function tr(t,e,i){var n=t.a,r=t.b;this.edge=t,this.site=e,this.angle=i?Math.atan2(i.y-e.y,i.x-e.x):t.l===e?Math.atan2(r.x-n.x,n.y-r.y):Math.atan2(n.x-r.x,r.y-n.y)}function er(){this._=null}function ir(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function nr(t,e){var i=e,n=e.R,r=i.U;r?r.L===i?r.L=n:r.R=n:t._=n,n.U=r,i.U=n,i.R=n.L,i.R&&(i.R.U=i),n.L=i}function rr(t,e){var i=e,n=e.L,r=i.U;r?r.L===i?r.L=n:r.R=n:t._=n,n.U=r,i.U=n,i.L=n.R,i.L&&(i.L.U=i),n.R=i}function sr(t){for(;t.L;)t=t.L;return t}function or(t,e){var i,n,r,s=t.sort(ar).pop();for(Gl=[],Kl=new Array(t.length),Jl=new er,Ql=new er;;)if(r=Xl,s&&(!r||s.y<r.y||s.y===r.y&&s.x<r.x))(s.x!==i||s.y!==n)&&(Kl[s.i]=new Wn(s),Rn(s),i=s.x,n=s.y),s=t.pop();else{if(!r)break;zn(r.arc)}e&&(Gn(e),jn(e));var o={cells:Kl,edges:Gl};return Jl=Ql=Gl=Kl=null,o}function ar(t,e){return e.y-t.y||e.x-t.x}function lr(t,e,i){return(t.x-i.x)*(e.y-t.y)-(t.x-e.x)*(i.y-t.y)}function cr(t){return t.x}function ur(t){return t.y}function hr(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function dr(t,e,i,n,r,s){if(!t(e,i,n,r,s)){var o=.5*(i+r),a=.5*(n+s),l=e.nodes;l[0]&&dr(t,l[0],i,n,o,a),l[1]&&dr(t,l[1],o,n,r,a),l[2]&&dr(t,l[2],i,a,o,s),l[3]&&dr(t,l[3],o,a,r,s)}}function pr(t,e){t=Ko.rgb(t),e=Ko.rgb(e);var i=t.r,n=t.g,r=t.b,s=e.r-i,o=e.g-n,a=e.b-r;return function(t){return"#"+ye(Math.round(i+s*t))+ye(Math.round(n+o*t))+ye(Math.round(r+a*t))}}function fr(t,e){var i,n={},r={};for(i in t)i in e?n[i]=vr(t[i],e[i]):r[i]=t[i];for(i in e)i in t||(r[i]=e[i]);return function(t){for(i in n)r[i]=n[i](t);return r}}function gr(t,e){return t=+t,e=+e,function(i){return t*(1-i)+e*i}}function mr(t,e){var i,n,r,s=ic.lastIndex=nc.lastIndex=0,o=-1,a=[],l=[];for(t+="",e+="";(i=ic.exec(t))&&(n=nc.exec(e));)(r=n.index)>s&&(r=e.slice(s,r),a[o]?a[o]+=r:a[++o]=r),(i=i[0])===(n=n[0])?a[o]?a[o]+=n:a[++o]=n:(a[++o]=null,l.push({i:o,x:gr(i,n)})),s=nc.lastIndex;
return s<e.length&&(r=e.slice(s),a[o]?a[o]+=r:a[++o]=r),a.length<2?l[0]?(e=l[0].x,function(t){return e(t)+""}):function(){return e}:(e=l.length,function(t){for(var i,n=0;e>n;++n)a[(i=l[n]).i]=i.x(t);return a.join("")})}function vr(t,e){for(var i,n=Ko.interpolators.length;--n>=0&&!(i=Ko.interpolators[n](t,e)););return i}function br(t,e){var i,n=[],r=[],s=t.length,o=e.length,a=Math.min(t.length,e.length);for(i=0;a>i;++i)n.push(vr(t[i],e[i]));for(;s>i;++i)r[i]=t[i];for(;o>i;++i)r[i]=e[i];return function(t){for(i=0;a>i;++i)r[i]=n[i](t);return r}}function yr(t){return function(e){return 0>=e?0:e>=1?1:t(e)}}function _r(t){return function(e){return 1-t(1-e)}}function wr(t){return function(e){return.5*(.5>e?t(2*e):2-t(2-2*e))}}function xr(t){return t*t}function kr(t){return t*t*t}function Cr(t){if(0>=t)return 0;if(t>=1)return 1;var e=t*t,i=e*t;return 4*(.5>t?i:3*(t-e)+i-.75)}function Ar(t){return function(e){return Math.pow(e,t)}}function Tr(t){return 1-Math.cos(t*Da)}function Sr(t){return Math.pow(2,10*(t-1))}function Mr(t){return 1-Math.sqrt(1-t*t)}function Dr(t,e){var i;return arguments.length<2&&(e=.45),arguments.length?i=e/Ma*Math.asin(1/t):(t=1,i=e/4),function(n){return 1+t*Math.pow(2,-10*n)*Math.sin((n-i)*Ma/e)}}function $r(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}}function Er(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function Pr(t,e){t=Ko.hcl(t),e=Ko.hcl(e);var i=t.h,n=t.c,r=t.l,s=e.h-i,o=e.c-n,a=e.l-r;return isNaN(o)&&(o=0,n=isNaN(n)?e.c:n),isNaN(s)?(s=0,i=isNaN(i)?e.h:i):s>180?s-=360:-180>s&&(s+=360),function(t){return ce(i+s*t,n+o*t,r+a*t)+""}}function Ir(t,e){t=Ko.hsl(t),e=Ko.hsl(e);var i=t.h,n=t.s,r=t.l,s=e.h-i,o=e.s-n,a=e.l-r;return isNaN(o)&&(o=0,n=isNaN(n)?e.s:n),isNaN(s)?(s=0,i=isNaN(i)?e.h:i):s>180?s-=360:-180>s&&(s+=360),function(t){return ae(i+s*t,n+o*t,r+a*t)+""}}function Nr(t,e){t=Ko.lab(t),e=Ko.lab(e);var i=t.l,n=t.a,r=t.b,s=e.l-i,o=e.a-n,a=e.b-r;return function(t){return he(i+s*t,n+o*t,r+a*t)+""}}function Fr(t,e){return e-=t,function(i){return Math.round(t+e*i)}}function Or(t){var e=[t.a,t.b],i=[t.c,t.d],n=zr(e),r=Br(e,i),s=zr(Rr(i,e,-r))||0;e[0]*i[1]<i[0]*e[1]&&(e[0]*=-1,e[1]*=-1,n*=-1,r*=-1),this.rotate=(n?Math.atan2(e[1],e[0]):Math.atan2(-i[0],i[1]))*Ia,this.translate=[t.e,t.f],this.scale=[n,s],this.skew=s?Math.atan2(r,s)*Ia:0}function Br(t,e){return t[0]*e[0]+t[1]*e[1]}function zr(t){var e=Math.sqrt(Br(t,t));return e&&(t[0]/=e,t[1]/=e),e}function Rr(t,e,i){return t[0]+=i*e[0],t[1]+=i*e[1],t}function Lr(t,e){var i,n=[],r=[],s=Ko.transform(t),o=Ko.transform(e),a=s.translate,l=o.translate,c=s.rotate,u=o.rotate,h=s.skew,d=o.skew,p=s.scale,f=o.scale;return a[0]!=l[0]||a[1]!=l[1]?(n.push("translate(",null,",",null,")"),r.push({i:1,x:gr(a[0],l[0])},{i:3,x:gr(a[1],l[1])})):n.push(l[0]||l[1]?"translate("+l+")":""),c!=u?(c-u>180?u+=360:u-c>180&&(c+=360),r.push({i:n.push(n.pop()+"rotate(",null,")")-2,x:gr(c,u)})):u&&n.push(n.pop()+"rotate("+u+")"),h!=d?r.push({i:n.push(n.pop()+"skewX(",null,")")-2,x:gr(h,d)}):d&&n.push(n.pop()+"skewX("+d+")"),p[0]!=f[0]||p[1]!=f[1]?(i=n.push(n.pop()+"scale(",null,",",null,")"),r.push({i:i-4,x:gr(p[0],f[0])},{i:i-2,x:gr(p[1],f[1])})):(1!=f[0]||1!=f[1])&&n.push(n.pop()+"scale("+f+")"),i=r.length,function(t){for(var e,s=-1;++s<i;)n[(e=r[s]).i]=e.x(t);return n.join("")}}function Hr(t,e){return e=(e-=t=+t)||1/e,function(i){return(i-t)/e}}function Wr(t,e){return e=(e-=t=+t)||1/e,function(i){return Math.max(0,Math.min(1,(i-t)/e))}}function jr(t){for(var e=t.source,i=t.target,n=Vr(e,i),r=[e];e!==n;)e=e.parent,r.push(e);for(var s=r.length;i!==n;)r.splice(s,0,i),i=i.parent;return r}function qr(t){for(var e=[],i=t.parent;null!=i;)e.push(t),t=i,i=i.parent;return e.push(t),e}function Vr(t,e){if(t===e)return t;for(var i=qr(t),n=qr(e),r=i.pop(),s=n.pop(),o=null;r===s;)o=r,r=i.pop(),s=n.pop();return o}function Ur(t){t.fixed|=2}function Yr(t){t.fixed&=-7}function Gr(t){t.fixed|=4,t.px=t.x,t.py=t.y}function Kr(t){t.fixed&=-5}function Jr(t,e,i){var n=0,r=0;if(t.charge=0,!t.leaf)for(var s,o=t.nodes,a=o.length,l=-1;++l<a;)s=o[l],null!=s&&(Jr(s,e,i),t.charge+=s.charge,n+=s.charge*s.cx,r+=s.charge*s.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var c=e*i[t.point.index];t.charge+=t.pointCharge=c,n+=c*t.point.x,r+=c*t.point.y}t.cx=n/t.charge,t.cy=r/t.charge}function Xr(t,e){return Ko.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=ns,t}function Qr(t,e){for(var i=[t];null!=(t=i.pop());)if(e(t),(r=t.children)&&(n=r.length))for(var n,r;--n>=0;)i.push(r[n])}function Zr(t,e){for(var i=[t],n=[];null!=(t=i.pop());)if(n.push(t),(s=t.children)&&(r=s.length))for(var r,s,o=-1;++o<r;)i.push(s[o]);for(;null!=(t=n.pop());)e(t)}function ts(t){return t.children}function es(t){return t.value}function is(t,e){return e.value-t.value}function ns(t){return Ko.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}function rs(t){return t.x}function ss(t){return t.y}function os(t,e,i){t.y0=e,t.y=i}function as(t){return Ko.range(t.length)}function ls(t){for(var e=-1,i=t[0].length,n=[];++e<i;)n[e]=0;return n}function cs(t){for(var e,i=1,n=0,r=t[0][1],s=t.length;s>i;++i)(e=t[i][1])>r&&(n=i,r=e);return n}function us(t){return t.reduce(hs,0)}function hs(t,e){return t+e[1]}function ds(t,e){return ps(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function ps(t,e){for(var i=-1,n=+t[0],r=(t[1]-n)/e,s=[];++i<=e;)s[i]=r*i+n;return s}function fs(t){return[Ko.min(t),Ko.max(t)]}function gs(t,e){return t.value-e.value}function ms(t,e){var i=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=i,i._pack_prev=e}function vs(t,e){t._pack_next=e,e._pack_prev=t}function bs(t,e){var i=e.x-t.x,n=e.y-t.y,r=t.r+e.r;return.999*r*r>i*i+n*n}function ys(t){function e(t){u=Math.min(t.x-t.r,u),h=Math.max(t.x+t.r,h),d=Math.min(t.y-t.r,d),p=Math.max(t.y+t.r,p)}if((i=t.children)&&(c=i.length)){var i,n,r,s,o,a,l,c,u=1/0,h=-1/0,d=1/0,p=-1/0;if(i.forEach(_s),n=i[0],n.x=-n.r,n.y=0,e(n),c>1&&(r=i[1],r.x=r.r,r.y=0,e(r),c>2))for(s=i[2],ks(n,r,s),e(s),ms(n,s),n._pack_prev=s,ms(s,r),r=n._pack_next,o=3;c>o;o++){ks(n,r,s=i[o]);var f=0,g=1,m=1;for(a=r._pack_next;a!==r;a=a._pack_next,g++)if(bs(a,s)){f=1;break}if(1==f)for(l=n._pack_prev;l!==a._pack_prev&&!bs(l,s);l=l._pack_prev,m++);f?(m>g||g==m&&r.r<n.r?vs(n,r=a):vs(n=l,r),o--):(ms(n,s),r=s,e(s))}var v=(u+h)/2,b=(d+p)/2,y=0;for(o=0;c>o;o++)s=i[o],s.x-=v,s.y-=b,y=Math.max(y,s.r+Math.sqrt(s.x*s.x+s.y*s.y));t.r=y,i.forEach(ws)}}function _s(t){t._pack_next=t._pack_prev=t}function ws(t){delete t._pack_next,delete t._pack_prev}function xs(t,e,i,n){var r=t.children;if(t.x=e+=n*t.x,t.y=i+=n*t.y,t.r*=n,r)for(var s=-1,o=r.length;++s<o;)xs(r[s],e,i,n)}function ks(t,e,i){var n=t.r+i.r,r=e.x-t.x,s=e.y-t.y;if(n&&(r||s)){var o=e.r+i.r,a=r*r+s*s;o*=o,n*=n;var l=.5+(n-o)/(2*a),c=Math.sqrt(Math.max(0,2*o*(n+a)-(n-=a)*n-o*o))/(2*a);i.x=t.x+l*r+c*s,i.y=t.y+l*s-c*r}else i.x=t.x+n,i.y=t.y}function Cs(t,e){return t.parent==e.parent?1:2}function As(t){var e=t.children;return e.length?e[0]:t.t}function Ts(t){var e,i=t.children;return(e=i.length)?i[e-1]:t.t}function Ss(t,e,i){var n=i/(e.i-t.i);e.c-=n,e.s+=i,t.c+=n,e.z+=i,e.m+=i}function Ms(t){for(var e,i=0,n=0,r=t.children,s=r.length;--s>=0;)e=r[s],e.z+=i,e.m+=i,i+=e.s+(n+=e.c)}function Ds(t,e,i){return t.a.parent===e.parent?t.a:i}function $s(t){return 1+Ko.max(t,function(t){return t.y})}function Es(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}function Ps(t){var e=t.children;return e&&e.length?Ps(e[0]):t}function Is(t){var e,i=t.children;return i&&(e=i.length)?Is(i[e-1]):t}function Ns(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function Fs(t,e){var i=t.x+e[3],n=t.y+e[0],r=t.dx-e[1]-e[3],s=t.dy-e[0]-e[2];return 0>r&&(i+=r/2,r=0),0>s&&(n+=s/2,s=0),{x:i,y:n,dx:r,dy:s}}function Os(t){var e=t[0],i=t[t.length-1];return i>e?[e,i]:[i,e]}function Bs(t){return t.rangeExtent?t.rangeExtent():Os(t.range())}function zs(t,e,i,n){var r=i(t[0],t[1]),s=n(e[0],e[1]);return function(t){return s(r(t))}}function Rs(t,e){var i,n=0,r=t.length-1,s=t[n],o=t[r];return s>o&&(i=n,n=r,r=i,i=s,s=o,o=i),t[n]=e.floor(s),t[r]=e.ceil(o),t}function Ls(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:fc}function Hs(t,e,i,n){var r=[],s=[],o=0,a=Math.min(t.length,e.length)-1;for(t[a]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<=a;)r.push(i(t[o-1],t[o])),s.push(n(e[o-1],e[o]));return function(e){var i=Ko.bisect(t,e,1,a)-1;return s[i](r[i](e))}}function Ws(t,e,i,n){function r(){var r=Math.min(t.length,e.length)>2?Hs:zs,l=n?Wr:Hr;return o=r(t,e,l,i),a=r(e,t,l,vr),s}function s(t){return o(t)}var o,a;return s.invert=function(t){return a(t)},s.domain=function(e){return arguments.length?(t=e.map(Number),r()):t},s.range=function(t){return arguments.length?(e=t,r()):e},s.rangeRound=function(t){return s.range(t).interpolate(Fr)},s.clamp=function(t){return arguments.length?(n=t,r()):n},s.interpolate=function(t){return arguments.length?(i=t,r()):i},s.ticks=function(e){return Us(t,e)},s.tickFormat=function(e,i){return Ys(t,e,i)},s.nice=function(e){return qs(t,e),r()},s.copy=function(){return Ws(t,e,i,n)},r()}function js(t,e){return Ko.rebind(t,e,"range","rangeRound","interpolate","clamp")}function qs(t,e){return Rs(t,Ls(Vs(t,e)[2]))}function Vs(t,e){null==e&&(e=10);var i=Os(t),n=i[1]-i[0],r=Math.pow(10,Math.floor(Math.log(n/e)/Math.LN10)),s=e/n*r;return.15>=s?r*=10:.35>=s?r*=5:.75>=s&&(r*=2),i[0]=Math.ceil(i[0]/r)*r,i[1]=Math.floor(i[1]/r)*r+.5*r,i[2]=r,i}function Us(t,e){return Ko.range.apply(Ko,Vs(t,e))}function Ys(t,e,i){var n=Vs(t,e);if(i){var r=il.exec(i);if(r.shift(),"s"===r[8]){var s=Ko.formatPrefix(Math.max(ca(n[0]),ca(n[1])));return r[7]||(r[7]="."+Gs(s.scale(n[2]))),r[8]="f",i=Ko.format(r.join("")),function(t){return i(s.scale(t))+s.symbol}}r[7]||(r[7]="."+Ks(r[8],n)),i=r.join("")}else i=",."+Gs(n[2])+"f";return Ko.format(i)}function Gs(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}function Ks(t,e){var i=Gs(e[2]);return t in gc?Math.abs(i-Gs(Math.max(ca(e[0]),ca(e[1]))))+ +("e"!==t):i-2*("%"===t)}function Js(t,e,i,n){function r(t){return(i?Math.log(0>t?0:t):-Math.log(t>0?0:-t))/Math.log(e)}function s(t){return i?Math.pow(e,t):-Math.pow(e,-t)}function o(e){return t(r(e))}return o.invert=function(e){return s(t.invert(e))},o.domain=function(e){return arguments.length?(i=e[0]>=0,t.domain((n=e.map(Number)).map(r)),o):n},o.base=function(i){return arguments.length?(e=+i,t.domain(n.map(r)),o):e},o.nice=function(){var e=Rs(n.map(r),i?Math:vc);return t.domain(e),n=e.map(s),o},o.ticks=function(){var t=Os(n),o=[],a=t[0],l=t[1],c=Math.floor(r(a)),u=Math.ceil(r(l)),h=e%1?2:e;if(isFinite(u-c)){if(i){for(;u>c;c++)for(var d=1;h>d;d++)o.push(s(c)*d);o.push(s(c))}else for(o.push(s(c));c++<u;)for(var d=h-1;d>0;d--)o.push(s(c)*d);for(c=0;o[c]<a;c++);for(u=o.length;o[u-1]>l;u--);o=o.slice(c,u)}return o},o.tickFormat=function(t,e){if(!arguments.length)return mc;arguments.length<2?e=mc:"function"!=typeof e&&(e=Ko.format(e));var n,a=Math.max(.1,t/o.ticks().length),l=i?(n=1e-12,Math.ceil):(n=-1e-12,Math.floor);return function(t){return t/s(l(r(t)+n))<=a?e(t):""}},o.copy=function(){return Js(t.copy(),e,i,n)},js(o,t)}function Xs(t,e,i){function n(e){return t(r(e))}var r=Qs(e),s=Qs(1/e);return n.invert=function(e){return s(t.invert(e))},n.domain=function(e){return arguments.length?(t.domain((i=e.map(Number)).map(r)),n):i},n.ticks=function(t){return Us(i,t)},n.tickFormat=function(t,e){return Ys(i,t,e)},n.nice=function(t){return n.domain(qs(i,t))},n.exponent=function(o){return arguments.length?(r=Qs(e=o),s=Qs(1/e),t.domain(i.map(r)),n):e},n.copy=function(){return Xs(t.copy(),e,i)},js(n,t)}function Qs(t){return function(e){return 0>e?-Math.pow(-e,t):Math.pow(e,t)}}function Zs(t,e){function i(i){return s[((r.get(i)||("range"===e.t?r.set(i,t.push(i)):0/0))-1)%s.length]}function n(e,i){return Ko.range(t.length).map(function(t){return e+i*t})}var r,s,o;return i.domain=function(n){if(!arguments.length)return t;t=[],r=new a;for(var s,o=-1,l=n.length;++o<l;)r.has(s=n[o])||r.set(s,t.push(s));return i[e.t].apply(i,e.a)},i.range=function(t){return arguments.length?(s=t,o=0,e={t:"range",a:arguments},i):s},i.rangePoints=function(r,a){arguments.length<2&&(a=0);var l=r[0],c=r[1],u=(c-l)/(Math.max(1,t.length-1)+a);return s=n(t.length<2?(l+c)/2:l+u*a/2,u),o=0,e={t:"rangePoints",a:arguments},i},i.rangeBands=function(r,a,l){arguments.length<2&&(a=0),arguments.length<3&&(l=a);var c=r[1]<r[0],u=r[c-0],h=r[1-c],d=(h-u)/(t.length-a+2*l);return s=n(u+d*l,d),c&&s.reverse(),o=d*(1-a),e={t:"rangeBands",a:arguments},i},i.rangeRoundBands=function(r,a,l){arguments.length<2&&(a=0),arguments.length<3&&(l=a);var c=r[1]<r[0],u=r[c-0],h=r[1-c],d=Math.floor((h-u)/(t.length-a+2*l)),p=h-u-(t.length-a)*d;return s=n(u+Math.round(p/2),d),c&&s.reverse(),o=Math.round(d*(1-a)),e={t:"rangeRoundBands",a:arguments},i},i.rangeBand=function(){return o},i.rangeExtent=function(){return Os(e.a[0])},i.copy=function(){return Zs(t,e)},i.domain(t)}function to(n,r){function s(){var t=0,e=r.length;for(a=[];++t<e;)a[t-1]=Ko.quantile(n,t/e);return o}function o(t){return isNaN(t=+t)?void 0:r[Ko.bisect(a,t)]}var a;return o.domain=function(r){return arguments.length?(n=r.map(e).filter(i).sort(t),s()):n},o.range=function(t){return arguments.length?(r=t,s()):r},o.quantiles=function(){return a},o.invertExtent=function(t){return t=r.indexOf(t),0>t?[0/0,0/0]:[t>0?a[t-1]:n[0],t<a.length?a[t]:n[n.length-1]]},o.copy=function(){return to(n,r)},s()}function eo(t,e,i){function n(e){return i[Math.max(0,Math.min(o,Math.floor(s*(e-t))))]}function r(){return s=i.length/(e-t),o=i.length-1,n}var s,o;return n.domain=function(i){return arguments.length?(t=+i[0],e=+i[i.length-1],r()):[t,e]},n.range=function(t){return arguments.length?(i=t,r()):i},n.invertExtent=function(e){return e=i.indexOf(e),e=0>e?0/0:e/s+t,[e,e+1/s]},n.copy=function(){return eo(t,e,i)},r()}function io(t,e){function i(i){return i>=i?e[Ko.bisect(t,i)]:void 0}return i.domain=function(e){return arguments.length?(t=e,i):t},i.range=function(t){return arguments.length?(e=t,i):e},i.invertExtent=function(i){return i=e.indexOf(i),[t[i-1],t[i]]},i.copy=function(){return io(t,e)},i}function no(t){function e(t){return+t}return e.invert=e,e.domain=e.range=function(i){return arguments.length?(t=i.map(e),e):t},e.ticks=function(e){return Us(t,e)},e.tickFormat=function(e,i){return Ys(t,e,i)},e.copy=function(){return no(t)},e}function ro(t){return t.innerRadius}function so(t){return t.outerRadius}function oo(t){return t.startAngle}function ao(t){return t.endAngle}function lo(t){function e(e){function o(){c.push("M",s(t(u),a))}for(var l,c=[],u=[],h=-1,d=e.length,p=Ae(i),f=Ae(n);++h<d;)r.call(this,l=e[h],h)?u.push([+p.call(this,l,h),+f.call(this,l,h)]):u.length&&(o(),u=[]);return u.length&&o(),c.length?c.join(""):null}var i=Mn,n=Dn,r=Si,s=co,o=s.key,a=.7;return e.x=function(t){return arguments.length?(i=t,e):i},e.y=function(t){return arguments.length?(n=t,e):n},e.defined=function(t){return arguments.length?(r=t,e):r},e.interpolate=function(t){return arguments.length?(o="function"==typeof t?s=t:(s=Cc.get(t)||co).key,e):o},e.tension=function(t){return arguments.length?(a=t,e):a},e}function co(t){return t.join("L")}function uo(t){return co(t)+"Z"}function ho(t){for(var e=0,i=t.length,n=t[0],r=[n[0],",",n[1]];++e<i;)r.push("H",(n[0]+(n=t[e])[0])/2,"V",n[1]);return i>1&&r.push("H",n[0]),r.join("")}function po(t){for(var e=0,i=t.length,n=t[0],r=[n[0],",",n[1]];++e<i;)r.push("V",(n=t[e])[1],"H",n[0]);return r.join("")}function fo(t){for(var e=0,i=t.length,n=t[0],r=[n[0],",",n[1]];++e<i;)r.push("H",(n=t[e])[0],"V",n[1]);return r.join("")}function go(t,e){return t.length<4?co(t):t[1]+bo(t.slice(1,t.length-1),yo(t,e))}function mo(t,e){return t.length<3?co(t):t[0]+bo((t.push(t[0]),t),yo([t[t.length-2]].concat(t,[t[1]]),e))}function vo(t,e){return t.length<3?co(t):t[0]+bo(t,yo(t,e))}function bo(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return co(t);var i=t.length!=e.length,n="",r=t[0],s=t[1],o=e[0],a=o,l=1;if(i&&(n+="Q"+(s[0]-2*o[0]/3)+","+(s[1]-2*o[1]/3)+","+s[0]+","+s[1],r=t[1],l=2),e.length>1){a=e[1],s=t[l],l++,n+="C"+(r[0]+o[0])+","+(r[1]+o[1])+","+(s[0]-a[0])+","+(s[1]-a[1])+","+s[0]+","+s[1];for(var c=2;c<e.length;c++,l++)s=t[l],a=e[c],n+="S"+(s[0]-a[0])+","+(s[1]-a[1])+","+s[0]+","+s[1]}if(i){var u=t[l];n+="Q"+(s[0]+2*a[0]/3)+","+(s[1]+2*a[1]/3)+","+u[0]+","+u[1]}return n}function yo(t,e){for(var i,n=[],r=(1-e)/2,s=t[0],o=t[1],a=1,l=t.length;++a<l;)i=s,s=o,o=t[a],n.push([r*(o[0]-i[0]),r*(o[1]-i[1])]);return n}function _o(t){if(t.length<3)return co(t);var e=1,i=t.length,n=t[0],r=n[0],s=n[1],o=[r,r,r,(n=t[1])[0]],a=[s,s,s,n[1]],l=[r,",",s,"L",Co(Sc,o),",",Co(Sc,a)];for(t.push(t[i-1]);++e<=i;)n=t[e],o.shift(),o.push(n[0]),a.shift(),a.push(n[1]),Ao(l,o,a);return t.pop(),l.push("L",n),l.join("")}function wo(t){if(t.length<4)return co(t);for(var e,i=[],n=-1,r=t.length,s=[0],o=[0];++n<3;)e=t[n],s.push(e[0]),o.push(e[1]);for(i.push(Co(Sc,s)+","+Co(Sc,o)),--n;++n<r;)e=t[n],s.shift(),s.push(e[0]),o.shift(),o.push(e[1]),Ao(i,s,o);return i.join("")}function xo(t){for(var e,i,n=-1,r=t.length,s=r+4,o=[],a=[];++n<4;)i=t[n%r],o.push(i[0]),a.push(i[1]);for(e=[Co(Sc,o),",",Co(Sc,a)],--n;++n<s;)i=t[n%r],o.shift(),o.push(i[0]),a.shift(),a.push(i[1]),Ao(e,o,a);return e.join("")}function ko(t,e){var i=t.length-1;if(i)for(var n,r,s=t[0][0],o=t[0][1],a=t[i][0]-s,l=t[i][1]-o,c=-1;++c<=i;)n=t[c],r=c/i,n[0]=e*n[0]+(1-e)*(s+r*a),n[1]=e*n[1]+(1-e)*(o+r*l);return _o(t)}function Co(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Ao(t,e,i){t.push("C",Co(Ac,e),",",Co(Ac,i),",",Co(Tc,e),",",Co(Tc,i),",",Co(Sc,e),",",Co(Sc,i))}function To(t,e){return(e[1]-t[1])/(e[0]-t[0])}function So(t){for(var e=0,i=t.length-1,n=[],r=t[0],s=t[1],o=n[0]=To(r,s);++e<i;)n[e]=(o+(o=To(r=s,s=t[e+1])))/2;return n[e]=o,n}function Mo(t){for(var e,i,n,r,s=[],o=So(t),a=-1,l=t.length-1;++a<l;)e=To(t[a],t[a+1]),ca(e)<$a?o[a]=o[a+1]=0:(i=o[a]/e,n=o[a+1]/e,r=i*i+n*n,r>9&&(r=3*e/Math.sqrt(r),o[a]=r*i,o[a+1]=r*n));for(a=-1;++a<=l;)r=(t[Math.min(l,a+1)][0]-t[Math.max(0,a-1)][0])/(6*(1+o[a]*o[a])),s.push([r||0,o[a]*r||0]);return s}function Do(t){return t.length<3?co(t):t[0]+bo(t,Mo(t))}function $o(t){for(var e,i,n,r=-1,s=t.length;++r<s;)e=t[r],i=e[0],n=e[1]+xc,e[0]=i*Math.cos(n),e[1]=i*Math.sin(n);return t}function Eo(t){function e(e){function l(){g.push("M",a(t(v),h),u,c(t(m.reverse()),h),"Z")}for(var d,p,f,g=[],m=[],v=[],b=-1,y=e.length,_=Ae(i),w=Ae(r),x=i===n?function(){return p}:Ae(n),k=r===s?function(){return f}:Ae(s);++b<y;)o.call(this,d=e[b],b)?(m.push([p=+_.call(this,d,b),f=+w.call(this,d,b)]),v.push([+x.call(this,d,b),+k.call(this,d,b)])):m.length&&(l(),m=[],v=[]);return m.length&&l(),g.length?g.join(""):null}var i=Mn,n=Mn,r=0,s=Dn,o=Si,a=co,l=a.key,c=a,u="L",h=.7;return e.x=function(t){return arguments.length?(i=n=t,e):n},e.x0=function(t){return arguments.length?(i=t,e):i},e.x1=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(r=s=t,e):s},e.y0=function(t){return arguments.length?(r=t,e):r},e.y1=function(t){return arguments.length?(s=t,e):s},e.defined=function(t){return arguments.length?(o=t,e):o},e.interpolate=function(t){return arguments.length?(l="function"==typeof t?a=t:(a=Cc.get(t)||co).key,c=a.reverse||a,u=a.closed?"M":"L",e):l},e.tension=function(t){return arguments.length?(h=t,e):h},e}function Po(t){return t.radius}function Io(t){return[t.x,t.y]}function No(t){return function(){var e=t.apply(this,arguments),i=e[0],n=e[1]+xc;return[i*Math.cos(n),i*Math.sin(n)]}}function Fo(){return 64}function Oo(){return"circle"}function Bo(t){var e=Math.sqrt(t/Sa);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}function zo(t,e){return fa(t,Ic),t.id=e,t}function Ro(t,e,i,n){var r=t.id;return R(t,"function"==typeof i?function(t,s,o){t.__transition__[r].tween.set(e,n(i.call(t,t.__data__,s,o)))}:(i=n(i),function(t){t.__transition__[r].tween.set(e,i)}))}function Lo(t){return null==t&&(t=""),function(){this.textContent=t}}function Ho(t,e,i,n){var r=t.__transition__||(t.__transition__={active:0,count:0}),s=r[i];if(!s){var o=n.time;s=r[i]={tween:new a,time:o,ease:n.ease,delay:n.delay,duration:n.duration},++r.count,Ko.timer(function(n){function a(n){return r.active>i?c():(r.active=i,s.event&&s.event.start.call(t,u,e),s.tween.forEach(function(i,n){(n=n.call(t,u,e))&&g.push(n)}),void Ko.timer(function(){return f.c=l(n||1)?Si:l,1},0,o))}function l(n){if(r.active!==i)return c();for(var o=n/p,a=h(o),l=g.length;l>0;)g[--l].call(t,a);return o>=1?(s.event&&s.event.end.call(t,u,e),c()):void 0}function c(){return--r.count?delete r[i]:delete t.__transition__,1}var u=t.__data__,h=s.ease,d=s.delay,p=s.duration,f=Za,g=[];return f.t=d+o,n>=d?a(n-d):void(f.c=a)},0,o)}}function Wo(t,e,i){t.attr("transform",function(t){var n=e(t);return"translate("+(isFinite(n)?n:i(t))+",0)"})}function jo(t,e,i){t.attr("transform",function(t){var n=e(t);return"translate(0,"+(isFinite(n)?n:i(t))+")"})}function qo(t){return t.toISOString()}function Vo(t,e,i){function n(e){return t(e)}function r(t,i){var n=t[1]-t[0],r=n/i,s=Ko.bisect(Wc,r);return s==Wc.length?[e.year,Vs(t.map(function(t){return t/31536e6}),i)[2]]:s?e[r/Wc[s-1]<Wc[s]/r?s-1:s]:[Vc,Vs(t,i)[2]]}return n.invert=function(e){return Uo(t.invert(e))},n.domain=function(e){return arguments.length?(t.domain(e),n):t.domain().map(Uo)},n.nice=function(t,e){function i(i){return!isNaN(i)&&!t.range(i,Uo(+i+1),e).length}var s=n.domain(),o=Os(s),a=null==t?r(o,10):"number"==typeof t&&r(o,t);return a&&(t=a[0],e=a[1]),n.domain(Rs(s,e>1?{floor:function(e){for(;i(e=t.floor(e));)e=Uo(e-1);return e},ceil:function(e){for(;i(e=t.ceil(e));)e=Uo(+e+1);return e}}:t))},n.ticks=function(t,e){var i=Os(n.domain()),s=null==t?r(i,10):"number"==typeof t?r(i,t):!t.range&&[{range:t},e];return s&&(t=s[0],e=s[1]),t.range(i[0],Uo(+i[1]+1),1>e?1:e)},n.tickFormat=function(){return i},n.copy=function(){return Vo(t.copy(),e,i)},js(n,t)}function Uo(t){return new Date(t)}function Yo(t){return JSON.parse(t.responseText)}function Go(t){var e=Qo.createRange();return e.selectNode(Qo.body),e.createContextualFragment(t.responseText)}var Ko={version:"3.4.13"};Date.now||(Date.now=function(){return+new Date});var Jo=[].slice,Xo=function(t){return Jo.call(t)},Qo=document,Zo=Qo.documentElement,ta=window;try{Xo(Zo.childNodes)[0].nodeType}catch(ea){Xo=function(t){for(var e=t.length,i=new Array(e);e--;)i[e]=t[e];return i}}try{Qo.createElement("div").style.setProperty("opacity",0,"")}catch(ia){var na=ta.Element.prototype,ra=na.setAttribute,sa=na.setAttributeNS,oa=ta.CSSStyleDeclaration.prototype,aa=oa.setProperty;na.setAttribute=function(t,e){ra.call(this,t,e+"")},na.setAttributeNS=function(t,e,i){sa.call(this,t,e,i+"")},oa.setProperty=function(t,e,i){aa.call(this,t,e+"",i)}}Ko.ascending=t,Ko.descending=function(t,e){return t>e?-1:e>t?1:e>=t?0:0/0},Ko.min=function(t,e){var i,n,r=-1,s=t.length;if(1===arguments.length){for(;++r<s&&!(null!=(i=t[r])&&i>=i);)i=void 0;for(;++r<s;)null!=(n=t[r])&&i>n&&(i=n)}else{for(;++r<s&&!(null!=(i=e.call(t,t[r],r))&&i>=i);)i=void 0;for(;++r<s;)null!=(n=e.call(t,t[r],r))&&i>n&&(i=n)}return i},Ko.max=function(t,e){var i,n,r=-1,s=t.length;if(1===arguments.length){for(;++r<s&&!(null!=(i=t[r])&&i>=i);)i=void 0;for(;++r<s;)null!=(n=t[r])&&n>i&&(i=n)}else{for(;++r<s&&!(null!=(i=e.call(t,t[r],r))&&i>=i);)i=void 0;for(;++r<s;)null!=(n=e.call(t,t[r],r))&&n>i&&(i=n)}return i},Ko.extent=function(t,e){var i,n,r,s=-1,o=t.length;if(1===arguments.length){for(;++s<o&&!(null!=(i=r=t[s])&&i>=i);)i=r=void 0;for(;++s<o;)null!=(n=t[s])&&(i>n&&(i=n),n>r&&(r=n))}else{for(;++s<o&&!(null!=(i=r=e.call(t,t[s],s))&&i>=i);)i=void 0;for(;++s<o;)null!=(n=e.call(t,t[s],s))&&(i>n&&(i=n),n>r&&(r=n))}return[i,r]},Ko.sum=function(t,e){var n,r=0,s=t.length,o=-1;if(1===arguments.length)for(;++o<s;)i(n=+t[o])&&(r+=n);else for(;++o<s;)i(n=+e.call(t,t[o],o))&&(r+=n);return r},Ko.mean=function(t,n){var r,s=0,o=t.length,a=-1,l=o;if(1===arguments.length)for(;++a<o;)i(r=e(t[a]))?s+=r:--l;else for(;++a<o;)i(r=e(n.call(t,t[a],a)))?s+=r:--l;return l?s/l:void 0},Ko.quantile=function(t,e){var i=(t.length-1)*e+1,n=Math.floor(i),r=+t[n-1],s=i-n;return s?r+s*(t[n]-r):r},Ko.median=function(n,r){var s,o=[],a=n.length,l=-1;if(1===arguments.length)for(;++l<a;)i(s=e(n[l]))&&o.push(s);else for(;++l<a;)i(s=e(r.call(n,n[l],l)))&&o.push(s);return o.length?Ko.quantile(o.sort(t),.5):void 0};var la=n(t);Ko.bisectLeft=la.left,Ko.bisect=Ko.bisectRight=la.right,Ko.bisector=function(e){return n(1===e.length?function(i,n){return t(e(i),n)}:e)},Ko.shuffle=function(t){for(var e,i,n=t.length;n;)i=Math.random()*n--|0,e=t[n],t[n]=t[i],t[i]=e;return t},Ko.permute=function(t,e){for(var i=e.length,n=new Array(i);i--;)n[i]=t[e[i]];return n},Ko.pairs=function(t){for(var e,i=0,n=t.length-1,r=t[0],s=new Array(0>n?0:n);n>i;)s[i]=[e=r,r=t[++i]];return s},Ko.zip=function(){if(!(n=arguments.length))return[];for(var t=-1,e=Ko.min(arguments,r),i=new Array(e);++t<e;)for(var n,s=-1,o=i[t]=new Array(n);++s<n;)o[s]=arguments[s][t];return i},Ko.transpose=function(t){return Ko.zip.apply(Ko,t)},Ko.keys=function(t){var e=[];for(var i in t)e.push(i);return e},Ko.values=function(t){var e=[];for(var i in t)e.push(t[i]);return e},Ko.entries=function(t){var e=[];for(var i in t)e.push({key:i,value:t[i]});return e},Ko.merge=function(t){for(var e,i,n,r=t.length,s=-1,o=0;++s<r;)o+=t[s].length;for(i=new Array(o);--r>=0;)for(n=t[r],e=n.length;--e>=0;)i[--o]=n[e];return i};var ca=Math.abs;Ko.range=function(t,e,i){if(arguments.length<3&&(i=1,arguments.length<2&&(e=t,t=0)),(e-t)/i===1/0)throw new Error("infinite range");var n,r=[],o=s(ca(i)),a=-1;if(t*=o,e*=o,i*=o,0>i)for(;(n=t+i*++a)>e;)r.push(n/o);else for(;(n=t+i*++a)<e;)r.push(n/o);return r},Ko.map=function(t){var e=new a;if(t instanceof a)t.forEach(function(t,i){e.set(t,i)});else for(var i in t)e.set(i,t[i]);return e};var ua="__proto__",ha="\x00";o(a,{has:u,get:function(t){return this._[l(t)]},set:function(t,e){return this._[l(t)]=e},remove:h,keys:d,values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:c(e),value:this._[e]});return t},size:p,empty:f,forEach:function(t){for(var e in this._)t.call(this,c(e),this._[e])}}),Ko.nest=function(){function t(e,o,l){if(l>=s.length)return n?n.call(r,o):i?o.sort(i):o;for(var c,u,h,d,p=-1,f=o.length,g=s[l++],m=new a;++p<f;)(d=m.get(c=g(u=o[p])))?d.push(u):m.set(c,[u]);return e?(u=e(),h=function(i,n){u.set(i,t(e,n,l))}):(u={},h=function(i,n){u[i]=t(e,n,l)}),m.forEach(h),u}function e(t,i){if(i>=s.length)return t;var n=[],r=o[i++];return t.forEach(function(t,r){n.push({key:t,values:e(r,i)})}),r?n.sort(function(t,e){return r(t.key,e.key)}):n}var i,n,r={},s=[],o=[];return r.map=function(e,i){return t(i,e,0)},r.entries=function(i){return e(t(Ko.map,i,0),0)},r.key=function(t){return s.push(t),r},r.sortKeys=function(t){return o[s.length-1]=t,r},r.sortValues=function(t){return i=t,r},r.rollup=function(t){return n=t,r},r},Ko.set=function(t){var e=new g;if(t)for(var i=0,n=t.length;n>i;++i)e.add(t[i]);return e},o(g,{has:u,add:function(t){return this._[l(t+="")]=!0,t},remove:h,values:d,size:p,empty:f,forEach:function(t){for(var e in this._)t.call(this,c(e))}}),Ko.behavior={},Ko.rebind=function(t,e){for(var i,n=1,r=arguments.length;++n<r;)t[i=arguments[n]]=m(t,e,e[i]);return t};var da=["webkit","ms","moz","Moz","o","O"];Ko.dispatch=function(){for(var t=new y,e=-1,i=arguments.length;++e<i;)t[arguments[e]]=_(t);return t},y.prototype.on=function(t,e){var i=t.indexOf("."),n="";if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t)return arguments.length<2?this[t].on(n):this[t].on(n,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(n,null);return this}},Ko.event=null,Ko.requote=function(t){return t.replace(pa,"\\$&")};var pa=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,fa={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var i in e)t[i]=e[i]},ga=function(t,e){return e.querySelector(t)},ma=function(t,e){return e.querySelectorAll(t)},va=Zo.matches||Zo[v(Zo,"matchesSelector")],ba=function(t,e){return va.call(t,e)};"function"==typeof Sizzle&&(ga=function(t,e){return Sizzle(t,e)[0]||null},ma=Sizzle,ba=Sizzle.matchesSelector),Ko.selection=function(){return xa};var ya=Ko.selection.prototype=[];ya.select=function(t){var e,i,n,r,s=[];t=A(t);for(var o=-1,a=this.length;++o<a;){s.push(e=[]),e.parentNode=(n=this[o]).parentNode;for(var l=-1,c=n.length;++l<c;)(r=n[l])?(e.push(i=t.call(r,r.__data__,l,o)),i&&"__data__"in r&&(i.__data__=r.__data__)):e.push(null)}return C(s)},ya.selectAll=function(t){var e,i,n=[];t=T(t);for(var r=-1,s=this.length;++r<s;)for(var o=this[r],a=-1,l=o.length;++a<l;)(i=o[a])&&(n.push(e=Xo(t.call(i,i.__data__,a,r))),e.parentNode=i);return C(n)};var _a={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};Ko.ns={prefix:_a,qualify:function(t){var e=t.indexOf(":"),i=t;return e>=0&&(i=t.slice(0,e),t=t.slice(e+1)),_a.hasOwnProperty(i)?{space:_a[i],local:t}:t}},ya.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var i=this.node();return t=Ko.ns.qualify(t),t.local?i.getAttributeNS(t.space,t.local):i.getAttribute(t)}for(e in t)this.each(S(e,t[e]));return this}return this.each(S(t,e))},ya.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var i=this.node(),n=(t=$(t)).length,r=-1;if(e=i.classList){for(;++r<n;)if(!e.contains(t[r]))return!1}else for(e=i.getAttribute("class");++r<n;)if(!D(t[r]).test(e))return!1;return!0}for(e in t)this.each(E(e,t[e]));return this}return this.each(E(t,e))},ya.style=function(t,e,i){var n=arguments.length;if(3>n){if("string"!=typeof t){2>n&&(e="");for(i in t)this.each(I(i,t[i],e));return this}if(2>n)return ta.getComputedStyle(this.node(),null).getPropertyValue(t);i=""}return this.each(I(t,e,i))},ya.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(N(e,t[e]));return this}return this.each(N(t,e))},ya.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},ya.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},ya.append=function(t){return t=F(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},ya.insert=function(t,e){return t=F(t),e=A(e),this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)})},ya.remove=function(){return this.each(function(){var t=this.parentNode;t&&t.removeChild(this)})},ya.data=function(t,e){function i(t,i){var n,r,s,o=t.length,h=i.length,d=Math.min(o,h),p=new Array(h),f=new Array(h),g=new Array(o);if(e){var m,v=new a,b=new Array(o);for(n=-1;++n<o;)v.has(m=e.call(r=t[n],r.__data__,n))?g[n]=r:v.set(m,r),b[n]=m;for(n=-1;++n<h;)(r=v.get(m=e.call(i,s=i[n],n)))?r!==!0&&(p[n]=r,r.__data__=s):f[n]=O(s),v.set(m,!0);for(n=-1;++n<o;)v.get(b[n])!==!0&&(g[n]=t[n])}else{for(n=-1;++n<d;)r=t[n],s=i[n],r?(r.__data__=s,p[n]=r):f[n]=O(s);for(;h>n;++n)f[n]=O(i[n]);for(;o>n;++n)g[n]=t[n]}f.update=p,f.parentNode=p.parentNode=g.parentNode=t.parentNode,l.push(f),c.push(p),u.push(g)}var n,r,s=-1,o=this.length;if(!arguments.length){for(t=new Array(o=(n=this[0]).length);++s<o;)(r=n[s])&&(t[s]=r.__data__);return t}var l=L([]),c=C([]),u=C([]);if("function"==typeof t)for(;++s<o;)i(n=this[s],t.call(n,n.parentNode.__data__,s));else for(;++s<o;)i(n=this[s],t);return c.enter=function(){return l},c.exit=function(){return u},c},ya.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")
},ya.filter=function(t){var e,i,n,r=[];"function"!=typeof t&&(t=B(t));for(var s=0,o=this.length;o>s;s++){r.push(e=[]),e.parentNode=(i=this[s]).parentNode;for(var a=0,l=i.length;l>a;a++)(n=i[a])&&t.call(n,n.__data__,a,s)&&e.push(n)}return C(r)},ya.order=function(){for(var t=-1,e=this.length;++t<e;)for(var i,n=this[t],r=n.length-1,s=n[r];--r>=0;)(i=n[r])&&(s&&s!==i.nextSibling&&s.parentNode.insertBefore(i,s),s=i);return this},ya.sort=function(t){t=z.apply(this,arguments);for(var e=-1,i=this.length;++e<i;)this[e].sort(t);return this.order()},ya.each=function(t){return R(this,function(e,i,n){t.call(e,e.__data__,i,n)})},ya.call=function(t){var e=Xo(arguments);return t.apply(e[0]=this,e),this},ya.empty=function(){return!this.node()},ya.node=function(){for(var t=0,e=this.length;e>t;t++)for(var i=this[t],n=0,r=i.length;r>n;n++){var s=i[n];if(s)return s}return null},ya.size=function(){var t=0;return R(this,function(){++t}),t};var wa=[];Ko.selection.enter=L,Ko.selection.enter.prototype=wa,wa.append=ya.append,wa.empty=ya.empty,wa.node=ya.node,wa.call=ya.call,wa.size=ya.size,wa.select=function(t){for(var e,i,n,r,s,o=[],a=-1,l=this.length;++a<l;){n=(r=this[a]).update,o.push(e=[]),e.parentNode=r.parentNode;for(var c=-1,u=r.length;++c<u;)(s=r[c])?(e.push(n[c]=i=t.call(r.parentNode,s.__data__,c,a)),i.__data__=s.__data__):e.push(null)}return C(o)},wa.insert=function(t,e){return arguments.length<2&&(e=H(this)),ya.insert.call(this,t,e)},ya.transition=function(){for(var t,e,i=Dc||++Nc,n=[],r=$c||{time:Date.now(),ease:Cr,delay:0,duration:250},s=-1,o=this.length;++s<o;){n.push(t=[]);for(var a=this[s],l=-1,c=a.length;++l<c;)(e=a[l])&&Ho(e,l,i,r),t.push(e)}return zo(n,i)},ya.interrupt=function(){return this.each(W)},Ko.select=function(t){var e=["string"==typeof t?ga(t,Qo):t];return e.parentNode=Zo,C([e])},Ko.selectAll=function(t){var e=Xo("string"==typeof t?ma(t,Qo):t);return e.parentNode=Zo,C([e])};var xa=Ko.select(Zo);ya.on=function(t,e,i){var n=arguments.length;if(3>n){if("string"!=typeof t){2>n&&(e=!1);for(i in t)this.each(j(i,t[i],e));return this}if(2>n)return(n=this.node()["__on"+t])&&n._;i=!1}return this.each(j(t,e,i))};var ka=Ko.map({mouseenter:"mouseover",mouseleave:"mouseout"});ka.forEach(function(t){"on"+t in Qo&&ka.remove(t)});var Ca="onselectstart"in Qo?null:v(Zo.style,"userSelect"),Aa=0;Ko.mouse=function(t){return Y(t,x())};var Ta=/WebKit/.test(ta.navigator.userAgent)?-1:0;Ko.touch=function(t,e,i){if(arguments.length<3&&(i=e,e=x().changedTouches),e)for(var n,r=0,s=e.length;s>r;++r)if((n=e[r]).identifier===i)return Y(t,n)},Ko.behavior.drag=function(){function t(){this.on("mousedown.drag",r).on("touchstart.drag",s)}function e(t,e,r,s,o){return function(){function a(){var t,i,n=e(d,g);n&&(t=n[0]-y[0],i=n[1]-y[1],f|=t|i,y=n,p({type:"drag",x:n[0]+c[0],y:n[1]+c[1],dx:t,dy:i}))}function l(){e(d,g)&&(v.on(s+m,null).on(o+m,null),b(f&&Ko.event.target===h),p({type:"dragend"}))}var c,u=this,h=Ko.event.target,d=u.parentNode,p=i.of(u,arguments),f=0,g=t(),m=".drag"+(null==g?"":"-"+g),v=Ko.select(r()).on(s+m,a).on(o+m,l),b=U(),y=e(d,g);n?(c=n.apply(u,arguments),c=[c.x-y[0],c.y-y[1]]):c=[0,0],p({type:"dragstart"})}}var i=k(t,"drag","dragstart","dragend"),n=null,r=e(b,Ko.mouse,J,"mousemove","mouseup"),s=e(G,Ko.touch,K,"touchmove","touchend");return t.origin=function(e){return arguments.length?(n=e,t):n},Ko.rebind(t,i,"on")},Ko.touches=function(t,e){return arguments.length<2&&(e=x().touches),e?Xo(e).map(function(e){var i=Y(t,e);return i.identifier=e.identifier,i}):[]};var Sa=Math.PI,Ma=2*Sa,Da=Sa/2,$a=1e-6,Ea=$a*$a,Pa=Sa/180,Ia=180/Sa,Na=Math.SQRT2,Fa=2,Oa=4;Ko.interpolateZoom=function(t,e){function i(t){var e=t*b;if(v){var i=ie(g),o=s/(Fa*d)*(i*ne(Na*e+g)-ee(g));return[n+o*c,r+o*u,s*i/ie(Na*e+g)]}return[n+t*c,r+t*u,s*Math.exp(Na*e)]}var n=t[0],r=t[1],s=t[2],o=e[0],a=e[1],l=e[2],c=o-n,u=a-r,h=c*c+u*u,d=Math.sqrt(h),p=(l*l-s*s+Oa*h)/(2*s*Fa*d),f=(l*l-s*s-Oa*h)/(2*l*Fa*d),g=Math.log(Math.sqrt(p*p+1)-p),m=Math.log(Math.sqrt(f*f+1)-f),v=m-g,b=(v||Math.log(l/s))/Na;return i.duration=1e3*b,i},Ko.behavior.zoom=function(){function t(t){t.on(S,c).on(Ra+".zoom",h).on("dblclick.zoom",d).on($,u)}function e(t){return[(t[0]-C.x)/C.k,(t[1]-C.y)/C.k]}function i(t){return[t[0]*C.k+C.x,t[1]*C.k+C.y]}function n(t){C.k=Math.max(T[0],Math.min(T[1],t))}function r(t,e){e=i(e),C.x+=t[0]-e[0],C.y+=t[1]-e[1]}function s(){y&&y.domain(b.range().map(function(t){return(t-C.x)/C.k}).map(b.invert)),x&&x.domain(_.range().map(function(t){return(t-C.y)/C.k}).map(_.invert))}function o(t){t({type:"zoomstart"})}function a(t){s(),t({type:"zoom",scale:C.k,translate:[C.x,C.y]})}function l(t){t({type:"zoomend"})}function c(){function t(){u=1,r(Ko.mouse(n),d),a(c)}function i(){h.on(M,null).on(D,null),p(u&&Ko.event.target===s),l(c)}var n=this,s=Ko.event.target,c=E.of(n,arguments),u=0,h=Ko.select(ta).on(M,t).on(D,i),d=e(Ko.mouse(n)),p=U();W.call(n),o(c)}function u(){function t(){var t=Ko.touches(p);return d=C.k,t.forEach(function(t){t.identifier in g&&(g[t.identifier]=e(t))}),t}function i(){var e=Ko.event.target;Ko.select(e).on(y,s).on(_,h),x.push(e);for(var i=Ko.event.changedTouches,o=0,l=i.length;l>o;++o)g[i[o].identifier]=null;var c=t(),u=Date.now();if(1===c.length){if(500>u-v){var d=c[0],p=g[d.identifier];n(2*C.k),r(d,p),w(),a(f)}v=u}else if(c.length>1){var d=c[0],b=c[1],k=d[0]-b[0],A=d[1]-b[1];m=k*k+A*A}}function s(){for(var t,e,i,s,o=Ko.touches(p),l=0,c=o.length;c>l;++l,s=null)if(i=o[l],s=g[i.identifier]){if(e)break;t=i,e=s}if(s){var u=(u=i[0]-t[0])*u+(u=i[1]-t[1])*u,h=m&&Math.sqrt(u/m);t=[(t[0]+i[0])/2,(t[1]+i[1])/2],e=[(e[0]+s[0])/2,(e[1]+s[1])/2],n(h*d)}v=null,r(t,e),a(f)}function h(){if(Ko.event.touches.length){for(var e=Ko.event.changedTouches,i=0,n=e.length;n>i;++i)delete g[e[i].identifier];for(var r in g)return void t()}Ko.selectAll(x).on(b,null),k.on(S,c).on($,u),A(),l(f)}var d,p=this,f=E.of(p,arguments),g={},m=0,b=".zoom-"+Ko.event.changedTouches[0].identifier,y="touchmove"+b,_="touchend"+b,x=[],k=Ko.select(p),A=U();W.call(p),i(),o(f),k.on(S,null).on($,i)}function h(){var t=E.of(this,arguments);m?clearTimeout(m):(p=e(f=g||Ko.mouse(this)),W.call(this),o(t)),m=setTimeout(function(){m=null,l(t)},50),w(),n(Math.pow(2,.002*Ba())*C.k),r(f,p),a(t)}function d(){var t=E.of(this,arguments),i=Ko.mouse(this),s=e(i),c=Math.log(C.k)/Math.LN2;o(t),n(Math.pow(2,Ko.event.shiftKey?Math.ceil(c)-1:Math.floor(c)+1)),r(i,s),a(t),l(t)}var p,f,g,m,v,b,y,_,x,C={x:0,y:0,k:1},A=[960,500],T=za,S="mousedown.zoom",M="mousemove.zoom",D="mouseup.zoom",$="touchstart.zoom",E=k(t,"zoomstart","zoom","zoomend");return t.event=function(t){t.each(function(){var t=E.of(this,arguments),e=C;Dc?Ko.select(this).transition().each("start.zoom",function(){C=this.__chart__||{x:0,y:0,k:1},o(t)}).tween("zoom:zoom",function(){var i=A[0],n=A[1],r=i/2,s=n/2,o=Ko.interpolateZoom([(r-C.x)/C.k,(s-C.y)/C.k,i/C.k],[(r-e.x)/e.k,(s-e.y)/e.k,i/e.k]);return function(e){var n=o(e),l=i/n[2];this.__chart__=C={x:r-n[0]*l,y:s-n[1]*l,k:l},a(t)}}).each("end.zoom",function(){l(t)}):(this.__chart__=C,o(t),a(t),l(t))})},t.translate=function(e){return arguments.length?(C={x:+e[0],y:+e[1],k:C.k},s(),t):[C.x,C.y]},t.scale=function(e){return arguments.length?(C={x:C.x,y:C.y,k:+e},s(),t):C.k},t.scaleExtent=function(e){return arguments.length?(T=null==e?za:[+e[0],+e[1]],t):T},t.center=function(e){return arguments.length?(g=e&&[+e[0],+e[1]],t):g},t.size=function(e){return arguments.length?(A=e&&[+e[0],+e[1]],t):A},t.x=function(e){return arguments.length?(y=e,b=e.copy(),C={x:0,y:0,k:1},t):y},t.y=function(e){return arguments.length?(x=e,_=e.copy(),C={x:0,y:0,k:1},t):x},Ko.rebind(t,E,"on")};var Ba,za=[0,1/0],Ra="onwheel"in Qo?(Ba=function(){return-Ko.event.deltaY*(Ko.event.deltaMode?120:1)},"wheel"):"onmousewheel"in Qo?(Ba=function(){return Ko.event.wheelDelta},"mousewheel"):(Ba=function(){return-Ko.event.detail},"MozMousePixelScroll");Ko.color=se,se.prototype.toString=function(){return this.rgb()+""},Ko.hsl=oe;var La=oe.prototype=new se;La.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new oe(this.h,this.s,this.l/t)},La.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new oe(this.h,this.s,t*this.l)},La.rgb=function(){return ae(this.h,this.s,this.l)},Ko.hcl=le;var Ha=le.prototype=new se;Ha.brighter=function(t){return new le(this.h,this.c,Math.min(100,this.l+Wa*(arguments.length?t:1)))},Ha.darker=function(t){return new le(this.h,this.c,Math.max(0,this.l-Wa*(arguments.length?t:1)))},Ha.rgb=function(){return ce(this.h,this.c,this.l).rgb()},Ko.lab=ue;var Wa=18,ja=.95047,qa=1,Va=1.08883,Ua=ue.prototype=new se;Ua.brighter=function(t){return new ue(Math.min(100,this.l+Wa*(arguments.length?t:1)),this.a,this.b)},Ua.darker=function(t){return new ue(Math.max(0,this.l-Wa*(arguments.length?t:1)),this.a,this.b)},Ua.rgb=function(){return he(this.l,this.a,this.b)},Ko.rgb=me;var Ya=me.prototype=new se;Ya.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,i=this.g,n=this.b,r=30;return e||i||n?(e&&r>e&&(e=r),i&&r>i&&(i=r),n&&r>n&&(n=r),new me(Math.min(255,e/t),Math.min(255,i/t),Math.min(255,n/t))):new me(r,r,r)},Ya.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new me(t*this.r,t*this.g,t*this.b)},Ya.hsl=function(){return we(this.r,this.g,this.b)},Ya.toString=function(){return"#"+ye(this.r)+ye(this.g)+ye(this.b)};var Ga=Ko.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Ga.forEach(function(t,e){Ga.set(t,ve(e))}),Ko.functor=Ae,Ko.xhr=Se(Te),Ko.dsv=function(t,e){function i(t,i,s){arguments.length<3&&(s=i,i=null);var o=Me(t,e,null==i?n:r(i),s);return o.row=function(t){return arguments.length?o.response(null==(i=t)?n:r(t)):i},o}function n(t){return i.parse(t.responseText)}function r(t){return function(e){return i.parse(e.responseText,t)}}function s(e){return e.map(o).join(t)}function o(t){return a.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var a=new RegExp('["'+t+"\n]"),l=t.charCodeAt(0);return i.parse=function(t,e){var n;return i.parseRows(t,function(t,i){if(n)return n(t,i-1);var r=new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");n=e?function(t,i){return e(r(t),i)}:r})},i.parseRows=function(t,e){function i(){if(u>=c)return o;if(r)return r=!1,s;var e=u;if(34===t.charCodeAt(e)){for(var i=e;i++<c;)if(34===t.charCodeAt(i)){if(34!==t.charCodeAt(i+1))break;++i}u=i+2;var n=t.charCodeAt(i+1);return 13===n?(r=!0,10===t.charCodeAt(i+2)&&++u):10===n&&(r=!0),t.slice(e+1,i).replace(/""/g,'"')}for(;c>u;){var n=t.charCodeAt(u++),a=1;if(10===n)r=!0;else if(13===n)r=!0,10===t.charCodeAt(u)&&(++u,++a);else if(n!==l)continue;return t.slice(e,u-a)}return t.slice(e)}for(var n,r,s={},o={},a=[],c=t.length,u=0,h=0;(n=i())!==o;){for(var d=[];n!==s&&n!==o;)d.push(n),n=i();e&&null==(d=e(d,h++))||a.push(d)}return a},i.format=function(e){if(Array.isArray(e[0]))return i.formatRows(e);var n=new g,r=[];return e.forEach(function(t){for(var e in t)n.has(e)||r.push(n.add(e))}),[r.map(o).join(t)].concat(e.map(function(e){return r.map(function(t){return o(e[t])}).join(t)})).join("\n")},i.formatRows=function(t){return t.map(s).join("\n")},i},Ko.csv=Ko.dsv(",","text/csv"),Ko.tsv=Ko.dsv("	","text/tab-separated-values");var Ka,Ja,Xa,Qa,Za,tl=ta[v(ta,"requestAnimationFrame")]||function(t){setTimeout(t,17)};Ko.timer=function(t,e,i){var n=arguments.length;2>n&&(e=0),3>n&&(i=Date.now());var r=i+e,s={c:t,t:r,f:!1,n:null};Ja?Ja.n=s:Ka=s,Ja=s,Xa||(Qa=clearTimeout(Qa),Xa=1,tl(Ee))},Ko.timer.flush=function(){Pe(),Ie()},Ko.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var el=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(Fe);Ko.formatPrefix=function(t,e){var i=0;return t&&(0>t&&(t*=-1),e&&(t=Ko.round(t,Ne(t,e))),i=1+Math.floor(1e-12+Math.log(t)/Math.LN10),i=Math.max(-24,Math.min(24,3*Math.floor((i-1)/3)))),el[8+i/3]};var il=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,nl=Ko.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=Ko.round(t,Ne(t,e))).toFixed(Math.max(0,Math.min(20,Ne(t*(1+1e-15),e))))}}),rl=Ko.time={},sl=Date;ze.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){ol.setUTCDate.apply(this._,arguments)},setDay:function(){ol.setUTCDay.apply(this._,arguments)},setFullYear:function(){ol.setUTCFullYear.apply(this._,arguments)},setHours:function(){ol.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){ol.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){ol.setUTCMinutes.apply(this._,arguments)},setMonth:function(){ol.setUTCMonth.apply(this._,arguments)},setSeconds:function(){ol.setUTCSeconds.apply(this._,arguments)},setTime:function(){ol.setTime.apply(this._,arguments)}};var ol=Date.prototype;rl.year=Re(function(t){return t=rl.day(t),t.setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),rl.years=rl.year.range,rl.years.utc=rl.year.utc.range,rl.day=Re(function(t){var e=new sl(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),rl.days=rl.day.range,rl.days.utc=rl.day.utc.range,rl.dayOfYear=function(t){var e=rl.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(t,e){e=7-e;var i=rl[t]=Re(function(t){return(t=rl.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var i=rl.year(t).getDay();return Math.floor((rl.dayOfYear(t)+(i+e)%7)/7)-(i!==e)});rl[t+"s"]=i.range,rl[t+"s"].utc=i.utc.range,rl[t+"OfYear"]=function(t){var i=rl.year(t).getDay();return Math.floor((rl.dayOfYear(t)+(i+e)%7)/7)}}),rl.week=rl.sunday,rl.weeks=rl.sunday.range,rl.weeks.utc=rl.sunday.utc.range,rl.weekOfYear=rl.sundayOfYear;var al={"-":"",_:" ",0:"0"},ll=/^\s*\d+/,cl=/^%/;Ko.locale=function(t){return{numberFormat:Oe(t),timeFormat:He(t)}};var ul=Ko.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Ko.format=ul.numberFormat,Ko.geo={},li.prototype={s:0,t:0,add:function(t){ci(t,this.t,hl),ci(hl.s,this.s,this),this.s?this.t+=hl.t:this.s=hl.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var hl=new li;Ko.geo.stream=function(t,e){t&&dl.hasOwnProperty(t.type)?dl[t.type](t,e):ui(t,e)};var dl={Feature:function(t,e){ui(t.geometry,e)},FeatureCollection:function(t,e){for(var i=t.features,n=-1,r=i.length;++n<r;)ui(i[n].geometry,e)}},pl={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)t=i[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){hi(t.coordinates,e,0)},MultiLineString:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)hi(i[n],e,0)},Polygon:function(t,e){di(t.coordinates,e)},MultiPolygon:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)di(i[n],e)},GeometryCollection:function(t,e){for(var i=t.geometries,n=-1,r=i.length;++n<r;)ui(i[n],e)}};Ko.geo.area=function(t){return fl=0,Ko.geo.stream(t,ml),fl};var fl,gl=new li,ml={sphere:function(){fl+=4*Sa},point:b,lineStart:b,lineEnd:b,polygonStart:function(){gl.reset(),ml.lineStart=pi},polygonEnd:function(){var t=2*gl;fl+=0>t?4*Sa+t:t,ml.lineStart=ml.lineEnd=ml.point=b}};Ko.geo.bounds=function(){function t(t,e){y.push(_=[u=t,d=t]),h>e&&(h=e),e>p&&(p=e)}function e(e,i){var n=fi([e*Pa,i*Pa]);if(v){var r=mi(v,n),s=[r[1],-r[0],0],o=mi(s,r);yi(o),o=_i(o);var l=e-f,c=l>0?1:-1,g=o[0]*Ia*c,m=ca(l)>180;if(m^(g>c*f&&c*e>g)){var b=o[1]*Ia;b>p&&(p=b)}else if(g=(g+360)%360-180,m^(g>c*f&&c*e>g)){var b=-o[1]*Ia;h>b&&(h=b)}else h>i&&(h=i),i>p&&(p=i);m?f>e?a(u,e)>a(u,d)&&(d=e):a(e,d)>a(u,d)&&(u=e):d>=u?(u>e&&(u=e),e>d&&(d=e)):e>f?a(u,e)>a(u,d)&&(d=e):a(e,d)>a(u,d)&&(u=e)}else t(e,i);v=n,f=e}function i(){w.point=e}function n(){_[0]=u,_[1]=d,w.point=t,v=null}function r(t,i){if(v){var n=t-f;b+=ca(n)>180?n+(n>0?360:-360):n}else g=t,m=i;ml.point(t,i),e(t,i)}function s(){ml.lineStart()}function o(){r(g,m),ml.lineEnd(),ca(b)>$a&&(u=-(d=180)),_[0]=u,_[1]=d,v=null}function a(t,e){return(e-=t)<0?e+360:e}function l(t,e){return t[0]-e[0]}function c(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var u,h,d,p,f,g,m,v,b,y,_,w={point:t,lineStart:i,lineEnd:n,polygonStart:function(){w.point=r,w.lineStart=s,w.lineEnd=o,b=0,ml.polygonStart()},polygonEnd:function(){ml.polygonEnd(),w.point=t,w.lineStart=i,w.lineEnd=n,0>gl?(u=-(d=180),h=-(p=90)):b>$a?p=90:-$a>b&&(h=-90),_[0]=u,_[1]=d}};return function(t){p=d=-(u=h=1/0),y=[],Ko.geo.stream(t,w);var e=y.length;if(e){y.sort(l);for(var i,n=1,r=y[0],s=[r];e>n;++n)i=y[n],c(i[0],r)||c(i[1],r)?(a(r[0],i[1])>a(r[0],r[1])&&(r[1]=i[1]),a(i[0],r[1])>a(r[0],r[1])&&(r[0]=i[0])):s.push(r=i);for(var o,i,f=-1/0,e=s.length-1,n=0,r=s[e];e>=n;r=i,++n)i=s[n],(o=a(r[1],i[0]))>f&&(f=o,u=i[0],d=r[1])}return y=_=null,1/0===u||1/0===h?[[0/0,0/0],[0/0,0/0]]:[[u,h],[d,p]]}}(),Ko.geo.centroid=function(t){vl=bl=yl=_l=wl=xl=kl=Cl=Al=Tl=Sl=0,Ko.geo.stream(t,Ml);var e=Al,i=Tl,n=Sl,r=e*e+i*i+n*n;return Ea>r&&(e=xl,i=kl,n=Cl,$a>bl&&(e=yl,i=_l,n=wl),r=e*e+i*i+n*n,Ea>r)?[0/0,0/0]:[Math.atan2(i,e)*Ia,te(n/Math.sqrt(r))*Ia]};var vl,bl,yl,_l,wl,xl,kl,Cl,Al,Tl,Sl,Ml={sphere:b,point:xi,lineStart:Ci,lineEnd:Ai,polygonStart:function(){Ml.lineStart=Ti},polygonEnd:function(){Ml.lineStart=Ci}},Dl=Ei(Si,Fi,Bi,[-Sa,-Sa/2]),$l=1e9;Ko.geo.clipExtent=function(){var t,e,i,n,r,s,o={stream:function(t){return r&&(r.valid=!1),r=s(t),r.valid=!0,r},extent:function(a){return arguments.length?(s=Hi(t=+a[0][0],e=+a[0][1],i=+a[1][0],n=+a[1][1]),r&&(r.valid=!1,r=null),o):[[t,e],[i,n]]}};return o.extent([[0,0],[960,500]])},(Ko.geo.conicEqualArea=function(){return ji(qi)}).raw=qi,Ko.geo.albers=function(){return Ko.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},Ko.geo.albersUsa=function(){function t(t){var s=t[0],o=t[1];return e=null,i(s,o),e||(n(s,o),e)||r(s,o),e}var e,i,n,r,s=Ko.geo.albers(),o=Ko.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a=Ko.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(t,i){e=[t,i]}};return t.invert=function(t){var e=s.scale(),i=s.translate(),n=(t[0]-i[0])/e,r=(t[1]-i[1])/e;return(r>=.12&&.234>r&&n>=-.425&&-.214>n?o:r>=.166&&.234>r&&n>=-.214&&-.115>n?a:s).invert(t)},t.stream=function(t){var e=s.stream(t),i=o.stream(t),n=a.stream(t);return{point:function(t,r){e.point(t,r),i.point(t,r),n.point(t,r)},sphere:function(){e.sphere(),i.sphere(),n.sphere()},lineStart:function(){e.lineStart(),i.lineStart(),n.lineStart()},lineEnd:function(){e.lineEnd(),i.lineEnd(),n.lineEnd()},polygonStart:function(){e.polygonStart(),i.polygonStart(),n.polygonStart()},polygonEnd:function(){e.polygonEnd(),i.polygonEnd(),n.polygonEnd()}}},t.precision=function(e){return arguments.length?(s.precision(e),o.precision(e),a.precision(e),t):s.precision()},t.scale=function(e){return arguments.length?(s.scale(e),o.scale(.35*e),a.scale(e),t.translate(s.translate())):s.scale()},t.translate=function(e){if(!arguments.length)return s.translate();var c=s.scale(),u=+e[0],h=+e[1];return i=s.translate(e).clipExtent([[u-.455*c,h-.238*c],[u+.455*c,h+.238*c]]).stream(l).point,n=o.translate([u-.307*c,h+.201*c]).clipExtent([[u-.425*c+$a,h+.12*c+$a],[u-.214*c-$a,h+.234*c-$a]]).stream(l).point,r=a.translate([u-.205*c,h+.212*c]).clipExtent([[u-.214*c+$a,h+.166*c+$a],[u-.115*c-$a,h+.234*c-$a]]).stream(l).point,t},t.scale(1070)};var El,Pl,Il,Nl,Fl,Ol,Bl={point:b,lineStart:b,lineEnd:b,polygonStart:function(){Pl=0,Bl.lineStart=Vi},polygonEnd:function(){Bl.lineStart=Bl.lineEnd=Bl.point=b,El+=ca(Pl/2)}},zl={point:Ui,lineStart:b,lineEnd:b,polygonStart:b,polygonEnd:b},Rl={point:Ki,lineStart:Ji,lineEnd:Xi,polygonStart:function(){Rl.lineStart=Qi},polygonEnd:function(){Rl.point=Ki,Rl.lineStart=Ji,Rl.lineEnd=Xi}};Ko.geo.path=function(){function t(t){return t&&("function"==typeof a&&s.pointRadius(+a.apply(this,arguments)),o&&o.valid||(o=r(s)),Ko.geo.stream(t,o)),s.result()}function e(){return o=null,t}var i,n,r,s,o,a=4.5;return t.area=function(t){return El=0,Ko.geo.stream(t,r(Bl)),El},t.centroid=function(t){return yl=_l=wl=xl=kl=Cl=Al=Tl=Sl=0,Ko.geo.stream(t,r(Rl)),Sl?[Al/Sl,Tl/Sl]:Cl?[xl/Cl,kl/Cl]:wl?[yl/wl,_l/wl]:[0/0,0/0]},t.bounds=function(t){return Fl=Ol=-(Il=Nl=1/0),Ko.geo.stream(t,r(zl)),[[Il,Nl],[Fl,Ol]]},t.projection=function(t){return arguments.length?(r=(i=t)?t.stream||en(t):Te,e()):i},t.context=function(t){return arguments.length?(s=null==(n=t)?new Yi:new Zi(t),"function"!=typeof a&&s.pointRadius(a),e()):n},t.pointRadius=function(e){return arguments.length?(a="function"==typeof e?e:(s.pointRadius(+e),+e),t):a},t.projection(Ko.geo.albersUsa()).context(null)},Ko.geo.transform=function(t){return{stream:function(e){var i=new nn(e);for(var n in t)i[n]=t[n];return i}}},nn.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},Ko.geo.projection=sn,Ko.geo.projectionMutator=on,(Ko.geo.equirectangular=function(){return sn(ln)}).raw=ln.invert=ln,Ko.geo.rotation=function(t){function e(e){return e=t(e[0]*Pa,e[1]*Pa),e[0]*=Ia,e[1]*=Ia,e}return t=un(t[0]%360*Pa,t[1]*Pa,t.length>2?t[2]*Pa:0),e.invert=function(e){return e=t.invert(e[0]*Pa,e[1]*Pa),e[0]*=Ia,e[1]*=Ia,e},e},cn.invert=ln,Ko.geo.circle=function(){function t(){var t="function"==typeof n?n.apply(this,arguments):n,e=un(-t[0]*Pa,-t[1]*Pa,0).invert,r=[];return i(null,null,1,{point:function(t,i){r.push(t=e(t,i)),t[0]*=Ia,t[1]*=Ia}}),{type:"Polygon",coordinates:[r]}}var e,i,n=[0,0],r=6;return t.origin=function(e){return arguments.length?(n=e,t):n},t.angle=function(n){return arguments.length?(i=fn((e=+n)*Pa,r*Pa),t):e},t.precision=function(n){return arguments.length?(i=fn(e*Pa,(r=+n)*Pa),t):r},t.angle(90)},Ko.geo.distance=function(t,e){var i,n=(e[0]-t[0])*Pa,r=t[1]*Pa,s=e[1]*Pa,o=Math.sin(n),a=Math.cos(n),l=Math.sin(r),c=Math.cos(r),u=Math.sin(s),h=Math.cos(s);return Math.atan2(Math.sqrt((i=h*o)*i+(i=c*u-l*h*a)*i),l*u+c*h*a)},Ko.geo.graticule=function(){function t(){return{type:"MultiLineString",coordinates:e()}}function e(){return Ko.range(Math.ceil(s/m)*m,r,m).map(d).concat(Ko.range(Math.ceil(c/v)*v,l,v).map(p)).concat(Ko.range(Math.ceil(n/f)*f,i,f).filter(function(t){return ca(t%m)>$a}).map(u)).concat(Ko.range(Math.ceil(a/g)*g,o,g).filter(function(t){return ca(t%v)>$a}).map(h))}var i,n,r,s,o,a,l,c,u,h,d,p,f=10,g=f,m=90,v=360,b=2.5;return t.lines=function(){return e().map(function(t){return{type:"LineString",coordinates:t}})},t.outline=function(){return{type:"Polygon",coordinates:[d(s).concat(p(l).slice(1),d(r).reverse().slice(1),p(c).reverse().slice(1))]}},t.extent=function(e){return arguments.length?t.majorExtent(e).minorExtent(e):t.minorExtent()},t.majorExtent=function(e){return arguments.length?(s=+e[0][0],r=+e[1][0],c=+e[0][1],l=+e[1][1],s>r&&(e=s,s=r,r=e),c>l&&(e=c,c=l,l=e),t.precision(b)):[[s,c],[r,l]]},t.minorExtent=function(e){return arguments.length?(n=+e[0][0],i=+e[1][0],a=+e[0][1],o=+e[1][1],n>i&&(e=n,n=i,i=e),a>o&&(e=a,a=o,o=e),t.precision(b)):[[n,a],[i,o]]},t.step=function(e){return arguments.length?t.majorStep(e).minorStep(e):t.minorStep()},t.majorStep=function(e){return arguments.length?(m=+e[0],v=+e[1],t):[m,v]},t.minorStep=function(e){return arguments.length?(f=+e[0],g=+e[1],t):[f,g]},t.precision=function(e){return arguments.length?(b=+e,u=mn(a,o,90),h=vn(n,i,b),d=mn(c,l,90),p=vn(s,r,b),t):b},t.majorExtent([[-180,-90+$a],[180,90-$a]]).minorExtent([[-180,-80-$a],[180,80+$a]])},Ko.geo.greatArc=function(){function t(){return{type:"LineString",coordinates:[e||n.apply(this,arguments),i||r.apply(this,arguments)]}}var e,i,n=bn,r=yn;return t.distance=function(){return Ko.geo.distance(e||n.apply(this,arguments),i||r.apply(this,arguments))},t.source=function(i){return arguments.length?(n=i,e="function"==typeof i?null:i,t):n},t.target=function(e){return arguments.length?(r=e,i="function"==typeof e?null:e,t):r},t.precision=function(){return arguments.length?t:0},t},Ko.geo.interpolate=function(t,e){return _n(t[0]*Pa,t[1]*Pa,e[0]*Pa,e[1]*Pa)},Ko.geo.length=function(t){return Ll=0,Ko.geo.stream(t,Hl),Ll};var Ll,Hl={sphere:b,point:b,lineStart:wn,lineEnd:b,polygonStart:b,polygonEnd:b},Wl=xn(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(Ko.geo.azimuthalEqualArea=function(){return sn(Wl)}).raw=Wl;var jl=xn(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},Te);(Ko.geo.azimuthalEquidistant=function(){return sn(jl)}).raw=jl,(Ko.geo.conicConformal=function(){return ji(kn)}).raw=kn,(Ko.geo.conicEquidistant=function(){return ji(Cn)}).raw=Cn;var ql=xn(function(t){return 1/t},Math.atan);(Ko.geo.gnomonic=function(){return sn(ql)}).raw=ql,An.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-Da]},(Ko.geo.mercator=function(){return Tn(An)}).raw=An;var Vl=xn(function(){return 1},Math.asin);(Ko.geo.orthographic=function(){return sn(Vl)}).raw=Vl;var Ul=xn(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});(Ko.geo.stereographic=function(){return sn(Ul)}).raw=Ul,Sn.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-Da]},(Ko.geo.transverseMercator=function(){var t=Tn(Sn),e=t.center,i=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])},t.rotate=function(t){return t?i([t[0],t[1],t.length>2?t[2]+90:90]):(t=i(),[t[0],t[1],t[2]-90])},i([0,0,90])}).raw=Sn,Ko.geom={},Ko.geom.hull=function(t){function e(t){if(t.length<3)return[];var e,r=Ae(i),s=Ae(n),o=t.length,a=[],l=[];for(e=0;o>e;e++)a.push([+r.call(this,t[e],e),+s.call(this,t[e],e),e]);for(a.sort(En),e=0;o>e;e++)l.push([a[e][0],-a[e][1]]);var c=$n(a),u=$n(l),h=u[0]===c[0],d=u[u.length-1]===c[c.length-1],p=[];for(e=c.length-1;e>=0;--e)p.push(t[a[c[e]][2]]);for(e=+h;e<u.length-d;++e)p.push(t[a[u[e]][2]]);return p}var i=Mn,n=Dn;return arguments.length?e(t):(e.x=function(t){return arguments.length?(i=t,e):i},e.y=function(t){return arguments.length?(n=t,e):n},e)},Ko.geom.polygon=function(t){return fa(t,Yl),t};var Yl=Ko.geom.polygon.prototype=[];Yl.area=function(){for(var t,e=-1,i=this.length,n=this[i-1],r=0;++e<i;)t=n,n=this[e],r+=t[1]*n[0]-t[0]*n[1];return.5*r},Yl.centroid=function(t){var e,i,n=-1,r=this.length,s=0,o=0,a=this[r-1];for(arguments.length||(t=-1/(6*this.area()));++n<r;)e=a,a=this[n],i=e[0]*a[1]-a[0]*e[1],s+=(e[0]+a[0])*i,o+=(e[1]+a[1])*i;return[s*t,o*t]},Yl.clip=function(t){for(var e,i,n,r,s,o,a=Nn(t),l=-1,c=this.length-Nn(this),u=this[c-1];++l<c;){for(e=t.slice(),t.length=0,r=this[l],s=e[(n=e.length-a)-1],i=-1;++i<n;)o=e[i],Pn(o,u,r)?(Pn(s,u,r)||t.push(In(s,o,u,r)),t.push(o)):Pn(s,u,r)&&t.push(In(s,o,u,r)),s=o;a&&t.push(t[0]),u=r}return t};var Gl,Kl,Jl,Xl,Ql,Zl=[],tc=[];Wn.prototype.prepare=function(){for(var t,e=this.edges,i=e.length;i--;)t=e[i].edge,t.b&&t.a||e.splice(i,1);return e.sort(qn),e.length},tr.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},er.prototype={insert:function(t,e){var i,n,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;i=t}else this._?(t=sr(this._),e.P=null,e.N=t,t.P=t.L=e,i=t):(e.P=e.N=null,this._=e,i=null);for(e.L=e.R=null,e.U=i,e.C=!0,t=e;i&&i.C;)n=i.U,i===n.L?(r=n.R,r&&r.C?(i.C=r.C=!1,n.C=!0,t=n):(t===i.R&&(nr(this,i),t=i,i=t.U),i.C=!1,n.C=!0,rr(this,n))):(r=n.L,r&&r.C?(i.C=r.C=!1,n.C=!0,t=n):(t===i.L&&(rr(this,i),t=i,i=t.U),i.C=!1,n.C=!0,nr(this,n))),i=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,i,n,r=t.U,s=t.L,o=t.R;if(i=s?o?sr(o):s:o,r?r.L===t?r.L=i:r.R=i:this._=i,s&&o?(n=i.C,i.C=t.C,i.L=s,s.U=i,i!==o?(r=i.U,i.U=t.U,t=i.R,r.L=t,i.R=o,o.U=i):(i.U=r,r=i,t=i.R)):(n=t.C,t=i),t&&(t.U=r),!n){if(t&&t.C)return void(t.C=!1);do{if(t===this._)break;if(t===r.L){if(e=r.R,e.C&&(e.C=!1,r.C=!0,nr(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,rr(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,nr(this,r),t=this._;break}}else if(e=r.L,e.C&&(e.C=!1,r.C=!0,rr(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,nr(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,rr(this,r),t=this._;
break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}},Ko.geom.voronoi=function(t){function e(t){var e=new Array(t.length),n=a[0][0],r=a[0][1],s=a[1][0],o=a[1][1];return or(i(t),a).cells.forEach(function(i,a){var l=i.edges,c=i.site,u=e[a]=l.length?l.map(function(t){var e=t.start();return[e.x,e.y]}):c.x>=n&&c.x<=s&&c.y>=r&&c.y<=o?[[n,o],[s,o],[s,r],[n,r]]:[];u.point=t[a]}),e}function i(t){return t.map(function(t,e){return{x:Math.round(s(t,e)/$a)*$a,y:Math.round(o(t,e)/$a)*$a,i:e}})}var n=Mn,r=Dn,s=n,o=r,a=ec;return t?e(t):(e.links=function(t){return or(i(t)).edges.filter(function(t){return t.l&&t.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})},e.triangles=function(t){var e=[];return or(i(t)).cells.forEach(function(i,n){for(var r,s,o=i.site,a=i.edges.sort(qn),l=-1,c=a.length,u=a[c-1].edge,h=u.l===o?u.r:u.l;++l<c;)r=u,s=h,u=a[l].edge,h=u.l===o?u.r:u.l,n<s.i&&n<h.i&&lr(o,s,h)<0&&e.push([t[n],t[s.i],t[h.i]])}),e},e.x=function(t){return arguments.length?(s=Ae(n=t),e):n},e.y=function(t){return arguments.length?(o=Ae(r=t),e):r},e.clipExtent=function(t){return arguments.length?(a=null==t?ec:t,e):a===ec?null:a},e.size=function(t){return arguments.length?e.clipExtent(t&&[[0,0],t]):a===ec?null:a&&a[1]},e)};var ec=[[-1e6,-1e6],[1e6,1e6]];Ko.geom.delaunay=function(t){return Ko.geom.voronoi().triangles(t)},Ko.geom.quadtree=function(t,e,i,n,r){function s(t){function s(t,e,i,n,r,s,o,a){if(!isNaN(i)&&!isNaN(n))if(t.leaf){var l=t.x,u=t.y;if(null!=l)if(ca(l-i)+ca(u-n)<.01)c(t,e,i,n,r,s,o,a);else{var h=t.point;t.x=t.y=t.point=null,c(t,h,l,u,r,s,o,a),c(t,e,i,n,r,s,o,a)}else t.x=i,t.y=n,t.point=e}else c(t,e,i,n,r,s,o,a)}function c(t,e,i,n,r,o,a,l){var c=.5*(r+a),u=.5*(o+l),h=i>=c,d=n>=u,p=(d<<1)+h;t.leaf=!1,t=t.nodes[p]||(t.nodes[p]=hr()),h?r=c:a=c,d?o=u:l=u,s(t,e,i,n,r,o,a,l)}var u,h,d,p,f,g,m,v,b,y=Ae(a),_=Ae(l);if(null!=e)g=e,m=i,v=n,b=r;else if(v=b=-(g=m=1/0),h=[],d=[],f=t.length,o)for(p=0;f>p;++p)u=t[p],u.x<g&&(g=u.x),u.y<m&&(m=u.y),u.x>v&&(v=u.x),u.y>b&&(b=u.y),h.push(u.x),d.push(u.y);else for(p=0;f>p;++p){var w=+y(u=t[p],p),x=+_(u,p);g>w&&(g=w),m>x&&(m=x),w>v&&(v=w),x>b&&(b=x),h.push(w),d.push(x)}var k=v-g,C=b-m;k>C?b=m+k:v=g+C;var A=hr();if(A.add=function(t){s(A,t,+y(t,++p),+_(t,p),g,m,v,b)},A.visit=function(t){dr(t,A,g,m,v,b)},p=-1,null==e){for(;++p<f;)s(A,t[p],h[p],d[p],g,m,v,b);--p}else t.forEach(A.add);return h=d=t=u=null,A}var o,a=Mn,l=Dn;return(o=arguments.length)?(a=cr,l=ur,3===o&&(r=i,n=e,i=e=0),s(t)):(s.x=function(t){return arguments.length?(a=t,s):a},s.y=function(t){return arguments.length?(l=t,s):l},s.extent=function(t){return arguments.length?(null==t?e=i=n=r=null:(e=+t[0][0],i=+t[0][1],n=+t[1][0],r=+t[1][1]),s):null==e?null:[[e,i],[n,r]]},s.size=function(t){return arguments.length?(null==t?e=i=n=r=null:(e=i=0,n=+t[0],r=+t[1]),s):null==e?null:[n-e,r-i]},s)},Ko.interpolateRgb=pr,Ko.interpolateObject=fr,Ko.interpolateNumber=gr,Ko.interpolateString=mr;var ic=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,nc=new RegExp(ic.source,"g");Ko.interpolate=vr,Ko.interpolators=[function(t,e){var i=typeof e;return("string"===i?Ga.has(e)||/^(#|rgb\(|hsl\()/.test(e)?pr:mr:e instanceof se?pr:Array.isArray(e)?br:"object"===i&&isNaN(e)?fr:gr)(t,e)}],Ko.interpolateArray=br;var rc=function(){return Te},sc=Ko.map({linear:rc,poly:Ar,quad:function(){return xr},cubic:function(){return kr},sin:function(){return Tr},exp:function(){return Sr},circle:function(){return Mr},elastic:Dr,back:$r,bounce:function(){return Er}}),oc=Ko.map({"in":Te,out:_r,"in-out":wr,"out-in":function(t){return wr(_r(t))}});Ko.ease=function(t){var e=t.indexOf("-"),i=e>=0?t.slice(0,e):t,n=e>=0?t.slice(e+1):"in";return i=sc.get(i)||rc,n=oc.get(n)||Te,yr(n(i.apply(null,Jo.call(arguments,1))))},Ko.interpolateHcl=Pr,Ko.interpolateHsl=Ir,Ko.interpolateLab=Nr,Ko.interpolateRound=Fr,Ko.transform=function(t){var e=Qo.createElementNS(Ko.ns.prefix.svg,"g");return(Ko.transform=function(t){if(null!=t){e.setAttribute("transform",t);var i=e.transform.baseVal.consolidate()}return new Or(i?i.matrix:ac)})(t)},Or.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ac={a:1,b:0,c:0,d:1,e:0,f:0};Ko.interpolateTransform=Lr,Ko.layout={},Ko.layout.bundle=function(){return function(t){for(var e=[],i=-1,n=t.length;++i<n;)e.push(jr(t[i]));return e}},Ko.layout.chord=function(){function t(){var t,c,h,d,p,f={},g=[],m=Ko.range(s),v=[];for(i=[],n=[],t=0,d=-1;++d<s;){for(c=0,p=-1;++p<s;)c+=r[d][p];g.push(c),v.push(Ko.range(s)),t+=c}for(o&&m.sort(function(t,e){return o(g[t],g[e])}),a&&v.forEach(function(t,e){t.sort(function(t,i){return a(r[e][t],r[e][i])})}),t=(Ma-u*s)/t,c=0,d=-1;++d<s;){for(h=c,p=-1;++p<s;){var b=m[d],y=v[b][p],_=r[b][y],w=c,x=c+=_*t;f[b+"-"+y]={index:b,subindex:y,startAngle:w,endAngle:x,value:_}}n[b]={index:b,startAngle:h,endAngle:c,value:(c-h)/t},c+=u}for(d=-1;++d<s;)for(p=d-1;++p<s;){var k=f[d+"-"+p],C=f[p+"-"+d];(k.value||C.value)&&i.push(k.value<C.value?{source:C,target:k}:{source:k,target:C})}l&&e()}function e(){i.sort(function(t,e){return l((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}var i,n,r,s,o,a,l,c={},u=0;return c.matrix=function(t){return arguments.length?(s=(r=t)&&r.length,i=n=null,c):r},c.padding=function(t){return arguments.length?(u=t,i=n=null,c):u},c.sortGroups=function(t){return arguments.length?(o=t,i=n=null,c):o},c.sortSubgroups=function(t){return arguments.length?(a=t,i=null,c):a},c.sortChords=function(t){return arguments.length?(l=t,i&&e(),c):l},c.chords=function(){return i||t(),i},c.groups=function(){return n||t(),n},c},Ko.layout.force=function(){function t(t){return function(e,i,n,r){if(e.point!==t){var s=e.cx-t.x,o=e.cy-t.y,a=r-i,l=s*s+o*o;if(l>a*a/m){if(f>l){var c=e.charge/l;t.px-=s*c,t.py-=o*c}return!0}if(e.point&&l&&f>l){var c=e.pointCharge/l;t.px-=s*c,t.py-=o*c}}return!e.charge}}function e(t){t.px=Ko.event.x,t.py=Ko.event.y,a.resume()}var i,n,r,s,o,a={},l=Ko.dispatch("start","tick","end"),c=[1,1],u=.9,h=lc,d=cc,p=-30,f=uc,g=.1,m=.64,v=[],b=[];return a.tick=function(){if((n*=.99)<.005)return l.end({type:"end",alpha:n=0}),!0;var e,i,a,h,d,f,m,y,_,w=v.length,x=b.length;for(i=0;x>i;++i)a=b[i],h=a.source,d=a.target,y=d.x-h.x,_=d.y-h.y,(f=y*y+_*_)&&(f=n*s[i]*((f=Math.sqrt(f))-r[i])/f,y*=f,_*=f,d.x-=y*(m=h.weight/(d.weight+h.weight)),d.y-=_*m,h.x+=y*(m=1-m),h.y+=_*m);if((m=n*g)&&(y=c[0]/2,_=c[1]/2,i=-1,m))for(;++i<w;)a=v[i],a.x+=(y-a.x)*m,a.y+=(_-a.y)*m;if(p)for(Jr(e=Ko.geom.quadtree(v),n,o),i=-1;++i<w;)(a=v[i]).fixed||e.visit(t(a));for(i=-1;++i<w;)a=v[i],a.fixed?(a.x=a.px,a.y=a.py):(a.x-=(a.px-(a.px=a.x))*u,a.y-=(a.py-(a.py=a.y))*u);l.tick({type:"tick",alpha:n})},a.nodes=function(t){return arguments.length?(v=t,a):v},a.links=function(t){return arguments.length?(b=t,a):b},a.size=function(t){return arguments.length?(c=t,a):c},a.linkDistance=function(t){return arguments.length?(h="function"==typeof t?t:+t,a):h},a.distance=a.linkDistance,a.linkStrength=function(t){return arguments.length?(d="function"==typeof t?t:+t,a):d},a.friction=function(t){return arguments.length?(u=+t,a):u},a.charge=function(t){return arguments.length?(p="function"==typeof t?t:+t,a):p},a.chargeDistance=function(t){return arguments.length?(f=t*t,a):Math.sqrt(f)},a.gravity=function(t){return arguments.length?(g=+t,a):g},a.theta=function(t){return arguments.length?(m=t*t,a):Math.sqrt(m)},a.alpha=function(t){return arguments.length?(t=+t,n?n=t>0?t:0:t>0&&(l.start({type:"start",alpha:n=t}),Ko.timer(a.tick)),a):n},a.start=function(){function t(t,n){if(!i){for(i=new Array(l),a=0;l>a;++a)i[a]=[];for(a=0;c>a;++a){var r=b[a];i[r.source.index].push(r.target),i[r.target.index].push(r.source)}}for(var s,o=i[e],a=-1,c=o.length;++a<c;)if(!isNaN(s=o[a][t]))return s;return Math.random()*n}var e,i,n,l=v.length,u=b.length,f=c[0],g=c[1];for(e=0;l>e;++e)(n=v[e]).index=e,n.weight=0;for(e=0;u>e;++e)n=b[e],"number"==typeof n.source&&(n.source=v[n.source]),"number"==typeof n.target&&(n.target=v[n.target]),++n.source.weight,++n.target.weight;for(e=0;l>e;++e)n=v[e],isNaN(n.x)&&(n.x=t("x",f)),isNaN(n.y)&&(n.y=t("y",g)),isNaN(n.px)&&(n.px=n.x),isNaN(n.py)&&(n.py=n.y);if(r=[],"function"==typeof h)for(e=0;u>e;++e)r[e]=+h.call(this,b[e],e);else for(e=0;u>e;++e)r[e]=h;if(s=[],"function"==typeof d)for(e=0;u>e;++e)s[e]=+d.call(this,b[e],e);else for(e=0;u>e;++e)s[e]=d;if(o=[],"function"==typeof p)for(e=0;l>e;++e)o[e]=+p.call(this,v[e],e);else for(e=0;l>e;++e)o[e]=p;return a.resume()},a.resume=function(){return a.alpha(.1)},a.stop=function(){return a.alpha(0)},a.drag=function(){return i||(i=Ko.behavior.drag().origin(Te).on("dragstart.force",Ur).on("drag.force",e).on("dragend.force",Yr)),arguments.length?void this.on("mouseover.force",Gr).on("mouseout.force",Kr).call(i):i},Ko.rebind(a,l,"on")};var lc=20,cc=1,uc=1/0;Ko.layout.hierarchy=function(){function t(r){var s,o=[r],a=[];for(r.depth=0;null!=(s=o.pop());)if(a.push(s),(c=i.call(t,s,s.depth))&&(l=c.length)){for(var l,c,u;--l>=0;)o.push(u=c[l]),u.parent=s,u.depth=s.depth+1;n&&(s.value=0),s.children=c}else n&&(s.value=+n.call(t,s,s.depth)||0),delete s.children;return Zr(r,function(t){var i,r;e&&(i=t.children)&&i.sort(e),n&&(r=t.parent)&&(r.value+=t.value)}),a}var e=is,i=ts,n=es;return t.sort=function(i){return arguments.length?(e=i,t):e},t.children=function(e){return arguments.length?(i=e,t):i},t.value=function(e){return arguments.length?(n=e,t):n},t.revalue=function(e){return n&&(Qr(e,function(t){t.children&&(t.value=0)}),Zr(e,function(e){var i;e.children||(e.value=+n.call(t,e,e.depth)||0),(i=e.parent)&&(i.value+=e.value)})),e},t},Ko.layout.partition=function(){function t(e,i,n,r){var s=e.children;if(e.x=i,e.y=e.depth*r,e.dx=n,e.dy=r,s&&(o=s.length)){var o,a,l,c=-1;for(n=e.value?n/e.value:0;++c<o;)t(a=s[c],i,l=a.value*n,r),i+=l}}function e(t){var i=t.children,n=0;if(i&&(r=i.length))for(var r,s=-1;++s<r;)n=Math.max(n,e(i[s]));return 1+n}function i(i,s){var o=n.call(this,i,s);return t(o[0],0,r[0],r[1]/e(o[0])),o}var n=Ko.layout.hierarchy(),r=[1,1];return i.size=function(t){return arguments.length?(r=t,i):r},Xr(i,n)},Ko.layout.pie=function(){function t(s){var o=s.map(function(i,n){return+e.call(t,i,n)}),a=+("function"==typeof n?n.apply(this,arguments):n),l=(("function"==typeof r?r.apply(this,arguments):r)-a)/Ko.sum(o),c=Ko.range(s.length);null!=i&&c.sort(i===hc?function(t,e){return o[e]-o[t]}:function(t,e){return i(s[t],s[e])});var u=[];return c.forEach(function(t){var e;u[t]={data:s[t],value:e=o[t],startAngle:a,endAngle:a+=e*l}}),u}var e=Number,i=hc,n=0,r=Ma;return t.value=function(i){return arguments.length?(e=i,t):e},t.sort=function(e){return arguments.length?(i=e,t):i},t.startAngle=function(e){return arguments.length?(n=e,t):n},t.endAngle=function(e){return arguments.length?(r=e,t):r},t};var hc={};Ko.layout.stack=function(){function t(a,l){if(!(d=a.length))return a;var c=a.map(function(i,n){return e.call(t,i,n)}),u=c.map(function(e){return e.map(function(e,i){return[s.call(t,e,i),o.call(t,e,i)]})}),h=i.call(t,u,l);c=Ko.permute(c,h),u=Ko.permute(u,h);var d,p,f,g,m=n.call(t,u,l),v=c[0].length;for(f=0;v>f;++f)for(r.call(t,c[0][f],g=m[f],u[0][f][1]),p=1;d>p;++p)r.call(t,c[p][f],g+=u[p-1][f][1],u[p][f][1]);return a}var e=Te,i=as,n=ls,r=os,s=rs,o=ss;return t.values=function(i){return arguments.length?(e=i,t):e},t.order=function(e){return arguments.length?(i="function"==typeof e?e:dc.get(e)||as,t):i},t.offset=function(e){return arguments.length?(n="function"==typeof e?e:pc.get(e)||ls,t):n},t.x=function(e){return arguments.length?(s=e,t):s},t.y=function(e){return arguments.length?(o=e,t):o},t.out=function(e){return arguments.length?(r=e,t):r},t};var dc=Ko.map({"inside-out":function(t){var e,i,n=t.length,r=t.map(cs),s=t.map(us),o=Ko.range(n).sort(function(t,e){return r[t]-r[e]}),a=0,l=0,c=[],u=[];for(e=0;n>e;++e)i=o[e],l>a?(a+=s[i],c.push(i)):(l+=s[i],u.push(i));return u.reverse().concat(c)},reverse:function(t){return Ko.range(t.length).reverse()},"default":as}),pc=Ko.map({silhouette:function(t){var e,i,n,r=t.length,s=t[0].length,o=[],a=0,l=[];for(i=0;s>i;++i){for(e=0,n=0;r>e;e++)n+=t[e][i][1];n>a&&(a=n),o.push(n)}for(i=0;s>i;++i)l[i]=(a-o[i])/2;return l},wiggle:function(t){var e,i,n,r,s,o,a,l,c,u=t.length,h=t[0],d=h.length,p=[];for(p[0]=l=c=0,i=1;d>i;++i){for(e=0,r=0;u>e;++e)r+=t[e][i][1];for(e=0,s=0,a=h[i][0]-h[i-1][0];u>e;++e){for(n=0,o=(t[e][i][1]-t[e][i-1][1])/(2*a);e>n;++n)o+=(t[n][i][1]-t[n][i-1][1])/a;s+=o*t[e][i][1]}p[i]=l-=r?s/r*a:0,c>l&&(c=l)}for(i=0;d>i;++i)p[i]-=c;return p},expand:function(t){var e,i,n,r=t.length,s=t[0].length,o=1/r,a=[];for(i=0;s>i;++i){for(e=0,n=0;r>e;e++)n+=t[e][i][1];if(n)for(e=0;r>e;e++)t[e][i][1]/=n;else for(e=0;r>e;e++)t[e][i][1]=o}for(i=0;s>i;++i)a[i]=0;return a},zero:ls});Ko.layout.histogram=function(){function t(t,s){for(var o,a,l=[],c=t.map(i,this),u=n.call(this,c,s),h=r.call(this,u,c,s),s=-1,d=c.length,p=h.length-1,f=e?1:1/d;++s<p;)o=l[s]=[],o.dx=h[s+1]-(o.x=h[s]),o.y=0;if(p>0)for(s=-1;++s<d;)a=c[s],a>=u[0]&&a<=u[1]&&(o=l[Ko.bisect(h,a,1,p)-1],o.y+=f,o.push(t[s]));return l}var e=!0,i=Number,n=fs,r=ds;return t.value=function(e){return arguments.length?(i=e,t):i},t.range=function(e){return arguments.length?(n=Ae(e),t):n},t.bins=function(e){return arguments.length?(r="number"==typeof e?function(t){return ps(t,e)}:Ae(e),t):r},t.frequency=function(i){return arguments.length?(e=!!i,t):e},t},Ko.layout.pack=function(){function t(t,s){var o=i.call(this,t,s),a=o[0],l=r[0],c=r[1],u=null==e?Math.sqrt:"function"==typeof e?e:function(){return e};if(a.x=a.y=0,Zr(a,function(t){t.r=+u(t.value)}),Zr(a,ys),n){var h=n*(e?1:Math.max(2*a.r/l,2*a.r/c))/2;Zr(a,function(t){t.r+=h}),Zr(a,ys),Zr(a,function(t){t.r-=h})}return xs(a,l/2,c/2,e?1:1/Math.max(2*a.r/l,2*a.r/c)),o}var e,i=Ko.layout.hierarchy().sort(gs),n=0,r=[1,1];return t.size=function(e){return arguments.length?(r=e,t):r},t.radius=function(i){return arguments.length?(e=null==i||"function"==typeof i?i:+i,t):e},t.padding=function(e){return arguments.length?(n=+e,t):n},Xr(t,i)},Ko.layout.tree=function(){function t(t,r){var u=o.call(this,t,r),h=u[0],d=e(h);if(Zr(d,i),d.parent.m=-d.z,Qr(d,n),c)Qr(h,s);else{var p=h,f=h,g=h;Qr(h,function(t){t.x<p.x&&(p=t),t.x>f.x&&(f=t),t.depth>g.depth&&(g=t)});var m=a(p,f)/2-p.x,v=l[0]/(f.x+a(f,p)/2+m),b=l[1]/(g.depth||1);Qr(h,function(t){t.x=(t.x+m)*v,t.y=t.depth*b})}return u}function e(t){for(var e,i={A:null,children:[t]},n=[i];null!=(e=n.pop());)for(var r,s=e.children,o=0,a=s.length;a>o;++o)n.push((s[o]=r={_:s[o],parent:e,children:(r=s[o].children)&&r.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=r);return i.children[0]}function i(t){var e=t.children,i=t.parent.children,n=t.i?i[t.i-1]:null;if(e.length){Ms(t);var s=(e[0].z+e[e.length-1].z)/2;n?(t.z=n.z+a(t._,n._),t.m=t.z-s):t.z=s}else n&&(t.z=n.z+a(t._,n._));t.parent.A=r(t,n,t.parent.A||i[0])}function n(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function r(t,e,i){if(e){for(var n,r=t,s=t,o=e,l=r.parent.children[0],c=r.m,u=s.m,h=o.m,d=l.m;o=Ts(o),r=As(r),o&&r;)l=As(l),s=Ts(s),s.a=t,n=o.z+h-r.z-c+a(o._,r._),n>0&&(Ss(Ds(o,t,i),t,n),c+=n,u+=n),h+=o.m,c+=r.m,d+=l.m,u+=s.m;o&&!Ts(s)&&(s.t=o,s.m+=h-u),r&&!As(l)&&(l.t=r,l.m+=c-d,i=t)}return i}function s(t){t.x*=l[0],t.y=t.depth*l[1]}var o=Ko.layout.hierarchy().sort(null).value(null),a=Cs,l=[1,1],c=null;return t.separation=function(e){return arguments.length?(a=e,t):a},t.size=function(e){return arguments.length?(c=null==(l=e)?s:null,t):c?null:l},t.nodeSize=function(e){return arguments.length?(c=null==(l=e)?null:s,t):c?l:null},Xr(t,o)},Ko.layout.cluster=function(){function t(t,s){var o,a=e.call(this,t,s),l=a[0],c=0;Zr(l,function(t){var e=t.children;e&&e.length?(t.x=Es(e),t.y=$s(e)):(t.x=o?c+=i(t,o):0,t.y=0,o=t)});var u=Ps(l),h=Is(l),d=u.x-i(u,h)/2,p=h.x+i(h,u)/2;return Zr(l,r?function(t){t.x=(t.x-l.x)*n[0],t.y=(l.y-t.y)*n[1]}:function(t){t.x=(t.x-d)/(p-d)*n[0],t.y=(1-(l.y?t.y/l.y:1))*n[1]}),a}var e=Ko.layout.hierarchy().sort(null).value(null),i=Cs,n=[1,1],r=!1;return t.separation=function(e){return arguments.length?(i=e,t):i},t.size=function(e){return arguments.length?(r=null==(n=e),t):r?null:n},t.nodeSize=function(e){return arguments.length?(r=null!=(n=e),t):r?n:null},Xr(t,e)},Ko.layout.treemap=function(){function t(t,e){for(var i,n,r=-1,s=t.length;++r<s;)n=(i=t[r]).value*(0>e?0:e),i.area=isNaN(n)||0>=n?0:n}function e(i){var s=i.children;if(s&&s.length){var o,a,l,c=h(i),u=[],d=s.slice(),f=1/0,g="slice"===p?c.dx:"dice"===p?c.dy:"slice-dice"===p?1&i.depth?c.dy:c.dx:Math.min(c.dx,c.dy);for(t(d,c.dx*c.dy/i.value),u.area=0;(l=d.length)>0;)u.push(o=d[l-1]),u.area+=o.area,"squarify"!==p||(a=n(u,g))<=f?(d.pop(),f=a):(u.area-=u.pop().area,r(u,g,c,!1),g=Math.min(c.dx,c.dy),u.length=u.area=0,f=1/0);u.length&&(r(u,g,c,!0),u.length=u.area=0),s.forEach(e)}}function i(e){var n=e.children;if(n&&n.length){var s,o=h(e),a=n.slice(),l=[];for(t(a,o.dx*o.dy/e.value),l.area=0;s=a.pop();)l.push(s),l.area+=s.area,null!=s.z&&(r(l,s.z?o.dx:o.dy,o,!a.length),l.length=l.area=0);n.forEach(i)}}function n(t,e){for(var i,n=t.area,r=0,s=1/0,o=-1,a=t.length;++o<a;)(i=t[o].area)&&(s>i&&(s=i),i>r&&(r=i));return n*=n,e*=e,n?Math.max(e*r*f/n,n/(e*s*f)):1/0}function r(t,e,i,n){var r,s=-1,o=t.length,a=i.x,c=i.y,u=e?l(t.area/e):0;if(e==i.dx){for((n||u>i.dy)&&(u=i.dy);++s<o;)r=t[s],r.x=a,r.y=c,r.dy=u,a+=r.dx=Math.min(i.x+i.dx-a,u?l(r.area/u):0);r.z=!0,r.dx+=i.x+i.dx-a,i.y+=u,i.dy-=u}else{for((n||u>i.dx)&&(u=i.dx);++s<o;)r=t[s],r.x=a,r.y=c,r.dx=u,c+=r.dy=Math.min(i.y+i.dy-c,u?l(r.area/u):0);r.z=!1,r.dy+=i.y+i.dy-c,i.x+=u,i.dx-=u}}function s(n){var r=o||a(n),s=r[0];return s.x=0,s.y=0,s.dx=c[0],s.dy=c[1],o&&a.revalue(s),t([s],s.dx*s.dy/s.value),(o?i:e)(s),d&&(o=r),r}var o,a=Ko.layout.hierarchy(),l=Math.round,c=[1,1],u=null,h=Ns,d=!1,p="squarify",f=.5*(1+Math.sqrt(5));return s.size=function(t){return arguments.length?(c=t,s):c},s.padding=function(t){function e(e){var i=t.call(s,e,e.depth);return null==i?Ns(e):Fs(e,"number"==typeof i?[i,i,i,i]:i)}function i(e){return Fs(e,t)}if(!arguments.length)return u;var n;return h=null==(u=t)?Ns:"function"==(n=typeof t)?e:"number"===n?(t=[t,t,t,t],i):i,s},s.round=function(t){return arguments.length?(l=t?Math.round:Number,s):l!=Number},s.sticky=function(t){return arguments.length?(d=t,o=null,s):d},s.ratio=function(t){return arguments.length?(f=t,s):f},s.mode=function(t){return arguments.length?(p=t+"",s):p},Xr(s,a)},Ko.random={normal:function(t,e){var i=arguments.length;return 2>i&&(e=1),1>i&&(t=0),function(){var i,n,r;do i=2*Math.random()-1,n=2*Math.random()-1,r=i*i+n*n;while(!r||r>1);return t+e*i*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var t=Ko.random.normal.apply(Ko,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=Ko.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(t){return function(){for(var e=0,i=0;t>i;i++)e+=Math.random();return e}}},Ko.scale={};var fc={floor:Te,ceil:Te};Ko.scale.linear=function(){return Ws([0,1],[0,1],vr,!1)};var gc={s:1,g:1,p:1,r:1,e:1};Ko.scale.log=function(){return Js(Ko.scale.linear().domain([0,1]),10,!0,[1,10])};var mc=Ko.format(".0e"),vc={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};Ko.scale.pow=function(){return Xs(Ko.scale.linear(),1,[0,1])},Ko.scale.sqrt=function(){return Ko.scale.pow().exponent(.5)},Ko.scale.ordinal=function(){return Zs([],{t:"range",a:[[]]})},Ko.scale.category10=function(){return Ko.scale.ordinal().range(bc)},Ko.scale.category20=function(){return Ko.scale.ordinal().range(yc)},Ko.scale.category20b=function(){return Ko.scale.ordinal().range(_c)},Ko.scale.category20c=function(){return Ko.scale.ordinal().range(wc)};var bc=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(be),yc=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(be),_c=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(be),wc=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(be);Ko.scale.quantile=function(){return to([],[])},Ko.scale.quantize=function(){return eo(0,1,[0,1])},Ko.scale.threshold=function(){return io([.5],[0,1])},Ko.scale.identity=function(){return no([0,1])},Ko.svg={},Ko.svg.arc=function(){function t(){var t=e.apply(this,arguments),s=i.apply(this,arguments),o=n.apply(this,arguments)+xc,a=r.apply(this,arguments)+xc,l=(o>a&&(l=o,o=a,a=l),a-o),c=Sa>l?"0":"1",u=Math.cos(o),h=Math.sin(o),d=Math.cos(a),p=Math.sin(a);return l>=kc?t?"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+-s+"A"+s+","+s+" 0 1,1 0,"+s+"M0,"+t+"A"+t+","+t+" 0 1,0 0,"+-t+"A"+t+","+t+" 0 1,0 0,"+t+"Z":"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+-s+"A"+s+","+s+" 0 1,1 0,"+s+"Z":t?"M"+s*u+","+s*h+"A"+s+","+s+" 0 "+c+",1 "+s*d+","+s*p+"L"+t*d+","+t*p+"A"+t+","+t+" 0 "+c+",0 "+t*u+","+t*h+"Z":"M"+s*u+","+s*h+"A"+s+","+s+" 0 "+c+",1 "+s*d+","+s*p+"L0,0Z"}var e=ro,i=so,n=oo,r=ao;return t.innerRadius=function(i){return arguments.length?(e=Ae(i),t):e},t.outerRadius=function(e){return arguments.length?(i=Ae(e),t):i},t.startAngle=function(e){return arguments.length?(n=Ae(e),t):n},t.endAngle=function(e){return arguments.length?(r=Ae(e),t):r},t.centroid=function(){var t=(e.apply(this,arguments)+i.apply(this,arguments))/2,s=(n.apply(this,arguments)+r.apply(this,arguments))/2+xc;return[Math.cos(s)*t,Math.sin(s)*t]},t};var xc=-Da,kc=Ma-$a;Ko.svg.line=function(){return lo(Te)};var Cc=Ko.map({linear:co,"linear-closed":uo,step:ho,"step-before":po,"step-after":fo,basis:_o,"basis-open":wo,"basis-closed":xo,bundle:ko,cardinal:vo,"cardinal-open":go,"cardinal-closed":mo,monotone:Do});Cc.forEach(function(t,e){e.key=t,e.closed=/-closed$/.test(t)});var Ac=[0,2/3,1/3,0],Tc=[0,1/3,2/3,0],Sc=[0,1/6,2/3,1/6];Ko.svg.line.radial=function(){var t=lo($o);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},po.reverse=fo,fo.reverse=po,Ko.svg.area=function(){return Eo(Te)},Ko.svg.area.radial=function(){var t=Eo($o);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},Ko.svg.chord=function(){function t(t,a){var l=e(this,s,t,a),c=e(this,o,t,a);return"M"+l.p0+n(l.r,l.p1,l.a1-l.a0)+(i(l,c)?r(l.r,l.p1,l.r,l.p0):r(l.r,l.p1,c.r,c.p0)+n(c.r,c.p1,c.a1-c.a0)+r(c.r,c.p1,l.r,l.p0))+"Z"}function e(t,e,i,n){var r=e.call(t,i,n),s=a.call(t,r,n),o=l.call(t,r,n)+xc,u=c.call(t,r,n)+xc;return{r:s,a0:o,a1:u,p0:[s*Math.cos(o),s*Math.sin(o)],p1:[s*Math.cos(u),s*Math.sin(u)]}}function i(t,e){return t.a0==e.a0&&t.a1==e.a1}function n(t,e,i){return"A"+t+","+t+" 0 "+ +(i>Sa)+",1 "+e}function r(t,e,i,n){return"Q 0,0 "+n}var s=bn,o=yn,a=Po,l=oo,c=ao;return t.radius=function(e){return arguments.length?(a=Ae(e),t):a},t.source=function(e){return arguments.length?(s=Ae(e),t):s},t.target=function(e){return arguments.length?(o=Ae(e),t):o},t.startAngle=function(e){return arguments.length?(l=Ae(e),t):l},t.endAngle=function(e){return arguments.length?(c=Ae(e),t):c},t},Ko.svg.diagonal=function(){function t(t,r){var s=e.call(this,t,r),o=i.call(this,t,r),a=(s.y+o.y)/2,l=[s,{x:s.x,y:a},{x:o.x,y:a},o];return l=l.map(n),"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}var e=bn,i=yn,n=Io;return t.source=function(i){return arguments.length?(e=Ae(i),t):e},t.target=function(e){return arguments.length?(i=Ae(e),t):i},t.projection=function(e){return arguments.length?(n=e,t):n},t},Ko.svg.diagonal.radial=function(){var t=Ko.svg.diagonal(),e=Io,i=t.projection;return t.projection=function(t){return arguments.length?i(No(e=t)):e},t},Ko.svg.symbol=function(){function t(t,n){return(Mc.get(e.call(this,t,n))||Bo)(i.call(this,t,n))}var e=Oo,i=Fo;return t.type=function(i){return arguments.length?(e=Ae(i),t):e},t.size=function(e){return arguments.length?(i=Ae(e),t):i},t};var Mc=Ko.map({circle:Bo,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*Pc)),i=e*Pc;return"M0,"+-e+"L"+i+",0 0,"+e+" "+-i+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/Ec),i=e*Ec/2;return"M0,"+i+"L"+e+","+-i+" "+-e+","+-i+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/Ec),i=e*Ec/2;return"M0,"+-i+"L"+e+","+i+" "+-e+","+i+"Z"}});Ko.svg.symbolTypes=Mc.keys();var Dc,$c,Ec=Math.sqrt(3),Pc=Math.tan(30*Pa),Ic=[],Nc=0;Ic.call=ya.call,Ic.empty=ya.empty,Ic.node=ya.node,Ic.size=ya.size,Ko.transition=function(t){return arguments.length?Dc?t.transition():t:xa.transition()},Ko.transition.prototype=Ic,Ic.select=function(t){var e,i,n,r=this.id,s=[];t=A(t);for(var o=-1,a=this.length;++o<a;){s.push(e=[]);for(var l=this[o],c=-1,u=l.length;++c<u;)(n=l[c])&&(i=t.call(n,n.__data__,c,o))?("__data__"in n&&(i.__data__=n.__data__),Ho(i,c,r,n.__transition__[r]),e.push(i)):e.push(null)}return zo(s,r)},Ic.selectAll=function(t){var e,i,n,r,s,o=this.id,a=[];t=T(t);for(var l=-1,c=this.length;++l<c;)for(var u=this[l],h=-1,d=u.length;++h<d;)if(n=u[h]){s=n.__transition__[o],i=t.call(n,n.__data__,h,l),a.push(e=[]);for(var p=-1,f=i.length;++p<f;)(r=i[p])&&Ho(r,p,o,s),e.push(r)}return zo(a,o)},Ic.filter=function(t){var e,i,n,r=[];"function"!=typeof t&&(t=B(t));for(var s=0,o=this.length;o>s;s++){r.push(e=[]);for(var i=this[s],a=0,l=i.length;l>a;a++)(n=i[a])&&t.call(n,n.__data__,a,s)&&e.push(n)}return zo(r,this.id)},Ic.tween=function(t,e){var i=this.id;return arguments.length<2?this.node().__transition__[i].tween.get(t):R(this,null==e?function(e){e.__transition__[i].tween.remove(t)}:function(n){n.__transition__[i].tween.set(t,e)})},Ic.attr=function(t,e){function i(){this.removeAttribute(a)}function n(){this.removeAttributeNS(a.space,a.local)}function r(t){return null==t?i:(t+="",function(){var e,i=this.getAttribute(a);return i!==t&&(e=o(i,t),function(t){this.setAttribute(a,e(t))})})}function s(t){return null==t?n:(t+="",function(){var e,i=this.getAttributeNS(a.space,a.local);return i!==t&&(e=o(i,t),function(t){this.setAttributeNS(a.space,a.local,e(t))})})}if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var o="transform"==t?Lr:vr,a=Ko.ns.qualify(t);return Ro(this,"attr."+t,e,a.local?s:r)},Ic.attrTween=function(t,e){function i(t,i){var n=e.call(this,t,i,this.getAttribute(r));return n&&function(t){this.setAttribute(r,n(t))}}function n(t,i){var n=e.call(this,t,i,this.getAttributeNS(r.space,r.local));return n&&function(t){this.setAttributeNS(r.space,r.local,n(t))}}var r=Ko.ns.qualify(t);return this.tween("attr."+t,r.local?n:i)},Ic.style=function(t,e,i){function n(){this.style.removeProperty(t)}function r(e){return null==e?n:(e+="",function(){var n,r=ta.getComputedStyle(this,null).getPropertyValue(t);return r!==e&&(n=vr(r,e),function(e){this.style.setProperty(t,n(e),i)})})}var s=arguments.length;if(3>s){if("string"!=typeof t){2>s&&(e="");for(i in t)this.style(i,t[i],e);return this}i=""}return Ro(this,"style."+t,e,r)},Ic.styleTween=function(t,e,i){function n(n,r){var s=e.call(this,n,r,ta.getComputedStyle(this,null).getPropertyValue(t));return s&&function(e){this.style.setProperty(t,s(e),i)}}return arguments.length<3&&(i=""),this.tween("style."+t,n)},Ic.text=function(t){return Ro(this,"text",t,Lo)},Ic.remove=function(){return this.each("end.transition",function(){var t;this.__transition__.count<2&&(t=this.parentNode)&&t.removeChild(this)})},Ic.ease=function(t){var e=this.id;return arguments.length<1?this.node().__transition__[e].ease:("function"!=typeof t&&(t=Ko.ease.apply(Ko,arguments)),R(this,function(i){i.__transition__[e].ease=t}))},Ic.delay=function(t){var e=this.id;return arguments.length<1?this.node().__transition__[e].delay:R(this,"function"==typeof t?function(i,n,r){i.__transition__[e].delay=+t.call(i,i.__data__,n,r)}:(t=+t,function(i){i.__transition__[e].delay=t}))},Ic.duration=function(t){var e=this.id;return arguments.length<1?this.node().__transition__[e].duration:R(this,"function"==typeof t?function(i,n,r){i.__transition__[e].duration=Math.max(1,t.call(i,i.__data__,n,r))}:(t=Math.max(1,t),function(i){i.__transition__[e].duration=t}))},Ic.each=function(t,e){var i=this.id;if(arguments.length<2){var n=$c,r=Dc;Dc=i,R(this,function(e,n,r){$c=e.__transition__[i],t.call(e,e.__data__,n,r)}),$c=n,Dc=r}else R(this,function(n){var r=n.__transition__[i];(r.event||(r.event=Ko.dispatch("start","end"))).on(t,e)});return this},Ic.transition=function(){for(var t,e,i,n,r=this.id,s=++Nc,o=[],a=0,l=this.length;l>a;a++){o.push(t=[]);for(var e=this[a],c=0,u=e.length;u>c;c++)(i=e[c])&&(n=Object.create(i.__transition__[r]),n.delay+=n.duration,Ho(i,c,s,n)),t.push(i)}return zo(o,s)},Ko.svg.axis=function(){function t(t){t.each(function(){var t,c=Ko.select(this),u=this.__chart__||i,h=this.__chart__=i.copy(),d=null==l?h.ticks?h.ticks.apply(h,a):h.domain():l,p=null==e?h.tickFormat?h.tickFormat.apply(h,a):Te:e,f=c.selectAll(".tick").data(d,h),g=f.enter().insert("g",".domain").attr("class","tick").style("opacity",$a),m=Ko.transition(f.exit()).style("opacity",$a).remove(),v=Ko.transition(f.order()).style("opacity",1),b=Math.max(r,0)+o,y=Bs(h),_=c.selectAll(".domain").data([0]),w=(_.enter().append("path").attr("class","domain"),Ko.transition(_));g.append("line"),g.append("text");var x,k,C,A,T=g.select("line"),S=v.select("line"),M=f.select("text").text(p),D=g.select("text"),$=v.select("text"),E="top"===n||"left"===n?-1:1;if("bottom"===n||"top"===n?(t=Wo,x="x",C="y",k="x2",A="y2",M.attr("dy",0>E?"0em":".71em").style("text-anchor","middle"),w.attr("d","M"+y[0]+","+E*s+"V0H"+y[1]+"V"+E*s)):(t=jo,x="y",C="x",k="y2",A="x2",M.attr("dy",".32em").style("text-anchor",0>E?"end":"start"),w.attr("d","M"+E*s+","+y[0]+"H0V"+y[1]+"H"+E*s)),T.attr(A,E*r),D.attr(C,E*b),S.attr(k,0).attr(A,E*r),$.attr(x,0).attr(C,E*b),h.rangeBand){var P=h,I=P.rangeBand()/2;u=h=function(t){return P(t)+I}}else u.rangeBand?u=h:m.call(t,h,u);g.call(t,u,h),v.call(t,h,h)})}var e,i=Ko.scale.linear(),n=Fc,r=6,s=6,o=3,a=[10],l=null;return t.scale=function(e){return arguments.length?(i=e,t):i},t.orient=function(e){return arguments.length?(n=e in Oc?e+"":Fc,t):n},t.ticks=function(){return arguments.length?(a=arguments,t):a},t.tickValues=function(e){return arguments.length?(l=e,t):l},t.tickFormat=function(i){return arguments.length?(e=i,t):e},t.tickSize=function(e){var i=arguments.length;return i?(r=+e,s=+arguments[i-1],t):r},t.innerTickSize=function(e){return arguments.length?(r=+e,t):r},t.outerTickSize=function(e){return arguments.length?(s=+e,t):s},t.tickPadding=function(e){return arguments.length?(o=+e,t):o},t.tickSubdivide=function(){return arguments.length&&t},t};var Fc="bottom",Oc={top:1,right:1,bottom:1,left:1};Ko.svg.brush=function(){function t(s){s.each(function(){var s=Ko.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",r).on("touchstart.brush",r),o=s.selectAll(".background").data([0]);o.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),s.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var a=s.selectAll(".resize").data(f,Te);a.exit().remove(),a.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return Bc[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),a.style("display",t.empty()?"none":null);var u,h=Ko.transition(s),d=Ko.transition(o);l&&(u=Bs(l),d.attr("x",u[0]).attr("width",u[1]-u[0]),i(h)),c&&(u=Bs(c),d.attr("y",u[0]).attr("height",u[1]-u[0]),n(h)),e(h)})}function e(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+u[+/e$/.test(t)]+","+h[+/^s/.test(t)]+")"
})}function i(t){t.select(".extent").attr("x",u[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",u[1]-u[0])}function n(t){t.select(".extent").attr("y",h[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",h[1]-h[0])}function r(){function r(){32==Ko.event.keyCode&&(M||(b=null,$[0]-=u[1],$[1]-=h[1],M=2),w())}function f(){32==Ko.event.keyCode&&2==M&&($[0]+=u[1],$[1]+=h[1],M=0,w())}function g(){var t=Ko.mouse(_),r=!1;y&&(t[0]+=y[0],t[1]+=y[1]),M||(Ko.event.altKey?(b||(b=[(u[0]+u[1])/2,(h[0]+h[1])/2]),$[0]=u[+(t[0]<b[0])],$[1]=h[+(t[1]<b[1])]):b=null),T&&m(t,l,0)&&(i(C),r=!0),S&&m(t,c,1)&&(n(C),r=!0),r&&(e(C),k({type:"brush",mode:M?"move":"resize"}))}function m(t,e,i){var n,r,a=Bs(e),l=a[0],c=a[1],f=$[i],g=i?h:u,m=g[1]-g[0];return M&&(l-=f,c-=m+f),n=(i?p:d)?Math.max(l,Math.min(c,t[i])):t[i],M?r=(n+=f)+m:(b&&(f=Math.max(l,Math.min(c,2*b[i]-n))),n>f?(r=n,n=f):r=f),g[0]!=n||g[1]!=r?(i?o=null:s=null,g[0]=n,g[1]=r,!0):void 0}function v(){g(),C.style("pointer-events","all").selectAll(".resize").style("display",t.empty()?"none":null),Ko.select("body").style("cursor",null),E.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),D(),k({type:"brushend"})}var b,y,_=this,x=Ko.select(Ko.event.target),k=a.of(_,arguments),C=Ko.select(_),A=x.datum(),T=!/^(n|s)$/.test(A)&&l,S=!/^(e|w)$/.test(A)&&c,M=x.classed("extent"),D=U(),$=Ko.mouse(_),E=Ko.select(ta).on("keydown.brush",r).on("keyup.brush",f);if(Ko.event.changedTouches?E.on("touchmove.brush",g).on("touchend.brush",v):E.on("mousemove.brush",g).on("mouseup.brush",v),C.interrupt().selectAll("*").interrupt(),M)$[0]=u[0]-$[0],$[1]=h[0]-$[1];else if(A){var P=+/w$/.test(A),I=+/^n/.test(A);y=[u[1-P]-$[0],h[1-I]-$[1]],$[0]=u[P],$[1]=h[I]}else Ko.event.altKey&&(b=$.slice());C.style("pointer-events","none").selectAll(".resize").style("display",null),Ko.select("body").style("cursor",x.style("cursor")),k({type:"brushstart"}),g()}var s,o,a=k(t,"brushstart","brush","brushend"),l=null,c=null,u=[0,0],h=[0,0],d=!0,p=!0,f=zc[0];return t.event=function(t){t.each(function(){var t=a.of(this,arguments),e={x:u,y:h,i:s,j:o},i=this.__chart__||e;this.__chart__=e,Dc?Ko.select(this).transition().each("start.brush",function(){s=i.i,o=i.j,u=i.x,h=i.y,t({type:"brushstart"})}).tween("brush:brush",function(){var i=br(u,e.x),n=br(h,e.y);return s=o=null,function(r){u=e.x=i(r),h=e.y=n(r),t({type:"brush",mode:"resize"})}}).each("end.brush",function(){s=e.i,o=e.j,t({type:"brush",mode:"resize"}),t({type:"brushend"})}):(t({type:"brushstart"}),t({type:"brush",mode:"resize"}),t({type:"brushend"}))})},t.x=function(e){return arguments.length?(l=e,f=zc[!l<<1|!c],t):l},t.y=function(e){return arguments.length?(c=e,f=zc[!l<<1|!c],t):c},t.clamp=function(e){return arguments.length?(l&&c?(d=!!e[0],p=!!e[1]):l?d=!!e:c&&(p=!!e),t):l&&c?[d,p]:l?d:c?p:null},t.extent=function(e){var i,n,r,a,d;return arguments.length?(l&&(i=e[0],n=e[1],c&&(i=i[0],n=n[0]),s=[i,n],l.invert&&(i=l(i),n=l(n)),i>n&&(d=i,i=n,n=d),(i!=u[0]||n!=u[1])&&(u=[i,n])),c&&(r=e[0],a=e[1],l&&(r=r[1],a=a[1]),o=[r,a],c.invert&&(r=c(r),a=c(a)),r>a&&(d=r,r=a,a=d),(r!=h[0]||a!=h[1])&&(h=[r,a])),t):(l&&(s?(i=s[0],n=s[1]):(i=u[0],n=u[1],l.invert&&(i=l.invert(i),n=l.invert(n)),i>n&&(d=i,i=n,n=d))),c&&(o?(r=o[0],a=o[1]):(r=h[0],a=h[1],c.invert&&(r=c.invert(r),a=c.invert(a)),r>a&&(d=r,r=a,a=d))),l&&c?[[i,r],[n,a]]:l?[i,n]:c&&[r,a])},t.clear=function(){return t.empty()||(u=[0,0],h=[0,0],s=o=null),t},t.empty=function(){return!!l&&u[0]==u[1]||!!c&&h[0]==h[1]},Ko.rebind(t,a,"on")};var Bc={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},zc=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Rc=rl.format=ul.timeFormat,Lc=Rc.utc,Hc=Lc("%Y-%m-%dT%H:%M:%S.%LZ");Rc.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?qo:Hc,qo.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},qo.toString=Hc.toString,rl.second=Re(function(t){return new sl(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),rl.seconds=rl.second.range,rl.seconds.utc=rl.second.utc.range,rl.minute=Re(function(t){return new sl(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),rl.minutes=rl.minute.range,rl.minutes.utc=rl.minute.utc.range,rl.hour=Re(function(t){var e=t.getTimezoneOffset()/60;return new sl(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),rl.hours=rl.hour.range,rl.hours.utc=rl.hour.utc.range,rl.month=Re(function(t){return t=rl.day(t),t.setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),rl.months=rl.month.range,rl.months.utc=rl.month.utc.range;var Wc=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],jc=[[rl.second,1],[rl.second,5],[rl.second,15],[rl.second,30],[rl.minute,1],[rl.minute,5],[rl.minute,15],[rl.minute,30],[rl.hour,1],[rl.hour,3],[rl.hour,6],[rl.hour,12],[rl.day,1],[rl.day,2],[rl.week,1],[rl.month,1],[rl.month,3],[rl.year,1]],qc=Rc.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",Si]]),Vc={range:function(t,e,i){return Ko.range(Math.ceil(t/i)*i,+e,i).map(Uo)},floor:Te,ceil:Te};jc.year=rl.year,rl.scale=function(){return Vo(Ko.scale.linear(),jc,qc)};var Uc=jc.map(function(t){return[t[0].utc,t[1]]}),Yc=Lc.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",Si]]);Uc.year=rl.year.utc,rl.scale.utc=function(){return Vo(Ko.scale.linear(),Uc,Yc)},Ko.text=Se(function(t){return t.responseText}),Ko.json=function(t,e){return Me(t,"application/json",Yo,e)},Ko.html=function(t,e){return Me(t,"text/html",Go,e)},Ko.xml=Se(function(t){return t.responseXML}),"function"==typeof define&&define.amd?define("d3",Ko):"object"==typeof module&&module.exports&&(module.exports=Ko),this.d3=Ko}(),define("models/m_channel",["underscore","backbone","bipclient"],function(t,e,i){return MChannel=e.Model.extend({defaults:{id:null,name:"",action:"",config:{},note:"",app_id:""},validation:{name:[function(t){console.log(t),console.log(this)},{required:!0,msg:"name required"},{maxLength:64,msg:"name cannot exceed 64 characters"}],note:[{required:!1},{maxLength:1024,msg:"Note cannot exceed 1024 characters"}]},initialize:function(){},url:function(){var t=this;return i.getResourceURL("channel",t)},getPodTokens:function(){return this.attributes.action.split(".")},getPod:function(){var t=this.getPodTokens();return i.getCollection("pod").get(t[0])},getPodName:function(){return this.getPod().get("name")},getPodIcon:function(t){return this.getPod().getIcon(t)},getIcon:function(){if(this.get("icon"))return this.get("icon");if(this.get("config").icon)return this.get("config").icon;var t=this.getPodTokens();return"flow"===t[0]?"/static/img/channels/32/color/flow/"+t[1]+".png":"dataviz"===t[0]?"/static/img/channels/32/color/dataviz/"+t[1]+".png":this.getPodIcon(t[1])},getAction:function(t){var e=t?t.split("."):this.getPodTokens(),n=e[1],t=i.getCollection("pod").get(e[0]).get("actions")[n];return t.name=t.name||n,t},_getSummary:function(e,i){var i=this.getAction(i),n={},r=i[e];return r&&r.properties&&t.each(r.properties,function(t,e){var i,r=t.oneOf&&t.oneOf[0].$ref,s=t.anyOf&&t.anyOf[0].$ref;r?i=t.oneOf[0].$ref:s&&(i=t.anyOf[0].$ref),n[e]={rpc_ref:i?0===i.indexOf("/rpcs"):!1,type:t.type,oneOf:r,anyOf:s}}),n},getConfigSummary:function(t){return this._getSummary("config",t)},hasImports:function(){var t=this.getAction().imports.properties;return t&&Object.keys(t).length>0},hasConfig:function(){return this.getPod().hasConfig(this.get("action"))}}),MChannel}),define("models/m_channel_log",["underscore","backbone"],function(t,e){return t.extend(e.Model.prototype,e.Validator),MChannelLog=e.Model.extend({}),MChannelLog}),define("c_channel_log",["underscore","backbone","models/m_channel_log","bipclient"],function(t,e,i,n){var r=e.Collection.extend({model:i,page:1,page_size:50,total:0,num_pages:1,sortBy:"recent",searchBy:"",channelId:null,initialize:function(e){t.bindAll(this,"parse","nextPage","prevPage","pageInfo","sort","search"),n.setCollection("channel_log",this),this.channelId=e},url:function(){return n.getResourceName("channel/"+this.channelId+"/logs",this.page,this.page_size,this.sortBy)},parse:function(t){return this.page=t.page,this.page_size=t.page_size,this.total=t.total,this.num_pages=t.num_pages,t.data},nextPage:function(){var t=this.page+1;return this.page=t>this.num_pages?this.page:t,this.fetch()},prevPage:function(){var t=this.page-1;return this.page=1>=t?1:t,this.fetch()},pageInfo:function(){return{page_current:this.page,page_total:this.num_pages,page_size:this.page_size,result_total:this.total}},sort:function(t){return this.sortBy=t,this.fetch()},search:function(t){return this.searchBy=t,this.fetch()}});return r}),function(t){function e(t,e,i){switch(arguments.length){case 2:return null!=t?t:e;case 3:return null!=t?t:null!=e?e:i;default:throw new Error("Implement me")}}function i(t,e){return Se.call(t,e)}function n(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function r(t){we.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function s(t,e){var i=!0;return f(function(){return i&&(r(t),i=!1),e.apply(this,arguments)},e)}function o(t,e){bi[t]||(r(e),bi[t]=!0)}function a(t,e){return function(i){return v(t.call(this,i),e)}}function l(t,e){return function(i){return this.localeData().ordinal(t.call(this,i),e)}}function c(t,e){var i,n,r=12*(e.year()-t.year())+(e.month()-t.month()),s=t.clone().add(r,"months");return 0>e-s?(i=t.clone().add(r-1,"months"),n=(e-s)/(s-i)):(i=t.clone().add(r+1,"months"),n=(e-s)/(i-s)),-(r+n)}function u(t,e,i){var n;return null==i?e:null!=t.meridiemHour?t.meridiemHour(e,i):null!=t.isPM?(n=t.isPM(i),n&&12>e&&(e+=12),n||12!==e||(e=0),e):e}function h(){}function d(t,e){e!==!1&&I(t),g(this,t),this._d=new Date(+t._d),_i===!1&&(_i=!0,we.updateOffset(this),_i=!1)}function p(t){var e=T(t),i=e.year||0,n=e.quarter||0,r=e.month||0,s=e.week||0,o=e.day||0,a=e.hour||0,l=e.minute||0,c=e.second||0,u=e.millisecond||0;this._milliseconds=+u+1e3*c+6e4*l+36e5*a,this._days=+o+7*s,this._months=+r+3*n+12*i,this._data={},this._locale=we.localeData(),this._bubble()}function f(t,e){for(var n in e)i(e,n)&&(t[n]=e[n]);return i(e,"toString")&&(t.toString=e.toString),i(e,"valueOf")&&(t.valueOf=e.valueOf),t}function g(t,e){var i,n,r;if("undefined"!=typeof e._isAMomentObject&&(t._isAMomentObject=e._isAMomentObject),"undefined"!=typeof e._i&&(t._i=e._i),"undefined"!=typeof e._f&&(t._f=e._f),"undefined"!=typeof e._l&&(t._l=e._l),"undefined"!=typeof e._strict&&(t._strict=e._strict),"undefined"!=typeof e._tzm&&(t._tzm=e._tzm),"undefined"!=typeof e._isUTC&&(t._isUTC=e._isUTC),"undefined"!=typeof e._offset&&(t._offset=e._offset),"undefined"!=typeof e._pf&&(t._pf=e._pf),"undefined"!=typeof e._locale&&(t._locale=e._locale),Oe.length>0)for(i in Oe)n=Oe[i],r=e[n],"undefined"!=typeof r&&(t[n]=r);return t}function m(t){return 0>t?Math.ceil(t):Math.floor(t)}function v(t,e,i){for(var n=""+Math.abs(t),r=t>=0;n.length<e;)n="0"+n;return(r?i?"+":"":"-")+n}function b(t,e){var i={milliseconds:0,months:0};return i.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(i.months,"M").isAfter(e)&&--i.months,i.milliseconds=+e-+t.clone().add(i.months,"M"),i}function y(t,e){var i;return e=z(e,t),t.isBefore(e)?i=b(t,e):(i=b(e,t),i.milliseconds=-i.milliseconds,i.months=-i.months),i}function _(t,e){return function(i,n){var r,s;return null===n||isNaN(+n)||(o(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period)."),s=i,i=n,n=s),i="string"==typeof i?+i:i,r=we.duration(i,n),w(this,r,t),this}}function w(t,e,i,n){var r=e._milliseconds,s=e._days,o=e._months;n=null==n?!0:n,r&&t._d.setTime(+t._d+r*i),s&&ge(t,"Date",fe(t,"Date")+s*i),o&&pe(t,fe(t,"Month")+o*i),n&&we.updateOffset(t,s||o)}function x(t){return"[object Array]"===Object.prototype.toString.call(t)}function k(t){return"[object Date]"===Object.prototype.toString.call(t)||t instanceof Date}function C(t,e,i){var n,r=Math.min(t.length,e.length),s=Math.abs(t.length-e.length),o=0;for(n=0;r>n;n++)(i&&t[n]!==e[n]||!i&&M(t[n])!==M(e[n]))&&o++;return o+s}function A(t){if(t){var e=t.toLowerCase().replace(/(.)s$/,"$1");t=hi[t]||di[e]||e}return t}function T(t){var e,n,r={};for(n in t)i(t,n)&&(e=A(n),e&&(r[e]=t[n]));return r}function S(e){var i,n;if(0===e.indexOf("week"))i=7,n="day";else{if(0!==e.indexOf("month"))return;i=12,n="month"}we[e]=function(r,s){var o,a,l=we._locale[e],c=[];if("number"==typeof r&&(s=r,r=t),a=function(t){var e=we().utc().set(n,t);return l.call(we._locale,e,r||"")},null!=s)return a(s);for(o=0;i>o;o++)c.push(a(o));return c}}function M(t){var e=+t,i=0;return 0!==e&&isFinite(e)&&(i=e>=0?Math.floor(e):Math.ceil(e)),i}function D(t,e){return new Date(Date.UTC(t,e+1,0)).getUTCDate()}function $(t,e,i){return ce(we([t,11,31+e-i]),e,i).week}function E(t){return P(t)?366:365}function P(t){return t%4===0&&t%100!==0||t%400===0}function I(t){var e;t._a&&-2===t._pf.overflow&&(e=t._a[De]<0||t._a[De]>11?De:t._a[$e]<1||t._a[$e]>D(t._a[Me],t._a[De])?$e:t._a[Ee]<0||t._a[Ee]>24||24===t._a[Ee]&&(0!==t._a[Pe]||0!==t._a[Ie]||0!==t._a[Ne])?Ee:t._a[Pe]<0||t._a[Pe]>59?Pe:t._a[Ie]<0||t._a[Ie]>59?Ie:t._a[Ne]<0||t._a[Ne]>999?Ne:-1,t._pf._overflowDayOfYear&&(Me>e||e>$e)&&(e=$e),t._pf.overflow=e)}function N(e){return null==e._isValid&&(e._isValid=!isNaN(e._d.getTime())&&e._pf.overflow<0&&!e._pf.empty&&!e._pf.invalidMonth&&!e._pf.nullInput&&!e._pf.invalidFormat&&!e._pf.userInvalidated,e._strict&&(e._isValid=e._isValid&&0===e._pf.charsLeftOver&&0===e._pf.unusedTokens.length&&e._pf.bigHour===t)),e._isValid}function F(t){return t?t.toLowerCase().replace("_","-"):t}function O(t){for(var e,i,n,r,s=0;s<t.length;){for(r=F(t[s]).split("-"),e=r.length,i=F(t[s+1]),i=i?i.split("-"):null;e>0;){if(n=B(r.slice(0,e).join("-")))return n;if(i&&i.length>=e&&C(r,i,!0)>=e-1)break;e--}s++}return null}function B(t){var e=null;if(!Fe[t]&&Be)try{e=we.locale(),require("./locale/"+t),we.locale(e)}catch(i){}return Fe[t]}function z(t,e){var i,n;return e._isUTC?(i=e.clone(),n=(we.isMoment(t)||k(t)?+t:+we(t))-+i,i._d.setTime(+i._d+n),we.updateOffset(i,!1),i):we(t).local()}function R(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function L(t){var e,i,n=t.match(He);for(e=0,i=n.length;i>e;e++)n[e]=vi[n[e]]?vi[n[e]]:R(n[e]);return function(r){var s="";for(e=0;i>e;e++)s+=n[e]instanceof Function?n[e].call(r,t):n[e];return s}}function H(t,e){return t.isValid()?(e=W(e,t.localeData()),pi[e]||(pi[e]=L(e)),pi[e](t)):t.localeData().invalidDate()}function W(t,e){function i(t){return e.longDateFormat(t)||t}var n=5;for(We.lastIndex=0;n>=0&&We.test(t);)t=t.replace(We,i),We.lastIndex=0,n-=1;return t}function j(t,e){var i,n=e._strict;switch(t){case"Q":return Ze;case"DDDD":return ei;case"YYYY":case"GGGG":case"gggg":return n?ii:Ve;case"Y":case"G":case"g":return ri;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return n?ni:Ue;case"S":if(n)return Ze;case"SS":if(n)return ti;case"SSS":if(n)return ei;case"DDD":return qe;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Ge;case"a":case"A":return e._locale._meridiemParse;case"x":return Xe;case"X":return Qe;case"Z":case"ZZ":return Ke;case"T":return Je;case"SSSS":return Ye;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return n?ti:je;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return je;case"Do":return n?e._locale._ordinalParse:e._locale._ordinalParseLenient;default:return i=new RegExp(Q(X(t.replace("\\","")),"i"))}}function q(t){t=t||"";var e=t.match(Ke)||[],i=e[e.length-1]||[],n=(i+"").match(ci)||["-",0,0],r=+(60*n[1])+M(n[2]);return"+"===n[0]?r:-r}function V(t,e,i){var n,r=i._a;switch(t){case"Q":null!=e&&(r[De]=3*(M(e)-1));break;case"M":case"MM":null!=e&&(r[De]=M(e)-1);break;case"MMM":case"MMMM":n=i._locale.monthsParse(e,t,i._strict),null!=n?r[De]=n:i._pf.invalidMonth=e;break;case"D":case"DD":null!=e&&(r[$e]=M(e));break;case"Do":null!=e&&(r[$e]=M(parseInt(e.match(/\d{1,2}/)[0],10)));break;case"DDD":case"DDDD":null!=e&&(i._dayOfYear=M(e));break;case"YY":r[Me]=we.parseTwoDigitYear(e);break;case"YYYY":case"YYYYY":case"YYYYYY":r[Me]=M(e);break;case"a":case"A":i._meridiem=e;break;case"h":case"hh":i._pf.bigHour=!0;case"H":case"HH":r[Ee]=M(e);break;case"m":case"mm":r[Pe]=M(e);break;case"s":case"ss":r[Ie]=M(e);break;case"S":case"SS":case"SSS":case"SSSS":r[Ne]=M(1e3*("0."+e));break;case"x":i._d=new Date(M(e));break;case"X":i._d=new Date(1e3*parseFloat(e));break;case"Z":case"ZZ":i._useUTC=!0,i._tzm=q(e);break;case"dd":case"ddd":case"dddd":n=i._locale.weekdaysParse(e),null!=n?(i._w=i._w||{},i._w.d=n):i._pf.invalidWeekday=e;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":t=t.substr(0,1);case"gggg":case"GGGG":case"GGGGG":t=t.substr(0,2),e&&(i._w=i._w||{},i._w[t]=M(e));break;case"gg":case"GG":i._w=i._w||{},i._w[t]=we.parseTwoDigitYear(e)}}function U(t){var i,n,r,s,o,a,l;i=t._w,null!=i.GG||null!=i.W||null!=i.E?(o=1,a=4,n=e(i.GG,t._a[Me],ce(we(),1,4).year),r=e(i.W,1),s=e(i.E,1)):(o=t._locale._week.dow,a=t._locale._week.doy,n=e(i.gg,t._a[Me],ce(we(),o,a).year),r=e(i.w,1),null!=i.d?(s=i.d,o>s&&++r):s=null!=i.e?i.e+o:o),l=ue(n,r,s,a,o),t._a[Me]=l.year,t._dayOfYear=l.dayOfYear}function Y(t){var i,n,r,s,o=[];if(!t._d){for(r=K(t),t._w&&null==t._a[$e]&&null==t._a[De]&&U(t),t._dayOfYear&&(s=e(t._a[Me],r[Me]),t._dayOfYear>E(s)&&(t._pf._overflowDayOfYear=!0),n=se(s,0,t._dayOfYear),t._a[De]=n.getUTCMonth(),t._a[$e]=n.getUTCDate()),i=0;3>i&&null==t._a[i];++i)t._a[i]=o[i]=r[i];for(;7>i;i++)t._a[i]=o[i]=null==t._a[i]?2===i?1:0:t._a[i];24===t._a[Ee]&&0===t._a[Pe]&&0===t._a[Ie]&&0===t._a[Ne]&&(t._nextDay=!0,t._a[Ee]=0),t._d=(t._useUTC?se:re).apply(null,o),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Ee]=24)}}function G(t){var e;t._d||(e=T(t._i),t._a=[e.year,e.month,e.day||e.date,e.hour,e.minute,e.second,e.millisecond],Y(t))}function K(t){var e=new Date;return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function J(e){if(e._f===we.ISO_8601)return void te(e);e._a=[],e._pf.empty=!0;var i,n,r,s,o,a=""+e._i,l=a.length,c=0;for(r=W(e._f,e._locale).match(He)||[],i=0;i<r.length;i++)s=r[i],n=(a.match(j(s,e))||[])[0],n&&(o=a.substr(0,a.indexOf(n)),o.length>0&&e._pf.unusedInput.push(o),a=a.slice(a.indexOf(n)+n.length),c+=n.length),vi[s]?(n?e._pf.empty=!1:e._pf.unusedTokens.push(s),V(s,n,e)):e._strict&&!n&&e._pf.unusedTokens.push(s);e._pf.charsLeftOver=l-c,a.length>0&&e._pf.unusedInput.push(a),e._pf.bigHour===!0&&e._a[Ee]<=12&&(e._pf.bigHour=t),e._a[Ee]=u(e._locale,e._a[Ee],e._meridiem),Y(e),I(e)}function X(t){return t.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,e,i,n,r){return e||i||n||r})}function Q(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Z(t){var e,i,r,s,o;if(0===t._f.length)return t._pf.invalidFormat=!0,void(t._d=new Date(0/0));for(s=0;s<t._f.length;s++)o=0,e=g({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._pf=n(),e._f=t._f[s],J(e),N(e)&&(o+=e._pf.charsLeftOver,o+=10*e._pf.unusedTokens.length,e._pf.score=o,(null==r||r>o)&&(r=o,i=e));f(t,i||e)}function te(t){var e,i,n=t._i,r=si.exec(n);if(r){for(t._pf.iso=!0,e=0,i=ai.length;i>e;e++)if(ai[e][1].exec(n)){t._f=ai[e][0]+(r[6]||" ");break}for(e=0,i=li.length;i>e;e++)if(li[e][1].exec(n)){t._f+=li[e][0];break}n.match(Ke)&&(t._f+="Z"),J(t)}else t._isValid=!1}function ee(t){te(t),t._isValid===!1&&(delete t._isValid,we.createFromInputFallback(t))}function ie(t,e){var i,n=[];for(i=0;i<t.length;++i)n.push(e(t[i],i));return n}function ne(e){var i,n=e._i;n===t?e._d=new Date:k(n)?e._d=new Date(+n):null!==(i=ze.exec(n))?e._d=new Date(+i[1]):"string"==typeof n?ee(e):x(n)?(e._a=ie(n.slice(0),function(t){return parseInt(t,10)}),Y(e)):"object"==typeof n?G(e):"number"==typeof n?e._d=new Date(n):we.createFromInputFallback(e)}function re(t,e,i,n,r,s,o){var a=new Date(t,e,i,n,r,s,o);return 1970>t&&a.setFullYear(t),a}function se(t){var e=new Date(Date.UTC.apply(null,arguments));return 1970>t&&e.setUTCFullYear(t),e}function oe(t,e){if("string"==typeof t)if(isNaN(t)){if(t=e.weekdaysParse(t),"number"!=typeof t)return null}else t=parseInt(t,10);return t}function ae(t,e,i,n,r){return r.relativeTime(e||1,!!i,t,n)}function le(t,e,i){var n=we.duration(t).abs(),r=Te(n.as("s")),s=Te(n.as("m")),o=Te(n.as("h")),a=Te(n.as("d")),l=Te(n.as("M")),c=Te(n.as("y")),u=r<fi.s&&["s",r]||1===s&&["m"]||s<fi.m&&["mm",s]||1===o&&["h"]||o<fi.h&&["hh",o]||1===a&&["d"]||a<fi.d&&["dd",a]||1===l&&["M"]||l<fi.M&&["MM",l]||1===c&&["y"]||["yy",c];return u[2]=e,u[3]=+t>0,u[4]=i,ae.apply({},u)}function ce(t,e,i){var n,r=i-e,s=i-t.day();return s>r&&(s-=7),r-7>s&&(s+=7),n=we(t).add(s,"d"),{week:Math.ceil(n.dayOfYear()/7),year:n.year()}}function ue(t,e,i,n,r){var s,o,a=se(t,0,1).getUTCDay();return a=0===a?7:a,i=null!=i?i:r,s=r-a+(a>n?7:0)-(r>a?7:0),o=7*(e-1)+(i-r)+s+1,{year:o>0?t:t-1,dayOfYear:o>0?o:E(t-1)+o}}function he(e){var i,n=e._i,r=e._f;return e._locale=e._locale||we.localeData(e._l),null===n||r===t&&""===n?we.invalid({nullInput:!0}):("string"==typeof n&&(e._i=n=e._locale.preparse(n)),we.isMoment(n)?new d(n,!0):(r?x(r)?Z(e):J(e):ne(e),i=new d(e),i._nextDay&&(i.add(1,"d"),i._nextDay=t),i))}function de(t,e){var i,n;if(1===e.length&&x(e[0])&&(e=e[0]),!e.length)return we();for(i=e[0],n=1;n<e.length;++n)e[n][t](i)&&(i=e[n]);return i}function pe(t,e){var i;return"string"==typeof e&&(e=t.localeData().monthsParse(e),"number"!=typeof e)?t:(i=Math.min(t.date(),D(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,i),t)}function fe(t,e){return t._d["get"+(t._isUTC?"UTC":"")+e]()}function ge(t,e,i){return"Month"===e?pe(t,i):t._d["set"+(t._isUTC?"UTC":"")+e](i)}function me(t,e){return function(i){return null!=i?(ge(this,t,i),we.updateOffset(this,e),this):fe(this,t)}}function ve(t){return 400*t/146097}function be(t){return 146097*t/400}function ye(t){we.duration.fn[t]=function(){return this._data[t]}}function _e(t){"undefined"==typeof ender&&(xe=Ae.moment,Ae.moment=t?s("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",we):we)}for(var we,xe,ke,Ce="2.9.0",Ae="undefined"==typeof global||"undefined"!=typeof window&&window!==global.window?this:global,Te=Math.round,Se=Object.prototype.hasOwnProperty,Me=0,De=1,$e=2,Ee=3,Pe=4,Ie=5,Ne=6,Fe={},Oe=[],Be="undefined"!=typeof module&&module&&module.exports,ze=/^\/?Date\((\-?\d+)/i,Re=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Le=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,He=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,We=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,je=/\d\d?/,qe=/\d{1,3}/,Ve=/\d{1,4}/,Ue=/[+\-]?\d{1,6}/,Ye=/\d+/,Ge=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Ke=/Z|[\+\-]\d\d:?\d\d/gi,Je=/T/i,Xe=/[\+\-]?\d+/,Qe=/[\+\-]?\d+(\.\d{1,3})?/,Ze=/\d/,ti=/\d\d/,ei=/\d{3}/,ii=/\d{4}/,ni=/[+-]?\d{6}/,ri=/[+-]?\d+/,si=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,oi="YYYY-MM-DDTHH:mm:ssZ",ai=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],li=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],ci=/([\+\-]|\d\d)/gi,ui=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),hi={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},di={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},pi={},fi={s:45,m:45,h:22,d:26,M:11},gi="DDD w W M D d".split(" "),mi="M D H h m s w W".split(" "),vi={M:function(){return this.month()+1},MMM:function(t){return this.localeData().monthsShort(this,t)},MMMM:function(t){return this.localeData().months(this,t)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(t){return this.localeData().weekdaysMin(this,t)},ddd:function(t){return this.localeData().weekdaysShort(this,t)},dddd:function(t){return this.localeData().weekdays(this,t)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return v(this.year()%100,2)},YYYY:function(){return v(this.year(),4)},YYYYY:function(){return v(this.year(),5)},YYYYYY:function(){var t=this.year(),e=t>=0?"+":"-";return e+v(Math.abs(t),6)},gg:function(){return v(this.weekYear()%100,2)},gggg:function(){return v(this.weekYear(),4)},ggggg:function(){return v(this.weekYear(),5)},GG:function(){return v(this.isoWeekYear()%100,2)},GGGG:function(){return v(this.isoWeekYear(),4)},GGGGG:function(){return v(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return M(this.milliseconds()/100)},SS:function(){return v(M(this.milliseconds()/10),2)},SSS:function(){return v(this.milliseconds(),3)},SSSS:function(){return v(this.milliseconds(),3)},Z:function(){var t=this.utcOffset(),e="+";return 0>t&&(t=-t,e="-"),e+v(M(t/60),2)+":"+v(M(t)%60,2)},ZZ:function(){var t=this.utcOffset(),e="+";return 0>t&&(t=-t,e="-"),e+v(M(t/60),2)+v(M(t)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},x:function(){return this.valueOf()},X:function(){return this.unix()},Q:function(){return this.quarter()}},bi={},yi=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"],_i=!1;gi.length;)ke=gi.pop(),vi[ke+"o"]=l(vi[ke],ke);for(;mi.length;)ke=mi.pop(),vi[ke+ke]=a(vi[ke],2);vi.DDDD=a(vi.DDD,3),f(h.prototype,{set:function(t){var e,i;for(i in t)e=t[i],"function"==typeof e?this[i]=e:this["_"+i]=e;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(t){return this._months[t.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(t){return this._monthsShort[t.month()]},monthsParse:function(t,e,i){var n,r,s;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;12>n;n++){if(r=we.utc([2e3,n]),i&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),i||this._monthsParse[n]||(s="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[n]=new RegExp(s.replace(".",""),"i")),i&&"MMMM"===e&&this._longMonthsParse[n].test(t))return n;if(i&&"MMM"===e&&this._shortMonthsParse[n].test(t))return n;if(!i&&this._monthsParse[n].test(t))return n}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(t){return this._weekdays[t.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(t){return this._weekdaysShort[t.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(t){return this._weekdaysMin[t.day()]},weekdaysParse:function(t){var e,i,n;for(this._weekdaysParse||(this._weekdaysParse=[]),e=0;7>e;e++)if(this._weekdaysParse[e]||(i=we([2e3,1]).day(e),n="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[e]=new RegExp(n.replace(".",""),"i")),this._weekdaysParse[e].test(t))return e},_longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(t){var e=this._longDateFormat[t];return!e&&this._longDateFormat[t.toUpperCase()]&&(e=this._longDateFormat[t.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(t){return t.slice(1)}),this._longDateFormat[t]=e),e},isPM:function(t){return"p"===(t+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(t,e,i){return t>11?i?"pm":"PM":i?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(t,e,i){var n=this._calendar[t];return"function"==typeof n?n.apply(e,[i]):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(t,e,i,n){var r=this._relativeTime[i];return"function"==typeof r?r(t,e,i,n):r.replace(/%d/i,t)},pastFuture:function(t,e){var i=this._relativeTime[t>0?"future":"past"];return"function"==typeof i?i(e):i.replace(/%s/i,e)},ordinal:function(t){return this._ordinal.replace("%d",t)},_ordinal:"%d",_ordinalParse:/\d{1,2}/,preparse:function(t){return t},postformat:function(t){return t},week:function(t){return ce(t,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},firstDayOfWeek:function(){return this._week.dow},firstDayOfYear:function(){return this._week.doy},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),we=function(e,i,r,s){var o;return"boolean"==typeof r&&(s=r,r=t),o={},o._isAMomentObject=!0,o._i=e,o._f=i,o._l=r,o._strict=s,o._isUTC=!1,o._pf=n(),he(o)},we.suppressDeprecationWarnings=!1,we.createFromInputFallback=s("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))}),we.min=function(){var t=[].slice.call(arguments,0);return de("isBefore",t)},we.max=function(){var t=[].slice.call(arguments,0);return de("isAfter",t)},we.utc=function(e,i,r,s){var o;return"boolean"==typeof r&&(s=r,r=t),o={},o._isAMomentObject=!0,o._useUTC=!0,o._isUTC=!0,o._l=r,o._i=e,o._f=i,o._strict=s,o._pf=n(),he(o).utc()},we.unix=function(t){return we(1e3*t)},we.duration=function(t,e){var n,r,s,o,a=t,l=null;return we.isDuration(t)?a={ms:t._milliseconds,d:t._days,M:t._months}:"number"==typeof t?(a={},e?a[e]=t:a.milliseconds=t):(l=Re.exec(t))?(n="-"===l[1]?-1:1,a={y:0,d:M(l[$e])*n,h:M(l[Ee])*n,m:M(l[Pe])*n,s:M(l[Ie])*n,ms:M(l[Ne])*n}):(l=Le.exec(t))?(n="-"===l[1]?-1:1,s=function(t){var e=t&&parseFloat(t.replace(",","."));return(isNaN(e)?0:e)*n
},a={y:s(l[2]),M:s(l[3]),d:s(l[4]),h:s(l[5]),m:s(l[6]),s:s(l[7]),w:s(l[8])}):null==a?a={}:"object"==typeof a&&("from"in a||"to"in a)&&(o=y(we(a.from),we(a.to)),a={},a.ms=o.milliseconds,a.M=o.months),r=new p(a),we.isDuration(t)&&i(t,"_locale")&&(r._locale=t._locale),r},we.version=Ce,we.defaultFormat=oi,we.ISO_8601=function(){},we.momentProperties=Oe,we.updateOffset=function(){},we.relativeTimeThreshold=function(e,i){return fi[e]===t?!1:i===t?fi[e]:(fi[e]=i,!0)},we.lang=s("moment.lang is deprecated. Use moment.locale instead.",function(t,e){return we.locale(t,e)}),we.locale=function(t,e){var i;return t&&(i="undefined"!=typeof e?we.defineLocale(t,e):we.localeData(t),i&&(we.duration._locale=we._locale=i)),we._locale._abbr},we.defineLocale=function(t,e){return null!==e?(e.abbr=t,Fe[t]||(Fe[t]=new h),Fe[t].set(e),we.locale(t),Fe[t]):(delete Fe[t],null)},we.langData=s("moment.langData is deprecated. Use moment.localeData instead.",function(t){return we.localeData(t)}),we.localeData=function(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return we._locale;if(!x(t)){if(e=B(t))return e;t=[t]}return O(t)},we.isMoment=function(t){return t instanceof d||null!=t&&i(t,"_isAMomentObject")},we.isDuration=function(t){return t instanceof p};for(ke=yi.length-1;ke>=0;--ke)S(yi[ke]);we.normalizeUnits=function(t){return A(t)},we.invalid=function(t){var e=we.utc(0/0);return null!=t?f(e._pf,t):e._pf.userInvalidated=!0,e},we.parseZone=function(){return we.apply(null,arguments).parseZone()},we.parseTwoDigitYear=function(t){return M(t)+(M(t)>68?1900:2e3)},we.isDate=k,f(we.fn=d.prototype,{clone:function(){return we(this)},valueOf:function(){return+this._d-6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var t=we(this).utc();return 0<t.year()&&t.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():H(t,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):H(t,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var t=this;return[t.year(),t.month(),t.date(),t.hours(),t.minutes(),t.seconds(),t.milliseconds()]},isValid:function(){return N(this)},isDSTShifted:function(){return this._a?this.isValid()&&C(this._a,(this._isUTC?we.utc(this._a):we(this._a)).toArray())>0:!1},parsingFlags:function(){return f({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(t){return this.utcOffset(0,t)},local:function(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(this._dateUtcOffset(),"m")),this},format:function(t){var e=H(this,t||we.defaultFormat);return this.localeData().postformat(e)},add:_(1,"add"),subtract:_(-1,"subtract"),diff:function(t,e,i){var n,r,s=z(t,this),o=6e4*(s.utcOffset()-this.utcOffset());return e=A(e),"year"===e||"month"===e||"quarter"===e?(r=c(this,s),"quarter"===e?r/=3:"year"===e&&(r/=12)):(n=this-s,r="second"===e?n/1e3:"minute"===e?n/6e4:"hour"===e?n/36e5:"day"===e?(n-o)/864e5:"week"===e?(n-o)/6048e5:n),i?r:m(r)},from:function(t,e){return we.duration({to:this,from:t}).locale(this.locale()).humanize(!e)},fromNow:function(t){return this.from(we(),t)},calendar:function(t){var e=t||we(),i=z(e,this).startOf("day"),n=this.diff(i,"days",!0),r=-6>n?"sameElse":-1>n?"lastWeek":0>n?"lastDay":1>n?"sameDay":2>n?"nextDay":7>n?"nextWeek":"sameElse";return this.format(this.localeData().calendar(r,this,we(e)))},isLeapYear:function(){return P(this.year())},isDST:function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},day:function(t){var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=oe(t,this.localeData()),this.add(t-e,"d")):e},month:me("Month",!0),startOf:function(t){switch(t=A(t)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===t?this.weekday(0):"isoWeek"===t&&this.isoWeekday(1),"quarter"===t&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(e){return e=A(e),e===t||"millisecond"===e?this:this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms")},isAfter:function(t,e){var i;return e=A("undefined"!=typeof e?e:"millisecond"),"millisecond"===e?(t=we.isMoment(t)?t:we(t),+this>+t):(i=we.isMoment(t)?+t:+we(t),i<+this.clone().startOf(e))},isBefore:function(t,e){var i;return e=A("undefined"!=typeof e?e:"millisecond"),"millisecond"===e?(t=we.isMoment(t)?t:we(t),+t>+this):(i=we.isMoment(t)?+t:+we(t),+this.clone().endOf(e)<i)},isBetween:function(t,e,i){return this.isAfter(t,i)&&this.isBefore(e,i)},isSame:function(t,e){var i;return e=A(e||"millisecond"),"millisecond"===e?(t=we.isMoment(t)?t:we(t),+this===+t):(i=+we(t),+this.clone().startOf(e)<=i&&i<=+this.clone().endOf(e))},min:s("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(t){return t=we.apply(null,arguments),this>t?this:t}),max:s("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(t){return t=we.apply(null,arguments),t>this?this:t}),zone:s("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",function(t,e){return null!=t?("string"!=typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}),utcOffset:function(t,e){var i,n=this._offset||0;return null!=t?("string"==typeof t&&(t=q(t)),Math.abs(t)<16&&(t=60*t),!this._isUTC&&e&&(i=this._dateUtcOffset()),this._offset=t,this._isUTC=!0,null!=i&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?w(this,we.duration(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,we.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?n:this._dateUtcOffset()},isLocal:function(){return!this._isUTC},isUtcOffset:function(){return this._isUTC},isUtc:function(){return this._isUTC&&0===this._offset},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(q(this._i)),this},hasAlignedHourOffset:function(t){return t=t?we(t).utcOffset():0,(this.utcOffset()-t)%60===0},daysInMonth:function(){return D(this.year(),this.month())},dayOfYear:function(t){var e=Te((we(this).startOf("day")-we(this).startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")},quarter:function(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)},weekYear:function(t){var e=ce(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==t?e:this.add(t-e,"y")},isoWeekYear:function(t){var e=ce(this,1,4).year;return null==t?e:this.add(t-e,"y")},week:function(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")},isoWeek:function(t){var e=ce(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")},weekday:function(t){var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")},isoWeekday:function(t){return null==t?this.day()||7:this.day(this.day()%7?t:t-7)},isoWeeksInYear:function(){return $(this.year(),1,4)},weeksInYear:function(){var t=this.localeData()._week;return $(this.year(),t.dow,t.doy)},get:function(t){return t=A(t),this[t]()},set:function(t,e){var i;if("object"==typeof t)for(i in t)this.set(i,t[i]);else t=A(t),"function"==typeof this[t]&&this[t](e);return this},locale:function(e){var i;return e===t?this._locale._abbr:(i=we.localeData(e),null!=i&&(this._locale=i),this)},lang:s("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===t?this.localeData():this.locale(e)}),localeData:function(){return this._locale},_dateUtcOffset:function(){return 15*-Math.round(this._d.getTimezoneOffset()/15)}}),we.fn.millisecond=we.fn.milliseconds=me("Milliseconds",!1),we.fn.second=we.fn.seconds=me("Seconds",!1),we.fn.minute=we.fn.minutes=me("Minutes",!1),we.fn.hour=we.fn.hours=me("Hours",!0),we.fn.date=me("Date",!0),we.fn.dates=s("dates accessor is deprecated. Use date instead.",me("Date",!0)),we.fn.year=me("FullYear",!0),we.fn.years=s("years accessor is deprecated. Use year instead.",me("FullYear",!0)),we.fn.days=we.fn.day,we.fn.months=we.fn.month,we.fn.weeks=we.fn.week,we.fn.isoWeeks=we.fn.isoWeek,we.fn.quarters=we.fn.quarter,we.fn.toJSON=we.fn.toISOString,we.fn.isUTC=we.fn.isUtc,f(we.duration.fn=p.prototype,{_bubble:function(){var t,e,i,n=this._milliseconds,r=this._days,s=this._months,o=this._data,a=0;o.milliseconds=n%1e3,t=m(n/1e3),o.seconds=t%60,e=m(t/60),o.minutes=e%60,i=m(e/60),o.hours=i%24,r+=m(i/24),a=m(ve(r)),r-=m(be(a)),s+=m(r/30),r%=30,a+=m(s/12),s%=12,o.days=r,o.months=s,o.years=a},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return m(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*M(this._months/12)},humanize:function(t){var e=le(this,!t,this.localeData());return t&&(e=this.localeData().pastFuture(+this,e)),this.localeData().postformat(e)},add:function(t,e){var i=we.duration(t,e);return this._milliseconds+=i._milliseconds,this._days+=i._days,this._months+=i._months,this._bubble(),this},subtract:function(t,e){var i=we.duration(t,e);return this._milliseconds-=i._milliseconds,this._days-=i._days,this._months-=i._months,this._bubble(),this},get:function(t){return t=A(t),this[t.toLowerCase()+"s"]()},as:function(t){var e,i;if(t=A(t),"month"===t||"year"===t)return e=this._days+this._milliseconds/864e5,i=this._months+12*ve(e),"month"===t?i:i/12;switch(e=this._days+Math.round(be(this._months/12)),t){case"week":return e/7+this._milliseconds/6048e5;case"day":return e+this._milliseconds/864e5;case"hour":return 24*e+this._milliseconds/36e5;case"minute":return 24*e*60+this._milliseconds/6e4;case"second":return 24*e*60*60+this._milliseconds/1e3;case"millisecond":return Math.floor(24*e*60*60*1e3)+this._milliseconds;default:throw new Error("Unknown unit "+t)}},lang:we.fn.lang,locale:we.fn.locale,toIsoString:s("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var t=Math.abs(this.years()),e=Math.abs(this.months()),i=Math.abs(this.days()),n=Math.abs(this.hours()),r=Math.abs(this.minutes()),s=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(t?t+"Y":"")+(e?e+"M":"")+(i?i+"D":"")+(n||r||s?"T":"")+(n?n+"H":"")+(r?r+"M":"")+(s?s+"S":""):"P0D"},localeData:function(){return this._locale},toJSON:function(){return this.toISOString()}}),we.duration.fn.toString=we.duration.fn.toISOString;for(ke in ui)i(ui,ke)&&ye(ke.toLowerCase());we.duration.fn.asMilliseconds=function(){return this.as("ms")},we.duration.fn.asSeconds=function(){return this.as("s")},we.duration.fn.asMinutes=function(){return this.as("m")},we.duration.fn.asHours=function(){return this.as("h")},we.duration.fn.asDays=function(){return this.as("d")},we.duration.fn.asWeeks=function(){return this.as("weeks")},we.duration.fn.asMonths=function(){return this.as("M")},we.duration.fn.asYears=function(){return this.as("y")},we.locale("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,i=1===M(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th";return t+i}}),Be?module.exports=we:"function"==typeof define&&define.amd?(define("moment",["require","exports","module"],function(t,e,i){return i.config&&i.config()&&i.config().noGlobal===!0&&(Ae.moment=xe),we}),_e(!0)):_e()}.call(this),define("apps/pods/views/v_channel_logs",["underscore","backbone","bipclient","c_channel_log","moment"],function(t,e,i,n){return ChannelLogsView=e.View.extend({events:{"click a.prev":"previous","click a.next":"next"},initialize:function(e,i){t.bindAll(this,"render","previous","next"),this.el=e,this.collection=new n(i),this.collection.fetch({success:this.render})},render:function(){var t,e=this.collection.models,i=$(this.el);if(e.length)for(var n=0;n<e.length;n++)t=moment(parseInt(e[n].get("created"))).format("MMMM Do YYYY, h:mm:ss a"),i.append('<tr><td class="alert alert-danger">'+$("<div/>").text(e[n].get("message").substring(0,400)).html()+'</td><td nowrap style="text-align:right" class="row-extras">Date <strong>'+t+"</strong><br/>Transaction <strong>"+e[n].get("transaction_id")+'</strong> <br/><a class="pull-right" href="/dash#bipio/'+e[n].get("bip_id")+'">View Source Bip</a></td></tr>');else $("#channel-logs-panel").html('<div class="alert alert-warning"><i class="icon-exclamation-sign"> No Logs Available</div>')},previous:function(t){return t.preventDefault(),$(t.currentTarget).hasClass("disabled")?void 0:(this.collection.prevPage(),!1)},next:function(t){return t.preventDefault(),$(t.currentTarget).hasClass("disabled")?void 0:(this.collection.nextPage(),!1)}}),ChannelLogsView}),define("apps/pods/views/v_channel_pod_list",["underscore","backbone","bipclient","models/m_channel","models/m_bip","apps/pods/views/v_channel_config","apps/pods/views/v_channel_logs","apps/bipio/views/v_bip_list"],function(t,e,i,n,r,s,o,a){var l=e.View.extend({el:"#channel-setup",tplModal:t.template($("#tpl-modal-auth").html()),tplAuthIsuuerToken:t.template($("#tpl-auth-issuer-token").html()),tplPodSelect:t.template($("#tpl-pod-select").html()),tplPodEntity:t.template($("#tpl-pod-entity").html()),tplActionEntity:t.template($("#tpl-action-entity").html()),tplActionSelect:t.template($("#tpl-action-select").html()),tplPostSave:t.template($("#tpl-post-save-dialog").html()),events:{"click .btn-verify":"verify","click .save-channel":"saveChannel","click #channel-delete-confirm":"remove","click .reauth":"reauthPod"},model:null,_router:null,configView:null,podFilters:[],initialize:function(e,n,r){t.bindAll(this,"render","reset","renderRow","updateRow","verify","verifyIssuerToken","podSelect","search","authModal","reauthPod","_authModalSpawn","saveChannel","remove","getBipsForChannel","validatedPublish","invalidModel","errTranslate","_credentialError","_renderPods","_renderChannel","_deAuthHandler","_authEvent"),this.collection=i.getCollection("pod"),this.collection.sort(),this._searchType=r||"all",n&&(this.collection.bind("reset",this.render),this.collection.bind("change",this.render)),this._router=n,this._configView=new s,i.authStatusChangeEvent.on(this._authEvent)},_authEvent:function(t){"accepted"===t.newstatus?this.trigger("pod:auth",t.provider):"disabled"===t.newstatus&&this.trigger("pod:deauth",t.provider)},render:function(t){var e=this;if(this._router){if(this.$el.html(this.tplPodSelect()),t){var n,r=i.getCollection("channel").get(t);r?(n=r.get("action").split("."),this._renderChannel(r,this.collection.get(n[0])),this.model=r):(i.growl("Action Does Not Exist","error"),this._renderPods())}else this._renderPods();$("#pod-search-form",this._container).on("keyup",function(){e.search($(this).val())})}},close:function(){this.unbind(),i.authStatusChangeEvent.unbind(this._authEvent)},reset:function(){this.render()},search:function(e){var i=t.map(e.split(","),function(t){return t.trim()});this.podFilters=[];for(var n=0;n<i.length;n++)i[n]&&this.podFilters.push(i[n]);this._renderPods(!0)},_renderPods:function(e,i){var r=this,s=this._searchType,i=i||r.podFilters;this.model=new n;var o=$("#pod-list",this.$el);return o.empty(),e&&!i&&(i=r.podFilters),this.collection.models.forEach(function(n){var a,l,c=e?!1:!0,u=!1;if((e||s)&&(a=n.get("name")+" "+n.get("title")+" "+n.get("tags"),n.get("tags")&&t.each(n.get("tags"),function(t){"all"===s&&(u=!0),a+=" "+t}),t.each(n.get("actions"),function(t,e){("all"===s||"actions"===s&&"invoke"===t.trigger||"emitters"===s&&"invoke"!==t.trigger||"emitters"===s&&"http"===t.trigger)&&(u=!0),a+=" "+e+" "+t.title}),i.length))for(var h=0;h<i.length&&!(i[h]&&(l=new RegExp(i[h],"gi"),c=l.test(a)));h++);(c&&u||u&&!i.length)&&r.renderRow(n,o)}),this},renderActionRow:function(n,r,s,o,a,l){var c=this;l||(l="");var u=a&&a.length?!1:!0;n.id&&$("#renderers li").click(function(){var t=$(this);return i.openRenderer(t.attr("data-cid"),t.attr("data-renderer")),!1}),actionList=$(".action-list",this.$el),s.remainingActions>0&&actionList.empty();for(action in o){if(n.id&&n.get("action")==r.get("name")+"."+action?(selectedAction=!0,l="active"):selectedAction=!1,a&&a.length){u=!1,currentAction=o[action],matchStr=currentAction.name+" "+currentAction.title+" "+currentAction.tags,currentAction.tags&&t.each(currentAction.tags,function(t){"all"===searchType&&(typeMatch=!0),matchStr+=" "+t});for(var h=0;h<a.length&&!(a[h]&&(actionFilter=new RegExp(a[h],"gi"),u=actionFilter.test(matchStr)));h++);}(!a||u)&&actionList.append(this._configView.render(r,action,o[action],n,l))}$(".action-list .action").click(function(t,n){if(!$(this).hasClass("active")&&!$(this).hasClass("browsing")){$("#action-search").hide(),$(".action-list .action").prop("checked",!1).trigger("change").removeClass("active"),$(".action-list .action input").attr("disabled",!0);var r=$("input.action-selected",$(this)).attr("value");schema=i.getCollection("pod").getActionSchema(r),podName=r.split(".")[0],c.model.isNew()&&($("#channel_name").val(schema.title),$("#channel_note").attr("placeholder",schema.description),$(".cancel-channel").html("&laquo; Back").on("click",function(t){e.history.loadUrl(e.history.fragment),t.preventDefault(),t.stopPropagation()})),$(this).addClass("active"),$(this).find("input").removeAttr("disabled"),$(".hidden",c.$el).removeClass("hidden"),$(".show",c.$el).removeClass("show").addClass("hidden"),$(".action-selectable").not(".active").hide(),$(".hidden",c.$el).remove(),$(this).find('input[name="action"]').prop("checked",!0).trigger("change"),n||c.trigger("view:actionSelected",schema,podName)}})},_renderChannel:function(e,n,r,s){function l(t){var e=!t.val().replace(/\s*/,""),i=t.parent();e?i.attr("empty",!0):i.removeAttr("empty")}for(var c,u,h=n.get("actions"),d="",p=!1,f=this,g={pod:n.toJSON(),channel:e.toJSON(),configure:!s,remainingActions:Object.keys(h).length},m={},f=this,v=!1,b=this._searchType,y=t.sortBy(h,function(t,e){return t.name=e,t.title}),_=0;_<y.length;_++)c=y[_],v=!1,("all"===b||"actions"===b&&"invoke"===c.trigger||"emitters"===b&&"invoke"!==c.trigger||"emitters"===b&&"http"===c.trigger)&&(v=!0),u=i.getCollection("channel").where({action:n.get("name")+"."+c.name}).length>0,e.id&&e.get("action")==n.get("name")+"."+c.name?(p=!0,d="active"):p=!1,v&&(!s&&(c.singleton&&!e.id&&u||e.id&&!p)?g.remainingActions--:m[c.name]=c);g.configure=g.configure&&g.remainingActions,g.hasBips=this.getBipsForChannel(e.id).length,this.trigger("podSelected",{pod:n,channel:e}),this.$el.html(this.tplActionSelect(g)),$("#action-search-form",this.$el).focus().on("keyup",function(i){if(27===i.keyCode)return void f.trigger("view:cancel");var r=$(this).val(),s=[];filters=t.map(r.split(","),function(t){return t.trim()});for(var o=0;o<filters.length;o++)filters[o]&&s.push(filters[o]);f.renderActionRow(e,n,g,m,s,d)}),this.renderActionRow(e,n,g,m,[],d),$(".btn-group button").on("click",function(){$(this).siblings("input[type=hidden]").val($(this).attr("data-selection"))}),this.$el.tab().on("shown",function(t){if("#channel_bips"===t.target.hash){var i=new a($("#bip-list-container"),this.router);models=f.getBipsForChannel(e.id),i.render(!0,models),$("#list-bip-container").addClass("row")}else if("#channel-data-panel"===t.target.hash)$("#channel-data-panel pre").html(jsl.format.formatJson(JSON.stringify(f.model.toJSON())));else if("#channel-logs-panel"===t.target.hash){var n=$("#log-body",t.target.hash);n.html()||new o(n,f.model.id)}}).tab("show"),$("[required] input").bind("propertychange keyup input paste",function(){l($(this))}),$("[required] input:not(#channel_name)").each(function(t,e){l($(e))}),r&&r()},getBipsForChannel:function(t){return i.getCollection("bip").filter(function(e){return-1!==e.get("_channel_idx").indexOf(t)})},errTranslate:function(t,e,i){var n=$("#channel_"+e.replace("config.",""),self.el).closest(".control-group");t?(n.addClass("error"),n.find(".help-block").html(i)):(n.removeClass("error"),n.find(".help-block").empty())},invalidModel:function(t,e){this.validatedPublish(),this.errTranslate(!1,"name"),this.errTranslate(!1,"note");for(key in e)this.errTranslate(!0,key,e[key])},validatedPublish:function(){$(".control-group").removeClass("error"),$(".help-block").empty()},saveChannel:function(t,r){var s,o=$(t.currentTarget),a=this;if(t.preventDefault(),!o.hasClass("disabled")){if($(".action-selectable:not(.active)").remove(),void 0===r){var r={};s=$("form.create-new-channel").serializeArray();for(var l,c,u,h,d,p=0;p<s.length;p++)if(u=s[p].value,d=s[p].name.split("#"),d.length>1){h=d[0],r[h]||(r[h]={}),c=r[h],l=d[1].split("/");for(var f=0;f<l.length;f++)h=l[f],f===l.length-1?c[h]?$.isArray(c[h])?c[h].push(u):c[h]=[c[h],u]:c[h]=u:(c[h]||(c[h]={}),c=c[h])}else h=s[p].name,r[h]=u}this.model&&!this.model.isNew()?this.model.set(r):this.model=new n(r),this.model.on("validated:invalid",this.invalidModel,this),this.model.on("validated:valid",this.validatedPublish,this),e.Validation.bind(this);var g,m,d=this.model.get("action").split("."),v=i.getCollection("pod").get(d[0]),b=v.get("actions")[d[1]].config.properties;for(key in b)if(m=b[key],g=[],m.optional||g.push({required:!0,msg:"Required"}),m.validate)for(var y=0;y<m.validate.length;y++)g.push(m.validate[y]);if(this.model.validate(),this.model.isValid(!0)){o.button("loading");var _=(this.model.isNew(),i.getCollection("channel").findWhere({name:this.model.get("name")}));!Object.keys(b).length&&_?(a.trigger("refresh"),a._router?(a._router.navigate("pods",!0),a.reset()):a.trigger("channel:saved",_)):this.model.save(this.model.toJSON(),{silent:!1,sync:!1,success:function(t){o.button("reset"),i.getCollection("channel").fetch({reset:!0,success:function(){i.decorateChannels(),a.trigger("refresh"),a._router||a.trigger("channel:saved",t)}}),a._router&&(a._router.navigate("pods",!0),a.reset()),i.growl("Action <strong>"+a.model.get("name")+"</strong> Saved")},error:function(t,e){o.button("reset");var n=JSON.parse(e.responseText);409===e.status?a.errTranslate(!0,"name","Action Name is already in use"):n.message?i.growl(n.message,"error"):i.growl("An Error Occurred","error")}})}}},remove:function(t){var e=this;t.stopPropagation(),t.preventDefault(),$("#channel-delete-dialog").modal("hide"),this.model.destroy({success:function(){i.growl("Action <strong>"+e.model.get("name")+"</strong> Deleted"),e._router.navigate("pods",!0),e.reset()},error:function(t,e){var n="An Error Occorred";409===e.status&&(n="<strong>"+t.get("name")+"</strong> is in use"),i.growl(n,"error")},wait:!0})},renderRow:function(t,e){var i=t.toJSON();i.auth_status_class="accepted"==i.auth.status?"alert-info":"",i.level_locked||(i.level_locked=!1),e.append(this.tplPodEntity(i))},reauthPod:function(t){var e=$(t.currentTarget),n=e.attr("data-pod"),r=i.getCollection("pod").get(n);r&&(t.preventDefault(),t.stopPropagation(),this._authModalSpawn(r,!0))},authModal:function(t){var e=$(t.currentTarget),n=e.attr("data-pod"),r=i.getCollection("pod").get(n);r&&(t.preventDefault(),t.stopPropagation(),this._authModalSpawn(r,"accepted"===r.get("auth").status))},_authModalSpawn:function(e,n,r){if(!r)var r="#authModal";var s,o=$(r),a=e.toJSON(),l=a.auth,c=this;if(a.reauth=n,"issuer_token"===l.strategy){var u=[];for(var h in l.properties)if(l.properties.hasOwnProperty(h)&&(u.push(l.properties[h].title),l.properties[h].description)){var d=$("<span>"+l.properties[h].description+"</span>"),p=$("a",d);t.each(p,function(t){$(t).attr("target","_blank")}),l.properties[h].description=d.html()}a.authEntities="<strong>"+u.join("</strong> and <strong>")+"</strong>"}else if("oauth"===l.strategy&&l.scopes.length){for(var f=[],g=0;g<l.scopes.length;g++)f.push(l.scopes[g].replace(/.*\/(.*)$/,"$1"));l.scopes=f}o.html(this.tplModal(a)),s=$(".modal-overlay",o),c._router||$(".modal-continue",s).remove(),$(".modal-continue",s).click(function(t){t.preventDefault(),s.hide(),c._router&&c._router.navigate("pods/pod/"+e.id+"/browse",{trigger:!0})}),$(".modal-authenticate",s).click(function(t){t.preventDefault();var i=$(".modal-authenticate").closest(".modal").find("form").serializeArray();c.verify(t,!1,i,e)}),$(".modal-deauth",s).click(function(){c.deAuthorize.apply(c,arguments)}),$(".modal-close").on("click",function(t){t.preventDefault(),!a.reauth&&c._router&&c._router.navigate("pods"),c.trigger("pod:authCancel"),s.hide()}),$(".modal-overlay",o).show(),$("i",o).popover(),i.centerModal($(".modal",o))},podSelect:function(t,e){var n=this;"accepted"==t.get("auth").status||"none"==t.get("auth")?n._renderChannel(i.getCollection("channel").newModel(),t):e?n._renderChannel(i.getCollection("channel").newModel(),t,void 0,!0):this._authModalSpawn(t)},updateRow:function(t){var e=$(".well",this.renderRow(t));$("#domain-entity-"+t.id).html(e)},_credentialError:function(t,e,i){var n=$("#authModal #"+e),r=n.closest(".control-group"),s=r.find(".help-block");s.html(i),t?r.addClass("error"):r.removeClass("error")},verifyIssuerToken:function(e){var i,n,r,s=this,o=($("#authModal #username"),$("#authModal #password"),$("#authModal #key"),!1);return t.each(e,function(t){"username"===t.name?(s._credentialError(!1,"username"),t.value&&""!==t.value?i=t.value:(s._credentialError(!0,"username","required"),o=!0)):"password"===t.name?(s._credentialError(!1,"password"),t.value&&""!==t.value?n=t.value:(s._credentialError(!0,"password","required"),o=!0)):"key"===t.name&&(s._credentialError(!1,"key"),t.value&&""!==t.value?r=t.value:(s._credentialError(!0,"key","required"),o=!0))}),o?void 0:[i,n,r]},_verifyHandler:function(t){this._router&&this._router.navigate("pods/pod/"+t,{trigger:!0}),this.trigger("pod:auth",t)},verify:function(t,e,n,r){var s,o,a,l,c,u=$(t.currentTarget),h=u.attr("data-model-id"),d=this;if(r=r||this.collection.get(h),o=r.get("auth").strategy,a=r.get("auth")._href,"issuer_token"===o){var p=d.verifyIssuerToken(n),l=p[0],c=p[1],f=p[2];if(!p)return!0}u.button("loading"),"oauth"===r.get("auth").strategy&&(s=window.open("","BipIO - Negotiating OAuth Token")),$.ajax("/auth/who",{success:function(t,n,r,o){return function(a){var l=$.parseJSON(a);if("issuer_token"===t.get("auth").strategy){var c=t.get("name");$.ajax({url:n,type:"GET",data:{username:r,password:o,key:f},xhrFields:{withCredentials:!0},beforeSend:function(t){return l.api_token_web?(t.setRequestHeader("Authorization","Basic "+l.api_token_web),t):void 0},success:function(){u.button("reset"),i.growl(c+" pod enabled","success"),i.authStatusChange(c,"accepted"),d._verifyHandler(c)},error:function(t,e,n){u.button("reset");var r;try{r=JSON.parse(t.responseText),r.message&&(r=r.message)}catch(s){}r=r||t.responseText||n,i.growl(i.getCollection("pod").get(c).get("title")+" : "+r,"error")},complete:function(){e||$("#authModal .modal-close").trigger("click")}})}else e||$("#authModal .modal-close").trigger("click"),u.button("reset"),s.location.href=n}}(r,a,l,c)})},_deAuthHandler:function(){this._router&&this._router.navigate("pods",{trigger:!0})},deAuthorize:function(t){t.preventDefault();var e,n,r=$(t.currentTarget),s=r.attr("data-model-id"),o=this,a=this.collection.get(s);e=a.get("auth").strategy,n=a.get("auth")._href,r.button("Forgetting..."),"issuer_token"===e?n=n.replace(/set$/,"deauth"):"oauth"===e&&(n=n.replace(/auth$/,"deauth")),$.ajax(n,{success:function(){i.authStatusChange(a.get("name"),"disabled"),i.growl(a.get("name")+" pod disabled"),r.button("reset"),$(".modal-close").trigger("click"),o._deAuthHandler(a.get("name"))},error:function(){r.button("reset"),i.growl("An Error Occurred","error")}})}});return l}),define("apps/bipio/views/v_functions_list",["underscore","backbone","bipclient","apps/pods/views/v_channel_pod_list"],function(t,e,i,n){return FunctionsListView=e.View.extend({tplFunctions:t.template($("#tpl-bipio-function-selector").html()),$select2:null,pods:[],_select2Opts:null,actionExlcusions:["flow.generator"],initialize:function(e){t.bindAll(this,"render","_resultFormatter"),this.el=e,this.$el=$(e),this.podListView=new n,this.pods=this.podListView.collection.filter(function(t){return-1!==i._functionPods.indexOf(t.id)})},_resultFormatter:function(t){var e=t.id.split("."),n=i.find.pod(e[0]).getIcon(e[1]);return'<img class="hub-icon hub-icon-16" src="'+n+'"> '+t.text},openSelect:function(){this.$select.select2("open")},bindEvents:function(){var t,e,i=this;this.$select.select2(this._select2Opts).on("change",function(t){i.$select.select2("data",null),i.trigger("function:selected",t.val)}).on("select2-open",function(){e.attr("class","icon-chevron-up")}).on("select2-close",function(){e.attr("class","icon-chevron-down"),i.trigger("select2-close")}),t=$("button.select2-arrow.dropdown-toggle",this.$el),t.attr("class","select2-arrow dropdown-toggle"),e=$("span.caret",t),e.attr("class","icon-chevron-down")},render:function(){var e,i=this;this.$el.append(this.tplFunctions()),this.$select=$("#function-select2 select",this.$el),this.pods.forEach(function(n){var r=n.get("actions");t.each(r,function(t,r){e=n.get("name")+"."+r,-1===i.actionExlcusions.indexOf(e)&&i.$select.append('<option value="'+e+'">'+t.title+"</option>")})}),this._select2Opts={placeholder:"Add A Function",allowClear:!0,containerCss:{width:"300px"},dropdownCssClass:"function-select2-active",formatResult:this._resultFormatter,formatSelection:this._resultFormatter},this.bindEvents()}}),FunctionsListView}),define("apps/bipio/views/v_bip_hub",["d3","underscore","backbone","bipclient","apps/bipio/views/v_functions_list"],function(t,e,i,n,r){return HubView=i.View.extend({el:"#hub",_bipSource:null,_actions:null,_currentExports:null,_radius:28,_arrowLength:7,_boundingBox:{top:36,bottom:10,left:10,right:10},_layoutConfig:{width:770,height:600},_mouseState:{upNode:null,downNode:null,upLink:null,downLink:null},_selectionState:{link:null,node:null},_svg:null,_forceLayout:null,_link:null,_node:null,_links:[],_nodes:[],_vis:null,_srcHelper:null,_drag_line:null,_functionListView:null,events:{"click svg":"refocus"},initialize:function(t){e.bindAll(this,"render","shutdown","getParentsForCID","getParentForCID","_redraw","_tick","_getNodeStruct","_removeSelectedNode","_setSelectedNodeParams","_spliceNodeLinks","_clearMouseState","_mouseCtl","_keyCtl","_bindBipSource","_addEdge","addChannel","selectSource","setTriggerSourceParams","refocus","linkNodes","setEmittingState","_enumerateActionPointer","addFunctionWidget"),this._bipSource=t},_pulseSettings:{fromr:16,tor:44,fromstroke:4,tostroke:1},render:function(i){var r=this._hub2D3(i);this._setDimensions(),this._clearMouseState(),this._actions=n.getCollection("channel").getActions(),pods=n.getCollection("pod").pluck("name"),-1===pods.indexOf("bipio")&&pods.push("bipio"),pods.push("undefined");var s=(t.scale.category20(),$('<div class="'+$("#bip-setup").attr("class")+'"></div>'));$("body").append(s),s.remove(),this._svg=t.select(this.el).append("svg:svg").attr("width",this._layoutConfig.width).attr("height",this._layoutConfig.height).attr("pointer-events","all"),this._svg.append("svg:defs").append("svg:marker").attr("id","end-arrow").attr("viewBox","0 -5 10 10").attr("refX",this._arrowLength).attr("markerWidth",3).attr("markerHeight",4).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5").attr("fill","inherit").attr("class","arrow"),this._svg.append("svg:defs").append("svg:marker").attr("id","end-arrow-selected").attr("viewBox","0 -5 10 10").attr("refX",this._arrowLength).attr("markerWidth",3).attr("markerHeight",4).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5").attr("fill","inherit").attr("class","arrow_selected"),this._vis=this._svg.append("svg:g").on("dblclick.zoom",null).append("svg:g").on("mousemove",this._mouseCtl("move")).on("mousedown",this._mouseCtl("down")).on("mouseup",this._mouseCtl("up")).on("touchmove",this._mouseCtl("touchmove")).on("touchstart",this._mouseCtl("touchstart")).on("touchend",this._mouseCtl("touchend")),this._vis.append("svg:rect").attr("width",this._layoutConfig.width).attr("height",this._layoutConfig.height).attr("fill","transparent"),this._drag_line=null,this._drag_line=this._vis.append("line").attr("class","drag_line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",0).attr("class","drag_line_hidden"),t.select("#hub-focus").on("keydown",this._keyCtl),"trigger"!==this._bipSource.get("type")&&this.addFunctionWidget(),this.refocus(),this._forceLayout=t.layout.force().nodes(r.nodes).links(r.links).size([this._layoutConfig.width,this._layoutConfig.height]).on("tick",this._tick),this._nodes=this._forceLayout.nodes(),this._links=this._forceLayout.links(),this._node=this._vis.selectAll("circle.node"),this._nodeFunction=this._vis.selectAll("path.node"),this._link=this._vis.selectAll(".link"),this._selectionState.node=e.where(this._nodes,{channel_id:"source"})[0],this._redraw(!0),this.setEmittingState(),i.source.edges.length&&this.addFunctionWidget(),this.on("channel:invalid",function(t,e){var i=this.getParentForCID(t);
i&&(i._invalid=!0,this.showNodeTooltip(i,e))}),this.on("channel:valid",function(t){var e=this.getParentForCID(t);e&&(e._invalid=!1,this.hideNodeTooltip(e))})},_setDimensions:function(){var t,e,i=$("#hub");return $("#hub").height($(window).height()-$("#hub").position().top-60),t=i.width(),e=i.height(),this._layoutConfig.width=t,this._layoutConfig.height=e,this._svg&&(this._svg.attr("width",t),this._svg.attr("height",e),this._redraw()),[t,e]},shutdown:function(){clearInterval(this._pulseIntvl),this.undelegateEvents(),this.$el.removeData().unbind(),this.$el.remove(),this.remove(),i.View.prototype.remove.call(this)},_enumerateActionPointer:function(t){var i,r=e.pluck(this._nodes,"channel_id"),s=0;if(!n.isUUID(t)){for(var o=0;o<r.length;o++)i=Number(r[o].split(".").pop().replace("_","")),!isNaN(i)&&i>=s&&(s=i+1);t=t+"._"+s}return t},addChannel:function(t,e,i){t=this._enumerateActionPointer(t),e&&i||!this._selectionState.node||(e=this._selectionState.node.x+40,i=this._selectionState.node.y+40);var r={channel_id:t,fill:n.find.channel(t).getIcon(),x:e,y:i,_tooltip:null,_dirty:!0,_invalid:!1,_parent:null,_new:!0,_bipSource:this._bipSource},s=this;this._nodes.push(r);var o=this._selectionState.node;this._selectionState.node=r,this._setSelectedNodeParams(t,!0),this._selectionState.node=o,s._redraw(),this.renderTooltip(r),this.refocus()},renderTooltip:function(e){e._tooltip=t.select(this.el).append("div").attr("id","hub-tooltip-"+e.channel_id).attr("class","hub-tooltip").style("position","absolute").style("z-index","10").style("opacity",.9),e._tooltip.attr("class","hub-tooltip alert alert-danger"),e._tooltip.style("display","block")},hideNodeTooltip:function(t){t._tooltip&&t._tooltip.style("z-index",-1).style("opacity",0)},showNodeTooltip:function(t,e){var i=this;if(t._tooltip||this.renderTooltip(t,e),e){{e.split(":")}t._tooltip.html('<i class="icon-exclamation-sign"></i>'),t._tooltip.style("top",parseInt(t.py)-32+"px").style("left",parseInt(t.px)-8+"px").style("z-index","10").style("opacity",.9),setTimeout(function(){i.hideNodeTooltip(t)},3e3),this._redraw()}},refocus:function(){$("#hub-focus").focus()},getParentForCID:function(t){var i={};return"source"===t?i.source=!0:i.channel_id=t,e.findWhere(this._nodes,i)},getParentsForCID:function(t){for(var e,i=[],n=t;n&&"source"!==n;)e=this.getParentForCID(n),n=e._parent,n&&(n=n.channel_id,i.push(n));return i},linkNodes:function(t,e){var i,n=this,r=this._nodeDegree(e);return 0===r["in"]&&e&&!e.source?(i={source:t,target:e},e._parent=t,n._links.push(i),n._selectionState.link=null,n._selectionState.node=e,i.target._dirty=!1,!1):t&&e&&t.channel_id!==e.channel_id?(n._selectionState.link=null,n._selectionState.node=null,n._drag_line.attr("class","drag_line_hidden"),n._clearMouseState(),"Cannot Link Backwards"):void 0},_redrawEnded:!0,_getChannelId:function(t){var e,i=t._bipSource.get("type");return"source"===t.channel_id?"trigger"===i?(e=t._bipSource.get("config").channel_id,e||(e="trigger")):e=t._bipSource.get("config").channel_id?t._bipSource.get("config").channel_id:i:e=t.channel_id,e},_redraw:function(i){var r=this;this._redrawEnded=!1,this._link=this._link.data(this._links,function(t){return t.source.channel_id+"-"+t.target.channel_id}),this._link.enter().insert("line",".node").style("marker-end",function(){return'url("#end-arrow")'}).attr("class","link").attr("class","link-fat").on("mousedown",function(t){r._mouseState.downLink=t,r._mouseState.downLink==r._selectionState.link?r._selectionState.link=null:(r._selectionState.link=r._mouseState.downLink,r.refocus()),r._selectionState.node=null,r._redraw()}).on("mouseover",function(t){if(r._forceLayout.alpha()<.1){var i=r._getChannelId(t.source),n=r._getChannelId(t.target);e.debounce(function(){r.trigger("edge:hover",i,n)},100,!0)()}}).on("mouseout",function(){r._forceLayout.alpha()<.1&&r.trigger("edge:dehover")}),this._link.exit().remove(),this._link.classed("link_selected",function(t){return t===r._selectionState.link}),this._link.style("marker-end",function(t){return t===r._selectionState.link?"url(#end-arrow-selected)":'url("#end-arrow")'});for(var s=[],o=[],a=0;a<this._nodes.length;a++)n.isFunctionPod(this._nodes[a].action)?o.push(this._nodes[a]):s.push(this._nodes[a]);this._node=this._node.data(s,function(t){return t.channel_id}),this._nodeFunction=this._nodeFunction.data(o,function(t){return t.channel_id});var l=0;if(this.selection=function(i,s){$(i).unbind();{var o,a=i.map(function(t){return t[0]&&t[0].__data__?t[0].__data__:{}})[0],c=i.insert("g");n.getCollection("channel").get(a.channel_id)}c.append("svg:image").attr("xlink:href",function(t){return t.fill}).attr("width",function(t){return n.isFunctionPod(t.action)?36:2*r._radius-13}).attr("height",function(t){return n.isFunctionPod(t.action)?36:2*r._radius-13}).attr("x",0).attr("y",0),o=c.insert(s).attr("r",this._radius),c.attr("class",function(t){var e="node";return"source"===t.channel_id&&(t.source=!0,e+=" node_source","Event Source"===t.label&&(e+=" node_init")),e}).attr("data-cid",function(t){return t.channel_id}).on("click",function(t){"source"===t.channel_id&&"Event Source"===t.label?r.trigger("loadPods"):r._mouseState.downNode==r._selectionState.node&&(r._selectionState.node=null)}).on("dblclick",function(t){return t._dirty?void n.growl("This Action Needs A Connection First!","warning"):(r._mouseState.downNode=t,r._selectionState.node=r._mouseState.downNode,r._drag_line.attr("class","drag_line_hidden"),r._redraw(),void r._initModal(t.channel_id,"transforms"))}).on("touchstart",function(){var e=t.event.timeStamp;if(500>e-l){var i=document.createEvent("UIEvents");i.initUIEvent("dblclick",!0,!0),t.event.srcElement.dispatchEvent(i),l=0}var i=document.createEvent("UIEvents");i.initUIEvent("mousedown",!0,!0),t.event.srcElement.dispatchEvent(i),l=e}).on("mousedown",function(e){if(r._nodes.length>1){if(t.event.shiftKey&&r._selectionState.node&&e!==r._selectionState.node){var i=r.linkNodes(r._selectionState.node,e);"reversal"===i?(r._addEdge(e._parent),r._selectionState.node=e):i?n.growl(i,"error"):(r._addEdge(e),r._selectionState.node=e._parent)}else r._mouseState.downNode=e,r._selectionState.node=r._mouseState.downNode,r.refocus(),r._selectionState.link=null,r._drag_line.attr("class","link").attr("x1",r._mouseState.downNode.px).attr("y1",r._mouseState.downNode.py).attr("x2",r._mouseState.downNode.px).attr("y2",r._mouseState.downNode.py);r._redraw()}}).on("contextmenu",function(){}).on("mousedrag",function(){r._redraw()}).on("mouseup",function(t){if(r._mouseState.downNode){if(r._mouseState.upNode=t,r._mouseState.upNode==r._mouseState.downNode)return r._drag_line.attr("class","drag_line_hidden"),void r._clearMouseState();r._clearCollision();var e=r.linkNodes(r._mouseState.downNode,r._mouseState.upNode);e&&"reversal"!==e&&(n.growl(e,"error"),r._selectionState.link=null,r._selectionState.node=null,r._drag_line.attr("class","drag_line_hidden"),r._clearMouseState()),r._redraw()}}).on("mouseover",function(t){var i,n=t._bipSource.get("type");r._forceLayout.alpha()<.1&&(t._tooltip&&1==t._invalid&&r.showNodeTooltip(t),"source"===t.channel_id?"trigger"===n?(i=t._bipSource.get("config").channel_id,i||(i="trigger")):i=t._bipSource.get("config").channel_id?t._bipSource.get("config").channel_id:n:i=t.channel_id,e.debounce(function(){r.trigger("channel:hover",i,t._parent)},100,!0)())}).on("mouseout",function(t){r._forceLayout.alpha()<.1&&(t._tooltip&&r.hideNodeTooltip(t),e.debounce(function(){r.trigger("channel:dehover")},100,!0)())}).transition().duration(50).ease("linear")},this.selection(this._node.enter(),"circle"),this.selection(this._nodeFunction.enter(),"path"),this._node.exit().transition().attr("r",0).remove(),this._node.classed("node_selected",function(t){return t===r._selectionState.node}),this._node.classed("node_orphan",function(t){return t._dirty}),this._node.classed("node_invalid",function(t){return t._invalid||t.collision_invalid}),this._node.classed("node_collide",function(t){return t.collision&&!t.collision_invalid}),this._nodeFunction.exit().transition().attr("r",0).remove(),this._nodeFunction.classed("node_selected",function(t){return t===r._selectionState.node}),this._nodeFunction.classed("node_orphan",function(t){return t._dirty}),this._nodeFunction.classed("node_invalid",function(t){return t._invalid||t.collision_invalid}),this._nodeFunction.classed("node_collide",function(t){return t.collision&&!t.collision_invalid}),t.event&&t.event.preventDefault(),this._forceLayout.linkDistance(85).charge(-1400).friction(.5).chargeDistance(900).alpha(.05).size([this._layoutConfig.width,this._layoutConfig.height]).on("end",function(){r._redrawEnded=!0}),this._forceLayout.start(),i){for(var c=0;this._forceLayout.alpha()>0&&(this._forceLayout.tick(),!(c++>100)););this._forceLayout.stop()}},selectSource:function(){for(var t=0;t<this._nodes.length;t++)if("source"==this._nodes[t].channel_id){this._selectionState.node=this._nodes[t];break}},setEmittingState:function(){var e=this;this._pulseIntvl&&clearInterval(this._pulseIntvl),this._pulseIntvl=setInterval(function(){var i,n,r=t.select("g.node_source circle");try{i=r.attr("cx"),n=r.attr("cy"),t.select("g > g").insert("circle","line").attr("class","ring").attr("cx",i).attr("cy",n).attr("r",e._pulseSettings.fromr).style("stroke-width",e._pulseSettings.fromstroke).style("stroke","#0194a4").style("fill","white").transition().ease("linear").duration(700).style("stroke-opacity",0).style("stroke-width",e._pulseSettings.tostroke).style("stroke","#0194a4").style("fill","white").attr("r",e._pulseSettings.tor).remove()}catch(s){clearInterval(e._pulseIntvl)}},1e3)},addFunctionWidget:function(t){if(t&&($("#function-select2").remove(),delete this._functionListView),!this._functionListView){var e=new r("#hub"),i=this;e.render(),e.on("function:selected",function(t){i.addChannel(t)}).on("select2-close",function(){setTimeout(function(){i.refocus()},200)}),this._functionListView=e}},setTriggerSourceParams:function(t){var i,n=this,r=$(this._node[0]);this._bindBipSource(t),this.selectSource(),this._setSelectedNodeParams(t.get("config").channel_id,!0);for(var s=0;s<r.length;s++)if(i=$(r[s]),"source"===i.attr("data-cid")){i.attr("class",function(t,e){return e.replace("node_init","")});break}$("circle.ring").remove();var o=e.clone(this._pulseSettings);this._pulseSettings={fromr:18,tor:40,fromstroke:6,tostroke:10},this.setEmittingState(),setTimeout(function(){n._pulseSettings=o},2e3),this.addFunctionWidget()},bindBipSourceIcon:function(t){$("g.node_source image").attr("href",t)},_bindBipSource:function(t){this._bipSource=t;for(var e=0;e<this._nodes.length;e++)if(this._nodes[e].source){this._nodes[e]._bipSource=this._bipSource,this.bindBipSourceIcon(this._bipSource.getIcon());break}},_addEdge:function(t){var e,i,n=t||this._selectionState.node,r=n._bipSource.get("hub"),s=n._parent;i=s._parent?s.channel_id:"source",r[i]||(r[i]={}),r[i].edges||(r[i].edges=[]),e=r[i],$.inArray(n.channel_id,e.edges)<0&&e.edges.push(n.channel_id),(!e.transforms||n.channel_id&&!e.transforms[n.channel_id])&&this.trigger("transform:hint",n.channel_id,i,"source"===i),this._activeModal&&this._activeModal.modal("hide"),this.trigger("channel:dehover")},_removeSelectedNode:function(){var t;if(this._selectionState.node&&!this._selectionState.node.source){t=this._selectionState.node,this.trigger("channel:remove",t.channel_id),this.trigger("channel:dehover");for(var i=e.filter(this._nodes,function(e){return e._parent&&e._parent.channel_id===t.channel_id}),n=0;n<i.length;n++)i[n]._parent=null;e.each(this._links,function(e){e.source===t&&(e.target._dirty=!0)}),this._selectionState.node=null,this._nodes.splice(this._nodes.indexOf(t),1),this._spliceNodeLinks(t),this._currentExports=null,t._parent=null}},_spliceNodeLinks:function(t){var e=this,i=this._links.filter(function(e){return e.source===t||e.target===t});i.map(function(t){e._links.splice(e._links.indexOf(t),1)})},_setSelectedNodeParams:function(t){if(this._selectionState.node)if(t){!this._selectionState.node.oldChannelId&&this._selectionState.node.channel_id&&(this._selectionState.node.oldChannelId=this._selectionState.node.channel_id);var e=n.getCollection("channel").get(t);this._selectionState.node.channel_id=t,this._selectionState.node.label=e.get("name"),this._selectionState.node.fill=this._selectionState.node.fill?this._selectionState.node.fill:"image_"+e.get("action").split(".")[0],this._selectionState.node.gone=!1,this._selectionState.node.action=e.get("action")}else this._selectionState.node.channel_id=null,this._selectionState.node.fill="",this._selectionState.node.gone=!0},channelReplace:function(t,i){e.each(this._nodes,function(e){e.channel_id===t&&(e.channel_id=i)})},_getNodeStruct:function(t){var e,i=this._layoutConfig.width/2,r=this._layoutConfig.height/2,s={channel_id:t,gone:!1,fill:"",weight:2,transforms:{}},o=this._bipSource,a=(o.get("config"),n.getChannel(t));return"source"===t?(e=o.getIcon(),s={channel_id:"source",label:this._bipSource.get("name")||this._bipSource.get("_repr"),gone:!1,fill:e,action:this._bipSource.get("action"),x:i,y:r,cx:i,cy:r}):a?(s.action=a.get("action"),s.label=a.get("name"),s.fill=a.getIcon()):(s.gone=!0,s.label="GONE!"),s._bipSource=this._bipSource,s},_hub2D3:function(t){var e,i=[],n=[],r={};for(var s in t){r[s]||(r[s]=this._getNodeStruct(s,this._actions));for(var o=0;o<t[s].edges.length;o++)e=t[s].edges[o],r[e]||(r[e]=this._getNodeStruct(e,this._actions)),i.push({source:r[s],target:r[e],weight:2})}for(var o=0;o<i.length;o++)i[o].target._parent=i[o].source;for(var a in r)n.push(r[a]);return{nodes:n,links:i}},_pathDeltas:function(t){var e=t.target.x-t.source.x,i=t.target.y-t.source.y,n=Math.sqrt(e*e+i*i);return{normX:e/n,normY:i/n}},_angleRad:function(t,e){return e?Math.atan2(t.source.y-t.target.y,t.source.x-t.target.x):Math.atan2(t.target.y-t.source.y,t.target.x-t.source.x)},_nodeDegree:function(t){for(var e=this,i=0,n=0,r=0;r<e._links.length;r++){if(link=e._links[r],link.target===t){i++;break}link.source===t&&n++}return{"in":i,out:n}},_pointCollision:function(t,i){var n,r,s=this,o=1.5*this._radius;return this._clearCollision(),e.each(this._nodes,function(e){var a=t-e.x,l=i-e.y,c=Math.sqrt(a*a+l*l);e!==s._mouseState.downNode&&c<o+s._radius&&(void 0===n||n>c)&&(n=c,r&&(r.collision=!1),r=e,r.collision=!0,r.collision_invalid=!!s._nodeDegree(e)["in"])}),r},_clearCollision:function(){e.each(this._nodes,function(t){delete t.collision,delete t.collision_invalid})},_testBounds:function(t,e){return t<this._boundingBox.left?t=this._boundingBox.left:t>this._layoutConfig.width-this._boundingBox.right&&(t=this._layoutConfig.width-this._boundingBox.right),e<this._boundingBox.top?e=this._boundingBox.top:e>this._layoutConfig.height-this._boundingBox.bottom&&(e=this._layoutConfig.height-this._boundingBox.bottom),[t,e]},_tick:function(){var e=this,i=this._radius;this._node.select("circle").attr("cx",function(t){return Math.max(i,Math.min(e._layoutConfig.width-i,e._testBounds(t.x,t.y)[0]))}).attr("cy",function(t){return Math.max(i,Math.min(e._layoutConfig.height-i,e._testBounds(t.x,t.y)[1]))}),this._node.select("image").attr("x",function(t){return Math.max(i,Math.min(e._layoutConfig.width-i,t.x))-e._radius+7}).attr("y",function(t){return Math.max(i,Math.min(e._layoutConfig.height-i,t.y))-e._radius+7});var r=t.svg.line().x(function(t){return t[0]}).y(function(t){return t[1]}).interpolate("linear");this._nodeFunction.select("path").attr("x",function(t){return Math.max(i,Math.min(e._layoutConfig.width-i,e._testBounds(t.x,t.y)[0]))}).attr("y",function(t){return Math.max(i,Math.min(e._layoutConfig.height-i,e._testBounds(t.x,t.y)[1]))}).attr("d",function(t){var n=Math.sqrt(3)/2,s=Math.floor(.7*e._radius),o=Math.ceil(Math.max(i,Math.min(e._layoutConfig.width-i,t.x))),a=Math.ceil(Math.max(i,Math.min(e._layoutConfig.height-i,t.y))),l=[[s+o,n+a],[s/2+o,s*n+a],[-s/2+o,s*n+a],[-s+o,0+a],[-s/2+o,-s*n+a],[s/2+o,-s*n+a],[s+o,n+a]];return r(l)}),this._nodeFunction.select("image").attr("x",function(t){return Math.max(i,Math.min(e._layoutConfig.width-i,t.x))-18}).attr("y",function(t){return Math.max(i,Math.min(e._layoutConfig.height-i,t.y))-18}),this._node._tooltip&&this._node._tooltip.style("top",parseInt(node.py)-32+"px").style("left",parseInt(node.px)-8+"px"),this._link.attr("x1",function(t){var r=e._angleRad(t),s=n.isFunctionPod(t.source.action)?7:2;return Math.cos(r)*(i-s)+t.source.x}).attr("y1",function(t){var r=e._angleRad(t),s=n.isFunctionPod(t.source.action)?7:2;return Math.sin(r)*(i-s)+t.source.y}).attr("x2",function(t){var n=e._angleRad(t,!0);return Math.cos(n)*(i+7)+t.target.x}).attr("y2",function(t){var n=e._angleRad(t,!0);return Math.sin(n)*(i+7)+t.target.y})},_initModal:function(t,e){{var i=!this._selectionState.node._parent||!this._selectionState.node._parent._parent;"trigger"===this._bipSource.get("type")}"transforms"===e?this._selectionState.node._parent?this.trigger("transform:cid",t,this._selectionState.node._parent.channel_id,i):this._selectionState.node._bipSource.get("config").channel_id&&(t=this._selectionState.node._bipSource.get("config").channel_id,this.trigger("trigger:configure",t)):this.trigger("select:cid",t,this._selectionState.node._parent.channel_id,i)},_modalEvTimer:null,_getSelection:function(){var t;return window.getSelection&&window.getSelection().rangeCount>0?t=window.getSelection().getRangeAt(0).cloneRange():document.selection&&(t=document.selection.createRange()),t},_updateFocus:function(t){var e=document.createRange(),i=window.getSelection();e.setStart(t,0),e.collapse(!0),i.removeAllRanges(),i.addRange(e)},_getValidExportParent:function(t){var e=t._parent;return e&&e._hasExports||e===e._bipSource?e:this._getValidExportParent(t._parent)},_getExports:function(){return this._currentExports},_mouseCtl:function(e){var i=this,r=this._mouseState;return"move"==e||"touchmove"==e?function(){return r.downNode?(i._drag_line.attr("x1",r.downNode.x).attr("y1",r.downNode.y).attr("x2",t.mouse(this)[0]).attr("y2",t.mouse(this)[1]),i._pointCollision(t.mouse(this)[0],t.mouse(this)[1]),i._redraw(),!1):void 0}:"up"==e||"touchend"==e?function(){var e=!1;if(i._drag_line.attr("class","drag_line_hidden"),r.downNode){if(!r.upNode){r.upNode=i._pointCollision(t.mouse(this)[0],t.mouse(this)[1]);var s=i.linkNodes(r.downNode,r.upNode);s&&(r.upNode=null,n.growl(s,"error"))}r.upNode&&(i._selectionState.node=r.upNode,r.upNode._parent=r.downNode,i._addEdge(),i.trigger("channel:dehover")),i._clearCollision(),i._redraw(),e&&i._initModal()}i._clearMouseState()}:"down"==e||"touchstart"==e?function(){}:void 0},_keyCtl:function(){var e=this;if((this._selectionState.node||this._selectionState.link)&&"hub-focus"===t.event.target.id){switch(t.event.keyCode){case 8:case 46:if(this._selectionState.node)this._removeSelectedNode();else if(this._selectionState.link){var i=this._selectionState.link;e.trigger("channel:remove",i.target.channel_id),e.trigger("channel:dehover"),this._selectionState.link.target._parent=null,this._selectionState.link.target._dirty=!0,this._links.splice(this._links.indexOf(this._selectionState.link),1)}this._selectionState.link=null,this._selectionState.node=null,this._redraw();break;case 73:if(t.event.ctrlKey)return e._functionListView.openSelect(),!1}e.trigger("keyEvent",t.event)}},_clearMouseState:function(){this._mouseState.upNode=this._mouseState.downNode=this._mouseState.upLink=this._mouseState.downLink=null}}),HubView}),define("models/m_bip_log",["underscore","backbone"],function(t,e){return t.extend(e.Model.prototype,e.Validator),MBipLog=e.Model.extend({}),MBipLog}),define("c_bip_log",["underscore","backbone","models/m_bip_log","bipclient"],function(t,e,i,n){var r=e.Collection.extend({model:i,page:1,page_size:50,total:0,num_pages:1,sortBy:"recent",searchBy:"",bipId:null,initialize:function(e){t.bindAll(this,"parse","nextPage","prevPage","pageInfo","sort","search"),n.setCollection("bip_log",this),this.bipId=e},url:function(){return n.getResourceName("bip/"+this.bipId+"/logs",this.page,this.page_size,this.sortBy)},parse:function(t){return this.page=t.page,this.page_size=t.page_size,this.total=t.total,this.num_pages=t.num_pages,t.data},nextPage:function(){var t=this.page+1;return this.page=t>this.num_pages?this.page:t,this.fetch()},prevPage:function(){var t=this.page-1;return this.page=1>=t?1:t,this.fetch()},pageInfo:function(){return{page_current:this.page,page_total:this.num_pages,page_size:this.page_size,result_total:this.total}},sort:function(t){return this.sortBy=t,this.fetch()},search:function(t){return this.searchBy=t,this.fetch()},clear:function(t){var e=this;n._request(null,n.getResourceName("bip/"+this.bipId+"/logs"),"DELETE",function(){e.fetch({success:t})},function(){n.growl("An Error Occurred","error")},!0)}});return r}),define("apps/bipio/views/v_bip_logs",["underscore","backbone","bipclient","c_bip_log","moment"],function(t,e,i,n){return BipLogsView=e.View.extend({el:"#log-body",events:{"click a.prev":"previous","click a.next":"next"},initialize:function(e){t.bindAll(this,"render"),this.collection=new n(e),this.refresh()},error:function(t){this.$el.empty(),i.growl(t,"error")},refresh:function(t){var e=this;this.collection.fetch({success:function(){e.render(),t&&t()},error:function(){e.error("An Error Occurred Retrieving Logs"),t&&t()}})},render:function(){var t,e,n,r=this.collection.models,s=this.$el,o=i.getCollection("channel"),a={bip_create:"Created",bip_deleted_auto:"Expired (Deleted)",bip_deleted_manual:"Deleted",bip_recieve:"Message Received",bip_paused_auto:"Expired (Paused)",bip_paused_manual:"Manually Paused",bip_share:"Config Shared",bip_unshare:"Config Un-Shared",bip_invoke:"Invoked",bip_channnel_error:"Error"};s.empty();for(var l=0;l<r.length;l++)e=moment(parseInt(r[l].get("created"))).format("MMMM Do YYYY, h:mm:ss a"),t=r[l].toJSON(),n=o.get(t.source),t.source=t.source&&n?'<img class="mini hub-icon" src="'+n.getIcon()+'"/> '+n.get("name"):"system",s.append("<tr><td>"+e+"</td><td>"+a[t.code]+"</td><td>"+t.source+'</td><td width="50%" class="'+("bip_channnel_error"===t.code?"alert alert-error":"")+'">'+t.message+"</td></tr>")}}),BipLogsView}),define("apps/bipio/views/v_req_parser",["underscore","backbone","bipclient"],function(t,e,i){return ParserView=e.View.extend({tplParser:t.template($("#tpl-bipio-parser").html()),events:{},initialize:function(e){var n=this;t.bindAll(this,"render","_setExports");var r=e.containerId||"bip-parser-panel";e.tplSelector&&(this.tplParser=t.template($(e.tplSelector).html())),e.tabContainer&&$(e.tabContainer).append('<li><a data-toggle="pill" href="#'+r+'"> Parser</a></li>'),e.contentContainer&&$(e.contentContainer).append('<div class="tab-pane span12" id="'+r+'"></div>'),e.el?this.$el=e.el:(this.el="#"+r,this.$el=$(this.el)),this.$el.html(this.tplParser()),$("#parse-json",this.$el).on("click",function(){var t=$("#sample-request",n.$el).val(),e=$(this);try{t=JSON.parse(t)}catch(r){return void i.growl("Payload Is Not Valid JSON","error")}e.button("loading"),i._request(t,i.find.pod("flow").get("rpcs").json_to_schema._href,"POST",function(t){n._setExports(t),n.trigger("schema:imported",t),e.button("reset")},function(t,n,r){i.growl(r,"error"),e.button("reset")},!0)})},_setExports:function(t){$("#json-schema",this.$el).html(JSON.stringify(t,!0,4))},render:function(t){t=t||{},this._setExports(t),$("#sample-request").text(JSON.stringify(i.schema2JSON(t),!0,4))}}),ParserView.test=function(){var t=i.find.pod("flow");return t&&t.get("rpcs").json_to_schema},ParserView});var jsl="undefined"==typeof jsl?{}:jsl;jsl.format=function(){function t(t,e){return new Array(e+1).join(t)}function e(t,e,i){try{jsonValue=i,currentValue=JSON.parse(t.val()),jsonValue.name=currentValue.name,jsonValue.note=currentValue.note,jsonValue.end_life=currentValue.end_life,jsonValue.paused=currentValue.paused,jsonValue.binder=currentValue.binder,jsonValue.icon=currentValue.icon,currentValue.hub.transforms?(jsonValue.hub.transforms={},$.each(currentValue.hub.transforms,function(t,e){jsonValue.hub.transforms[t]={},$.each(e,function(e,i){jsonValue.hub.transforms[t][e]=i})})):delete jsonValue.hub.transforms,t.val(JSON.stringify(jsonValue,void 0,4)),e.innerHTML=JSON.stringify(jsonValue,void 0,4),$("#bip_name").val(jsonValue.name)}catch(n){t.val(JSON.stringify(jsonValue,void 0,4)),e.innerHTML=JSON.stringify(jsonValue,void 0,4)}}function i(e){var i=0,n=0,r="    ",s="",o=0,a=!1,l=null;for(i=0,n=e.length;n>i;i+=1)switch(l=e.charAt(i)){case"{":case"[":a?s+=l:(s+=l+"\n"+t(r,o+1),o+=1);break;case"}":case"]":a?s+=l:(o-=1,s+="\n"+t(r,o)+l);break;case",":s+=a?l:",\n"+t(r,o);break;case":":s+=a?l:": ";break;case" ":case"\n":case"	":a&&(s+=l);break;case'"':i>0&&"\\"!==e.charAt(i-1)&&(a=!a),s+=l;break;default:s+=l}return s}function n(t){var e=JSON.parse(t),i=["name","note","icon","end_life.action"],n=["paused","end_life.imp","end_life.time"],r=["binder"];i.forEach(function(i){try{var n;1!=i.split(".").length?(n='"'+i.split(".")[1]+'": "'+e[i.split(".")[0]][i.split(".")[1]]+'"',i=i.split(".")[1]):n='"'+i+'": "'+e[i]+'"';var r=t.split(n);if(r.length>1){var s=n.split(":");t=r[0]+"<span>"+s[0]+'</span>:"<span contenteditable=true '+("name"==i?'id="bip-name"':"")+">"+s[1].split('"')[1]+'</span>"'+r[1]}}catch(o){}}),n.forEach(function(i){try{var n;1!=i.split(".").length?(n='"'+i.split(".")[1]+'": '+e[i.split(".")[0]][i.split(".")[1]],i=i.split(".")[1]):n='"'+i+'": '+e[i];var r=t.split(n);if(r.length>1){var s=n.split(":");t=r[0]+"<span >"+s[0]+"</span>:<span contenteditable=true>"+s[1]+"</span>"+r[1]}}catch(o){}}),r.forEach(function(i){stringToSplit='"'+i+'": '+JSON.stringify(e[i]);var n=t.split(stringToSplit);if(n.length>1){var r=stringToSplit.split(":"),s="";try{var o=JSON.parse(r[1]);if(o.length>0){s='"'+o[0]+'"';for(var a=1;a<o.length;a++)s='\n,"'+o[a]+'"'}}catch(l){}t=n[0]+"<span >"+r[0]+"</span>:[<span contenteditable=true>"+s+"</span>]"+n[1]}});try{e.hub.transforms.forEach(function(i){i.forEach(function(i){try{stringToSplit='"'+i+'": "'+e[i]+'"';var n=t.split(stringToSplit);if(n.length>1){var r=stringToSplit.split(":");t=n[0]+"<span >"+r[0]+'</span>:"<span contenteditable=true>'+r[1].split('"')[1]+'</span>"'+n[1]}}catch(s){}})})}catch(s){}return t}return{formatJson:i,changeJSON:e,changeToEditable:n}}(),define("apps/bipio/views/v_bip_data",["underscore","backbone","bipclient"],function(t,e,i){return BipDataView=e.View.extend({tplParser:t.template($("#tpl-bipio-data").html()),events:{},initialize:function(e,i){t.bindAll(this,"render");var n="bip-data-panel";$(e).append('<li><a data-toggle="pill" href="#'+n+'"> Data View</a></li>'),$(i).append('<div class="tab-pane span12" id="'+n+'"></div>'),this.el="#"+n,this.$el=$(this.el),this.$el.html(this.tplParser())},publish:function(){$("#bip-data-panel pre").first()[0]},render:function(e){var n=e.toJSON();delete n.created,t.each(n,function(t,e){0===e.indexOf("_")&&delete n[e]}),$("pre",this.$el).html(JSON.stringify(JSON.parse(i.htmlEncode(JSON.stringify(n))),void 0,4))}}),BipDataView}),define("models/m_pod",["underscore","backbone","bipclient"],function(t,e){return e.Model.extend({validate:function(){},initialize:function(){},getExports:function(t){return this.actions[t].exports.properties},getImports:function(t){return this.get("actions")[t].imports.properties},getRenderer:function(){},getIcon:function(t){return"flow"===this.get("name")&&t?"/static/img/channels/32/color/flow/"+t+".png":"dataviz"===this.get("name")&&t?"/static/img/channels/32/color/dataviz/"+t+".png":this.get("icon")},isAuthed:function(){return"accepted"===this.get("auth").status},getAction:function(t){return this.get("actions")[t]},isValidEnum:function(t,e,i,n){var r,s,o,a,l,c=this.getAction(t),u=c[e],h=!1;if(u.properties[i]&&(u.properties[i].oneOf?l=u.properties[i].oneOf:u.properties[i].anyOf&&(l=u.properties[i].anyOf),l))for(var d=0;d<l.length;d++)if(r=l[d],r.$ref){context=0===r.$ref.indexOf("#")?c:this.toJSON(),o=r.$ref.replace(/^#\//,"").split("#"),s=o[0].split("/"),s[0]||s.shift();for(var p=0;p<s.length;p++){if(a=a?a[s[p]]:context[s[p]],a&&a._href)return!1;if(p===s.length-1){if(/^{.*}$/.test(s[p]))return!1;if(a&&a["enum"])return-1!==a["enum"].indexOf(n)}}}return h},hasConfig:function(t){var e=t.split(".");t=e.length>1?e[1]:e[0];var i=this.get("actions")[t];return!!(i&&i.config&&i.config.properties&&Object.keys(i.config.properties).length)}})}),define("c_pod",["underscore","backbone","models/m_pod","bipclient"],function(t,e,i,n){return PodCollection=e.Collection.extend({model:i,url:n.getPodDescriptions,comparator:"title",initialize:function(){n.setCollection("pod",this)},parse:function(e){var i,n=[];for(podName in e)i=e[podName],i.id=i.name,i.title||(i.title=i.description,i.description=i.description_long),t.each(i.actions,function(e){e.title||(e.title=e.description,e.description=e.description_long),t.each(e.renderers,function(t){t.title||(t.title=t.description,t.description=t.description_long,delete t.description_long)})}),n.push(i);return n},getPod:function(t){var e=t.split(".");return this.get(e[0])},getActionSchema:function(t){var e,i,n,r=t.split(".");return 2===r.length&&(e=this.get(r[0]),i=e.get("actions")[r[1]],i&&(n=i)),n},getRenderable:function(e){var i,n=[];return i=t.filter(this.models,function(t){return Object.keys(t.get("rpcs")).length>0}),e?(t.each(i,function(t){n.push(t.toJSON())}),n):i},getPodName:function(){}}),PodCollection}),define("apps/bipio/collections/c_action_searchable_collection",["underscore","backbone","bipclient","models/m_pod"],function(t,e,i,n){var r=e.Collection.extend({model:n,page:1,page_size:10,total:0,num_pages:1,searchBy:"",_filter:null,_searchType:"",_exclusions:null,podFilters:[],initialize:function(){t.bindAll(this,"updateFilter","resetSearch","nextPage","prevPage","pageInfo","setSearchType","search","setSearchExclusions"),this.podsCollection=i.getCollection("pod"),this.podsCollection.sort()},setSearchExclusions:function(t){this._exclusions=t},normSearchRegexp:function(t){var e=t?t.trim().replace(/\s*/i," ").replace(/\s/i,".*").replace(/,/g,"|").replace(/,\s*/g,",").replace(/^\||\|$/,""):"";return new RegExp(e,"i")},updateFilter:function(t){return this.page=1,this._filter=t,this},resetSearch:function(){return this.searchBy="",this},nextPage:function(){var t=this.page+1;this.page=t>this.num_pages?this.page:t},prevPage:function(){var t=this.page-1;this.page=1>=t?1:t},pageInfo:function(){return{page_current:this.page,page_total:this.num_pages,page_size:this.page_size,result_total:this.total}},setSearchType:function(t){this._searchType=t||"all"},search:function(e){(!this.searchBy||""===this.searchBy&&e&&1!=this.page)&&(this.page=1);var i=t.map(e.split(","),function(t){return t.trim()});this.podFilters=[];for(var n=0;n<i.length;n++)i[n]&&this.podFilters.push(i[n]);this.searchBy=e.trim()},getFilteredModels:function(e,i){var n=[],r=this,s=this._searchType,i=i||r.podFilters;return this.searchBy?(this.podsCollection.models.filter(function(t){return!t.get("level_locked")}).forEach(function(r){var o,a,l=e?!1:!0,c=!1;if(e&&(o=r.get("name")+" "+r.get("title")+" "+r.get("tags"),r.get("tags")&&t.each(r.get("tags"),function(t){"all"===s&&(c=!0),o+=" "+t}),t.each(r.get("actions"),function(t,e){o+=" "+e+" "+t.title}),i.length))for(var u=0;u<i.length&&!(i[u]&&(a=new RegExp(i[u],"gi"),l=a.test(o)));u++);(l||!i.length)&&(actions=r.get("actions"),t.each(Object.keys(actions).sort(),function(t){if(action=actions[t],"all"===s||"actions"===s&&"invoke"===action.trigger||"emitters"===s&&"invoke"!==action.trigger){var e={name:r.get("name"),title:action.title,action:r.get("name")+"."+t,config:{}};n.push(e)}}))}),this.num_pages=Math.ceil(n.length/this.page_size),this.total=n.length,this.reset(n),this.models):(this.num_pages=0,this.total=0,[])}});return r}),define("apps/bipio/views/channel/v_channel_list",["underscore","backbone","bipclient","c_pod","apps/bipio/collections/c_action_searchable_collection"],function(t,e,i,n,r){var s=e.View.extend({el:"#channel-list-widget",tplWidget:t.template($("#tpl-resource-list-channel").html()),tplListEntity:t.template($("#tpl-bipio-list-channel-entity").html()),tplListTitle:t.template($("#tpl-bipio-list-title").html()),tplPaginate:t.template($("#tpl-pagination").html()),_container:null,modalView:null,filter:null,_filterContext:null,channelCollection:null,podCollection:null,searchType:"actions",initialize:function(e,i,n){t.bindAll(this,"renderRows","next","previous","resetPage","sort","delay","search","modalOpen","updateFilter","setFilterContext","setSearchExclusions"),this._container=e,i&&(this.el=i),this.collection=new r,this.collection.setSearchType(n),this.searchType=n
},render:function(t){t&&(this._container=t);var e=$(this.el,this._container),n=this.tplWidget(),r=this;e.html(n),$("#channel-search-form",this._container).on("keyup",function(){r.search($(this).val())}),$(".dropdown-toggle").dropdown(),this.renderRows(),$("#channel-search-form").val(i.getCollection("channel").searchBy)},renderRows:function(){var t,e,i,n,r,s=this,o=$(this.el,this._container),a=("actions"===this.searchType?"Actions":"Events",(this.collection.page-1)*this.collection.page_size),l=a+this.collection.page_size;t=$("#list-channel-container",o),e=$("#channel-list",t),e.empty(),r=this.collection.getFilteredModels(!0);r.slice(a,l).forEach(function(t){n=t.toJSON(),actionTokens=n.action.split("."),n.pod=actionTokens[0],n.podContext=!1,n.icon=t.getIcon(actionTokens[1]),e.append(s.tplListEntity(n))});var c=$(".channel-list h2");c.html(this._filterContext?'<img class="hub-icon hub-icon-32" src="'+this._filterContext.getIcon()+'"/> '+this._filterContext.get("title"):"All Configured Channels"),i=$(".channel-list-pagination",this._container),i.html(s.tplPaginate(s.collection.pageInfo())),$("a.prev",this._container).on("click",this.previous),$("a.next",this._container).on("click",this.next),$(".channel-list-item a").on("click",function(t){t.preventDefault()}),$(".create-action button").on("click",function(t){t.preventDefault(),s.trigger("view:addAction",$(this).siblings("a").attr("data-action"))}),this.trigger("view:rendered")},updateFilter:function(t){this.collection.updateFilter(t),this.renderMergedRows()},setFilterContext:function(t){this._filterContext=t},resetPage:function(){this.collection.resetPage()},previous:function(t){return t.preventDefault(),$(t.currentTarget).hasClass("disabled")?void 0:(this.collection.prevPage(),this.renderRows(),!1)},next:function(t){return t.preventDefault(),$(t.currentTarget).hasClass("disabled")?void 0:(this.collection.nextPage(),this.renderRows(),!1)},sort:function(t){var e,i=t.currentTarget.getAttribute("data-sort");return $('[data-toggle="dropdown"]').parent().removeClass("open"),e=$("#channel-order").children("li"),e.each(function(){var e=$(this);e.removeClass("active"),e.attr("data-sort")==i&&e.addClass("active"),$("#channel-order-by-label",this.el).html($(t.currentTarget).children("a").html())}),this.collection.sort(i),!1},modalOpen:function(t){return void alert("not yet")},delay:function(){var t=0;return function(e,i){clearTimeout(t),t=setTimeout(e,i)}}(),search:function(t){this.collection.search(t),this.renderRows()},setSearchExclusions:function(t){this.collection.setSearchExclusions(t)}});return s}),!function(t){function e(t,e,i){return{id:t,text:e,type:i||"object",children:[]}}function i(t,n,r){var s,o;for(var a in t){if(s=e(a,t[a].title||t[a].description||t[a].name||a,t[a].type),r){if(!t[a].properties||!Object.keys(t[a].properties).length)continue;o={id:"",text:s.text+" Object",type:s.type,children:[]},s.children.push(o),n.push(s),s=o}t[a].properties?i(t[a].properties,s.children):t[a].items?i({items:t[a].items},s.children):delete s.children,r||n.push(s)}}var n=function(e,i){this.$element=t(e),this.options=t.extend({},t.fn.templar2.defaults,i),this.tokens=0,this.listen()};n.prototype={constructor:n,_templateKey:null,_savedRange:null,_getType:function(t){return Object.prototype.toString.call(t)},_isObject:function(t){return"[object Object]"==this._getType(t)},_isArray:function(t){return"[object Array]"==this._getType(t)},_escapeRegExp:function(t){return t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},getSelection:function(){var t;return window.getSelection&&window.getSelection().rangeCount>0?t=window.getSelection().getRangeAt(0).cloneRange():document.selection&&(t=document.selection.createRange()),t},updateFocus:function(t){var e=document.createRange(),i=window.getSelection();e.setStart(t,0),e.collapse(!0),i.removeAllRanges(),i.addRange(e)},renderChildren:function(t,e,i,n){var r,s,o=(this.options,"");if(t.children)for(var a=0;a<t.children.length;a++)r=t.children[a],s=e+(r.id?"."+r.id:""),o+='<option class="opt-level-'+n+'" data-type="'+(r.type||"string")+'"'+(i===s?'selected="selected"':"")+' value="'+s+'">'+r.text+"</option>",o+=this.renderChildren(r,s,i,n+1);return o},getSelect:function(t){var e,i=this.options,n='<span class="templar-select" contenteditable="false"><select><option value=""></option>';for(var r in i.tags)e=i.tags[r],n+='<optgroup value="'+e.id+'" data-index="'+r+'" label="'+e.text+'">',n+=this.renderChildren(e,e.id,t,0),n+="</optgroup>";return n+="</select></span>"},insertTextAtCursor:function(t){var e,i;window.getSelection?(e=window.getSelection(),e.getRangeAt&&e.rangeCount&&(i=e.getRangeAt(0),i.deleteContents(),i.insertNode(document.createTextNode(t)))):document.selection&&document.selection.createRange&&(document.selection.createRange().text=t)},_isValidTag:function(t){var e,i,n,r=this.options.tags;t=t.replace(/^\[|%|\]$/g,"").trim();var s=t.match(/.*\._\d*/);if(e=s&&s.length?[s[0]].concat(t.replace(new RegExp(s[0]+".?"),"").split(".")):t.split("."),!e.length)return!1;for(;i=e.shift();){if(n=-1!==i.indexOf("[")?{type:"array",id:i.replace(/\[.*\]/g,"")}:{id:i},r=_.findWhere(r,n),!r)return!1;r=r.children,!r||r[0].id&&"items"!==r[0].id||(r=r[0].children)}return!0},setTemplate:function(e){var i,n=this.options.data.match(/\[%(\s*?)[a-zA-Z0-9_\-#:.$@*[\],?()]*(\s*?)%\]/gi)||[];this.options.data=e=e.replace(/\n/g,"<br/>");for(var r=0;r<n.length;r++)i=n[r].replace(/#/,"."),this._isValidTag(i)&&(e=e.replace(new RegExp(this._escapeRegExp(n[r]),"g"),this.getSelect(i.replace(/[\[%\]]/gi,"").trim())));this.$element.html(e),this._addTag(t(".templar-select select",this.$element))},listen:function(){var e=this;this.$element.hasClass("templar")||this.$element.addClass("templar"),this.$element.attr("contenteditable",!0),this.$element.on("blur",function(){e._savedRange=e.getSelection()}),this._templateKey=new RegExp(this.options.templateKey),this.options.data&&(this.setTemplate(this.options.data),this.$element.on("keydown",function(i){var n,r=e.getSelection(),s=t(this);if(e.options.keyEvent(i)){i.stopPropagation(),n=t(e.getSelect()),r.insertNode(n[0]);var o=t("select",n),a=document.createTextNode("");e._addTag(o,a),r.setStartAfter(n[0]),r.insertNode(a),o.select2("open")}else 13===i.keyCode&&"none"===e.$element.css("resize")&&(i.stopPropagation(),i.preventDefault());setTimeout(function(){e._emit(s)},10)}),this._emit(this.$element)),"text"===this.options.pasteMode&&this.$element.on("paste",function(i){i.preventDefault();var n,r=(i.originalEvent||i).clipboardData;n=void 0===r||null===r?window.clipboardData.getData("text")||"":r.getData("text/plain")||"",e.insertTextAtCursor(n),e._emit(t(this))})},_bindArrayIndice:function(e){e.on("mousedown",function(){return t(this).focus(),!1}),e.on("change",function(){})},_addTag:function(e,i){var n=this;!function(e,i){e.data("templar-tags",n.options.tags);var r=e.select2(n.options.select2).on("change",function(){i&&n.updateFocus(i),n.$element.focus(),n._emit(n.$element)}).on("select2-close",function(){n._bindArrayIndice(t("input.select2-subscript",r.data("select2").container)),""===t(":selected",e).val()&&e.parent().remove(),i&&n.updateFocus(i),n._emit(n.$element)});r.data("select2")&&n._bindArrayIndice(t("input.select2-subscript",r.data("select2").container));var s=t('<button class="btn-templar-delete btn btn-primary pull-left"><i class="icon-remove"></i></button>'),o=r.siblings(".select2-container");o.prepend(s),t(".btn-templar-delete",o).on("click",function(){t(this).parents(".templar-select").remove(),i&&n.updateFocus(i),n._emit(n.$element)})}(e,i)},addTag:function(){{var e,i=this,n=i._savedRange||i.getSelection();t(this)}e=t(i.getSelect()),n.insertNode(e[0]);var r=t("select",e),s=document.createTextNode("");i._addTag(r,s),n.setStartAfter(e[0]),n.insertNode(s),r.select2("open")},_emit:function(t){t[0].normalize(),this.$element.trigger("templar-template",this.computeTemplate())},_ucRE:/[\0-\x1F\x7F-\x9F\xAD\u0378\u0379\u037F-\u0383\u038B\u038D\u03A2\u0528-\u0530\u0557\u0558\u0560\u0588\u058B-\u058E\u0590\u05C8-\u05CF\u05EB-\u05EF\u05F5-\u0605\u061C\u061D\u06DD\u070E\u070F\u074B\u074C\u07B2-\u07BF\u07FB-\u07FF\u082E\u082F\u083F\u085C\u085D\u085F-\u089F\u08A1\u08AD-\u08E3\u08FF\u0978\u0980\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA\u09BB\u09C5\u09C6\u09C9\u09CA\u09CF-\u09D6\u09D8-\u09DB\u09DE\u09E4\u09E5\u09FC-\u0A00\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A\u0A3B\u0A3D\u0A43-\u0A46\u0A49\u0A4A\u0A4E-\u0A50\u0A52-\u0A58\u0A5D\u0A5F-\u0A65\u0A76-\u0A80\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA\u0ABB\u0AC6\u0ACA\u0ACE\u0ACF\u0AD1-\u0ADF\u0AE4\u0AE5\u0AF2-\u0B00\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A\u0B3B\u0B45\u0B46\u0B49\u0B4A\u0B4E-\u0B55\u0B58-\u0B5B\u0B5E\u0B64\u0B65\u0B78-\u0B81\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BBD\u0BC3-\u0BC5\u0BC9\u0BCE\u0BCF\u0BD1-\u0BD6\u0BD8-\u0BE5\u0BFB-\u0C00\u0C04\u0C0D\u0C11\u0C29\u0C34\u0C3A-\u0C3C\u0C45\u0C49\u0C4E-\u0C54\u0C57\u0C5A-\u0C5F\u0C64\u0C65\u0C70-\u0C77\u0C80\u0C81\u0C84\u0C8D\u0C91\u0CA9\u0CB4\u0CBA\u0CBB\u0CC5\u0CC9\u0CCE-\u0CD4\u0CD7-\u0CDD\u0CDF\u0CE4\u0CE5\u0CF0\u0CF3-\u0D01\u0D04\u0D0D\u0D11\u0D3B\u0D3C\u0D45\u0D49\u0D4F-\u0D56\u0D58-\u0D5F\u0D64\u0D65\u0D76-\u0D78\u0D80\u0D81\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0DC9\u0DCB-\u0DCE\u0DD5\u0DD7\u0DE0-\u0DF1\u0DF5-\u0E00\u0E3B-\u0E3E\u0E5C-\u0E80\u0E83\u0E85\u0E86\u0E89\u0E8B\u0E8C\u0E8E-\u0E93\u0E98\u0EA0\u0EA4\u0EA6\u0EA8\u0EA9\u0EAC\u0EBA\u0EBE\u0EBF\u0EC5\u0EC7\u0ECE\u0ECF\u0EDA\u0EDB\u0EE0-\u0EFF\u0F48\u0F6D-\u0F70\u0F98\u0FBD\u0FCD\u0FDB-\u0FFF\u10C6\u10C8-\u10CC\u10CE\u10CF\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B\u135C\u137D-\u137F\u139A-\u139F\u13F5-\u13FF\u169D-\u169F\u16F1-\u16FF\u170D\u1715-\u171F\u1737-\u173F\u1754-\u175F\u176D\u1771\u1774-\u177F\u17DE\u17DF\u17EA-\u17EF\u17FA-\u17FF\u180F\u181A-\u181F\u1878-\u187F\u18AB-\u18AF\u18F6-\u18FF\u191D-\u191F\u192C-\u192F\u193C-\u193F\u1941-\u1943\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19CF\u19DB-\u19DD\u1A1C\u1A1D\u1A5F\u1A7D\u1A7E\u1A8A-\u1A8F\u1A9A-\u1A9F\u1AAE-\u1AFF\u1B4C-\u1B4F\u1B7D-\u1B7F\u1BF4-\u1BFB\u1C38-\u1C3A\u1C4A-\u1C4C\u1C80-\u1CBF\u1CC8-\u1CCF\u1CF7-\u1CFF\u1DE7-\u1DFB\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FC5\u1FD4\u1FD5\u1FDC\u1FF0\u1FF1\u1FF5\u1FFF\u200B-\u200F\u202A-\u202E\u2060-\u206F\u2072\u2073\u208F\u209D-\u209F\u20BB-\u20CF\u20F1-\u20FF\u218A-\u218F\u23F4-\u23FF\u2427-\u243F\u244B-\u245F\u2700\u2B4D-\u2B4F\u2B5A-\u2BFF\u2C2F\u2C5F\u2CF4-\u2CF8\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D71-\u2D7E\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF\u2E3C-\u2E7F\u2E9A\u2EF4-\u2EFF\u2FD6-\u2FEF\u2FFC-\u2FFF\u3040\u3097\u3098\u3100-\u3104\u312E-\u3130\u318F\u31BB-\u31BF\u31E4-\u31EF\u321F\u32FF\u4DB6-\u4DBF\u9FCD-\u9FFF\uA48D-\uA48F\uA4C7-\uA4CF\uA62C-\uA63F\uA698-\uA69E\uA6F8-\uA6FF\uA78F\uA794-\uA79F\uA7AB-\uA7F7\uA82C-\uA82F\uA83A-\uA83F\uA878-\uA87F\uA8C5-\uA8CD\uA8DA-\uA8DF\uA8FC-\uA8FF\uA954-\uA95E\uA97D-\uA97F\uA9CE\uA9DA-\uA9DD\uA9E0-\uA9FF\uAA37-\uAA3F\uAA4E\uAA4F\uAA5A\uAA5B\uAA7C-\uAA7F\uAAC3-\uAADA\uAAF7-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F-\uABBF\uABEE\uABEF\uABFA-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBC2-\uFBD2\uFD40-\uFD4F\uFD90\uFD91\uFDC8-\uFDEF\uFDFE\uFDFF\uFE1A-\uFE1F\uFE27-\uFE2F\uFE53\uFE67\uFE6C-\uFE6F\uFE75\uFEFD-\uFF00\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFDF\uFFE7\uFFEF-\uFFFB\uFFFE\uFFFF]/g,clearTemplate:function(){this.$element.empty(),this.computeTemplate()},_mergeIndice:function(t){for(var e,i,n=t.split("."),r=t.split("."),s=r.length>n.length?r.length:n.length,o=0;s>o;o++)e=n[o],i=r[o]},_packContents:function(e){{var i="",n="",r=this;e.length}return t.each(e,function(e,s){var o=s.nodeName.toLowerCase();if(3!=this.nodeType||/\S/.test(this.nodeValue))if("#text"==o)i+=t(s).text();else if("br"==o)i+="\n";else if("div"==o||"p"==o)i+=r._packContents(t(s).contents());else{var a=t("select",s);if(a&&a.length&&(n=a.val().replace("&nbsp;"," ").replace(this._ucRE,""))){for(var l,c=t(".select2-subscript",a.data("select2").container),u=0;u<c.length;u++)l=t(c[u]),n=n.replace(l.attr("data-path")+".items",l.attr("data-path")+"["+l.val()+"]");i+=r.options.template.replace(r._templateKey,n)}}}),i},computeTemplate:function(){var e=this._packContents(this.$element.contents());return this.$element.attr("data-template",e),t("<div>"+e+"</div>").text().replace(/\s*/,"")?this.$element.removeAttr("empty").removeClass("invalid"):this.$element.attr("empty",!0),e},jsonMode:function(t){console.log("jsonpath for "+t.source)}};var r=t.fn.templar2;t.fn.templar2=function(e,r){return this.each(function(){var s=t(this),o=s.data("templar"),a="object"==typeof e&&e;a.schema&&(a.tags=[],i(a.schema,a.tags,!0)),o||s.data("templar",o=new n(this,a)),"string"==typeof e&&o[e](r)})},t.fn.templar2.defaults={tags:[],schema:{},templateKey:"value",template:"",delimiter:".",buttonClass:"btn-primary",pasteMode:"text",keyEvent:function(t){return 73===t.keyCode&&t.ctrlKey}},t.fn.templar2.defaults.template=t.fn.templar2.defaults.templateKey,t.fn.templar2.Constructor=n,t.fn.templar2.noConflict=function(){return t.fn.templar2=r,this},t.fn.elIgnore=function(t){return this.clone().find(t||">*").remove().end()}}(window.jQuery),define("templar2",function(){}),define("apps/bipio/views/channel/v_transform",["underscore","backbone","bipclient","apps/pods/views/v_channel_config","templar2"],function(t,e,i,n){return TransformsView=e.View.extend({tplModalTransform:t.template($("#tpl-bipio-transform-container").html()),tplModalConfigEntity:t.template($("#tpl-bipio-config-entity").html()),tplModalTransformEntity:t.template($("#tpl-bipio-transform-entity").html()),tplModalTransformEntityComp:t.template($("#tpl-bipio-transform-entity-composite").html()),model:null,_configView:null,_activeTransforms:null,initialize:function(e){var i=this;t.bindAll(this,"render","setTransforms","applyPresets","_renderProperty","_select2Templar","_getImageFromSource"),this.el=e,this.$el=$(e),i._configView=new n,i._configView.on("attribute:rendered",function(t){void 0===i._activeTransforms[t]&&(i._activeTransforms[t]="");var e=i._activeTransforms[t];e.trim&&(txVAl=e.trim());var n=$('.control-label[for="import-'+t+'"]').parent();i._toggleTransformMode(n,!0)})},_getImageFromSource:function(t){var e;if("source"===t)e=this.model.getIcon();else{if("_client"===t)return'<i class="icon-user"></i> ';"_bip"===t?e="/static/img/channels/32/color/bipio.png":(channel=i.getCollection("channel").get(t),channel?e=channel.getPod().getIcon():i.find.pod(t)&&(e=i.find.pod(t).getIcon()))}return e},_select2Templar:function(){var e=this;return{formatResult:function(t){var i=t.text.length>32?t.text.substr(0,32)+"..":t.text;if(t.children&&t.children.length){var n,r=$(t.element).attr("value"),n=e._getImageFromSource(r)||"";return n&&-1===n.indexOf("<")&&(n='<img class="hub-icon hub-icon-16" src="'+n+'"> '),n+i}var s=0,o="";try{var s=parseInt(t.css.match(/opt-level-\d/).pop().split("-").pop());o="&nbsp;&nbsp;".repeat(s+1)}catch(a){}return o+i+'<label class="label pull-right">'+$(t.element).attr("data-type")+"</label>"},formatSelection:function(n){var r,s,o,a,l,c=n.id.split("#").shift(),u=$(n.element).parents("select:first").data("templar-tags"),h=n.id.split("."),d=h.shift();i.isUUID(d)||"source"===d||0===d.indexOf("_")||(d+="."+h.shift(),a=h.shift(),a&&(d+="."+a)),o=t.findWhere(u,{id:d}),l=o.text,"array"===o.type&&(l+=' [<input data-path="'+n.id+'" class="select2-subscript input input-mini" type="text" value=""/>]'),o=o.children[0];for(var p=d;h.length;)s=h.shift(),p+="."+s,o.children&&(o=t.findWhere(o.children,{id:s}),l+=' <i class="icon-chevron-right"></i> '+o.text,"array"===o.type&&(l+=' [<input data-path="'+p+'" class="select2-subscript input input-mini" type="text" value=""/>]'));return c=c.split(".").shift(),r=e._getImageFromSource(c)||"",r&&-1===r.indexOf("<")&&(r='<img class="hub-icon hub-icon-16" src="'+r+'"> '),r+l},matcher:function(t,e,i){var n=$(i),r=$(i).parent(),s=e+" "+n.attr("data-type")+" "+r.attr("label")+" "+r.attr("value");return-1!=s.toLowerCase().indexOf(t)},escapeMarkup:function(t){return t},dropdownAutoWidth:!0,placeholder:"Select an Attribute"}},_toggleTransformMode:function(t,e){var i=$(".transform-html",t),n=$(".transform-config",t),r=$(".transform-override",t),s=$(".config-html",t),o=$(".templar.field",i),a=$(".templar.field",i).attr("id"),l=$("label[for^="+a+"]");s.removeClass("blocked"),i.removeClass("blocked"),r.removeClass("active"),n.removeClass("active"),e?(i.addClass("blocked"),r.addClass("active"),a&&(o=$("#"+a.replace("import-","channel_")))):(s.addClass("blocked"),n.addClass("active")),o.length>0?this.setValidation(o,l):s.length&&s.val&&this.setValidation(s,l)},_renderProperty:function(e,n,r,s,o,a){var l,c,u=this,h=e.imports.properties[n],d=n,p=e.imports.required&&-1!==e.imports.required.indexOf(d);this._activeTransforms=s=s||[],void 0===s[d]&&h&&h["default"]&&(s[d]=h["default"]);var f=h.description;if(f){var g=$("<span>"+h.description+"</span>"),m=$("a",g);t.each(m,function(t){$(t).attr("target","_blank")}),f=g.html()}var c;if(e.config&&e.config.properties&&(config=e.config.properties[d],config)){var v=a;s[d]?v.config[n]=s[d]:v.config[n]&&(s[d]=v.config[n]),u._configView._attachChannelOptions(this.action,v,e.name,this.pod.get("name"),[d]),c=$(u.tplModalTransformEntityComp({name:n,description:f,title:h.title,required:p,config:config})),$(".btn-group button",c).on("click",function(){$(this).siblings("input[type=hidden]").val($(this).attr("data-selection"))})}config||(c=$(u.tplModalTransformEntity({name:n,description:f,title:h.title,required:p}))),"text"===h.type&&$(".templar",c).addClass("resize-vertical full-width"),$(".control-label",c).append('&nbsp;&nbsp;<label class="label">'+h.type+"</label>"),function(t){$(".transform-override,.transform-config",t).on("click",function(){return u._toggleTransformMode(t,!$(this).hasClass("transform-config")),!1})}(c),l=s[d],l||(l=""),l=String(l);var b=new RegExp("^\\[\\%..*\\%\\]","i");b.test(l)&&(l=l.replace(/#/g,".")),l=i.htmlEncode(l),$(".templar",c).templar2({delimiter:"#",template:"[%value%]",schema:r,data:"&nbsp;"+l+"&nbsp;",select2:u._select2Templar(),pasteMode:"text"}).on("select2-loaded",function(){$(this);$(".tooltip").remove()});var y=l.trim(),_=!1;return this.pod.isValidEnum(e.name,"imports",n,y)?_=!0:e.imports.properties[n]&&"boolean"===e.imports.properties[n].type&&i.isBool(y)?_=!0:""===y&&(_=!0),this._toggleTransformMode(c,_),c},setValidation:function(t,e){var i=!t.val().replace(/\s*/,"");i&&t.attr("data-template")&&(i=!t.attr("data-template").replace(/\s*/,"")),i?(t.attr("empty",!0),e.addClass("invalid")):(t.removeAttr("empty"),t.removeClass("invalid"),e.removeClass("invalid"))},render:function(e,n,r,s,o){var a,r,l,c=this,u=(n.get("action"),i.realClone(n.toJSON()));this.model=e,a=this.action=n.getAction(),this.pod=n.getPod(),u._action=this.action,this.$el.html(this.tplModalTransform(u)),r=o?"source":r;for(var h=t.uniq((a.config.disposition?a.config.disposition:Object.keys(a.config.properties)).concat(a.imports.disposition?a.imports.disposition:Object.keys(a.imports.properties))),d=0;d<h.length;d++)l=this._renderProperty(a,h[d],s||{},this.model.get("hub")[r].transforms&&this.model.get("hub")[r].transforms[u.id]?this.model.get("hub")[r].transforms[u.id]:{},r,u),this.$el.append(l);$(".control-label[required]",this.$el).each(function(t,e){var i="channel_"+$(e).attr("for").replace("import-",""),n=$("#"+i);n.attr("required",!0),n.bind("propertychange keyup input paste",function(){c.setValidation($(this),$(e))});var r=$(e).attr("for"),s=$("#"+r);s.bind("templar-template",function(){c.setValidation($(this),$(e))})}),$(".add-templar-var",this.$el).click(function(){return $(".templar",$(arguments[0].currentTarget).parent().parent()).focus().templar2("addTag"),!1}),this.setTransforms({},[],!0)},renderTrigger:function(t,e){var n,r,s=this,o=(e.get("action"),t.get("config")),a=i.realClone(e.toJSON());o.config||(o.config={}),this.model=t,n=this.action=e.getAction(),this.pod=e.getPod(),a._action=this.action,this.$el.html(this.tplModalTransform(a));for(var l in n.imports.properties)r=this._renderTriggerProperty(n,l,o.config,a),this.$el.append(r);i.bindEmptyInputStyles(this.$el),this.setTransforms({},[],!0),$(".control-group [required]",this.$el).each(function(t,e){var i="channel_"+$(e).attr("for").replace("config-",""),n=$("#"+i);n.attr("required",!0),n.bind("propertychange keyup input paste",function(){s.setValidation($(this),$(e))}),n.length&&s.setValidation($(n),$(e))})},_renderTriggerProperty:function(e,i,n,r){var s,o=this,a=e.imports.properties[i],l=i,c=e.imports.required&&-1!==e.imports.required.indexOf(l);this._activeTransforms=n=n||[],void 0===n[l]&&a["default"]&&(n[l]=a["default"]);var u=a.description;if(u){var h=$("<span>"+a.description+"</span>"),d=$("a",h);t.each(d,function(t){$(t).attr("target","_blank")}),u=h.html()}var s;if(e.config&&e.config.properties&&(config=e.config.properties[l],config)){var p=r;n[l]?p.config[i]=n[l]:p.config[i]&&(n[l]=p.config[i]),o._configView._attachChannelOptions(this.action,p,e.name,this.pod.get("name"),[l]),s=$(o.tplModalConfigEntity({name:i,description:u,title:a.title,required:c,config:config})),$(".btn-group button",s).on("click",function(){$(this).siblings("input[type=hidden]").val($(this).attr("data-selection"))})}return s},setTransforms:function(e,i,n){var r,s,o=this,a=o._configView.serialize(this.el).config,l=$(".config-html div[id^=channel]",this.$el);if(a||(a={}),t.each(a,function(t,i){e[i]=t}),t.each(l,function(t,e,i){var n,r,s=$(i[e]);n=s.attr("name").replace("config#",""),r=s.hasClass("select2-offscreen")?s.select2("val"):$(t).attr("data-template"),a[n]=r}),$("div[id^=import],[name^=config]",this.$el).each(function(t,l){var c,u=$(l);u.attr("id")&&(c=u.attr("id").replace(/import-|channel_/,""),u.parent().hasClass("blocked")||u.parent().parent().hasClass("blocked")?c&&a[c]&&(e[c]=a[c]):u.hasClass("templar")&&(u.templar2("computeTemplate"),template=u.attr("data-template"),template&&""!==template&&(e[c]=u.attr("data-template").trim())),s=$('label[for="'+u.attr("id")+'"]'),(s.attr("required")||u.parent().attr("required")||u.attr("required"))&&(r=u,u.parent().hasClass("blocked")&&(r=$("#channel_"+c,o.el)),"true"==r.attr("empty")||"true"===r.parent().attr("empty")?(n||r.addClass("invalid"),s.addClass("invalid"),i.push($('label[for="'+u.attr("id")+'"]').text())):s.removeClass("invalid")))}),i.length){var c=this.$el.parent(),u=$(".templar.invalid:first",this.$el).parents(".control-group:first");return u.length&&c.animate({scrollTop:u.offset().top-c.offset().top+c.scrollTop()}),void o.trigger("transform:invalid")}},applyPresets:function(e){var n,r,s=this;i.isUUID(e)&&(r=i.find.channel(e),r&&(n=r.get("config"),s._configView._updateChannelOptions(r),n&&t.each(n,function(t,e){t&&$("#group-"+e+" .transform-override").click()}))),i.bindEmptyInputStyles(this.$el)},getForm:function(){var t={},e=[];return this.setTransforms(t,e),t}}),TransformsView}),define("apps/pods/views/v_channel_select_inline",["underscore","backbone","bipclient","models/m_channel"],function(t,e,i,n){var r=e.View.extend({tplInlineChannel:t.template($("#tpl-pods-inline-channel-select").html()),actionPtr:null,collection:null,initialize:function(e){t.bindAll(this,"render","removeChannel"),this.el=e,this.$el=$(e),this.collection=i.getCollection("channel"),$("#channel-delete-confirm").off("click"),$("#channel-delete-confirm").on("click",this.removeChannel)},_getPresetName:function(){for(var t,e=this,n=[],r=-1,s=e.action.title,o=i.getCollection("channel").filter(function(t){return e.actionPtr===t.get("action")&&0==t.get("name").trim().indexOf(s)?t:void 0}),a=0;a<o.length;a++)n=o[a].get("name").trim().split(" "),t=Number(n.pop()),!isNaN(t)&&t>=r?r=t:s===o[a].get("name").trim()&&r++;return s+(r>=0?" "+(r+1):"")},render:function(t,e){var n=t.split("."),r=this,s=i.isContainerAction(t);this.actionPtr=t,this.action=i.getCollection("pod").get(n[0]).getAction(n[1]),this.$el.html(this.tplInlineChannel());var o=$("div#channel-inline",this.$el),a=$("input",o),l=$("select",o),c=$(".action-delete",this.$el);this.collection.forEach(function(i){var n;i.get("action")===t&&(n=e&&i.get("id")===e.get("id"),l.append("<option "+(n?'selected="selected"':"")+' value="'+i.get("id")+'">'+i.get("name")+"</option>"))}),l.select2({dropdownAutoWidth:!0}),l.on("change",function(){r.errTranslate(!1,"name");var t=$(this).val(),e=i.find.channel(t);t&&e?(a.val(e.get("name")),c.show()):(c.hide(),a.val(r._getPresetName())),r.trigger("channel:selected",t)}),$("button.action-save",o).on("click",function(){r.trigger("channel:save")}),s&&!e?a.val(r._getPresetName()):e&&a.val(e.get("name")),e?c.show():c.hide()},errTranslate:function(t,e,i){var n=$("#channel-"+e,this.$el).closest(".control-group");t?(n.addClass("error"),n.find(".help-block").html(i)):(n.removeClass("error"),n.find(".help-block").empty())},removeChannel:function(t){var e=this,n=this.collection.get($("select",this.$el).val()),r=$(".action-save",this.$el);if(t.stopPropagation(),t.preventDefault(),r.hide(),$("#channel-delete-dialog").modal("hide"),n){var s=n.get("name"),o=n.get("action");n.destroy({success:function(){i.growl("Preset <strong>"+s+"</strong> Deleted"),e.render(o)},error:function(t,e){r.show();var n="An Error Occorred";409===e.status&&(n="<strong>"+s+"</strong> is in use"),i.growl(n,"error")},wait:!0})}},getSelectedChannel:function(){return $("select",this.$el).val()},saveChannel:function(r,s){var o={},a=this,l=this.action,c=$(".action-save",this.$el);l.config&&l.config.properties&&t.each(l.config.properties,function(t,e){r[e]&&(o[e]=r[e])});var u,h=$("input#channel-name",this.$el),d=h.val(),p=this.getSelectedChannel();if(h&&d&&d.trim().length){if(u=p?this.collection.get(p):this.collection.findWhere({name:d})){if(u.get("action")!==this.actionPtr)return void a.errTranslate(!0,"name","Preset Name Is Already In Use");if(u.get("name")!==d){if(existChannel=this.collection.findWhere({name:d}),existChannel)return void a.errTranslate(!0,"name","Preset Name Is Already In Use");u.set("name",d)}u.set("config",o)}else u=new n({name:d,action:this.actionPtr,config:o});e.Validation.bind(this,{model:u,invalid:function(t,e,i){a.errTranslate(!0,e,i)},valid:function(){a.errTranslate(!1)}}),u.isValid(!0)&&(c.button("loading"),u.save(u.toJSON(),{silent:!1,sync:!1,success:function(){c.button("reset"),i.getCollection("channel").fetch({reset:!0,success:function(){i.decorateChannels(),s?s(u.id):a.render(u.get("action"))}}),i.growl("Preset <strong>"+u.get("name")+"</strong> Saved")},error:function(t,e){c.button("reset");try{var n=JSON.parse(e.responseText);409===e.status?a.errTranslate(!0,"name","Preset Name is already in use"):n.message?i.growl(n.message,"error"):i.growl("An Error Occurred","error")}catch(r){i.growl("An Unknown Error Occurred","error"),i.getCollection("channel").fetch({reset:!0,success:function(){i.decorateChannels(),s?s(u.id):a.render(u.get("action"))}})}}}))}else a.errTranslate(!0,"name","Please Name This Preset")}});return r}),define("apps/bipio/views/v_node_config",["underscore","backbone","bipclient","apps/bipio/views/channel/v_transform","apps/pods/views/v_channel_select_inline","apps/bipio/views/v_req_parser"],function(t,e,i,n,r,s){return ConfigView=e.View.extend({tplModalTransform:t.template($("#tpl-bipio-modal-transform").html()),tplRpcTab:t.template($("#tpl-bipio-rpc-tab").html()),_transformView:null,_ilView:null,_isContainerAction:!1,_hasConfig:!1,sinceTime:null,events:{},initialize:function(e,i){t.bindAll(this,"render","confirm","_bindRPCs","_addRPC"),this.el=i,this.$el=$(i),this.model=e},getChannelDict:function(e){var n,r,s={};if("http"===e){var o=this.model.toJSON();r=o.config&&o.config.channel_id?{title:this.model.get("_repr"),name:this.model.get("name"),note:this.model.get("note")||"Processes incoming "+o.config.channel_id.split(".")[0]+" requests to any of your domains",_action:{config:{}},pod:{title:i.getCollection("channel").get(o.config.channel_id).getPod().get("title"),icon:this.model.getIcon(),auth:{_repr:""}}}:{title:this.model.get("_repr"),name:this.model.get("name"),note:this.model.get("note")||"Processes incoming HTTP requests to any of your domains",_action:{config:{}},pod:{title:"Incoming Web Hook",icon:this.model.getIcon(),auth:{_repr:""}}}}else"smtp"===e?r={title:this.model.get("_repr"),name:this.model.get("name"),note:this.model.get("note")||"Processes incoming Email to any of your domains",_action:{config:{}},pod:{title:"Incoming Email",icon:this.model.getIcon(),auth:{_repr:""}}}:"payload"===e?r={title:this.model.get("_repr"),name:this.model.get("name"),note:this.model.get("note")||"Generate Data",_action:{config:{}},pod:{title:"Generate Data",icon:this.model.getIcon(),auth:{_repr:""}}}:"trigger"===e?r={title:this.model.get("_repr"),name:this.model.get("name")||"Every Bip Needs An Event Source.<br/><br/>Click To Begin",note:this.model.get("note"),_action:{config:{}},pod:{title:"Event Source",icon:this.model.getIcon(),auth:{_repr:""}}}:(n=i.getChannel(e),n.set("name",this.model.getTitleForCid(e)),r=n.toJSON(),r.pod={title:n.getPod().get("title"),icon:n.getIcon(),auth:{_repr:n.getPod().get("auth")._repr}},r._action=n._action);if(n?(r.icon=n.getIcon(),r.hasConfig=n.getPod().hasConfig(n.get("action")),r.isContainerAction=i.isContainerAction(n.get("action"))):r.icon=r.pod.icon,t.each(r._action.config.properties,function(t,e){var i=t["default"];r.config[e]&&""!==r.config[e]&&(i=r.config[e]),i&&(s[t.title]=i)}),r._configItems=s,r._hover=!1,r.name||(r.name=r.title),r.rpcs=[],i.isUUID(e))for(var a=0;a<r._links.length;a++)r.rpcs.push({_href:i.getRendererURI(r.id,r._links[a].name),contentType:r._links[a].contentType,description:r._links[a].description,name:r._links[a].name,title:r._links[a].title});else;return r},_addRPC:function(t,e,i){if("invoke"!==t&&(!e.method||"GET"===e.method)){var n,r=this,s=$("#b-config-tabs",this.$el),o=$(".tab-content",this.$el),a="rpc-"+t+"-panel";s.append('<li class="rpcTab"><a id="tab-'+a+'" href="#'+a+'" data-toggle="pill">'+e.title+"</a></li>"),n=e._href,n=n.replace(/:channelId/,i),r.model.id&&(n=n.replace(/:bip_id/,r.model.id)),e.properties&&e.properties.since&&this.sinceTime&&(n+=(-1===n.indexOf("?")?"?":"&")+"since="+this.sinceTime),o.append(r.tplRpcTab({tabId:a,schema:e,url:n})),$("#"+a+" .btn-refresh",o).on("click",function(){r._fetchData("#"+$(this).parents(".rpcTab").attr("id"),!0)})}},_fetchData:function(t,e){var n=this;if($tabContent=$(t),$url=$(".rpc-url",$tabContent).text(),contentType=$tabContent.attr("data-content-type"),"text/html"===contentType||-1!==contentType.indexOf("xml"))$panel=$("iframe",$tabContent),$panel.length&&(!$panel.attr("src")||e)&&$panel.attr("src",$url);else if($panel=$(t+" pre"),$panel.length){if(!e&&$panel.text())return;$panel.empty(),$panel.append($(".roto",n.tplLoader())),$.ajax({url:$url,success:function(t){$panel.html("application/json"===contentType?i.htmlEncode(JSON.stringify(t,!0,4)):i.htmlEncode(t))},error:function(){$panel.empty(),i.growl("Error Reaching "+$(t.replace("#","#tab-")).text()+" Endpoint","error")}})}},_bindParserTab:function(t){var e=this;if(s.test()&&i.isParsable(t.get("action"))){$tabTitles=$("#b-config-tabs",this.$el),tabId="edge-parser-panel",$tabPane=$("#"+tabId),$tabTitles.append('<li id="parserTab"><a id="tab-'+tabId+'" href="#'+tabId+'" data-toggle="pill">Parser</a></li>');var n=new s({el:$(".parser-content",$tabPane),tplSelector:"#tpl-bipio-parser-mini"});n.render(e.model.getExportsForCid(t.get("id"))),n.on("schema:imported",function(i){e.model.setExportsForCid(t.get("id"),i)})}},_bindRPCs:function(e){var n,r=this,s=i.getChannel(e),o=s?s.get("_links"):[];if($("#b-config-tabs .rpcTab,.tab-content .rpcTab").remove(),s){r._bindParserTab(s);
for(var a=0;a<o.length;a++)this._addRPC(o[a].name,o[a],e);t.each(s.getAction().rpcs,function(n,s){t.findWhere(o,{name:s})||!n._href||i.isContainerAction(e)||r._addRPC(s,n,e)}),n=$("#b-config-tabs a"),n.off("click").on("click",function(t){{var e=$(this);e.text()}t.preventDefault(),$(this).parent().hasClass("rpcTab")&&r._fetchData(e.attr("href")),$(this).tab("show")})}},render:function(t){var e=this,s=i.getChannel(t),o=this.getChannelDict(t);if(this._hasConfig=s.getPod().hasConfig(s.get("action")),this._isContainerAction=i.isContainerAction(s.get("action")),o.icon=s?s.getIcon():o.pod.icon,o.hasConfig=this._hasConfig,o.isContainerAction=this._isContainerAction,this.$el.html(this.tplModalTransform(o)),this._transformView=new n("#panel-channel-transform-body"),e._transformView.on("transform:invalid",function(){e.trigger("transform:invalid")}),this._ilView=new r("#inline-channel"),this._hasConfig){var a=this._ilView;a.render(s.get("action"),this._isContainerAction&&s.id&&i.isUUID(s.id)?s:null),a.on("channel:selected",function(t){e._transformView.applyPresets(t),e.model.isNew()||e._bindRPCs(t)}),a.on("channel:save",function(){a.saveChannel(e._transformView.getForm())})}a&&this._isContainerAction&&$(".action-save",a.$el).remove(),e.model.isNew()?e._bindParserTab(s):e._bindRPCs(s.id),$(".rpc-url").tooltip({placement:"top"}).on("click",function(){return document.createRange?(rangeToSelect=document.createRange(),rangeToSelect.selectNode(this.firstChild),curSelect=window.getSelection(),curSelect.addRange(rangeToSelect),!1):document.body&&document.body.createTextRange?(range=document.body.createTextRange(),range.moveToElementText(this),range.select(),!1):void 0}),this.trigger("meta:refresh",o)},confirm:function(t,e){var n=this,r=n._transformView.getForm(),s=(i.find.channel(t).getAction().imports.required,{}),o=[];if(n._transformView.setTransforms(s,o),!o.length)if(this._isContainerAction){var t=this._ilView.getSelectedChannel();t?e?e(t,r):n.trigger("channel:set",t,r):this._ilView.saveChannel(r,function(t){e?e(t,r):n.trigger("channel:set",t,r)})}else e?e(t,r):n.trigger("channel:set",t,r)}}),ConfigView}),define("apps/bipio/views/v_bip_transform",["underscore","backbone","bipclient","apps/bipio/views/v_node_config"],function(t,e,i,n){return CompositeTransformsView=n.extend({tplLoader:t.template($("#tpl-loader").html()),events:{},initialize:function(){n.prototype.initialize.apply(this,arguments),t.bindAll(this,"setTransforms","transformHint","getForm","_buildExports")},setTransforms:function(t,e,i){this._transformView.setTransforms(t,e,i)},getForm:function(){return this._transformView.getForm()},_buildExports:function(t,e){var n,r,s=t,o=this.model,a=o.getExportsForCid(t),l=o.get("type"),c=o.get("config"),u=i.getCollection("channel");if("source"===t?(n=l,"trigger"===l&&(t=c.channel_id)):n="channel",a=a||i.getExports(n,t),r=u.get(t),"source"===s){if("http"===l&&this.model.get("exports")){delete a.properties.body,delete a.properties.title;var h=this.model.get("exports");h.id=a.id,h.title=a.title,e[s]=h}else e[s]=a;e[s].description=r?r.get("name"):a.title}else e[r.get("id")]={name:r.get("name"),properties:a.properties};if(r=u.get("source"===t?o.get("config").channel_id:t),a.properties&&Object.keys(a.properties).length>0){var d=["_bip","_client","_files"];for(var p in a.properties)if(-1!==d.indexOf(p)){if("_files"===p){delete a.properties[p];continue}e[p]=a.properties[p],delete a.properties[p]}}return e},render:function(e,n,r,s){this.constructor.__super__.render.apply(this,arguments);var o,a,l,c,u=this,h=this.model,d={},p=i.getChannel(e);txTo=p.get("action"),hubParent=h.get("hub")[s?"source":n],("trigger"===h.get("type")||"http"===h.get("type")&&h.get("config").channel_id)&&(r=t.without(r,h.get("config").channel_id),-1===r.indexOf("source")&&r.push("source")),c=r[r.length-1];for(var f=0;f<r.length;f++)this._buildExports(r[f],d);a=p._action;var g=!1;"source"===c?"trigger"===h.get("type")?(p=i.getChannel(h.get("config").channel_id),c=p.get("action"),g=!0):c=r[r.length-1]:(p=i.getChannel(c),c=p.get("action")),l=$("#panel-channel-transform-body"),l.empty(),l.append($(".roto",u.tplLoader()));var m=function(){u._transformView.render(h,i.getChannel(e),n,d,s)};a&&(o=a.imports.properties),o&&(hubParent&&hubParent.transforms&&hubParent.transforms[e]?m():i.getTransformHint(u,c,txTo,m))},confirm:function(t,e,i){{var n=this;n.model.get("hub"),n.model.get("config")}this.constructor.__super__.confirm.call(this,t,function(t,e){i&&i(t,e),n.trigger("channel:set",t)})},_confirm:function(t,e){var i,n=this,r=n.model.get("hub"),s={};err=[],"trigger"===n.model.get("type")&&n.model.get("config").channel_id===e&&(e="source"),n._transformView.setTransforms(s,err),err.length>0||this.constructor.__super__.confirm.call(this,function(t){r[e]||(r[e]={}),r[e].edges||(r[e].edges=[]),r[e].transforms||(r[e].transforms={}),i=r[e],i.transforms[t]=s,$.inArray(t,i.edges)<0&&i.edges.push(t),n.trigger("channel:set",t)})},transformHint:function(e,n){var r,s=this,o=this.model,a=o.get("hub")[n],l=e,c=i.getCollection("channel"),u=c.get(e);u&&(r="source"===n?"trigger"===o.get("type")?i.getChannel(o.get("config").channel_id).get("action"):"bip."+o.get("type"):i.getChannel(n).get("action"),i.getTransformHint(s,r,u.get("action"),function(e,i){e||(a.transforms||(a.transforms={}),a.transforms[l]={},t.each(i,function(t,e){null!=t?(a.transforms[l][e]=t,s.trigger("channel:valid",l)):s.trigger("channel:invalid",l,e+" is required")}))}))}}),CompositeTransformsView}),define("apps/bipio/views/v_bip_trigger",["underscore","backbone","bipclient","apps/bipio/views/v_node_config"],function(t,e,i,n){return CompositeTriggerView=n.extend({events:{},initialize:function(){n.prototype.initialize.apply(this,arguments)},render:function(t){this.constructor.__super__.render.apply(this,arguments),this._transformView.renderTrigger(this.model,i.getChannel(t))},confirm:function(e){var i=this,n=i.model.get("config");this.constructor.__super__.confirm.call(this,e,function(e,r){i._isContainerAction?n.config&&delete n.config.config:n.config=t.clone(r),i.trigger("channel:set",e,r)})}}),CompositeTriggerView}),define("apps/bipio/views/v_curl",["underscore","backbone","bipclient"],function(t,e){return CurlView=e.View.extend({el:"#curl-repr",tpl:t.template($("#tpl-curl-repr").html()),events:{},initialize:function(e){this.model=e,t.bindAll(this,"render")},setModel:function(t){this.model=t},render:function(t){this.$el.html(this.tpl({cmd:this.model.getCurlStr(t)})),$("pre",this.$el).tooltip({placement:"top"}).on("click",function(){return document.createRange?(rangeToSelect=document.createRange(),rangeToSelect.selectNode(this.firstChild),curSelect=window.getSelection(),curSelect.addRange(rangeToSelect),!1):document.body&&document.body.createTextRange?(range=document.body.createTextRange(),range.moveToElementText(this),range.select(),!1):void 0})}}),CurlView}),define("apps/bipio/views/v_auth",["underscore","backbone","bipclient","apps/bipio/views/v_curl"],function(t,e,i,n){return AuthView=e.View.extend({tplAuth:t.template($("#tpl-bipio-auth").html()),events:{},$username:null,$password:null,$type:null,initialize:function(e,i,n){this.model=n,t.bindAll(this,"render","toggleAuth","setUsername","setPassword","setAuthHeaderHint");var r="bip-auth-panel";$(e).append('<li><a data-toggle="pill" href="#'+r+'"> Auth</a></li>'),$(i).append('<div class="tab-pane span12" id="'+r+'"></div>'),this.el="#"+r,this.$el=$(this.el)},render:function(){var t=this.model.get("config");this.$el.html(this.tplAuth(this.model.toJSON())),this._curlView=new n(this.model),this._curlView.render(),this.$type=$("#auth",this.$el),this.$username=$("#auth_username",this.$el),this.$password=$("#auth_password",this.$el),this.$type.on("change",this.toggleAuth),this.$username.on("keyup",this.setUsername),this.$password.on("keyup",this.setPassword),this.setAuthHeaderHint(),this.$type.val(t.auth)},setAuthHeaderHint:function(){var t=this.model.getAuthHeader();this._curlView.render(),$(".auth-headers",this.$el).text(t||"No Authorization Header Required")},setUsername:function(t){this.model.get("config").username=$(t.currentTarget).val(),this.setAuthHeaderHint()},setPassword:function(t){this.model.get("config").password=$(t.currentTarget).val(),this.setAuthHeaderHint()},toggleAuth:function(t){var e=$(t.currentTarget),i=e.find(":selected").val();t.preventDefault(),"basic"===i?$("#auth-control").css("display","block"):$("#auth-control").css("display","none"),this.model.get("config").auth=i,this.setAuthHeaderHint()}}),AuthView}),define("apps/pods/views/v_channel_renderers",["underscore","backbone","bipclient"],function(t,e,i){var n=e.View.extend({el:"#renderers-panel",tplRendererPanel:null,events:{"click .select-renderer button":"selectRenderer","click .btn-remove-renderer":"selectRenderer"},initialize:function(e,i){this.tplRendererPanel=t.template($("#tpl-renderers").html()),e&&(this.el=e,this.$el=$(e)),this.container=i,t.bindAll(this,"render","_applySelectedRendererHTML","selectRenderer")},_applySelectedRendererHTML:function(e,n){var r,s,o,a;n&&Object.keys(n).length?n.channel_id?(s=i.getCollection("channel").get(n.channel_id),s&&(a=t.findWhere(s.get("_links"),{name:n.renderer}),a&&Object.keys(a).length&&(o=s.getPod(),r='<img class="hub-icon hub-icon-24" src="'+s.getPodIcon()+'"> <strong>'+o.get("title")+" : "+s.get("name")+"</strong> "+a.title+" ("+a.contentType+')<button class="btn btn-mini btn-danger pull-right btn-remove-renderer">Remove</button>'))):n.pod&&(o=i.getCollection("pod").get(n.pod),o&&(a=o.get("rpcs")[n.renderer],r='<img class="hub-icon hub-icon-24" src="'+o.getIcon()+'"> <strong>'+o.get("title")+"</strong> "+a.title+" ("+a.contentType+')<button class="btn btn-mini btn-danger pull-right btn-remove-renderer">Remove</button>')):r='<i class="icon-ban-circle"></i> No Responder Enabled',e.html(r)},render:function(t){var e={rendererChannels:i.getCollection("channel").getRenderable(!0),rendererPods:i.getCollection("pod").getRenderable()};return this.$el.html(this.tplRendererPanel(e)),this._applySelectedRendererHTML($(".renderer-selected",this.container),t),$("#include-channel-invoke").on("click",function(t){var e=$(t.currentTarget),i=$(".renderer-container",e.parents(this.container));e.is(":checked")?$(".hide",i).removeClass("hide").addClass("hide_disabled"):$(".hide_disabled",i).removeClass("hide_disabled").addClass("hide")}),this},selectRenderer:function(t){var e=$(t.currentTarget),n=e.parent(),r=n.attr("data-channel-id"),s=n.attr("data-pod-id"),o=n.attr("data-renderer"),a=$(this.container+" .renderer-selected");if(e.hasClass("btn-enable-renderer")){var l={renderer:o};r?l.channel_id=r:s&&(l.pod=s),this._applySelectedRendererHTML(a,l),this.trigger("renderer:add",l)}else e.hasClass("btn-remove-renderer")?(this._applySelectedRendererHTML(a),this.trigger("renderer:remove")):e.hasClass("btn-preview-renderer")&&i.openRenderer(n.attr("data-channel-id"),n.attr("data-renderer"));return!1}});return n}),define("apps/bipio/views/v_bip_edit",["underscore","backbone","bipclient","apps/bipio/views/v_bip_hub","apps/bipio/views/v_bip_logs","apps/bipio/views/v_req_parser","apps/bipio/views/v_bip_data","apps/bipio/views/channel/v_channel_list","apps/bipio/views/v_bip_share","apps/bipio/views/v_bip_transform","apps/bipio/views/v_bip_trigger","apps/bipio/views/v_auth","apps/pods/views/v_channel_pod_list","apps/pods/views/v_channel_config","apps/pods/views/v_channel_renderers"],function(t,e,i,n,r,s,o,a,l,c,u,h,d,p,f){return BipEditView=e.View.extend({el:"#bip-setup",$controlPane:null,$controlModal:null,$controlModalContent:null,tplBipConfig:t.template($("#tpl-bipio-select").html()),tplLoader:t.template($("#tpl-loader").html()),tplInfoPod:t.template($("#tpl-bipio-pod-info").html()),tplPodEntity:t.template($("#tpl-bipio-pod-entity").html()),tplPodSelectModal:t.template($("#tpl-bipio-modal-pod-select").html()),tplCtlStart:t.template($("#tpl-bipio-hub-start").html()),tplCtlChanSelect:t.template($("#tpl-bipio-channel-select").html()),tplCtlPodSelect:t.template($("#tpl-bipio-pod-select").html()),tplCtlChanCreate:t.template($("#tpl-bipio-channel-create").html()),tplCtlTransform:t.template($("#tpl-bipio-transform").html()),tplCtlEdge:t.template($("#tpl-bipio-edge").html()),hubView:null,logsView:null,_podView:null,_transformView:null,_triggerView:null,_channelListView:null,_authView:null,modalOpen:!1,mode:null,waiting:!1,modalWrapperPos:{},channelFilter:[],_openTime:null,_activeShareID:null,_activeCID:null,_activeParentCID:null,_activeParentCIDSource:!1,events:{"click #bip-submit-close":"publish","click #bip-submit":"publish","click .delete-action":"deleteBip","keyup #bip_name":"reprUpdate","click #bip-cancel":"modalClose","unfocus #bip-name":"nameChanged","click .pause-action":"pauseAction","click .share-action":"shareAction","click .trigger-action":"triggerAction","click #repr-toggle":"toggleRepr","click .clear-log-action":"clearLogs","click .refresh-log-action":"refreshLogs","click .description-action":function(){setTimeout(function(){$("#bipio-desc-modal .modal-body textarea").focus()},500)},"click #bip-repr":i.selectContents},initialize:function(e){t.bindAll(this,"render","shutdown","publish","deleteBip","reprUpdate","nameChanged","modalClose","closeRefresh","clearErrorClasses","invalidModel","errTranslate","pauseAction","pauseBip","toggleAuth","clearLogs","refreshLogs","setTrigger","toggleRepr","_addChannel","_renderBip","_renderDefault","_bindModalEvents","_setupValidation","_modalResize","_setControlModalContent","_initControlPane","_controlPaneRest","_controlPaneChanSelect","_controlPanePodSelect","_controlPaneChanCreate","_controlPaneChanTransform","_controlPaneConfigureTrigger"),this._router=e,this.deleteModal=$("#bipio-delete-modal")},_enableOptions:function(){$("#edit-options").removeClass("hide")},_isWaiting:function(){return this.model&&"trigger"===this.model.get("type")&&!Object.keys(this.model.get("config")).length},render:function(t,e,n){var r=this;if(("new"===t||"dup"===e||"shared"===e)&&i.bipsExceedPlan())return r._router.navigate("bipio",{trigger:!0}),void i.selectPlanRoute("num_bips");if(this._openTime=moment().unix(),this.channelFilter=[],this.mode=e,t&&"new"!==t&&"shared"!==e){if(this.model=i.getCollection("bip").factoryClone(t),"dup"===e){var s=this.model.toJSON();delete s.id,s.name+=" - copy",s.dup=!0,s.paused=!1;for(var o in s)0===o.indexOf("_")&&delete s[o];this.model=i.getCollection("bip").factory(s)}this.model?"delete"===e?this.deleteBip():this._renderBip(!1,!1,e):(this.model=i.getCollection("bip").factory({id:t}),this.model.fetch({success:function(t){r.model=t,r._renderBip()},error:function(){i.growl("Bip Does Not Exist","error")}}))}else if("shared"===e){var a=i.activeShare;if(!a)return i.growl("No Community Bip Selected","error"),void r._router.navigate("bipio",{trigger:!0});a.domain_id=userSettings.bip_domain_id,this.model=i.getCollection("bip").factory(a),this._renderBip(!0),this._activeShareID=n,i.growl("Please Confirm Settings Before Saving")}else if("http"===e&&"new"===t&&n){{var l=i.getCollection("pod").getActionSchema(n);n.split(".")[0]}if(l&&"http"===l.trigger){var c={type:e,domain_id:userSettings.bip_domain_id,config:{channel_id:n},name:n.replace(/\.|_/g,"-"),note:l.description};l.exports&&l.exports.properties&&(c.exports=l.exports),this.model=i.getCollection("bip").factoryDefault(c),this._renderBip()}else this._renderDefault(e,n)}else this._renderDefault(e);$("#hub").droppable({accept:".channel-list-item",drop:function(t,e){var i=($("a",e.draggable).attr("data-channel-id"),$("a",e.draggable).attr("data-action")),n=$(this).offset(),s=e.offset.left-n.left;y=e.offset.top-n.top,r.itemDragged=!1,e.draggable.remove(),r._addChannel(i,t,s,y)}}),$("#repr-toggle").tooltip(),this._setupValidation(),$("#hub").click(function(){$("#collapseContent").hasClass("in")&&$("#collapseContent").collapse("hide")}),r.listenTo(r.model,"channel:invalid",this.triggerInvalidChannel),this.hubView.on("loadPods",this.loadPods,this)},triggerInvalidChannel:function(t,e){this.hubView.trigger("channel:invalid",t,e)},shutdown:function(){this.undelegateEvents(),this.$el.removeData().unbind(),this.$el.remove(),this.remove(),e.View.prototype.remove.call(this),$(window).off("resize orientationchange",this._resize),this.hubView&&(this.hubView.shutdown(),this.hubView.undelegateEvents(),this.hubView.$el.removeData().unbind(),this.hubView.$el.remove(),this.hubView.remove(),e.View.prototype.remove.call(this.hubView))},_modalResize:function(){var t,e=$("#channel-connect").width();$("#hub").height(t),t=this.hubView._setDimensions()[1],$("#channel-connect").height(t),$(".tab-pane").height($("#hub").height()+10),$("#config-modal .modal",this.$el).css("height",t).css("left",e+30).css("width",$("#bipio-container").width()-e)},_toggleOverlay:function(t){var e=$("#blocking-overlay");t?e.addClass("hide"):e.removeClass("hide")},_renderDefault:function(t,e){var n={type:t,domain_id:userSettings.bip_domain_id};this.model=i.getCollection("bip").factoryDefault(n),e&&this.model.set("name",e),this._renderBip()},_renderBip:function(a,l,d){var p=this.model.toJSON(),g=$(this.el),m=this.model.get("end_life"),v=p.type,b=this;if(p.shared=a,p.isNew=void 0==this.model.id,this.isNewTrigger=this.model.isNew()&&"trigger"===this.model.get("type")&&"dup"!==d&&!a,p._repr||(p._repr=""),p.app_id||(p.app_id=""),p.isNew&&(p.end_life=t.clone(userSettings.bip_end_life)),p.end_life.action&&""!==p.end_life.action||(p.end_life.action=userSettings.bip_expire_behaviour),p.domainCollection=i.getCollection("domain").toJSON(),p.expiry_imp=parseInt(m.imp),(isNaN(p.expiry_imp)||0==p.expiry_imp)&&(p.expiry_imp=""),p.explicitDate=!1,p.time_zone=userSettings.timezone,p.expiry_time_period="",0!=m.time&&""!=m.time)if(m.time.match){var y=m.time.match(/(\d+)(d|m|y)/);y&&y[1]&&y[2]?(p.expiry_time=y[1],p.expiry_time_period=y[2]):p.expiry_time=m.time}else p.explicitDate=!0,p.expiry_time=moment(1e3*m.time).format("MM/DD/YYYY");else p.expiry_time="";if(p.icon=this.model.getIcon(),p.iconURL=p.icon,0===p.iconURL.indexOf("/")&&(p.iconURL=""),p.trigger=null,p.pod=null,"trigger"==p.type){if(p.shared||!p.isNew||l){p.isNewTrigger=!1;var _=i.getCollection("channel").get(p.config.channel_id);p.trigger=_.toJSON(),p.pod=_.getPod().toJSON()}else p.isNewTrigger=!0}else if(p.config.channel_id){var _=i.getCollection("channel").get(p.config.channel_id);p.pod=_.getPod().toJSON()}if("refresh"===d)var w=$("#hub");if(g.html(b.tplBipConfig(p)),"refresh"===d&&($("#hub").replaceWith(w),b.hubView.addFunctionWidget(!0)),this.modalWrapperPos=$("#modal-wrapper").offset(),$(".map-action h3 small i").popover(),"refresh"!==d&&(b.hubView=new n(b.model),b.hubView.on("keyEvent",function(t){65===t.keyCode&&t.ctrlKey&&$("#link-channel-create").click()}),p.hub&&b.hubView.render(p.hub)),!p.isNew){$("#bip_expiry_date_control").datepicker({date:p.expiry_time?p.expiry_time:null});var x=new o($("#bip-config-tabs",this.$el),$(".tab-content",this.$el));x.render(this.model)}if("http"===v){if(s.test()){var k=new s({tabContainer:$("#bip-config-tabs",this.$el),contentContainer:$(".tab-content",this.$el)});k.render(p.exports),k.on("schema:imported",function(t){b.model.set("exports",t)})}this._authView=new h($("#bip-config-tabs",this.$el),$(".tab-content",this.$el),this.model),this._authView.render()}this.renderersView=new f("#renderers-panel","#bip-render-panel"),this.renderersView.on("renderer:add",function(e){var i=b.model.get("config");delete i.renderer,i.renderer=t.clone(e)}),this.renderersView.on("renderer:remove",function(){var t=b.model.get("config");delete t.renderer}),$("#bip-config-tabs a").click(function(t){t.preventDefault(),$(this).tab().on("shown",function(t){if("#bip-logs-panel"===t.target.hash){var e=$("#log-body",t.target.hash);e.html()||(e.append($(".roto",b.tplLoader())),b.logsView=new r(b.model.id))}}).tab("show")}),$('#bip-config-tabs a[href="#bip-'+d+'-panel"]').trigger("click"),$(".tooltipped").tooltip();var C=t.clone(b.model.get("schedule")),A=i.getUserPlan();return C&&Object.keys(C).length||(C={recurrencePattern:"FREQ=MINUTELY;INTERVAL=5;"},A&&A.schedule&&A.schedule.recurrencePattern&&(C.recurrencePattern=A.schedule.recurrencePattern)),$("#bip-schedule").scheduler("value",C),A&&A.schedule?($(".scheduler-upgrade").show(),$(".scheduler-repeat").hide(),$(".scheduler-upgrade button").on("click",function(){i.selectPlanRoute("schedule")})):($(".scheduler-upgrade").hide(),$(".scheduler-repeat").show()),$("#bipio-desc-modal").on("shown",function(){i.centerModal($(".modal",this))}),$("#bipio-icon-modal").on("shown",function(){i.centerModal($(".modal",this))}),$("#bipio-icon-modal").on("hide",function(){var t=$("input",this).val();return""===t||/https?:\/\//.test(t)?(""===t?b.model.set("icon",""):b.model.set("icon",t),b.hubView.bindBipSourceIcon(b.model.getIcon()),$("img",this).attr("src",b.model.getIcon()),void 0):(i.growl("Not A Valid Icon URL","error"),!1)}),this.isNewTrigger&&$("#tab-schedule,#tab-expiry").hide(),this._refreshRenderers(),this.model.on("validated:invalid",this.invalidModel,this),this.model.on("validated:valid",this.clearErrorClasses,this),e.Validation.bind(this),this.$controlPane=$("#control-pane",this.$el),this.$controlModal=$("#config-modal",this.$el),this.$controlModalContent=$(".modal-content",this.$controlModal),this._transformView=new c(this.model,this.$controlModalContent),this._transformView.sinceTime=this._openTime,this._transformView.on("meta:refresh",function(t){b.$controlPane.html(b.tplCtlTransform(t))}).on("channel:valid",function(t){b.hubView.trigger("channel:valid",t)}).on("channel:invalid",function(t,e){b.hubView.trigger("channel:invalid",t,e)}).on("transform:invalid",function(){$("#tab-home").click()}),this._triggerView=new u(this.model,this.$controlModalContent),this._triggerView.sinceTime=this._openTime,this._triggerView.on("meta:refresh",function(t){b.$controlPane.html(b.tplCtlTransform(t))}).on("channel:set",function(t){b.setTrigger(t||b._activeCID),b.model.get("hub").source.edges.length||i.growl("Event Source Selected, Add Some Actions!")}),b._activeParentCID=null,b._activeCID=null,b._activeParentCIDSource=!1,this._initControlPane(p),this.listenTo(this.model,"channel:invalid",this.triggerInvalidChannel),this._isWaiting()||this._enableOptions(),t.findWhere(this.model.get("_links"),{name:"errors"})&&$('#bip-config-tabs li a[href="#bip-logs-panel"]').addClass("tab-error"),$(window).on("resize orientationchange",this._modalResize),this._modalResize(),this},clearLogs:function(){i.getCollection("bip_log").clear(this.logsView.render)},refreshLogs:function(t){var e=$(t.currentTarget),i=this;e.button("loading"),this.logsView.$el.append($(".roto",i.tplLoader())),this.logsView.refresh(function(){e.button("reset")})},_containerFade:function(t,e){t.fadeOut(100,function(){e(),t.fadeIn(50)})},_setControlModalContent:function(t){var e=this;$(".modal",this.$controlModal).html(t),$(".modal-close",this.$controlModal).on("click",function(){e.hubView.trigger("channel:cancel"),e._controlPaneRest(!0)}),$("body").css("overflow","hidden"),this.minimizeModal(),this.changeZIndex($("#channel-connect")[0],750),window.scrollTo(0,0),this.$controlModal.show(),this.modalOpen=!0},_setControlModalBody:function(t){$(".modal-body",this.$controlModal).html(t)},_setControlModalFooter:function(t){$(".modal-footer",this.$controlModal).html(t)},_addChannel:function(t,e,n,r){var s=this,n=n||32,r=r||(e?e.clientY-$("svg").position().top-24:0);if("trigger"!==s.model.get("type")||s.model.get("config").channel_id){var o=i.getCollection("channel").get(t).toJSON();s.hubView.addChannel(o.id,n,r),s.channelFilter.push(o.id),s._controlPaneRest(!0)}else s.setTrigger(t)},_refreshRenderers:function(){var t={};"http"===this.model.get("type")&&this.model.get("config").renderer&&(t=this.model.get("config").renderer),this.renderersView.render(t)},_initControlPane:function(){var e=this;$(".modal-content",this.$controlModal).height($("#hub").height()),$("#modal-wrapper").draggable({handle:".modal-header"}),this._controlPaneRest(),e.hubView.on("select:cid",function(t,i,n){e._activeParentCID=i,e._activeCID=t,e._activeParentCIDSource=n,t||e._controlPaneChanSelect()}),e.hubView.on("transform:cid",function(t,n,r){var s=i.getCollection("channel").get(t);s.hasImports()?(e._activeParentCID=n,e._activeParentCIDSource=r,e._activeCID=t,e._controlPaneChanTransform()):i.growl("Action Has No Attributes To Personalize")}),e.hubView.on("trigger:configure",function(t){var n=i.getCollection("channel").get(t);n.getPod().hasConfig(n.get("action"))?(e._activeCID=t,e._controlPaneConfigureTrigger()):i.growl("Action Has No Attributes To Personalize")}),e.hubView.on("edge:hover",function(t,i){if(!e.itemDragged){var n=e._transformView.getChannelDict(t),r=e._transformView.getChannelDict(i);e._containerFade(e.$controlPane,function(){$("#channel-connect").addClass("edge-connect"),e.$controlPane.html(e.tplCtlEdge({source:n,target:r}))})}}),e.hubView.on("edge:dehover",function(){e.itemDragged||e.modalOpen||(e._containerFade(e.$controlPane,function(){$("#channel-connect").removeClass("edge-connect"),e._controlPaneChanSelect()}),e.hubView.refocus())}),e.hubView.on("transform:hint",e._transformView.transformHint),e.hubView.on("channel:hover",function(t,n){if(!e.itemDragged){var r=i.getCollection("channel").get(t),s=e._transformView.getChannelDict(t);s.icon=r?r.getIcon():s.pod.icon,t&&"trigger"!==t&&(s._hover="drag",n&&r.hasImports()&&(s._hover="click")),s.isNewTrigger=e.isNewTrigger,e._containerFade(e.$controlPane,function(){e.$controlPane.html(e.tplCtlTransform(s))})}}),e.hubView.on("channel:dehover",function(){e.itemDragged||e.modalOpen||(e._containerFade(e.$controlPane,function(){$("#channel-connect").removeClass("edge-connect"),e._controlPaneChanSelect()}),e.hubView.refocus())}),e.hubView.on("channel:remove",function(i){e.model.removeEdge(i),e.channelFilter=t.difference(e.channelFilter,[i]),e._controlPaneRest(!0)})},_controlPaneRest:function(){this._controlPaneChanSelect(),this.changeZIndex($("#channel-connect")[0],0),$("body").css("overflow","auto"),$("#modal-wrapper")[0].style.position="relative",$("#modal-wrapper").css({top:this.modalWrapperPos.top,left:0}),this.minimizeModal(),this.$controlModal.hide(),this._toggleOverlay(!0),this.hubView.refocus(),$("#hub svg rect").trigger("mouseup"),this.modalOpen=!1},_controlPaneChanSelect:function(t){var e=this,n=this.model.get("hub");e.itemDragged=!1;for(var t in n){this.channelFilter.push(t);for(var r=0;r<n[t].edges.length;r++)this.channelFilter.push(n[t].edges[r])}this.channelFilter=$.unique(this.channelFilter),this.$controlPane.html(this.tplCtlChanSelect({emitter:this.isNewTrigger,waiting:!this.channelFilter.slice(1).length,sourceConnections:!0})),this._channelListView||(this._channelListView=channelList=new a(e.$controlPane,".ag-list-results",this.isNewTrigger?"emitters":"actions",this.channelFilter),this._channelListView.on("view:rendered",function(){$(".channel-list-item").draggable({containment:".map-action",appendTo:"body",cursorAt:{top:0,left:0},drag:function(){e.itemDragged=!0},helper:function(){return $("img",arguments[0].currentTarget).clone().css("z-index",1e3)}}),$(".channel-list-item").on("mouseover",function(){$("button",this).css("right","0px")}).on("mouseout",function(){$("button",this).css("right","-65px")}).on("dblclick",function(t){var i=$(this).children("a").attr("data-channel-id"),n=$(this).children("a").attr("data-action");i=i||n,i&&e._addChannel(i,t)})}),this._channelListView.on("view:addAction",function(t){var n=t.split("."),r=i.getCollection("pod").get(n[0]);if(r&&!r.isAuthed()){var s=new d;s._authModalSpawn(r),s.on("pod:auth",function(){e._controlPanePodSelect(r,n[1])})}else e._addChannel(t)})),this._channelListView.setSearchExclusions(this.channelFilter),this._channelListView.render(e.$controlPane),$("#channel-search-form").val(this._channelListView.collection.searchBy),$("#link-channel-create",e.$controlPane).on("click",function(t){t.preventDefault(),t.stopPropagation(),e._controlPanePodSelect()}),$("#channel-search-form",this.$controlModal).focus()},loadPods:function(){this._controlPanePodSelect()},_controlPanePodSelect:function(e,n,r,s){function o(e){if(c.isNewTrigger){var n=$("#pod-list"),r={type:"payload",title:"Custom Event",icon:i.getCollection("pod").get("flow").getIcon("generator")},s=!e||!e.length,o=!1;s||t.each(e,function(t){!o&&(r.type+r.title).toLowerCase().match(t)&&(o=!0)}),(s||o)&&n.prepend(c.tplPodEntity(r))}}function a(e){var n=$("#bip_name").val();if(c.isNewTrigger){var r=$("#pod-list"),s={type:"smtp",title:"Incoming Email",icon:"/static/img/channels/32/color/bip_smtp.png",name:n},o={type:"http",title:"Incoming Web Hook",icon:"/static/img/channels/32/color/bip_http.png",name:n},a=!e||!e.length,l=!1,u=!1,h=i.getCollection("bip_descriptions"),d=h.get("smtp"),p=h.get("http");a||t.each(e,function(t){p&&!l&&(o.type+o.title).toLowerCase().match(t)&&(l=!0),d&&!u&&(s.type+s.title).toLowerCase().match(t)&&(u=!0)}),(a&&d||u)&&r.prepend(c.tplPodEntity(s)),(a&&p||l)&&r.prepend(c.tplPodEntity(o))}}var l,c=this;this._toggleOverlay(),this.$controlPane.html(this.tplCtlPodSelect({emitter:this.isNewTrigger})),this._setControlModalContent(this.tplPodSelectModal({emitter:this.isNewTrigger})),$("#link-channel-search",c.$controlPane).on("click",function(t){t.preventDefault(),t.stopPropagation(),c._controlPaneRest()});var u=new d(null,null,this.isNewTrigger?"emitters":"actions");this._podView=u,u.tplActionSelect=t.template($("#tpl-bipio-action-select").html()),u._configView=new p,u._configView.tplActionEntity=t.template($("#tpl-bipio-action-entity").html()),u.on("podSelected",function(t){$("#config-modal h2").html("Select A "+t.pod.get("title")+" "+(c.isNewTrigger?"Event":"Action")+" Below")}),u.on("view:actionSelected",function(t,e){var n=i.find.channel(e+"."+t.name);if(c._controlPaneRest(!0),c.isNewTrigger){if("http"===t.trigger)return void c._router.navigate("bipio/new/http/"+e+"."+t.name,{trigger:!0});if(n.hasConfig())return void c.hubView.trigger("trigger:configure",n.get("id"));c.setTrigger(n.get("id")),c.model.get("hub").source.edges.length||i.growl("Event Source Selected, Add Some Actions!")}else{var r=n.toJSON();c.hubView.addChannel(r.id)}c._enableOptions()}),u.on("view:cancel",function(){c._controlPaneRest(!0)}),u.on("pod:deauth",function(e){t.findWhere(c.model.getManifest().normedManifest,{pod:e})&&c.model.isValid(!0)&&c.pauseBip("pause","Bip Has Disabled Services Integrated And Has Been Paused")}),u.on("pod:auth",function(t){var e=i.getCollection("pod").get(t);c._controlPaneChanCreate(e),u.podSelect(e,!0)}),e?(u._renderPods(),u.podSelect(e,!0,r),n?e.isAuthed()?c.hubView.addChannel(e.get("name")+"."+n,0,0):(c._controlPaneChanCreate(e),$("#pod-auth").click()):c._controlPaneChanCreate(e),u.on("channel:saved",function(t){if(c.isNewTrigger)c.setTrigger(t.get("id"));else{var e=t.toJSON();c.hubView.addChannel(e.id,0,0),c.channelFilter.push(e.id)}c._controlPaneRest(!0),c._refreshRenderers()}),s||(c._controlPaneChanSelect(),c._toggleOverlay(!0))):(l=function(t){u._renderPods(void 0!==t,t),o(t),$("#pod-list .pod-selector").on("click",function(t){var e=$(t.currentTarget).parent().parent().attr("data-pod"),n=i.getCollection("pod").get(e);return"bip-payload"==e?(c._controlPaneRest(!0),c.setTrigger("flow.generator")):n.get("level_locked")?i.confirmNavModal({cb:function(){return i.selectPlanRoute("pod_exclusions",n.get("title")),!1},title:'<img src="'+n.getIcon()+'"/> Upgrade Required',body:n.get("title")+" is a Premium pod and requires a plan upgrade to use",confirm:"Upgrade"}):(u.podSelect(n,!0),c._controlPaneChanCreate(n),n.isAuthed()||($(".action-selectable").addClass("browsing"),$("#pod-auth").click())),!1}),a(t),$("#pod-list .pod-selector").on("mouseover focus",function(t){var e,n,r=$(t.currentTarget).parent().parent().attr("data-pod");if(0===r.indexOf("bip-")){var s,o,a,l=r.split("-").pop();"http"===l?(o="Incoming Web Hook",s="Processes incoming HTTP requests to any of your domains"):"smtp"===l?(o="Incoming Email",s="Processes incoming Emails to any of your domains"):"payload"===l&&(o="Generate Data",s=i.getCollection("pod").get("flow").getAction("generator").description,a=i.getCollection("pod").get("flow").getIcon("generator")),n={ignore_auth:!0,pod:{getIcon:function(){return a?a:"/static/img/channels/32/color/bip_"+l+".png"
}},podJSON:{name:o,title:o,description:s,auth:{status:"accepted"}}}}else e=i.getCollection("pod").get(r),n={ignore_auth:!1,pod:e,podJSON:e.toJSON()};n.hover=!0,$(".ctrl-panel-info",c.$controlPane).html(c.tplInfoPod(n))}).on("mouseout",function(){$(".ctrl-panel-info",c.$controlPane).empty()});var e=0;$("#channel-search-form").attr("tabindex",e),e++,$(".channel-list-item a").each(function(){$(this).attr("tabindex",e),e++})},$("#channel-search-form",this.$controlModal).on("keyup",function(e){if(27===e.keyCode)return void c._controlPaneRest(!0);for(var i=$(this).val(),n=[],r=t.map(i.split(","),function(t){return t.trim()}),s=0;s<r.length;s++)r[s]&&n.push(r[s]);l(n)}),u.on("channel:saved",function(t){if(c.isNewTrigger)c.setTrigger(t.get("id"));else{var e=t.toJSON();c.hubView.addChannel(e.id,0,0),c.channelFilter.push(e.id)}c._controlPaneRest(!0),c._refreshRenderers()}),l(),setTimeout(function(){$("#channel-search-form",this.$controlModal).focus()},200)),$(".save-channel").click(u.saveChannel)},_controlPaneChanCreate:function(t){function e(){$("#config-modal h2").html("Activate "+r.pod.get("title")+" And Access These Useful "+(n.isNewTrigger?"Events":"Actions"))}var n=this,r={ignore_auth:!1,pod:t,podJSON:t.toJSON(),emitter:this.isNewTrigger,hover:!1};this._toggleOverlay(),this.$controlPane.html(this.tplCtlChanCreate(r)),$(".ctrl-panel-info",this.$controlPane).html(n.tplInfoPod(r)),$("#link-pod-select",n.$controlPane).on("click",function(t){t.preventDefault(),t.stopPropagation();var e=i.find.pod($(this).attr("data-pod"));n._controlPanePodSelect(e)});var s=new d;$("#pod-auth",n.$controlPane).on("click",function(){s.authModal.apply(this,arguments),n.modalOpen=!0}),s.on("pod:authCancel",e)},_setNodeTitle:function(t){this.model.setTitleForCid(this._activeCID,t),$("#node-title-repr").html(t)},_toggleNodeEdit:function(){return $repr=$("#node-title"),$input=$("#node-title-edit"),$repr.is(":visible")?$repr.fadeOut(50,function(){$input.fadeIn(50,function(){$(this).focus()})}):$input.is(":visible")&&$input.fadeOut(50,function(){$repr.fadeIn(50,function(){$(this).focus()})}),!1},_bindModalEvents:function(){var t=this;$("body").css("overflow","hidden"),$("#resizeModal","#modal-wrapper").click(function(){"icon-resize-small"==$(this).attr("class")?t.minimizeModal():"icon-resize-full"==$(this).attr("class")&&t.maximizeModal()}),$(".modal-close",this.$controlModalContent).on("click",function(e){e.preventDefault(),e.stopPropagation(),t._controlPaneRest(!0)}),$(".tooltippable",this.$controlModalContent).tooltip(),$(".icon-question-sign").popover(),$("#node-title").on("click",this._toggleNodeEdit),$("#node-title-edit").on("blur",function(){t._setNodeTitle($(this).val()),$("#node-title").trigger("click")}).on("keyup",function(e){13===e.keyCode?$(this).blur():27===e.keyCode&&($(this).val(t.model.getTitleForCid(t._activeCID)),$(this).blur())}),this.minimizeModal(),this.changeZIndex($("#channel-connect")[0],750),window.scrollTo(0,0),this.$controlModal.show(),this.modalOpen=!0},_controlPaneChanTransform:function(){{var t=this,e=t._activeCID,n=(i.getChannel(e),t._activeParentCID),r=t._activeParentCIDSource;[n].concat(this.hubView.getParentsForCID(n))}this._toggleOverlay(),this._transformView.render(e,n,[n].concat(this.hubView.getParentsForCID(n)),r),$(".modal-confirm",this.$controlModalContent).on("click",function(){var e=t._activeParentCID;return"trigger"===t.model.get("type")&&t.model.get("config").channel_id===e&&(e=t._activeParentCID="source"),t._transformView.confirm(t._activeCID,t._activeParentCID,function(e,i){var n=t._activeParentCIDSource?"source":t._activeParentCID,r=t.model.get("hub");r[n]||(r[n]={}),r[n].edges||(r[n].edges=[]),r[n].transforms||(r[n].transforms={}),ptr=r[n],t._activeCID!=e&&(t.model.hubReplace(t._activeCID,e),t.hubView.channelReplace(t._activeCID,e)),ptr.transforms[e]=i,$.inArray(e,ptr.edges)<0&&ptr.edges.push(e),t.hubView.trigger("channel:valid",e),t._controlPaneRest()}),!1}),$(".modal-delete",this.$controlModalContent).on("click",function(){return t.hubView._removeSelectedNode(),t.hubView._selectionState.link=null,t.hubView._selectionState.node=null,t.hubView._redraw(!0),t._controlPaneRest(!0),!1}),this._bindModalEvents()},_controlPaneConfigureTrigger:function(){var t=this;this._toggleOverlay(),this._triggerView.render(t._activeCID),$(".modal-delete",this.$controlModalContent).remove(),$(".modal-confirm",this.$controlModalContent).on("click",function(){return t._triggerView.confirm(t._activeCID),!1}),this._bindModalEvents()},changeZIndex:function(t,e){t.style.zIndex=e},maximizeModal:function(){$("#resizeModal").attr("class","icon-resize-small"),$("#modal-wrapper")[0].style.position="absolute",$(".modal-content").height($(window).height()),$("#channel-connect").height($(window).height()),$("#modal-wrapper").offset({top:"0",left:this.modalWrapperPos.left})},minimizeModal:function(){$("#resizeModal").attr("class","icon-resize-full"),$("#modal-wrapper")[0].style.position="relative",$(".modal-content").height($("#hub").height()),$("#channel-connect").height($("#hub").height()),$("#modal-wrapper").css("top","").css("left","")},invalidModel:function(t,e){var n,r;this.clearErrorClasses();for(key in e)n=key,r=e[key],/^hub/.test(n)?i.growl(r,"error"):/^end_life/.test(n)?this.errTranslate(!0,n.replace(/\..*/g,""),r):this.errTranslate(!0,n,r)},clearErrorClasses:function(){var t=$("#hub").siblings(".control-group");t.removeClass("error"),t.find(".help-block").html(""),this.errTranslate(!1,"end_life"),this.errTranslate(!1,"name"),this.errTranslate(!1,"note")},_setupValidation:function(){var t=this;e.Validation.bind(this,{model:this.model,invalid:function(e,n,r){if(/^hub/.test(n)){var s=$("#hub").parents(".control-group");s.addClass("error"),s.find(".help-block").html(r);var o=$(s).parents(".tab-pane").attr("id");$('#bip-config-tabs li a[href="#'+o+'"]').addClass("alert-danger"),i.growl(r,"error")}else/^end_life/.test(n)?(t.errTranslate(!0,n.replace(/\..*/g,""),r),i.growl(r,"error")):(t.errTranslate(!0,n,r),i.growl(r,"error"))},valid:function(e,i,n){if(/^hub/.test(i)){var r=$("#hub").siblings(".control-group");r.removeClass("error"),r.find(".help-block").html("")}else/^end_life/.test(i)&&t.errTranslate(!1,i.replace(/\..*/g,""),n)}})},setTrigger:function(e){var n=i.getCollection("channel").get(e),r=this,s=this.model.get("config"),o=this.model.get("hub"),a={name:$("#bip_name").val()||n.get("name"),note:n.get("note"),type:this.model.get("type")||"trigger",config:{channel_id:e,config:t.clone(s.config)},hub:Object.keys(o).length?o:{source:{edges:[]}}};r.model.set(a,{silent:!0}),$("#bip_name").val(a.name),r.hubView.setTriggerSourceParams(r.model),r.isNewTrigger=!1,delete r._channelListView,$("#tab-schedule,#tab-expiry").show(),r._controlPaneRest()},saveRefresh:function(t){var e=this;i.getCollection("bip").fetch({reset:!0,success:function(){t&&e.modalClose()}})},closeRefresh:function(){i.getCollection("bip").fetch({reset:!0}),this.modalClose()},deleteBip:function(){return $(".btn-success",this.deleteModal).attr("data-bip-id",this.model.id),this.deleteModal.modal(),i.centerModal($(".modal",this.deleteModal)),!1},errTranslate:function(t,e,i){var n=$("#bip_"+e,self.el).parent(),r=$("#bip_"+e,self.el).closest(".control-group");if(t){r.addClass("error"),n.children(".help-block").html(i);var s=$(n).parent().attr("id");$('#bip-config-tabs li a[href="#'+s+'"]').addClass("alert-danger")}else n.removeClass("error"),r.children(".help-block").html("");return n.length},isChildOfSource:function(t,e){if("source"==e)return!0;t=null==t?"source":t;var i=this.model.attributes.hub;if(i[t]){if($.inArray(e,i[t].edges)>-1)return!0;for(var n=0,r=i[t].edges.length;r>n;n++)if(this.isChildOfSource(i[t].edges[n],e))return!0}return!1},clearEdgesTransforms:function(t){var e=this.model.attributes.hub,n=e[t].edges;if(n.length>0){var r=e[t].transforms;for(var s in r)$.inArray(s,n)<0&&delete r[s]}else e[t].exports||e[t].title||delete e[t];var o=this.isChildOfSource(null,t);o||delete e[t],"source"!=t||e[t]||(e[t]=i.getCollection("bip").factoryDefault().get("hub").source)},publish:function(t){var e,n=this,r=(this.model.isNew(),$.trim($("#channel_id_selected").val()),$(t.currentTarget));t.preventDefault(),$("#bip-config-tabs li a").removeAttr("required").removeAttr("empty");var e={imp:$.trim($("#bip_expiry_imp").val()),time:"",action:$("#bip_expire_behaviour :button.active").attr("data-selection")},s=$("#bip_expiry_date").val();if(s){var o=this.model.get("end_life"),a=new Date(1e3*o.time);e.time=s!=a.toString("dd-MM-yyyy")?s:o.time}else{var l=$.trim($("#bip_expiry_time").val());""!=l&&0!=l&&(e.time="+"+l+$.trim($("#bip_expiry_time_resolution").find(":selected").val()))}var c={name:$.trim($("#bip_name").val()),domain_id:$.trim($("#domain_id :selected").val()),note:$.trim($("#bip_note").val()),end_life:e,schedule:JSON.parse(JSON.stringify($("#bip-schedule").scheduler("value")))};"http"===this.model.get("type")&&(c.config=this.model.get("config"),c.config.auth=$("#auth").find(":selected").val(),c.config.username=$("#auth_username").val(),c.config.password=$("#auth_password").val()),this.model.set(c);for(var u in this.model.attributes.hub)this.clearEdgesTransforms(u);if(this._isWaiting())i.growl("Please Select An Event Source");else if(this.model.isValid(!0)){r.button("loading");var h=this.model.id?i.getCollection("bip").get(this.model.id):this.model;h.set(this.model.toJSON()),this.model=h,h.save(h.toJSON(),{silent:!1,patch:!0,sync:!0,success:function(t,e){r.button("reset"),e&&e.errors?(that.renderErrMsg(e.errors),$("#bip-submit i").removeClass("icon-save").addClass("icon-warning-sign"),$("#bip-submit").removeClass("btn-success").addClass("btn-warning")):("shared"===n.mode&&i.activeShare&&n._activeShareID&&i.incShare(n._activeShareID),i.growl("Bip <strong>"+e.name+"</strong> Saved"),"bip-submit-close"==r.attr("id")?n.saveRefresh(!0):"bip-submit"==r.attr("id")&&(n.saveRefresh(),n._renderBip(!1,!1,"refresh")))},error:function(t,e){var s=!1;if(r.button("reset"),409===e.status)i.growl("Bip Name Is Already In Use","error");else if(402==e.status)i.selectPlanRoute("num_bips");else if(""!==e.responseText){var o=JSON.parse(e.responseText);if(o&&400===o.status)for(var a in o.errors)n.errTranslate(!0,a,o.errors[a].message)?s=!0:i.growl(o.errors[a].message,"error")}s&&i.growl("There were errors","error")}})}},reprUpdate:function(t){var e,i=$(t.currentTarget).val(),n=$("#domain_id :selected").html(),r=this.model.get("type");switch(r){case"http":e="https://"+n+"/bip/http/"+i;break;case"smtp":e=i+"@"+n;break;case"payload":e=i+"@"+n;break;case"trigger":e=i;break;case"default":}this.model.set("name",i),this.model.set("_repr",e),$("#bip-repr",this.el).html(e),this._authView&&this._authView.setAuthHeaderHint()},modalClose:function(){this.trigger("modal-destroy"),"shared"==this.mode?this._router.navigate("#community",{trigger:!0}):this._router.navigate("#bipio",{trigger:!0})},pauseBip:function(t,e,n){var r=this;this.model.save({paused:"play"==t?!1:!0},{patch:!0,success:function(){n&&n(),i.growl(e||"<strong>"+r.model.get("name")+"</strong> is "+("play"===t?"Active":"Paused"));var s=$("#bip-controls button.pause-action[data-action=play]"),o=$("#bip-controls button.pause-action[data-action=pause]");"pause"===t?(o.hide(),s.show()):(o.show(),s.hide()),i.getCollection("bip").get(r.model.id).set("paused",r.model.get("paused"))}})},pauseAction:function(t){var e=$(t.currentTarget).attr("data-action"),i=$(t.currentTarget);t.preventDefault(),this.pauseBip(e,void 0,function(){i.button("reset")})},shareAction:function(){var t=this.model,e=new l;return e.share(t),!1},triggerAction:function(t){var e=$(t.currentTarget).attr("data-id");i.triggerBip(e),t.preventDefault()},_setAuthHeaderHint:function(){switch(selected){case"basic":break;case"token":}$("#auth-headers").text(authHeader)},toggleAuth:function(t){var e=$(t.currentTarget),i=e.find(":selected").val();t.preventDefault(),"basic"===i?$("#auth-control").css("display","block"):$("#auth-control").css("display","none")},nameChanged:function(){$("#bip_name").val($("#bip-name").val())},toggleRepr:function(){var t,e,i=$("#bip-repr",this.$el),n=$("#bip-endpoint",this.$el);n.is(":visible")?(t=i,e=n):(t=n,e=i),e.addClass("hidden"),t.removeClass("hidden")}}),BipEditView}),define("apps/bipio/index",["underscore","backbone","bipclient","apps/bipio/views/v_bip_list","apps/bipio/views/v_bip_edit"],function(t,e,i,n,r){var s=e.View.extend({el:"#bipio-container",appID:"bipio",tplLanderWidget:t.template($("#tpl-bipio-lander").html()),tplEditWidget:t.template($("#tpl-bipio-edit").html()),container:null,router:null,modalView:null,bipListView:null,initialize:function(n,r){var s=this;t.bindAll(this,"render","shutdown"),this.container=r,this.router=n,this.deleteModal=$("#bipio-delete-modal"),$(".btn-success",this.deleteModal).on("click",function(){s.deleteModal.modal("hide");var t=i.find.bip($(this).attr("data-bip-id"));t.destroy({success:function(t){i.growl("Bip <strong>"+t.get("name")+"</strong> Deleted"),"bipio"===e.history.getFragment()?s.render.apply(s):s.router.navigate("bipio",{trigger:!0})},error:function(t,e){console.log(e)}})})},shutdown:function(){this.modalView&&this.modalView.shutdown()},render:function(e,s,o){var a=t.template($("#tpl-layouts-"+this.appID).html());this.modalView&&this.modalView.shutdown(),this.container.html(a()),e?($(this.el).html(this.tplEditWidget()),this.modalView=new r(this.router),this.modalView.render(e,s,o)):($(this.el).html(this.tplLanderWidget({bip_count:i.getCollection("bip").length})),this.bipListView=new n($("#bip-list-container",this.container),this.router),i.bipsExceedPlan()&&$("#bip-create > a").html('<i class="icon-plus-sign"></i> Upgrade Now To Create More Bips'),this.bipListView.render())},appInfo:function(t,e){var i=this,n=arguments,r={name:this.appID,title:"My Bips",ready:function(e){t.route(i.appID,i.appID,function(){i.render.apply(i,arguments)}),t.route(i.appID+"/:id",i.appID,function(){i.render.apply(i,arguments)}),t.route(i.appID+"/:id/:mode/:child_id",i.appID,function(){i.render.apply(i,arguments)}),t.route(i.appID+"/:id/:mode",i.appID,function(){i.render.apply(i,arguments)}),i.initialize.apply(i,n),e()},shutdown:function(){i.shutdown.apply(i,arguments)}};return this.container=e,this.router=t,r}});return s}),define("apps/community/views/v_bip_auth_config",["underscore","backbone","bipclient","apps/pods/views/v_channel_pod_list"],function(t,e,i,n){var r=e.View.extend({data:null,ptr:null,initialize:function(e){var i=this;t.bindAll(this,"render","close","stepOne","install","activate","spanwModal"),this._activeShare=e,this.activeShareManifest=this._activeShare.get("manifest"),this.stepOneTpl=t.template($("#tpl-modal-share-setup-step-one").html()),this.stepTwoTpl=t.template($("#tpl-modal-share-setup-step-two").html()),this.podView=new n,this.podView.on("pod:auth",function(e){t.each(t.where(i.data.actions,{name:e}),function(t){t.isActivated=!0}),i.stepTwo(!0)}),this.shareModal=$("#sharedModal")},close:function(){this.unbind(),this.remove(),this.podView.unbind(),this.podView.close(),delete this.podView},render:function(){var t=this.stepOne(),e=this;if(t)this.shareModal.modal(),this.spanwModal(this.stepOneTpl(t)),$("div:first-child",this.shareModal).first().modal(),$("#share-setup-action",this.shareModalContent).click(function(){return e.stepTwo(),!1});else{if(null===t)return;this.install()}},activate:function(t){this.podView._authModalSpawn(i.getCollection("pod").get(t),!1,"#sharedModal")},install:function(){var t=this._activeShare.toJSON(),e={name:t.name,type:t.type,config:t.config?i.deepClone(t.config):{},hub:i.deepClone(t.hub),note:t.note,schedule:t.schedule,icon:t.icon,exports:t.exports};this.trigger("shared-install",e,this._activeShare.id)},spanwModal:function(t){this.shareModalContent=$(".modal-container",this.shareModal),this.shareModalContent.html(t).modal()},checkPerm:function(t){return t.get("level_locked")?(i.confirmNavModal({cb:function(){return i.selectPlanRoute("pod_exclusions",t.get("title")),!1},title:'<img src="'+t.getIcon()+'"/> Upgrade Required',body:t.get("title")+" is a Premium pod and requires a plan upgrade to use",confirm:"Upgrade"}),!1):!0},stepOne:function(){var e=this,n={name:this._activeShare.get("name"),description:this._activeShare.get("note"),actions:[]},r=this.activeShareManifest,s=[];this.data=n;var o;for(var a in r){if(o=i.find.channel(r[a]).getPod(),!e.checkPerm(o))return null;o.isAuthed()||s.push(r[a])}if(s.length){for(var l,c=0;c<s.length;c++)l=s[c].split("."),t.findWhere(n.actions,{name:l[0]})||(n.actions[c]={name:l[0],action:l[1],current:!1});return n}return!1},stepTwo:function(){var t=this;return this.ptr=this.data.actions.shift(),this.ptr?(action=this.ptr,action.isActivated?this.ptr.channelId?void t.stepTwo():void this.spanwModal(this.stepTwoTpl({data:this.data,action:this.ptr})):void t.activate(this.ptr.name)):void this.install(this.data)}});return r}),define("models/m_bip_share",["underscore","backbone","bipclient"],function(t,e,i){return t.extend(e.Model.prototype,e.Validator),MBipShare=e.Model.extend({get:function(t){var i;if("function"==typeof this[t])return this[t]();if("_repr"===t){if(""===this.attributes._repr){switch(this.attributes.type){case"http":i="Incoming Web Hook";break;case"smtp":i="Incoming Email";break;case"trigger":i="Event Source"}return i}}else if("action"===t)return"bip."+this.attributes.type;return e.Model.prototype.get.call(this,t)},getTypeRepr:function(t){var e="";switch(t||this.get("type")){case"http":e="Incoming Web Hook";break;case"smtp":e="Incoming Email";break;case"trigger":e="Event Source"}return e},getIcon:function(){var t=this.get("icon"),e=this.get("type");return"trigger"===e&&this.get("config").channel_id&&(t=i.getCollection("channel").get(this.get("config").channel_id).getIcon()),t?t:"/static/img/channels/32/color/bip_"+e+".png"},getManifest:function(e,n){var r,s=this.toJSON(),o=(i.getCollection("pod"),i.getCollection("channel"));s.type_description=this.get("_repr"),s.type_icon=this.getIcon(),s.normedManifest=[];for(var a in s.hub)s.hub.hasOwnProperty(a)&&t.each(s.hub[a].edges,function(t){r=o.get(t),tokens=r.get("action").split("."),action=r.getAction(),s.normedManifest.push({pod:tokens[0],action:tokens[1],icon:r.getIcon(),title:r.getPod().get("title"),description:r.get("name")})});return n?i.distributeManifest(s,n):s},url:function(){return i.getShareURL(this.id)},parse:function(t){return t.data.length?t.data[0]:null}}),MBipShare}),define("apps/community/views/v_bip_shared",["underscore","backbone","bipclient","apps/pods/views/v_channel_pod_list","apps/pods/views/v_channel_config","apps/community/views/v_bip_auth_config","models/m_bip_share"],function(t,e,i,n,r,s,o){return BipSharedView=e.View.extend({el:"#bip-setup",tplSharedContainer:t.template($("#tpl-community-bips").html()),tplSharedEntity:t.template($("#tpl-community-shared-entity").html()),tplBipPreview:t.template($("#tpl-bipio-bip-preview").html()),tplPaginate:t.template($("#tpl-pagination").html()),tplActionEntity:t.template($("#tpl-action-entity").html()),tplEmbedCode:t.template($("#tpl-community-embed-code").html()),tplLoader:t.template($("#tpl-loader").html()),manifestPending:[],manifestDup:{},manifestResolved:{},shareModal:null,podSetupView:null,channelConfigView:null,_configStep:!1,_activeChannel:null,_activeShare:null,channelQueue:{},channelConfigs:{},channelSelectView:null,hubView:null,events:{"click button":"buttonClick","click a.prev":"previous","click a.next":"next"},initialize:function(){t.bindAll(this,"render","renderRows","previous","next","buttonClick","setShare","getShare","installShare","_normalizeTransform"),this.collection=i.getCollection("bip_shares"),this.collection.bind("reset",this.renderRows),this.podSetupView=new n,this.channelConfigView=new r,this.embedModal=$("#community-embed-modal")},setShare:function(t,e){this._activeShare=this.collection.get(t),this._activeShare=new o({id:t}),this._activeShare.fetch({success:function(t){this._activeShare=t,t.get("manifest")?e():i.growl("Share Could Not Be Found","warning")},error:function(){i.growl("Share Could Not Be Found","warning")}})},getShare:function(){return this._activeShare},render:function(){var t=this;this.$el.html(this.tplSharedContainer({smtp_enabled:i.getCollection("bip_descriptions").findWhere({id:"smtp"}),emitters:i.getCollection("channel").getEmitters()})),$("#shared-bip-search-form",t._container).on("keyup",function(){var e;return function(){var n=this.value;clearTimeout(e),e=setTimeout(function(){$(".list-bips",t.$el).append($(".roto",t.tplLoader())),i.getCollection("bip_share").search(n)},300)}}()),this.renderRows()},renderRows:function(){var t,e,n,r,s,o=i.getCollection("pod"),a=this,l="/static/img/channels/32/color/bip_",c=$(".list-bips",a.$el);c.empty();for(var u=0;u<a.collection.models.length;u++){switch(t=a.collection.models[u].toJSON(),t.type_description="",t.type_icon=t.icon?t.icon:l+t.type+".png",t.type){case"http":t.type_description="HTTPS Endpoint";break;case"smtp":t.type_description="Email Address";break;case"trigger":r=t.config.channel_id,e=t.config.channel_id.split("."),n=o.get(e[0]).get("actions")[e[1]],t.type_description="Event Source - "+n.description,t.type_icon=t.config&&t.config.config&&t.config.config.icon?t.config.config.icon:t.config&&t.config.icon?t.config.icon:a.collection.models[u].getIcon()}t.normedManifest=[];for(var h=0;h<t.manifest.length;h++)"source"!==t.manifest[h]&&r!==t.manifest[h]&&(e=t.manifest[h].split("."),n=o.get(e[0]).get("actions")[e[1]],t.normedManifest.push({pod:e[0],action:e[1],icon:o.get(e[0]).getIcon(e[1]),title:n.title,description:n.description||""}));t=i.distributeManifest(t,8),s=$(a.tplSharedEntity(t)),$(".bip-preview",s).html(a.tplBipPreview(t)),c.append(s)}$(".bip-select-info a").click(function(){var t=$(this).attr("data-share-id");return a.setShare(t,function(){a.installShare()}),!1}),listPaginate=$(".shared-list-pagination"),listPaginate.html(a.tplPaginate(a.collection.pageInfo())),$("a.prev",listPaginate).on("click",this.previous),$("a.next",listPaginate).on("click",this.next)},previous:function(t){return t.preventDefault(),$(t.currentTarget).hasClass("disabled")?void 0:(this.collection.prevPage(),!1)},next:function(t){return t.preventDefault(),$(t.currentTarget).hasClass("disabled")?void 0:(this.collection.nextPage(),!1)},_actionTranslate:function(t){return i.getCollection("channel").getChannelJSONAction(t.replace("-","."))},_normalizeTransform:function(t){return t},installShare:function(){var t=this;this.shareInstallModal=new s(this.getShare()),this.shareInstallModal.on("shared-install",function(e,i){t.shareInstallModal.close(),delete t.shareInstallModal,t.trigger("shared-install",e,i)}),this.shareInstallModal.render()},buttonClick:function(t){var e=$(t.currentTarget),n=e.attr("data-action"),r=this,s=e.closest(".bip-select").attr("data-model-id"),o=r.collection.get(s),a=o.get("name");if("install"===n)this.setShare(s,function(){r.installShare()});else if("uninstall"===n)i.unShare(s,function(t,e){t?i.growl(e||"Could Not Un-Share","error"):i.growl(a+" Is No Longer Shared"),r.collection.fetch({reset:!0})});else if("embed"===n){var l=this.tplEmbedCode({shareId:s}).replace(/embedscript/g,"script");$("#share-embed-code",this.embedModal).val(l),$("#share-embed-slug",this.embedModal).val(r.collection.slugURL(o.id)),this.embedModal.modal(),i.centerModal($(".modal",this.embedModal))}}}),BipSharedView}),define("apps/community/index",["underscore","backbone","bipclient","apps/community/views/v_bip_shared"],function(t,e,i,n){var r=e.View.extend({el:"#community-container",appID:"community",container:null,router:null,initialize:function(){t.bindAll(this,"render")},shutdown:function(){},render:function(e){var r=this,s=t.template($("#tpl-layouts-"+this.appID).html());this.container.html(s()),this._activeShareList=new n,this._activeShareList.render(),this._activeShareList.on("shared-install",function(t,e){t.exports&&!Object.keys(t.exports).length&&delete t.exports,i.activeShare=t,r.router.navigate("bipio/new/shared/"+e,{trigger:!0})}),this._activeShareList.on("shared-refresh",function(){i.getCollection("shared").fetch()}),e&&this._activeShareList.setShare(e,function(){r._activeShareList.installShare()})},appInfo:function(t,e){var i=this,n={name:this.appID,title:"Community",ready:function(e){t.route(i.appID,i.appID,function(){i.render.apply(i,arguments)}),t.route(i.appID+"/:id",i.appID,function(){i.render.apply(i,arguments)}),e()}};return this.container=e,this.router=t,n}});return r}),define("apps/pods/views/v_channel_list",["underscore","backbone","bipclient","c_pod"],function(t,e,i){var n=e.View.extend({el:"#channel-list-widget",tplWidget:t.template($("#tpl-resource-list-channel").html()),_enableWidgetWrapper:!0,tplListEntity:t.template($("#tpl-list-channel-entity").html()),tplPaginate:t.template($("#tpl-pagination").html()),_container:null,modalView:null,filter:null,clickHandler:null,_filterContext:null,initialize:function(e,n,r,s,o,a,l){var c=this;t.bindAll(this,"renderRows","next","previous","resetPage","sort","delay","search","updateFilter","setFilterContext"),this.collection=i.getCollection("channel"),"any"!==o&&this.collection.setSearchType(o),this.collection.setSearchExclusions(a),this.collection.searchBy=null,this.collection.bind("reset",function(){c.renderRows()}),this._container=e,r&&(this.el=r),void 0!==s&&(this._enableWidgetWrapper=s,this.collection.page_size=9),l&&(this.clickHandler=l)},render:function(){var t=$(this.el,this._container),e=this.tplWidget(),n=this;this._enableWidgetWrapper&&t.html(e),$("#channel-search-form",this._container).on("keyup",function(){n.search($(this).val())}),$(".dropdown-toggle").dropdown(),this.renderRows(),$("#channel-search-form").val(i.getCollection("channel").searchBy).attr("tabindex",0)},renderRows:function(t){var e,i,n,r=this,s=$(this.el,this._container);this._enableWidgetWrapper?(e=$("#list-channel-container",s),i=$("#channel-list",e)):i=s,i.empty();var o,a;a=this.collection.getFilteredModels();var l=(this.collection.page-1)*this.collection.page_size,c=l+this.collection.page_size;a.slice(l,c).forEach(function(e){o=e.toJSON(),actionTokens=o.action.split("."),o.pod=actionTokens[0],o.podContext=t?!0:!1,i.append(r.tplListEntity(o))}),this.clickHandler&&$(".channel-list-item a").click(this.clickHandler),$(".channel-list-item").removeClass("defocused"),t&&$(".channel-list-item a:not([data-channel-id="+t.get("id")+"])").addClass("defocused");var u=$(".channel-list h2");u.html(this._filterContext?'<img class="hub-icon hub-icon-32" src="'+this._filterContext.getIcon()+'"/> '+this._filterContext.get("title"):"All Saved Presets"),n=$(".channel-list-pagination",this._container),n.html(r.tplPaginate(r.collection.pageInfo())),$("a.prev",this._container).on("click",this.previous),$("a.next",this._container).on("click",this.next),this._setTabIndices(),this.trigger("view:rendered")},_setTabIndices:function(){var t=1;$(".channel-list-item a").each(function(){$(this).attr("tabindex",t),t++})},updateFilter:function(t,e){this.collection.updateFilter(t),this.renderRows(e)},setFilterContext:function(t){this._filterContext=t},resetPage:function(){this.collection.resetPage()},previous:function(t){return t.preventDefault(),$(t.currentTarget).hasClass("disabled")?void 0:(this.collection.prevPage(),this.renderRows(),!1)},next:function(t){return t.preventDefault(),$(t.currentTarget).hasClass("disabled")?void 0:(this.collection.nextPage(),this.renderRows(),!1)},sort:function(t){var e,i=t.currentTarget.getAttribute("data-sort");return $('[data-toggle="dropdown"]').parent().removeClass("open"),e=$("#channel-order").children("li"),e.each(function(){var e=$(this);e.removeClass("active"),e.attr("data-sort")==i&&e.addClass("active"),$("#channel-order-by-label",this.el).html($(t.currentTarget).children("a").html())}),this.collection.sort(i),!1},delay:function(){var t=0;return function(e,i){clearTimeout(t),t=setTimeout(e,i)}}(),search:function(t){this.collection.search(t),this.renderRows()}});return n}),define("apps/pods/index",["underscore","backbone","bipclient","apps/pods/views/v_channel_list","apps/pods/views/v_channel_pod_list"],function(t,e,i,n,r){var s=e.View.extend({el:"#pods-container",appID:"pods",container:null,router:null,modalView:null,initialize:function(e,i){t.bindAll(this,"render","shutdown"),this.container=e,this.router=i},render:function(){},shutdown:function(){},render:function(e,s,o){var a=t.template($("#tpl-layouts-"+this.appID).html());this.container.html(a()),$("#page-body .container").removeAttr("style");var l=new n(this.container,this.router),c=new r(this.container,this.router);l.updateFilter(),l.setFilterContext(),c.on("podSelected",function(t){var e,i;if(t){var n=t.pod,i=t.channel;n&&(e={attr:"action",match:new RegExp("^"+n.id)},l.resetPage(),l.setFilterContext(n))}l.updateFilter(e,i)}),l.render(),currentView=l,s?(c.render(),c.podSelect(i.getCollection("pod").get(s),"browse"===o)):c.render(e)},appInfo:function(t,e){var i=this,n={name:this.appID,title:"Pods",ready:function(e){t.route(i.appID,i.appID,function(){i.render.apply(i,arguments)}),t.route(i.appID+"/:id",i.appID,function(){i.render.apply(i,arguments)}),t.route(i.appID+"/:id/:podName",i.appID,function(){i.render.apply(i,arguments)}),t.route(i.appID+"/:id/:podName/:mode",i.appID,function(){i.render.apply(i,arguments)}),e()},shutdown:function(){i.shutdown.apply(i,arguments)}};return this.container=e,this.router=t,n}});return s}),define("wotadmin_hub",["jquery"],function(t){var e=function(i,n,r){var s=e;s.socket=null,s.children=[],s.modalHandler=i,s._wsHost=n?n:null,s._ifexe_v=r?r:null,s.register=function(t,e){s.children.indexOf(t)>=0||(s.children.push(t),"function"==typeof t.postMessage&&s.setupChild(t,e),s.isOpen()&&(console.log("Socket already Opened"),"function"==typeof t.postMessage&&t.postMessage(JSON.stringify(["socket_opened"]),"*")))},s.getChildURLParameter=function(t,e){for(var i=t.split("?")[1],n=i.split("&"),r=0;r<n.length;r++){var s=n[r].split("=");if(s[0]==e)return s[1]}return null},s.setupChild=function(t,e){var i=document.querySelectorAll("iframe[src='"+e[2]+"'")[0];i.setAttribute("scrolling","no"),i.style.overflow="hidden";var n=s.getChildURLParameter(e[2],"wotio-widget");i.setAttribute("wotio-widget",n),i.setAttribute("id",n);var r=s.getChildURLParameter(e[2],"height");r&&i.setAttribute("height",r);var o=s.getChildURLParameter(e[2],"maxHeight");o&&i.setAttribute("maxHeight",o);var a=s.getChildURLParameter(e[2],"minHeight");a&&i.setAttribute("minHeight",a);var l=s.getChildURLParameter(e[2],"width");l&&i.setAttribute("width",l)};var o=function(t){return function(e){if(e.data instanceof Blob){var i=new FileReader;i.readAsText(e.data),i.onload=function(){s.handleMessage(i.result,e,t)},i.onerror=function(t){console.log("Error",t)}}else s.handleMessage(e.data,e,t)}};return s.handleMessage=function(t,e,i){var n=i;e.source&&(n=e.source);try{if(json=JSON.parse(t),"bipio"!=json[0]&&console.log(t),"widget"==json[0]&&e.source&&s.register(e.source,json),"loggedin"==json[0]&&e.source)return void(s.isOpen()?(console.log("Socket already Opened"),window.postMessage(JSON.stringify(["socket_opened"]),"*")):s.openConnection(json));if("resize"==json[0]&&e.source)return document.querySelector("[wotio-widget='"+json[1]+"']").style.height=json[2],void document.querySelector("[wotio-widget='"+json[1]+"']").setAttribute("height",json[2]);if("load_info"==json[0]&&s.publishChildFrameInfo(e.source,document.querySelector("[wotio-widget='"+json[1]+"']")),"logout"==json[0]&&e.source)return void s.closeConnection();if("render_modal"==json[0])return void(null!=s.modalHandler?(e.source.postMessage(JSON.stringify({render_modal:!0}),"*"),s.modalHandler.renderModal(json[1])):e.source.postMessage(JSON.stringify({render_modal:!1,msgid:json[1].msgid}),"*"))}catch(r){}s.children.filter(function(t){return n!=t}).map(function(e){"function"==typeof e.postMessage&&e.postMessage(t,"*");try{"function"==typeof e.send&&(e.send(t),console.debug("Message sent to socket: ",t))}catch(i){}})
},s.publishChildFrameInfo=function(t,e){var i=e.getAttribute("maxHeight")?parseInt(e.getAttribute("maxHeight")):0/0,n=e.getAttribute("minHeight")?parseInt(e.getAttribute("minHeight")):0/0;isNaN(i)&&(i=0),isNaN(n)&&(n=0),t.postMessage(JSON.stringify({frame_info:[n,i]}),"*")},s.openConnection=function(t){null!=s.socket&&s.socket.close();var e=t[3]+"."+Date.now(),i=t[2],n=t[3],r="https:"==window.location.protocol?"wss:":"ws:";s.url="";var o="";if(s._wsHost)s._ifexe_v&&"1"==s._ifexe_v?s.url=s._wsHost+"/management/console/%23/"+e+"/wotio/"+i+"/"+n:(s.url=s._wsHost.split("//")[0]+"//"+n+"@"+s._wsHost.split("//")[1]+"/management/"+e+"/wotio/"+i+"?apikey="+n,o="wss:"==s._wsHost.split("//")[0]?"https:":"http://"+s._wsHost.split("//")[1]+"/management/console/"+e+"/%23");else if("undefined"!=typeof config&&null!==config){if(config.socket_url&&""!=config.socket_url&&("1"==config.ifexe_version?s.url=r+"//"+config.socket_url+"/management/console/%23/"+e+"/wotio/"+i+"/"+n:(s.url=r+"//"+config.socket_url+"/management/"+e+"/wotio/"+i+"?apikey="+n,o=("wss:"==r?"https:":"http:")+"//"+config.socket_url+"/management/console/"+e+"/%23")),config.isTestMode&&1==config.isTestMode)if(config.socket_url&&""!=config.socket_url)s.url=config.socket_url;else{var a=document.location.hostname.split(".")[1];config.account&&""!=config.account&&(a=config.account),s.url="ws://localhost."+a+".wot.io:3000"}}else"1"==config.ifexe_version?s.url=r+"//"+document.location.host+":8080/management/console/%23/"+e+"/wotio/"+i+"/"+n:(s.url=r+"//"+n+"@"+document.location.host+":8080/management/"+e+"/wotio/"+i+"?apikey="+n,o=("wss:"==r?"https:":"http:")+"//"+n+"@"+document.location.host+":8080/management/console/"+e+"/%23");console.log("POST URL TO BIND: "+o),o&&""!=o?s.processRequest("POST",o,n,function(t){t.socket_setup()}):s.socket_setup()},s.socket_setup=function(){console.log("Socket Url:",s.url),s.socket=new WebSocket(s.url),s.socket.addEventListener("message",o(s.socket),!1),s.socket.addEventListener("open",function(){s.register(s.socket),window.postMessage(JSON.stringify(["socket_opened"]),"*")}),s.socket.addEventListener("close",function(){console.log("socket closed"),s.children.splice(s.children.indexOf(s.socket),1),window.postMessage(JSON.stringify(["socket_closed"]),"*")}),s.socket.addEventListener("error",function(t){console.debug("socket error",t)})},s.processRequest=function(e,i,n,r){var o=this.createCORSRequest(e,i);return o?(o.setRequestHeader("Authorization","Bearer "+n),o.onload=function(){var t=o.responseText;try{var e=JSON.parse(t);console.log(e),r(s,e,n)}catch(i){console.log(i)}},o.onerror=function(){t("#messages").text("An XHR occured!"),window.parent.postMessage('[{"code":"error", "message": "XHR error"}]',"*")},void o.send()):void alert("CORS not supported")},s.createCORSRequest=function(t,e){var i=new XMLHttpRequest;return"withCredentials"in i?i.open(t,e,!0):"undefined"!=typeof XDomainRequest?(i=new XDomainRequest,i.open(t,e)):i=null,i},s.closeConnection=function(){null!=s.socket&&s.socket.close()},s.isOpen=function(){return s.socket&&1===s.socket.readyState},window.addEventListener("message",o(),!1),s};return e}),define("apps/wotadmin/views/v_wotadmin_modal",["jquery","backbone"],function(t,e){var i=e.View.extend({template:_.template(t("#tpl-wotadmin-modal").html()),el:"#wotadmin-modal-container",callBackEvent:_.extend({},e.Events),model:{},initialize:function(){_.bindAll(this,"render","callback")},events:{},render:function(){var e,i,n=this;return e=this.template(this.model),this.$el.html(e),i=t("#wotadmin-modal",this.$el),t("button.callback",i).click(function(t){n.callback(t,i)}),this.model&&this.model.onclose&&t("button[trigger='"+this.model.onclose+"']").click(function(){i.modal("hide")}),t("button.close",i).click(function(){i.modal("hide")}),i.modal("show").on("hidden",function(){n.unbindModal(i),n.model={},i.remove()}),this},unbindModal:function(e){t("button.close",e).unbind("click"),t("button[trigger='"+this.model.onclose+"']").unbind("click"),t("button.callback",e).unbind("click")},renderModal:function(t){this.model=t,this.render()},callback:function(t,e){if(this.model&&this.model.msgid){var i='{"'+this.model.msgid+'" :["'+t.currentTarget.attributes.trigger.value+'"]}';window.postMessage(i,"*"),e.modal("hide")}}});return i}),define("apps/wotadmin/index",["underscore","backbone","bipclient","wotadmin_hub","apps/wotadmin/views/v_wotadmin_modal"],function(t,e,i,n,r){var s={},o=0;socketOpenedTime=null,socketClosedTime=null;var a,l,c=function(){if(i._auth.ws_host&&!s.isOpen()){var t=["loggedin",i._auth.ws_host.split(".")[1],i._auth.token_username,i._auth.auth_token];window.addEventListener("message",u,!1),window.postMessage(JSON.stringify(t),"*")}},u=function(t){if(t.origin==window.location.origin){var e=null;try{e=JSON.parse(t.data)}catch(o){e=t.data}if(e instanceof Array){if("client_loaded"==e[0]){var a=new r({});s=new n(a,("https"==i._params.proto?"wss://":"ws://")+i._auth.ws_host,i._params.ifexe_version),c()}"socket_opened"==e[0]&&(socketOpenedTime=Date.now(),s.socket.addEventListener("close",h,!1),p()),"socket_closed"==e[0]&&s.socket.addEventListener("close",h,!1)}}},h=function(){socketClosedTime=Date.now();var t=socketClosedTime-socketOpenedTime;1e4>t?(l&&clearTimeout(l),l=setTimeout(function(){a&&a()},1e3)):6e4>t||(console.log("Tryin to reopen socket immediately: "+Date.now()),c(),o=0)},d=function(){window.addEventListener("message",u,!1)},p=function(){window.removeEventListener("message",u,!1)};d();var f=e.View.extend({el:"#wotadmin-container",appID:"wotadmin",container:null,router:null,obView:null,initialize:function(){t.bindAll(this,"render"),console.log("in initialize: ",i)},shutdown:function(){},render:function(){var e={users:{title:"Users",frames:[{src:"users/user_list",minHeight:400,maxHeight:800},{src:"users/user_details",minHeight:400,maxHeight:800},{src:"users/user_group_list",minHeight:400,maxHeight:800}]},"reset-password":{title:"Reset Password",frames:[{src:"resetPassword/reset_password_widget",minHeight:500,height:500}]},groups:{title:"Groups",frames:[{src:"groups/group_list",minHeight:400,height:400},{src:"groups/member_list",minHeight:400,height:400},{src:"groups/token_list",minHeight:500,height:500}]},permissions:{title:"Permissions",frames:[{src:"permissions/permission_list",minHeight:400,height:400}]},mounts:{title:"Mounts",frames:[{src:"mounts/mount_list",minHeight:800,height:800},{src:"mounts/mount_details",minHeight:800,height:800}]},notifications:{title:"Notifications",frames:[{src:"notifications/notification_form",minHeight:560,height:560},{src:"notifications/notifications_list",minHeight:400,height:400}]},servers:{title:"Servers",frames:[{src:"servers/server_list",minHeight:400,height:400},{src:"servers/server_details",minHeight:400,height:400},{src:"servers/server_configuration",minHeight:400,height:400}]},services:{title:"Services",frames:[{src:"services/services_list",minHeight:400,height:400},{src:"services/services_details",minHeight:400,height:400},{src:"services/services_servers",minHeight:400,height:400},{src:"services/service_update",minHeight:400,height:400}]},dataUsage:{title:"Monitoring",frames:[{src:"dataUsage/dataUsageForm",minHeight:650,height:650},{src:"dataUsage/chart.html?render=connections",minHeight:500,height:500},{src:"dataUsage/chart.html?render=bytes_read",minHeight:500,height:500},{src:"dataUsage/chart.html?render=bytes_written",minHeight:500,height:500}]},messages:{title:"Publish/Consume",frames:[{src:"messages/publish_message",span:5,minHeight:600,height:600,maxHeight:600},{src:"messages/consume_message",span:7,minHeight:600,height:600,maxHeight:600}]},regex:{title:"Regex Validate",frames:[{src:"regex/regex_bus",minHeight:400,height:400},{src:"regex/regex_write",minHeight:400,height:400}]}},n=t.template($("#tpl-layouts-"+this.appID).html());base=i._params.proto+"://"+i._auth.ws_host.split(":")[0]+"/"+i._auth.ws_host.split(".")[1]+"/",t.each(e,function(e){t.each(e.frames,function(t){t.id=t.src.replace(/\.*$/,""),-1===t.src.indexOf(".html")&&(t.src+=".html"),t.src=base+t.src+(-1===t.src.indexOf("?")?"?":"&")+"wotio-widget="+t.id})}),this.container.html(n({adminFrames:e})),$("#wotadmin-tabs a").click(function(t){t.preventDefault(),$(this).tab("show")}).tab().on("shown",function(){var e=$($(this).attr("href")+" iframe");t.each(e,function(t){var e=$(t);e.attr("src")||e.attr("src",e.attr("data-src"))})})},appInfo:function(t,e){var n=this,r={name:this.appID,title:"Admin",ready:function(e){i._auth.ws_host?(t.route(n.appID,n.appID,function(){n.render.apply(n,arguments)}),t.route(n.appID+"/:frame",n.appID,function(t){n.render(t)}),e()):a&&a()},close:function(t){a=t}};return this.container=e,this.router=t,r}});return f}),String.prototype.repeat=function(t){return new Array(t+1).join(this)},define("apps/ui/index",["underscore","backbone","bipclient"],function(t,e,i){var n=e.View.extend({el:"#ui-container",appID:"ui",container:null,router:null,obView:null,initialize:function(){t.bindAll(this,"render")},shutdown:function(){},render:function(){var e=t.template($("#tpl-layouts-"+this.appID).html());this.container.html(e()),this.test()},test:function(){var t="",e=this,i={bips:{name:"Schema 1",properties:{subject:{type:"string",description:"Subject"},arr:{type:"array",description:"List",items:{description:"list object",properties:{label:{name:"label",type:"string",description:"Arr Object Label"}}}},body:{type:"object",description:"Body Object",properties:{label:{type:"string",description:"Obj Label"}}}},definitions:{}},things:{name:"Thing",properties:{name:{type:"string",description:"Name"}},definitions:{}}},n=$("#template-preview");t="[%bips.arr[3].label%]",$("#templar-test").templar2({delimiter:"#",template:"[%value%]",schema:i,data:"&nbsp;"+t+"&nbsp;",select2:e._select2Templar(),pasteMode:"text"}).on("select2-loaded",function(){var t=$(this);$(".tooltip").remove(),$(".select2-result-label .tooltippable").on("click",function(){t.templar2("jsonMode",{source:$(this).attr("data-cid")})}).tooltip()}).on("templar-template",function(t,e){n.html(e)})},_getImageFromSource:function(t){var e;if("source"===t)e=this.model.getIcon();else{if("_client"===t)return'<i class="icon-user"></i> ';"_bip"===t?e="/static/img/channels/32/color/bipio.png":(channel=i.getCollection("channel").get(t),channel&&(e=channel.getPod().getIcon()))}return e},_select2Templar:function(){var e=this;return{formatResult:function(t){var i=t.text.length>32?t.text.substr(0,32)+"..":t.text;if(t.children&&t.children.length){var n,r=$(t.element).attr("value"),n=e._getImageFromSource(r)||"";return n&&-1===n.indexOf("<")&&(n='<img class="hub-icon hub-icon-16" src="'+n+'"> '),n+i}var s=0,o="";try{var s=parseInt(t.css.match(/opt-level-\d/).pop().split("-").pop());o="&nbsp;&nbsp;".repeat(s+1)}catch(a){}return o+i+'<label class="label pull-right">'+$(t.element).attr("data-type")+"</label>"},formatSelection:function(i){var n,r,s=i.id.split("#").shift(),o=$(i.element).parents("select:first").data("templar-tags"),a=i.id.split("."),l=a.shift(),c=t.findWhere(o,{id:l}),u=c.text;"array"===c.type&&a.length>1&&(u+=' [<input data-path="'+i.id+'" class="select2-subscript input input-mini" type="text" value=""/>]'),c=c.children[0];for(var h=l;a.length;)r=a.shift(),h+="."+r,c.children&&(c=t.findWhere(c.children,{id:r}),u+=' <i class="icon-chevron-right"></i> '+c.text,"array"===c.type&&a.length&&(u+=' [<input data-path="'+h+'" class="select2-subscript input input-mini" type="text" value=""/>]'));return s=s.split(".").shift(),n=e._getImageFromSource(s)||"",n&&-1===n.indexOf("<")&&(n='<img class="hub-icon hub-icon-16" src="'+n+'"> '),n+u},escapeMarkup:function(t){return t},dropdownAutoWidth:!0,placeholder:"Select an Attribute"}},appInfo:function(t,e){var i=this,n={name:this.appID,title:"UI",ready:function(e){t.route(i.appID,i.appID,function(){i.render.apply(i,arguments)}),e()}};return this.container=e,this.router=t,n}});return n}),define("apps/stats/index",["underscore","backbone","bipclient"],function(t,e,i){var n=e.View.extend({el:"#stats-container",appID:"stats",container:null,router:null,initialize:function(){t.bindAll(this,"render")},shutdown:function(){},getPreviousMonthParams:function(){var t="",e=moment().subtract(1,"months");return t+="fromUnix="+e.startOf("month").unix(),t+="&toUnix="+e.endOf("month").unix()},_renderTwitter:function(){$twitter=$("#metric-twitter",this.$el);var t=i.getEndpoint()+"/rpc/channel/twitter.users_show/invoke?screen_name=bipioapp";i.callRPCAccount(t,function(t){$(".metric-value",$twitter).html(t.followers_count)})},_renderGithub:function(){$github=$("#metric-github",this.$el);var t=i.getEndpoint()+"/rpc/channel/github.get_repository/invoke?owner=bipio-server&repo=bipio";i.callRPCAccount(t,function(t){var e=t.watchers_count+" Watchers,<br/>"+t.forks+" Forks";$(".metric-value",$github).html(e)})},_renderMailChimp:function(){$mc=$("#metric-mailchimp",this.$el);var t=i.getEndpoint()+"/rpc/channel/mailchimp.get_growth_history/invoke?list_id=b56498e932";i.callRPCAccount(t,function(t){for(var e,i="",n=2,r=0;n>r;r++)e=t.pop(),i+=e.month+" - "+e.existing+"<br/>";$(".metric-value",$mc).html(i)})},_users:null,_tableToCSV:function(e){var i="data:text/csv;charset=utf-8,",n=$("#"+e+" tbody tr"),r=$("#"+e+"  thead th"),s="";t.each(r,function(t){s&&(s+=","),s+=$(t).text()}),i+=s+"\n",t.each(n,function(e){var n=$("td",e),r="";t.each(n,function(t){r&&(r+=","),r+=$(t).text()}),i+=r+"\n"});var o=encodeURI(i);window.open(o,e+".csv")},_renderUserRows:function(){var e,i,n,r,s,o=this._users,a=0,l=!1,c={},u={},h=!1,d=!1,p={},f=$("#stat_filters input[type=checkbox]:checked");t.each(f,function(t){"filter_month"==t.id?l=!0:0==t.id.indexOf("filter_level")?c[t.id.split("_").pop()]=!0:0==t.id.indexOf("filter_activity")&&(u[t.id.split("_").pop()]=!0)}),h=Object.keys(c).length,d=Object.keys(u).length,o.stat=t.sortBy(o.stat,function(t){return Number(t.created_day)}).reverse(),$users.empty();for(var g=0;g<o.stat.length;g++)e="",n="",i=o.stat[g],r=!0,l&&parseInt(i.created_day)<parseInt(moment().subtract(1,"month").format("YYYYMMDD"))&&(r=!1),h&&(r=r&&c[i.account.account_level]),i.total&&i.account.last_session&&(e="success",n="Active"),i.total||i.ttfb||(e="warning",n="Aborted"),(i.total||i.ttfb||i.account.last_session)&&e||(e="error",n="Zombie"),r&&d&&(r=r&&u[n.toLowerCase()]),r&&($users.append('<tr class="'+e+'"><td>'+i.account.username+"</td><td>"+i.account.email_account+"</td><td>"+i.account.account_level+"</td><td>"+i.total+"</td><td>"+i.ttfb+"</td><td>"+moment(i.created_day,"YYYYMMDD").format("Do MMM YYYY")+"</td><td>"+i.account.last_session_pretty+"</td><td>"+n+"</td><td>"+i.plan_params.reason.join("<br/>")+"</td></tr>"),a++),s=moment(i.created_day,"YYYYMMDD").format("MMM YYYY"),p[s]||(p[s]={signups:0,active:0,bips:0}),p[s].signups++,p[s].active+="Active"===n?1:0,p[s].bips+=i.total;var m=$("#metric-users-summary tbody",this.$el),v=o.stat.length;m.empty(),t.each(p,function(t,e){m.append("<tr><td>"+e+"</td><td>"+v+"</td><td>"+t.signups+"</td><td>"+t.active+"</td><td>"+((t.active/t.signups*100).toFixed(0)+"%")+"</td><td>"+t.bips+"</td></tr>"),v-=t.signups}),$("#num_results").html(a+" results, "+(a/o.stat.length*100).toFixed(0)+"%")},_renderUsersRecent:function(){var t=this;$users=$("#metric-users-recent tbody",this.$el),$("#filter_month").attr("checked",!0),$("#csv").on("click",function(){t._tableToCSV("metric-users-recent")}),$("#csv_summary").on("click",function(){t._tableToCSV("metric-users-summary")}),$("#csv_pods").on("click",function(){t._tableToCSV("metric-pods")}),$("#csv_shares").on("click",function(){t._tableToCSV("metric-shares")});var e=i.getEndpoint()+"/rpc/stats/users/recent?planparams=1";i.callRPCAccount(e,function(e){t._users=e.users,t._renderUserRows(),$("#metric-users .metric-value").html(t._users.stat.length)}),$("#stat_filters input[type=checkbox]").on("click",function(){t._renderUserRows()})},_renderBips:function(){$bips=$("#metric-bips",this.$el);var t=i.getEndpoint()+"/rpc/stats/bips";i.callRPCAccount(t,function(t){var e=t.bips;$(".metric-value",$bips).html(e)})},_renderDistinctPrevious:function(){$distinct=$("#metric-distinct-bips",this.$el);var t=i.getEndpoint()+"/rpc/stats/bips/distinct_running?"+this.getPreviousMonthParams();i.callRPCAccount(t,function(t){var e=t.bips.distinct.length;$(".metric-value",$distinct).html(e)})},_renderPods:function(){$pods=$("#metric-pods tbody",this.$el);var e=i.getEndpoint()+"/rpc/stats/pods/users";i.callRPCAccount(e,function(e){var n,r=e.pods,s=[];i.getCollection("pod").each(function(t){var e=r[t.get("name")];s.push({icon:t.getIcon(),name:t.get("name"),title:t.get("title"),count:e&&e.count?e.count:0,users:e&&e.users?e.users:[]}),n="<tr><td>"+t.getIcon()+"</td><td>"+t.get("title")+"</td><td></td></tr>"}),s=t.sortBy(s,function(t){return t.count}).reverse(),t.each(s,function(t){$pods.append('<tr class="'+(t.count?"":"error")+'""><td><img src="'+t.icon+'" class="hub-icon hub-icon-32"> '+t.title+"</td><td>"+t.count+"</td><td>"+t.users.join("<br/>")+"</td><td>"+(-1!==i._plans.user.pod_exclusions.indexOf(t.name)?"Premium":"Community")+"</td></tr>")})})},_renderShares:function(){var e,n=$("#metric-shares tbody",this.$el),r=i.getCollection("bip"),s=i.getResourceName("bip/share/list",1,0,"installs",void 0,"rpc");i.callRPCAccount(s,function(i){n.empty(),i.data=t.sortBy(i.data,function(t){return t.installs||(t.installs=0),t.installs}).reverse(),t.each(i.data,function(t){e=r.factory(t).getIcon(),n.append('<tr><td><img class="hub-icon hub-icon-32" src="'+e+'"> '+t.name+"</td><td>"+t.installs+'</td><td><a target="_blank" href="/user/'+t.user_name+'">'+t.owner_name+"</a></td></tr>")})})},render:function(){var e=t.template($("#tpl-layouts-"+this.appID).html());this.container.html(e()),this._renderUsersRecent(),this._renderBips(),this._renderPods(),this._renderTwitter(),this._renderGithub(),this._renderMailChimp(),this._renderShares()},appInfo:function(t,e){var i=this,n={name:this.appID,title:"Stats",ready:function(e){t.route(i.appID,i.appID,function(){i.render.apply(i,arguments)}),e()}};return this.container=e,this.router=t,n}});return n}),define("apps/logs/index",["underscore","backbone","bipclient"],function(t,e,i){var n=e.View.extend({el:"#logs-container",appID:"logs",container:null,router:null,_limit:1e3,initialize:function(){t.bindAll(this,"render")},shutdown:function(){},render:function(){var e=this,i=t.template($("#tpl-layouts-"+this.appID).html());this.container.html(i()),$(".btn-group button",this.el).on("click",function(){e._renderLogs($(this).attr("data-mode"))}),this._fetchLogs(function(){e._renderLogs()})},_logs:null,_fetchLogs:function(t){var e=i.getEndpoint()+"/rpc/logs/server",n=moment().format("YYYYMMDD"),r=this;e+="/"+n+"/"+r._limit,i.callRPCAccount(e,function(e){r._logs=e,t&&t()})},_renderLogs:function(e){var n=this,r=e||$(".btn-group .active",n.el).attr("data-mode"),s=$("#result-table"),o="errors"===r,a="usage"===r,l="uncaught"===r,c=$("tbody",s),u=$("thead",s),h=$("#limit-note"),d=0;if(c.empty(),u.empty(),"raw"==r)c.append("<pre>"+JSON.stringify(n._logs,!0,4)+"</pre>"),h.html("Last "+this._limit);else if(o||a||l){var p={};u.append("<tr><td></td><td>Timestamp</td><td>Message</td><td>Stack</td></tr>"),n._logs&&t.each(n._logs.server_error,function(t){t.stack&&(o||a&&t.message.split(":").length>2||l&&-1!==t.message.indexOf("uncaughtException"))&&(p[t.stack]||(p[t.stack]={log:t,count:0}),p[t.stack].count++)});var f=t.sortBy(t.map(p,function(t,e){return{stack:e,log:t}}),function(t){return t.log.count}).reverse();f.length&&(criticality=Math.round(f[0].log.count/3)),t.each(f,function(e){var n="",r="minus-sign";e.log.count>2*criticality?(n="error",r="exclamation-sign"):e.log.count>criticality&&(n="warning",r="warning-sign");var s=e.log.log.stack.join?e.log.log.stack.join("</br>"):e.log.log.stack.replace(/(?:\r\n|\r|\n)/g,"<br />"),o=e.log.log.message.split(":"),a=o[0].split(".").shift(),l="",u="",h=50;t.each(o,function(t){l+=(t.length>h?t.substr(0,h)+"..":t)+"</br>"}),a&&i.find.pod(a)&&(u='<img src="'+i.find.pod(a).getIcon()+'">');var p='<em style="font-size:0.4em;position:absolute;margin-top: -10px;margin-left: 0px;">'+e.log.count+"</em>";c.append('<tr class="'+n+'"><td><h1><i class="icon-'+r+'"></i>'+p+u+"</h1></td><td>"+e.log.log.timestamp+"</td><td>"+l+"</td><td>"+s+"</td></tr>"),d+=e.log.count}),h.html(d+" results, "+(d/n._logs.server_error.length*100).toFixed(0)+"% ("+f.length+" distinct)")}},appInfo:function(t,e){var i=this,n={name:this.appID,title:"Logs",ready:function(e){t.route(i.appID,i.appID,function(){i.render.apply(i,arguments)}),e()}};return this.container=e,this.router=t,n}});return n}),define("dash-router",["underscore","backbone","bipclient","apps/outbox/index","apps/bipio/index","apps/community/index","apps/pods/index","apps/wotadmin/index","apps/ui/index","apps/stats/index","apps/logs/index"],function(t,e,i){function n(t){var e=t.name;$("#app-links ul").append('<li id="init-'+e+'"><a href="#'+e+'">'+t.title+"</a></li>")}function r(t){var e=t.name;$("#init-"+e).remove()}var s=["OutboxModule","BipModule","BipCommunityView","PodsModuleView","WotAdminView","UIModuleView","StatsModuleView","LogsModuleView"],o=3,a=arguments,l={"*actions":"defaultRoute"},c=[],u=i.getParamNames(a.callee);t.each(UIModules.split(","),function(t){var e=u.indexOf(t);-1!==e?c.push(a[e]):-1!==s.indexOf(t)&&c.push(a[o+s.indexOf(t)])});var h,d=!1,p=e.Router.extend({routes:l,before:function(){},after:function(){},hashChange:function(t){var e=/bipio\/(new|[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})/.test(t.originalEvent.oldURL),n=-1!==t.originalEvent.newURL.indexOf("bipio"),r=-1!==t.originalEvent.oldURL.indexOf("shared");if(!e||n||r||0!=d)d=!1;else{var s=this;t.stopImmediatePropagation(),s.cancelNavigate=!0;var o=t.originalEvent.newURL;window.history.pushState("","",t.originalEvent.oldURL),i.confirmNavModal({cb:function(t){t.preventDefault(),d=!0,this.close(),h.navigate(o.substring(o.indexOf("#")),{trigger:!0})}})}},beforeUnload:function(){},allowNavigationFlag:function(){d=!0}}),f=($("#page-body .container").width(),$("#app-content"),function(t){$("[id^=init-]").removeClass("active"),$("#init-"+t).addClass("active")}),g=($("#page-body .container").width(),$("#app-content"),function(){$("#loader-wrapper").fadeOut(function(){$(this).remove()}),h=new p,$(window).on("hashchange",h.hashChange),$(window).on("beforeunload",h.beforeUnload),h.on("route",function(t){"defaultRoute"!==t&&f(t)}),t.each(c,function(t){var e;if(t.prototype.appInfo&&(e=t.prototype.appInfo(h,$("#app-content")),e.ready(function(t){return function(){n(t)}}(e)),e.close&&e.close(function(t){return function(){r(t)}}(e)),e.shutdown)){var i=function(t){t!==e.name&&e.shutdown()};h.on("route",i)}}),c.length&&$("#app-links").fadeIn();i.getCollection("channel").where({action:"email.smtp_forward"});h.on("route:defaultRoute",function(){h.navigate("#bipio",{trigger:!0})}),h.route("upgrade",function(){i.growl('<span style="text-transform:capitalize"><i class="icon-ok-sign"></i> Upgraded to '+userSettings.account_level.replace(/[-_]/g," ")+" Plan"),h.navigate("#bipio",{trigger:!0})}),e.history.start(),$(".greyified").removeClass("greyified")});return{initialize:g}}),define("dash",["dash-router"],function(t){var e=function(){t.initialize()};return{initialize:e}}),define("models/m_domain",["underscore","backbone","bipclient"],function(t,e,i){return MDomain=e.Model.extend({defaults:{id:null,name:"",_available:!1},validate:function(){},initialize:function(){t.bindAll(this,"rpcVerify")},url:function(){var t=this;return i.getResourceURL("domain",t)},rpcVerify:function(t){var e=this;i.domainVerify(this.id,function(i,n){i||e.set("_available",n._available),t(i,e)})}}),MDomain}),define("c_domain",["underscore","backbone","models/m_domain","bipclient"],function(t,e,i,n){return DomainCollection=e.Collection.extend({model:i,url:function(){return n.getResourceName("domain")},initialize:function(){n.setCollection("domain",this),t.bindAll(this,"newModel")},parse:function(t){return this.page=t.page,this.page_size=t.page_size,this.total=t.total,this.num_pages=t.num_pages,t.data},newModel:function(){return new i}}),DomainCollection}),define("c_channel",["underscore","backbone","models/m_channel","bipclient"],function(t,e,i,n){return ChannelCollection=e.Collection.extend({model:i,page:1,page_size:10,total:0,num_pages:1,sortBy:"recent",searchBy:"",_filter:null,_actionManifest:{},_searchType:"any",_exclusions:null,url:function(){return n.getResourceName("channel",1,0,this.sortBy)},initialize:function(){t.bindAll(this,"nextPage","prevPage","pageInfo","sort","search","newModel","getEmitters","getActions","setSearchExclusions")},getEmitters:function(){return this.where({_emitter:!0})},getActions:function(){return this.where({_emitter:!1})},getRenderable:function(e){var i,n,r=[];return i=t.filter(this.models,function(t){return Object.keys(t.get("_links")).length>0}),e?(t.each(i,function(t){n=t.toJSON(),n.pod=t.getPod().toJSON(),r.push(n)}),r):i},getChannelJSONAction:function(t){return this._actionManifest[t]},getPods:function(){return t.uniq(t.map(this.pluck("action"),function(t){var e=t.split(".");return e[0]}))},newModel:function(e,i){if(i&&e.name){var n=0,r=0,s=new RegExp(/\d*$/);if(this.findWhere({name:e.name})){t.each(this.models,function(t){-1!==t.get("name").indexOf(e.name.trim())&&(result=t.get("name").match(s).pop(),result&&(n=parseInt(result),!isNaN(n)&&n>r&&(r=n)))})}}return r&&(e.name+=" - "+(r+1)),new this.model(e)},parse:function(t){this.page=t.page,this.page_size=this.page_size,this.total=t.total,this.num_pages=Math.ceil(t.total/this.page_size);for(var e=0;e<t.data.length;e++)this._actionManifest[t.data[e].action]=t.data[e].id;return t.data},setSearchType:function(t){this._searchType=t||"any"},setSearchExclusions:function(t){this._exclusions=t},getFilteredModels:function(e){var i,n=this,r=this.searchBy;return e?(tmpSearch=!0,this.searchBy=e):e=this.searchBy,i=this._filter||""!==this.searchBy?this.models.filter(function(t){var i,r=!1,s=t.get("_emitter"),o=n.normSearchRegexp(e);return"actions"===n._searchType&&s||"emitters"===n._searchType&&!s?!1:n._filter&&(r=n._filter.match.test(t.get(n._filter.attr)),!r)?!1:(""!==e&&(i=t.get("_repr")+t.get("action")+t.get("name")+JSON.stringify(t.get("config")).replace(/\W/g,""),r=o.test(i)),r)}):"actions"===this._searchType?this.where({_emitter:!1}):"emitters"===this._searchType?this.where({_emitter:!0}):this.models,this._exclusions&&(i=t.filter(i,function(e){return-1===t.indexOf(n._exclusions,e.id)})),this.total=i.length,this.num_pages=Math.ceil(this.total/this.page_size),this.searchBy=r,i},updateFilter:function(t){return this.page=1,this._filter=t,this},resetSearch:function(){return this.searchBy="",this},resetPage:function(){this.page=1},nextPage:function(){var t=this.page+1;this.page=t>this.num_pages?this.page:t},prevPage:function(){var t=this.page-1;this.page=1>=t?1:t},pageInfo:function(){return{page_current:this.page,page_total:this.num_pages,page_size:this.page_size,page_displayed_total:this.page*this.page_size-this.total,result_total:this.total}},sort:function(t){return this.sortBy=t,this.fetch()},search:function(t){(!this.searchBy||""===this.searchBy&&t&&1!=this.page)&&(this.page=1),this.searchBy=t},normSearchRegexp:function(t){var e=t?t.trim().replace(/\s*/i," ").replace(/\s/i,".*").replace(/,/g,"|").replace(/,\s*/g,",").replace(/^\||\|$/,""):"";return new RegExp(e,"i")},get:function(t){if(t){if(n.isUUID(t))return e.Collection.prototype.get.call(this,arguments[0]);if(t.id)return t;var r=t.split("."),s=n.find.pod(r[0]),o=s?s.getAction(r[1]):void 0;return s&&o?new i({id:t,action:r[0]+"."+r[1],name:o.title,description:o.description,_links:[]}):void 0}}}),ChannelCollection}),define("models/m_bip_description",["underscore","backbone","bipclient"],function(t,e){return e.Model.extend({defaults:function(){return{exports:null}},validate:function(){},initialize:function(){},getExports:function(t){return this.exports[t].exports.properties},getExportTemplate:function(){}})}),define("c_bip_desc",["underscore","backbone","models/m_bip_description","bipclient"],function(t,e,i,n){var r=e.Collection.extend({model:i,url:function(){return n.getBipDescriptions()},initialize:function(){t.bindAll(this,"getExports"),n.setCollection("bip_descriptions",this)},parse:function(t){var e,i,n=[],r=t["*"];for(e in t)if("*"!=e){i={};for(var s in t[e])i[[s]]=t[e][s];for(var o in r)for(var s in r[o])i[o][s]=r[o][s];n.push({id:e,exports:i})}return n},getExports:function(){return this.get("exports")}});return r}),define("c_bip_share",["underscore","backbone","models/m_bip","bipclient"],function(t,e,i,n){var r=e.Collection.extend({model:i,page:1,page_size:10,total:0,num_pages:1,sortBy:"recent",searchBy:"",initialize:function(){t.bindAll(this,"parse","nextPage","prevPage","pageInfo","sort","search"),n.setCollection("bip_share",this)},url:function(){return n.getResourceName("bip/share/list",this.page,this.page_size,this.sortBy,""==this.searchBy?void 0:{search:this.searchBy},"rpc")},parse:function(t){return this.page=t.page,this.page_size=t.page_size,this.total=t.total,this.num_pages=t.num_pages,t.data},nextPage:function(){var t=this.page+1;return this.page=t>this.num_pages?this.page:t,this.fetch({reset:!0})},prevPage:function(){var t=this.page-1;return this.page=1>=t?1:t,this.fetch({reset:!0})},pageInfo:function(){return{page_current:this.page,page_total:this.num_pages,page_size:this.page_size,result_total:this.total}},sort:function(t){return this.sortBy=t,this.fetch()},search:function(t){return this.searchBy=t,this.fetch({reset:!0})},slugURL:function(t){var e=this.get(t);return e?BIPClientParams.proto+"://"+BIPClientParams.hostname+"/share/"+e.get("user_name")+"/"+e.get("slug"):""}});return r}),function(t){"object"==typeof exports?module.exports=t(require("backbone"),require("underscore")):"function"==typeof define&&define.amd&&define("backbone.validator",["backbone","underscore"],t)}(function(t,e){return t.Validation=function(e){var i={forceUpdate:!1,selector:"name",labelFormatter:"sentenceCase",valid:Function.prototype,invalid:Function.prototype},n={formatLabel:function(t,e){return c[i.labelFormatter](t,e)},format:function(){var t=Array.prototype.slice.call(arguments),e=t.shift();return e.replace(/\{(\d+)\}/g,function(e,i){return"undefined"!=typeof t[i]?t[i]:e})}},r=function(i,n,s){return n=n||{},s=s||"",e.each(i,function(e,o){i.hasOwnProperty(o)&&(e&&"object"==typeof e&&!(e instanceof Array||e instanceof Date||e instanceof RegExp||e instanceof t.Model||e instanceof t.Collection)?r(e,n,s+o+"."):n[s+o]=e)}),n},s=function(){var t=function(t){return e.reduce(e.keys(e.result(t,"validation")||{}),function(t,e){return t[e]=void 0,t},{})},s=function(t,i){var n=t.validation?e.result(t,"validation")[i]||{}:{};return(e.isFunction(n)||e.isString(n))&&(n={fn:n}),e.isArray(n)||(n=[n]),e.reduce(n,function(t,i){return e.each(e.without(e.keys(i),"msg"),function(e){t.push({fn:u[e],val:i[e],msg:i.msg})}),t},[])},a=function(t,i,r,o){return e.reduce(s(t,i),function(s,a){var l=e.extend({},n,u),c=a.fn.call(l,r,i,a.val,t,o);return c===!1||s===!1?!1:c&&!s?e.result(a,"msg")||c:s},"")},l=function(t,i){var n,s={},o=!0,l=e.clone(i),c=r(i);return e.each(c,function(e,i){n=a(t,i,e,l),n&&(s[i]=n,o=!1)}),{invalidAttrs:s,isValid:o}},c=function(i,n){return{preValidate:function(t,i){var n,r=this,s={};return e.isObject(t)?(e.each(t,function(t,e){n=r.preValidate(e,t),n&&(s[e]=n)}),e.isEmpty(s)?void 0:s):a(this,t,i,e.extend({},this.attributes))},isValid:function(t){var i=r(this.attributes);return e.isString(t)?!a(this,t,i[t],e.extend({},this.attributes)):e.isArray(t)?e.reduce(t,function(t,n){return t&&!a(this,n,i[n],e.extend({},this.attributes))},!0,this):(t===!0&&this.validate(),this.validation?this._isValid:!0)},validate:function(s,o){var a=this,c=!s,u=e.extend({},n,o),h=t(a),d=e.extend({},h,a.attributes,s),p=r(s||d),f=l(a,d);return a._isValid=f.isValid,e.each(h,function(t,e){var n=f.invalidAttrs.hasOwnProperty(e);n||u.valid(i,e,u.selector)}),e.each(h,function(t,e){var n=f.invalidAttrs.hasOwnProperty(e),r=p.hasOwnProperty(e);
n&&(r||c)&&u.invalid(i,e,f.invalidAttrs[e],u.selector)}),e.defer(function(){a.trigger("validated",a._isValid,a,f.invalidAttrs),a.trigger("validated:"+(a._isValid?"valid":"invalid"),a,f.invalidAttrs)}),!u.forceUpdate&&e.intersection(e.keys(f.invalidAttrs),e.keys(p)).length>0?f.invalidAttrs:void 0}}},h=function(t,i,n){e.extend(i,c(t,n))},d=function(t){delete t.validate,delete t.preValidate,delete t.isValid},p=function(t){h(this.view,t,this.options)},f=function(t){d(t)};return{version:"0.9.1",configure:function(t){e.extend(i,t)},bind:function(t,n){n=e.extend({},i,o,n);var r=n.model||t.model,s=n.collection||t.collection;if("undefined"==typeof r&&"undefined"==typeof s)throw"Before you execute the binding your view must have a model or a collection.\nSee http://thedersen.com/projects/backbone-validation/#using-form-model-validation for more information.";r?h(t,r,n):s&&(s.each(function(e){h(t,e,n)}),s.bind("add",p,{view:t,options:n}),s.bind("remove",f))},unbind:function(t,i){i=e.extend({},i);var n=i.model||t.model,r=i.collection||t.collection;n?d(n):r&&(r.each(function(t){d(t)}),r.unbind("add",p),r.unbind("remove",f))},mixin:c(null,i)}}(),o=s.callbacks={valid:function(t,e,i){t.$("["+i+'~="'+e+'"]').removeClass("invalid").removeAttr("data-error")},invalid:function(t,e,i,n){t.$("["+n+'~="'+e+'"]').addClass("invalid").attr("data-error",i)}},a=s.patterns={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},l=s.messages={required:"{0} is required",acceptance:"{0} must be accepted",min:"{0} must be greater than or equal to {1}",max:"{0} must be less than or equal to {1}",range:"{0} must be between {1} and {2}",length:"{0} must be {1} characters",minLength:"{0} must be at least {1} characters",maxLength:"{0} must be at most {1} characters",rangeLength:"{0} must be between {1} and {2} characters",oneOf:"{0} must be one of: {1}",equalTo:"{0} must be the same as {1}",digits:"{0} must only contain digits",number:"{0} must be a number",email:"{0} must be a valid email",url:"{0} must be a valid url",inlinePattern:"{0} is invalid"},c=s.labelFormatters={none:function(t){return t},sentenceCase:function(t){return t.replace(/(?:^\w|[A-Z]|\b\w)/g,function(t,e){return 0===e?t.toUpperCase():" "+t.toLowerCase()}).replace(/_/g," ")},label:function(t,e){return e.labels&&e.labels[t]||c.sentenceCase(t,e)}},u=s.validators=function(){var t=String.prototype.trim?function(t){return null===t?"":String.prototype.trim.call(t)}:function(t){var e=/^\s+/,i=/\s+$/;return null===t?"":t.toString().replace(e,"").replace(i,"")},i=function(t){return e.isNumber(t)||e.isString(t)&&t.match(a.number)},n=function(i){return!(e.isNull(i)||e.isUndefined(i)||e.isString(i)&&""===t(i)||e.isArray(i)&&e.isEmpty(i))};return{fn:function(t,i,n,r,s){return e.isString(n)&&(n=r[n]),n.call(r,t,i,s)},required:function(t,i,r,s,o){var a=e.isFunction(r)?r.call(s,t,i,o):r;return a||n(t)?a&&!n(t)?this.format(l.required,this.formatLabel(i,s)):void 0:!1},acceptance:function(t,i,n,r){return"true"===t||e.isBoolean(t)&&t!==!1?void 0:this.format(l.acceptance,this.formatLabel(i,r))},min:function(t,e,n,r){return!i(t)||n>t?this.format(l.min,this.formatLabel(e,r),n):void 0},max:function(t,e,n,r){return!i(t)||t>n?this.format(l.max,this.formatLabel(e,r),n):void 0},range:function(t,e,n,r){return!i(t)||t<n[0]||t>n[1]?this.format(l.range,this.formatLabel(e,r),n[0],n[1]):void 0},length:function(t,i,n,r){return e.isString(t)&&t.length===n?void 0:this.format(l.length,this.formatLabel(i,r),n)},minLength:function(t,i,n,r){return!e.isString(t)||t.length<n?this.format(l.minLength,this.formatLabel(i,r),n):void 0},maxLength:function(t,i,n,r){return!e.isString(t)||t.length>n?this.format(l.maxLength,this.formatLabel(i,r),n):void 0},rangeLength:function(t,i,n,r){return!e.isString(t)||t.length<n[0]||t.length>n[1]?this.format(l.rangeLength,this.formatLabel(i,r),n[0],n[1]):void 0},oneOf:function(t,i,n,r){return e.include(n,t)?void 0:this.format(l.oneOf,this.formatLabel(i,r),n.join(", "))},equalTo:function(t,e,i,n,r){return t!==r[i]?this.format(l.equalTo,this.formatLabel(e,n),this.formatLabel(i,n)):void 0},pattern:function(t,e,i,r){return n(t)&&t.toString().match(a[i]||i)?void 0:this.format(l[i]||l.inlinePattern,this.formatLabel(e,r),i)}}}();return e.each(u,function(t,i){u[i]=e.bind(u[i],e.extend({},n,u))}),s}(e),t.Validation}),!function(t){var e=function(e,i){this.options=t.extend({},t.fn.affix.defaults,i),this.$window=t(window).on("scroll.affix.data-api",t.proxy(this.checkPosition,this)).on("click.affix.data-api",t.proxy(function(){setTimeout(t.proxy(this.checkPosition,this),1)},this)),this.$element=t(e),this.checkPosition()};e.prototype.checkPosition=function(){if(this.$element.is(":visible")){var e,i=t(document).height(),n=this.$window.scrollTop(),r=this.$element.offset(),s=this.options.offset,o=s.bottom,a=s.top,l="affix affix-top affix-bottom";"object"!=typeof s&&(o=a=s),"function"==typeof a&&(a=s.top()),"function"==typeof o&&(o=s.bottom()),e=null!=this.unpin&&n+this.unpin<=r.top?!1:null!=o&&r.top+this.$element.height()>=i-o?"bottom":null!=a&&a>=n?"top":!1,this.affixed!==e&&(this.affixed=e,this.unpin="bottom"==e?r.top-n:null,this.$element.removeClass(l).addClass("affix"+(e?"-"+e:"")))}};var i=t.fn.affix;t.fn.affix=function(i){return this.each(function(){var n=t(this),r=n.data("affix"),s="object"==typeof i&&i;r||n.data("affix",r=new e(this,s)),"string"==typeof i&&r[i]()})},t.fn.affix.Constructor=e,t.fn.affix.defaults={offset:0},t.fn.affix.noConflict=function(){return t.fn.affix=i,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var e=t(this),i=e.data();i.offset=i.offset||{},i.offsetBottom&&(i.offset.bottom=i.offsetBottom),i.offsetTop&&(i.offset.top=i.offsetTop),e.affix(i)})})}(window.jQuery),!function(t){var e=function(t,e){this.init("tooltip",t,e)};e.prototype={constructor:e,init:function(e,i,n){var r,s,o,a,l;for(this.type=e,this.$element=t(i),this.options=this.getOptions(n),this.enabled=!0,o=this.options.trigger.split(" "),l=o.length;l--;)a=o[l],"click"==a?this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this)):"manual"!=a&&(r="hover"==a?"mouseenter":"focus",s="hover"==a?"mouseleave":"blur",this.$element.on(r+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,t.proxy(this.leave,this)));this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(e){return e=t.extend({},t.fn[this.type].defaults,this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},enter:function(e){var i,n=t.fn[this.type].defaults,r={};return this._options&&t.each(this._options,function(t,e){n[t]!=e&&(r[t]=e)},this),i=t(e.currentTarget)[this.type](r).data(this.type),i.options.delay&&i.options.delay.show?(clearTimeout(this.timeout),i.hoverState="in",void(this.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show))):i.show()},leave:function(e){var i=t(e.currentTarget)[this.type](this._options).data(this.type);return this.timeout&&clearTimeout(this.timeout),i.options.delay&&i.options.delay.hide?(i.hoverState="out",void(this.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide))):i.hide()},show:function(){var e,i,n,r,s,o,a=t.Event("show");if(this.hasContent()&&this.enabled){if(this.$element.trigger(a),a.isDefaultPrevented())return;switch(e=this.tip(),this.setContent(),this.options.animation&&e.addClass("fade"),s="function"==typeof this.options.placement?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,e.detach().css({top:0,left:0,display:"block"}),this.options.container?e.appendTo(this.options.container):e.insertAfter(this.$element),i=this.getPosition(),n=e[0].offsetWidth,r=e[0].offsetHeight,s){case"bottom":o={top:i.top+i.height,left:i.left+i.width/2-n/2};break;case"top":o={top:i.top-r,left:i.left+i.width/2-n/2};break;case"left":o={top:i.top+i.height/2-r/2,left:i.left-n};break;case"right":o={top:i.top+i.height/2-r/2,left:i.left+i.width}}this.applyPlacement(o,s),this.$element.trigger("shown")}},applyPlacement:function(t,e){var i,n,r,s,o=this.tip(),a=o[0].offsetWidth,l=o[0].offsetHeight;o.offset(t).addClass(e).addClass("in"),i=o[0].offsetWidth,n=o[0].offsetHeight,"top"==e&&n!=l&&(t.top=t.top+l-n,s=!0),"bottom"==e||"top"==e?(r=0,t.left<0&&(r=-2*t.left,t.left=0,o.offset(t),i=o[0].offsetWidth,n=o[0].offsetHeight),this.replaceArrow(r-a+i,i,"left")):this.replaceArrow(n-l,n,"top"),s&&o.offset(t)},replaceArrow:function(t,e,i){this.arrow().css(i,t?50*(1-t/e)+"%":"")},setContent:function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},hide:function(){function e(){var e=setTimeout(function(){i.off(t.support.transition.end).detach()},500);i.one(t.support.transition.end,function(){clearTimeout(e),i.detach()})}var i=this.tip(),n=t.Event("hide");return this.$element.trigger(n),n.isDefaultPrevented()?void 0:(i.removeClass("in"),t.support.transition&&this.$tip.hasClass("fade")?e():i.detach(),this.$element.trigger("hidden"),this)},fixTitle:function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var e=this.$element[0];return t.extend({},"function"==typeof e.getBoundingClientRect?e.getBoundingClientRect():{width:e.offsetWidth,height:e.offsetHeight},this.$element.offset())},getTitle:function(){var t,e=this.$element,i=this.options;return t=e.attr("data-original-title")||("function"==typeof i.title?i.title.call(e[0]):i.title)},tip:function(){return this.$tip=this.$tip||t(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(e){var i=e?t(e.currentTarget)[this.type](this._options).data(this.type):this;i.tip().hasClass("in")?i.hide():i.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var i=t.fn.tooltip;t.fn.tooltip=function(i){return this.each(function(){var n=t(this),r=n.data("tooltip"),s="object"==typeof i&&i;r||n.data("tooltip",r=new e(this,s)),"string"==typeof i&&r[i]()})},t.fn.tooltip.Constructor=e,t.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},t.fn.tooltip.noConflict=function(){return t.fn.tooltip=i,this}}(window.jQuery),!function(t){var e=function(e,i){this.$element=t(e),this.options=t.extend({},t.fn.button.defaults,i)};e.prototype.setState=function(t){var e="disabled",i=this.$element,n=i.data(),r=i.is("input")?"val":"html";t+="Text",n.resetText||i.data("resetText",i[r]()),i[r](n[t]||this.options[t]),setTimeout(function(){"loadingText"==t?i.addClass(e).attr(e,e):i.removeClass(e).removeAttr(e)},0)},e.prototype.toggle=function(){var t=this.$element.closest('[data-toggle="buttons-radio"]');t&&t.find(".active").removeClass("active"),this.$element.toggleClass("active")};var i=t.fn.button;t.fn.button=function(i){return this.each(function(){var n=t(this),r=n.data("button"),s="object"==typeof i&&i;r||n.data("button",r=new e(this,s)),"toggle"==i?r.toggle():i&&r.setState(i)})},t.fn.button.defaults={loadingText:"loading..."},t.fn.button.Constructor=e,t.fn.button.noConflict=function(){return t.fn.button=i,this},t(document).on("click.button.data-api","[data-toggle^=button]",function(e){var i=t(e.target);i.hasClass("btn")||(i=i.closest(".btn")),i.button("toggle")})}(window.jQuery),!function(t){var e=function(e,i){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,"hover"==this.options.pause&&this.$element.on("mouseenter",t.proxy(this.pause,this)).on("mouseleave",t.proxy(this.cycle,this))};e.prototype={cycle:function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},getActiveIndex:function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},to:function(e){var i=this.getActiveIndex(),n=this;if(!(e>this.$items.length-1||0>e))return this.sliding?this.$element.one("slid",function(){n.to(e)}):i==e?this.pause().cycle():this.slide(e>i?"next":"prev",t(this.$items[e]))},pause:function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition.end&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),clearInterval(this.interval),this.interval=null,this},next:function(){return this.sliding?void 0:this.slide("next")},prev:function(){return this.sliding?void 0:this.slide("prev")},slide:function(e,i){var n,r=this.$element.find(".item.active"),s=i||r[e](),o=this.interval,a="next"==e?"left":"right",l="next"==e?"first":"last",c=this;if(this.sliding=!0,o&&this.pause(),s=s.length?s:this.$element.find(".item")[l](),n=t.Event("slide",{relatedTarget:s[0],direction:a}),!s.hasClass("active")){if(this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var e=t(c.$indicators.children()[c.getActiveIndex()]);e&&e.addClass("active")})),t.support.transition&&this.$element.hasClass("slide")){if(this.$element.trigger(n),n.isDefaultPrevented())return;s.addClass(e),s[0].offsetWidth,r.addClass(a),s.addClass(a),this.$element.one(t.support.transition.end,function(){s.removeClass([e,a].join(" ")).addClass("active"),r.removeClass(["active",a].join(" ")),c.sliding=!1,setTimeout(function(){c.$element.trigger("slid")},0)})}else{if(this.$element.trigger(n),n.isDefaultPrevented())return;r.removeClass("active"),s.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return o&&this.cycle(),this}}};var i=t.fn.carousel;t.fn.carousel=function(i){return this.each(function(){var n=t(this),r=n.data("carousel"),s=t.extend({},t.fn.carousel.defaults,"object"==typeof i&&i),o="string"==typeof i?i:s.slide;r||n.data("carousel",r=new e(this,s)),"number"==typeof i?r.to(i):o?r[o]():s.interval&&r.pause().cycle()})},t.fn.carousel.defaults={interval:5e3,pause:"hover"},t.fn.carousel.Constructor=e,t.fn.carousel.noConflict=function(){return t.fn.carousel=i,this},t(document).on("click.carousel.data-api","[data-slide], [data-slide-to]",function(e){var i,n,r=t(this),s=t(r.attr("data-target")||(i=r.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"")),o=t.extend({},s.data(),r.data());s.carousel(o),(n=r.attr("data-slide-to"))&&s.data("carousel").pause().to(n).cycle(),e.preventDefault()})}(window.jQuery),!function(t){var e=function(e,i){this.$element=t(e),this.options=t.extend({},t.fn.collapse.defaults,i),this.options.parent&&(this.$parent=t(this.options.parent)),this.options.toggle&&this.toggle()};e.prototype={constructor:e,dimension:function(){var t=this.$element.hasClass("width");return t?"width":"height"},show:function(){var e,i,n,r;if(!this.transitioning&&!this.$element.hasClass("in")){if(e=this.dimension(),i=t.camelCase(["scroll",e].join("-")),n=this.$parent&&this.$parent.find("> .accordion-group > .in"),n&&n.length){if(r=n.data("collapse"),r&&r.transitioning)return;n.collapse("hide"),r||n.data("collapse",null)}this.$element[e](0),this.transition("addClass",t.Event("show"),"shown"),t.support.transition&&this.$element[e](this.$element[0][i])}},hide:function(){var e;!this.transitioning&&this.$element.hasClass("in")&&(e=this.dimension(),this.reset(this.$element[e]()),this.transition("removeClass",t.Event("hide"),"hidden"),this.$element[e](0))},reset:function(t){var e=this.dimension();return this.$element.removeClass("collapse")[e](t||"auto")[0].offsetWidth,this.$element[null!==t?"addClass":"removeClass"]("collapse"),this},transition:function(e,i,n){var r=this,s=function(){"show"==i.type&&r.reset(),r.transitioning=0,r.$element.trigger(n)};this.$element.trigger(i),i.isDefaultPrevented()||(this.transitioning=1,this.$element[e]("in"),t.support.transition&&this.$element.hasClass("collapse")?this.$element.one(t.support.transition.end,s):s())},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};var i=t.fn.collapse;t.fn.collapse=function(i){return this.each(function(){var n=t(this),r=n.data("collapse"),s=t.extend({},t.fn.collapse.defaults,n.data(),"object"==typeof i&&i);r||n.data("collapse",r=new e(this,s)),"string"==typeof i&&r[i]()})},t.fn.collapse.defaults={toggle:!0},t.fn.collapse.Constructor=e,t.fn.collapse.noConflict=function(){return t.fn.collapse=i,this},t(document).on("click.collapse.data-api","[data-toggle=collapse]",function(e){var i,n=t(this),r=n.attr("data-target")||e.preventDefault()||(i=n.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""),s=t(r).data("collapse")?"toggle":n.data();n[t(r).hasClass("in")?"addClass":"removeClass"]("collapsed"),t(r).collapse(s)})}(window.jQuery),!function(t){function e(){t(n).each(function(){i(t(this)).removeClass("open")})}function i(e){var i,n=e.attr("data-target");return n||(n=e.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,"")),i=n&&t(n),i&&i.length||(i=e.parent()),i}var n="[data-toggle=dropdown]",r=function(e){var i=t(e).on("click.dropdown.data-api",this.toggle);t("html").on("click.dropdown.data-api",function(){i.parent().removeClass("open")})};r.prototype={constructor:r,toggle:function(){var n,r,s=t(this);if(!s.is(".disabled, :disabled"))return n=i(s),r=n.hasClass("open"),e(),r||n.toggleClass("open"),s.focus(),!1},keydown:function(e){var r,s,o,a,l;if(/(38|40|27)/.test(e.keyCode)&&(r=t(this),e.preventDefault(),e.stopPropagation(),!r.is(".disabled, :disabled"))){if(o=i(r),a=o.hasClass("open"),!a||a&&27==e.keyCode)return 27==e.which&&o.find(n).focus(),r.click();s=t("[role=menu] li:not(.divider):visible a",o),s.length&&(l=s.index(s.filter(":focus")),38==e.keyCode&&l>0&&l--,40==e.keyCode&&l<s.length-1&&l++,~l||(l=0),s.eq(l).focus())}}};var s=t.fn.dropdown;t.fn.dropdown=function(e){return this.each(function(){var i=t(this),n=i.data("dropdown");n||i.data("dropdown",n=new r(this)),"string"==typeof e&&n[e].call(i)})},t.fn.dropdown.Constructor=r,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=s,this},t(document).on("click.dropdown.data-api",e).on("click.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.dropdown-menu",function(t){t.stopPropagation()}).on("click.dropdown.data-api",n,r.prototype.toggle).on("keydown.dropdown.data-api",n+", [role=menu]",r.prototype.keydown)}(window.jQuery),function(t){t.bootstrapGrowl=function(e,i){var i=t.extend({},t.bootstrapGrowl.default_options,i),n=t("<div>");n.attr("class","bootstrap-growl alert"),i.type&&n.addClass("alert-"+i.type),i.allow_dismiss&&n.append('<a class="close" data-dismiss="alert" href="#">&times;</a>'),n.append(e),i.top_offset&&(i.offset={from:"top",amount:i.top_offset});var r=0;css={position:"body"==i.ele?"fixed":"absolute",margin:0,"z-index":"9999",display:"none"};for(var s in i.offset)css[s]=i.offset[s]+r+"px";switch(n.css(css),"auto"!==i.width&&n.css("width",i.width+"px"),t(i.ele).append(n),i.align){case"center":n.css({left:"50%","margin-left":"-"+n.outerWidth()/2+"px"});break;case"left":n.css("left","20px");break;default:n.css("right")||n.css("right","50px")}n.fadeIn(),i.delay>=0&&n.delay(i.delay).fadeOut("slow",function(){t(this).remove()})},t.bootstrapGrowl.default_options={ele:"body",type:null,offset:{top:20},align:"right",width:250,delay:4e3,allow_dismiss:!0,stackup_spacing:10}}(jQuery),!function(t){var e=function(e,i){this.options=i,this.$element=t(e).delegate('[data-dismiss="modal"]',"click.dismiss.modal",t.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};e.prototype={constructor:e,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var e=this,i=t.Event("show");this.$element.trigger(i),this.isShown||i.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.backdrop(function(){var i=t.support.transition&&e.$element.hasClass("fade");e.$element.parent().length||e.$element.appendTo(document.body),e.$element.show(),i&&e.$element[0].offsetWidth,e.$element.addClass("in").attr("aria-hidden",!1),e.enforceFocus(),i?e.$element.one(t.support.transition.end,function(){e.$element.focus().trigger("shown")}):e.$element.focus().trigger("shown")}))},hide:function(e){e&&e.preventDefault();e=t.Event("hide"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),t(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),t.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var e=this;t(document).on("focusin.modal",function(t){e.$element[0]===t.target||e.$element.has(t.target).length||e.$element.focus()})},escape:function(){var t=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(e){27==e.which&&t.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var e=this,i=setTimeout(function(){e.$element.off(t.support.transition.end),e.hideModal()},500);this.$element.one(t.support.transition.end,function(){clearTimeout(i),e.hideModal()})},hideModal:function(){var t=this;this.$element.hide(),this.backdrop(function(){t.removeBackdrop(),t.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(e){var i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var n=t.support.transition&&i;if(this.$backdrop=t('<div class="modal-backdrop '+i+'" />').appendTo(document.body),this.$backdrop.click("static"==this.options.backdrop?t.proxy(this.$element[0].focus,this.$element[0]):t.proxy(this.hide,this)),n&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;n?this.$backdrop.one(t.support.transition.end,e):e()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(t.support.transition.end,e):e()):e&&e()}};var i=t.fn.modal;t.fn.modal=function(i){return this.each(function(){var n=t(this),r=n.data("modal"),s=t.extend({},t.fn.modal.defaults,n.data(),"object"==typeof i&&i);r||n.data("modal",r=new e(this,s)),"string"==typeof i?r[i]():s.show&&r.show()})},t.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},t.fn.modal.Constructor=e,t.fn.modal.noConflict=function(){return t.fn.modal=i,this},t(document).on("click.modal.data-api",'[data-toggle="modal"]',function(e){var i=t(this),n=i.attr("href"),r=t(i.attr("data-target")||n&&n.replace(/.*(?=#[^\s]+$)/,"")),s=r.data("modal")?"toggle":t.extend({remote:!/#/.test(n)&&n},r.data(),i.data());e.preventDefault(),r.modal(s).one("hide",function(){i.focus()})})}(window.jQuery),!function(t){var e=function(t,e){this.init("popover",t,e)};e.prototype=t.extend({},t.fn.tooltip.Constructor.prototype,{constructor:e,setContent:function(){var t=this.tip(),e=this.getTitle(),i=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content")[this.options.html?"html":"text"](i),t.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var t,e=this.$element,i=this.options;return t=("function"==typeof i.content?i.content.call(e[0]):i.content)||e.attr("data-content")},tip:function(){return this.$tip||(this.$tip=t(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});var i=t.fn.popover;t.fn.popover=function(i){return this.each(function(){var n=t(this),r=n.data("popover"),s="object"==typeof i&&i;r||n.data("popover",r=new e(this,s)),"string"==typeof i&&r[i]()})},t.fn.popover.Constructor=e,t.fn.popover.defaults=t.extend({},t.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),t.fn.popover.noConflict=function(){return t.fn.popover=i,this}}(window.jQuery),!function(t){var e=function(e){this.element=t(e)};e.prototype={constructor:e,show:function(){var e,i,n,r=this.element,s=r.closest("ul:not(.dropdown-menu)"),o=r.attr("data-target");o||(o=r.attr("href"),o=o&&o.replace(/.*(?=#[^\s]*$)/,"")),r.parent("li").hasClass("active")||(e=s.find(".active:last a")[0],n=t.Event("show",{relatedTarget:e}),r.trigger(n),n.isDefaultPrevented()||(i=t(o),this.activate(r.parent("li"),s),this.activate(i,i.parent(),function(){r.trigger({type:"shown",relatedTarget:e})})))},activate:function(e,i,n){function r(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),e.addClass("active"),o?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu")&&e.closest("li.dropdown").addClass("active"),n&&n()}var s=i.find("> .active"),o=n&&t.support.transition&&s.hasClass("fade");o?s.one(t.support.transition.end,r):r(),s.removeClass("in")}};var i=t.fn.tab;t.fn.tab=function(i){return this.each(function(){var n=t(this),r=n.data("tab");r||n.data("tab",r=new e(this)),"string"==typeof i&&r[i]()})},t.fn.tab.Constructor=e,t.fn.tab.noConflict=function(){return t.fn.tab=i,this},t(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(e){e.preventDefault(),t(this).tab("show")})}(window.jQuery),!function(t){t(function(){t.support.transition=function(){var t=function(){var t,e=document.createElement("bootstrap"),i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(t in i)if(void 0!==e.style[t])return i[t]}();return t&&{end:t}}()})}(window.jQuery),define("bootstrap",function(){}),function(t,e){"function"==typeof define&&define.amd?define("momenttz",["moment"],e):"object"==typeof exports?module.exports=e(require("moment")):e(t.moment)}(this,function(t){function e(t){return t>96?t-87:t>64?t-29:t-48}function i(t){var i,n=0,r=t.split("."),s=r[0],o=r[1]||"",a=1,l=0,c=1;for(45===t.charCodeAt(0)&&(n=1,c=-1),n;n<s.length;n++)i=e(s.charCodeAt(n)),l=60*l+i;for(n=0;n<o.length;n++)a/=60,i=e(o.charCodeAt(n)),l+=i*a;return l*c}function n(t){for(var e=0;e<t.length;e++)t[e]=i(t[e])}function r(t,e){for(var i=0;e>i;i++)t[i]=Math.round((t[i-1]||0)+6e4*t[i]);t[e-1]=1/0}function s(t,e){var i,n=[];for(i=0;i<e.length;i++)n[i]=t[e[i]];return n}function o(t){var e=t.split("|"),i=e[2].split(" "),o=e[3].split(""),a=e[4].split(" ");return n(i),n(o),n(a),r(a,o.length),{name:e[0],abbrs:s(e[1].split(" "),o),offsets:s(i,o),untils:a}}function a(t){t&&this._set(o(t))}function l(t){return(t||"").toLowerCase().replace(/\//g,"_")}function c(t){var e,i,n;for("string"==typeof t&&(t=[t]),e=0;e<t.length;e++)i=new a(t[e]),n=l(i.name),C[n]=i,p(n)}function u(t){return C[l(t)]||null}function h(){var t,e=[];for(t in C)C.hasOwnProperty(t)&&C[t]&&e.push(C[t].name);return e.sort()}function d(t){var e,i;for("string"==typeof t&&(t=[t]),e=0;e<t.length;e++)i=t[e].split("|"),g(i[0],i[1]),g(i[1],i[0])}function p(t){if(A[t]){var e,i=C[t],n=A[t];for(e=0;e<n.length;e++)f(i,n[e]);A[t]=null}}function f(t,e){var i=C[l(e)]=new a;i._set(t),i.name=e}function g(t,e){t=l(t),C[t]?f(C[t],e):(A[t]=A[t]||[],A[t].push(e))}function m(t){c(t.zones),d(t.links),_.dataVersion=t.version}function v(t){return v.didShowError||(v.didShowError=!0,y("moment.tz.zoneExists('"+t+"') has been deprecated in favor of !moment.tz.zone('"+t+"')")),!!u(t)}function b(t){return!(!t._a||void 0!==t._tzm)}function y(t){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(t)}function _(e){var i=Array.prototype.slice.call(arguments,0,-1),n=arguments[arguments.length-1],r=u(n),s=t.utc.apply(null,i);return r&&!t.isMoment(e)&&b(s)&&s.add(r.parse(s),"minutes"),s.tz(n),s}function w(t){return function(){return this._z?this._z.abbr(this):t.call(this)}}function x(t){return function(){return this._z=null,t.apply(this,arguments)}}if(void 0!==t.tz)return t;var k="0.3.0",C={},A={},T=t.version.split("."),S=+T[0],M=+T[1];(2>S||2===S&&6>M)&&y("Moment Timezone requires Moment.js >= 2.6.0. You are using Moment.js "+t.version+". See momentjs.com"),a.prototype={_set:function(t){this.name=t.name,this.abbrs=t.abbrs,this.untils=t.untils,this.offsets=t.offsets},_index:function(t){var e,i=+t,n=this.untils;for(e=0;e<n.length;e++)if(i<n[e])return e},parse:function(t){var e,i,n,r,s=+t,o=this.offsets,a=this.untils,l=a.length-1;for(r=0;l>r;r++)if(e=o[r],i=o[r+1],n=o[r?r-1:r],i>e&&_.moveAmbiguousForward?e=i:e>n&&_.moveInvalidForward&&(e=n),s<a[r]-6e4*e)return o[r];return o[l]},abbr:function(t){return this.abbrs[this._index(t)]},offset:function(t){return this.offsets[this._index(t)]}},_.version=k,_.dataVersion="",_._zones=C,_._links=A,_.add=c,_.link=d,_.load=m,_.zone=u,_.zoneExists=v,_.names=h,_.Zone=a,_.unpack=o,_.unpackBase60=i,_.needsOffset=b,_.moveInvalidForward=!0,_.moveAmbiguousForward=!1;var D=t.fn;t.tz=_,t.defaultZone=null,t.updateOffset=function(e,i){var n;void 0===e._z&&(e._z=t.defaultZone),e._z&&(n=e._z.offset(e),Math.abs(n)<16&&(n/=60),void 0!==e.utcOffset?e.utcOffset(-n,i):e.zone(n,i))},D.tz=function(e){return e?(this._z=u(e),this._z?t.updateOffset(this):y("Moment Timezone has no data for "+e+". See http://momentjs.com/timezone/docs/#/data-loading/."),this):this._z?this._z.name:void 0},D.zoneName=w(D.zoneName),D.zoneAbbr=w(D.zoneAbbr),D.utc=x(D.utc),t.tz.setDefault=function(e){return(2>S||2===S&&9>M)&&y("Moment Timezone setDefault() requires Moment.js >= 2.9.0. You are using Moment.js "+t.version+"."),t.defaultZone=e?u(e):null,t
};var $=t.momentProperties;return"[object Array]"===Object.prototype.toString.call($)?($.push("_z"),$.push("_a")):$&&($._z=null),m({version:"2014j",zones:["Africa/Abidjan|GMT|0|0|","Africa/Addis_Ababa|EAT|-30|0|","Africa/Algiers|CET|-10|0|","Africa/Bangui|WAT|-10|0|","Africa/Blantyre|CAT|-20|0|","Africa/Cairo|EET EEST|-20 -30|0101010101010101010101010101010|1Cby0 Fb0 c10 8n0 8Nd0 gL0 e10 mn0 1o10 jz0 gN0 pb0 1qN0 dX0 e10 xz0 1o10 bb0 e10 An0 1o10 5z0 e10 FX0 1o10 2L0 e10 IL0 1C10 Lz0","Africa/Casablanca|WET WEST|0 -10|01010101010101010101010101010101010101010|1Cco0 Db0 1zd0 Lz0 1Nf0 wM0 co0 go0 1o00 s00 dA0 vc0 11A0 A00 e00 y00 11A0 uo0 e00 DA0 11A0 rA0 e00 Jc0 WM0 m00 gM0 M00 WM0 jc0 e00 RA0 11A0 dA0 e00 Uo0 11A0 800 gM0 Xc0","Africa/Ceuta|CET CEST|-10 -20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Africa/Johannesburg|SAST|-20|0|","Africa/Tripoli|EET CET CEST|-20 -10 -20|0120|1IlA0 TA0 1o00","Africa/Windhoek|WAST WAT|-20 -10|01010101010101010101010|1C1c0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0","America/Adak|HAST HADT|a0 90|01010101010101010101010|1BR00 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Anchorage|AKST AKDT|90 80|01010101010101010101010|1BQX0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Anguilla|AST|40|0|","America/Araguaina|BRT BRST|30 20|010|1IdD0 Lz0","America/Argentina/Buenos_Aires|ART|30|0|","America/Asuncion|PYST PYT|30 40|01010101010101010101010|1C430 1a10 1fz0 1a10 1fz0 1cN0 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0","America/Atikokan|EST|50|0|","America/Bahia|BRT BRST|30 20|010|1FJf0 Rb0","America/Bahia_Banderas|MST CDT CST|70 50 60|01212121212121212121212|1C1l0 1nW0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0","America/Belem|BRT|30|0|","America/Belize|CST|60|0|","America/Boa_Vista|AMT|40|0|","America/Bogota|COT|50|0|","America/Boise|MST MDT|70 60|01010101010101010101010|1BQV0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Campo_Grande|AMST AMT|30 40|01010101010101010101010|1BIr0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10","America/Cancun|CST CDT|60 50|01010101010101010101010|1C1k0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0","America/Caracas|VET|4u|0|","America/Cayenne|GFT|30|0|","America/Chicago|CST CDT|60 50|01010101010101010101010|1BQU0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Chihuahua|MST MDT|70 60|01010101010101010101010|1C1l0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0","America/Creston|MST|70|0|","America/Dawson|PST PDT|80 70|01010101010101010101010|1BQW0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Detroit|EST EDT|50 40|01010101010101010101010|1BQT0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Eirunepe|AMT ACT|40 50|01|1KLE0","America/Glace_Bay|AST ADT|40 30|01010101010101010101010|1BQS0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Godthab|WGT WGST|30 20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","America/Goose_Bay|AST ADT|40 30|01010101010101010101010|1BQQ1 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Grand_Turk|EST EDT AST|50 40 40|0101010101012|1BQT0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Guayaquil|ECT|50|0|","America/Guyana|GYT|40|0|","America/Havana|CST CDT|50 40|01010101010101010101010|1BQR0 1wo0 U00 1zc0 U00 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0","America/La_Paz|BOT|40|0|","America/Lima|PET|50|0|","America/Metlakatla|PST|80|0|","America/Miquelon|PMST PMDT|30 20|01010101010101010101010|1BQR0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Montevideo|UYST UYT|20 30|01010101010101010101010|1BQQ0 1ld0 14n0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 14n0 1ld0 14n0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10","America/Noronha|FNT|20|0|","America/North_Dakota/Beulah|MST MDT CST CDT|70 60 60 50|01232323232323232323232|1BQV0 1zb0 Oo0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Paramaribo|SRT|30|0|","America/Port-au-Prince|EST EDT|50 40|0101010101010101010|1GI70 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Santa_Isabel|PST PDT|80 70|01010101010101010101010|1C1m0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0","America/Santiago|CLST CLT|30 40|01010101010101010101010|1C1f0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1zb0 Op0 1zb0 Rd0 1wn0 Rd0","America/Sao_Paulo|BRST BRT|20 30|01010101010101010101010|1BIq0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10","America/Scoresbysund|EGT EGST|10 0|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","America/St_Johns|NST NDT|3u 2u|01010101010101010101010|1BQPv 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","Antarctica/Casey|CAST AWST|-b0 -80|0101|1BN30 40P0 KL0","Antarctica/Davis|DAVT DAVT|-50 -70|0101|1BPw0 3Wn0 KN0","Antarctica/DumontDUrville|DDUT|-a0|0|","Antarctica/Macquarie|AEDT MIST|-b0 -b0|01|1C140","Antarctica/Mawson|MAWT|-50|0|","Antarctica/McMurdo|NZDT NZST|-d0 -c0|01010101010101010101010|1C120 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00","Antarctica/Rothera|ROTT|30|0|","Antarctica/Syowa|SYOT|-30|0|","Antarctica/Troll|UTC CEST|0 -20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Antarctica/Vostok|VOST|-60|0|","Asia/Aden|AST|-30|0|","Asia/Almaty|ALMT|-60|0|","Asia/Amman|EET EEST|-20 -30|010101010101010101010|1BVy0 1qM0 11A0 1o00 11A0 4bX0 Dd0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0","Asia/Anadyr|ANAT ANAST ANAT|-c0 -c0 -b0|0120|1BWe0 1qN0 WM0","Asia/Aqtau|AQTT|-50|0|","Asia/Ashgabat|TMT|-50|0|","Asia/Baku|AZT AZST|-40 -50|01010101010101010101010|1BWo0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Asia/Bangkok|ICT|-70|0|","Asia/Beirut|EET EEST|-20 -30|01010101010101010101010|1BWm0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0","Asia/Bishkek|KGT|-60|0|","Asia/Brunei|BNT|-80|0|","Asia/Calcutta|IST|-5u|0|","Asia/Chita|YAKT YAKST YAKT IRKT|-90 -a0 -a0 -80|01023|1BWh0 1qM0 WM0 8Hz0","Asia/Choibalsan|CHOT|-80|0|","Asia/Chongqing|CST|-80|0|","Asia/Dacca|BDT|-60|0|","Asia/Damascus|EET EEST|-20 -30|01010101010101010101010|1C0m0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0","Asia/Dili|TLT|-90|0|","Asia/Dubai|GST|-40|0|","Asia/Dushanbe|TJT|-50|0|","Asia/Gaza|EET EEST|-20 -30|01010101010101010101010|1BVW1 SKX 1xd1 MKX 1AN0 1a00 1fA0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0","Asia/Hebron|EET EEST|-20 -30|0101010101010101010101010|1BVy0 Tb0 1xd1 MKX bB0 cn0 1cN0 1a00 1fA0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0","Asia/Hong_Kong|HKT|-80|0|","Asia/Hovd|HOVT|-70|0|","Asia/Irkutsk|IRKT IRKST IRKT|-80 -90 -90|01020|1BWi0 1qM0 WM0 8Hz0","Asia/Istanbul|EET EEST|-20 -30|01010101010101010101010|1BWp0 1qM0 Xc0 1qo0 WM0 1qM0 11A0 1o00 1200 1nA0 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Asia/Jakarta|WIB|-70|0|","Asia/Jayapura|WIT|-90|0|","Asia/Jerusalem|IST IDT|-20 -30|01010101010101010101010|1BVA0 17X0 1kp0 1dz0 1c10 1aL0 1eN0 1oL0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0","Asia/Kabul|AFT|-4u|0|","Asia/Kamchatka|PETT PETST PETT|-c0 -c0 -b0|0120|1BWe0 1qN0 WM0","Asia/Karachi|PKT|-50|0|","Asia/Kashgar|XJT|-60|0|","Asia/Kathmandu|NPT|-5J|0|","Asia/Khandyga|VLAT VLAST VLAT YAKT YAKT|-a0 -b0 -b0 -a0 -90|010234|1BWg0 1qM0 WM0 17V0 7zD0","Asia/Krasnoyarsk|KRAT KRAST KRAT|-70 -80 -80|01020|1BWj0 1qM0 WM0 8Hz0","Asia/Kuala_Lumpur|MYT|-80|0|","Asia/Magadan|MAGT MAGST MAGT MAGT|-b0 -c0 -c0 -a0|01023|1BWf0 1qM0 WM0 8Hz0","Asia/Makassar|WITA|-80|0|","Asia/Manila|PHT|-80|0|","Asia/Nicosia|EET EEST|-20 -30|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Asia/Novokuznetsk|KRAT NOVST NOVT NOVT|-70 -70 -60 -70|01230|1BWj0 1qN0 WM0 8Hz0","Asia/Novosibirsk|NOVT NOVST NOVT|-60 -70 -70|01020|1BWk0 1qM0 WM0 8Hz0","Asia/Omsk|OMST OMSST OMST|-60 -70 -70|01020|1BWk0 1qM0 WM0 8Hz0","Asia/Oral|ORAT|-50|0|","Asia/Pyongyang|KST|-90|0|","Asia/Qyzylorda|QYZT|-60|0|","Asia/Rangoon|MMT|-6u|0|","Asia/Sakhalin|SAKT SAKST SAKT|-a0 -b0 -b0|01020|1BWg0 1qM0 WM0 8Hz0","Asia/Samarkand|UZT|-50|0|","Asia/Singapore|SGT|-80|0|","Asia/Srednekolymsk|MAGT MAGST MAGT SRET|-b0 -c0 -c0 -b0|01023|1BWf0 1qM0 WM0 8Hz0","Asia/Tbilisi|GET|-40|0|","Asia/Tehran|IRST IRDT|-3u -4u|01010101010101010101010|1BTUu 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0","Asia/Thimbu|BTT|-60|0|","Asia/Tokyo|JST|-90|0|","Asia/Ulaanbaatar|ULAT|-80|0|","Asia/Ust-Nera|MAGT MAGST MAGT VLAT VLAT|-b0 -c0 -c0 -b0 -a0|010234|1BWf0 1qM0 WM0 17V0 7zD0","Asia/Vladivostok|VLAT VLAST VLAT|-a0 -b0 -b0|01020|1BWg0 1qM0 WM0 8Hz0","Asia/Yakutsk|YAKT YAKST YAKT|-90 -a0 -a0|01020|1BWh0 1qM0 WM0 8Hz0","Asia/Yekaterinburg|YEKT YEKST YEKT|-50 -60 -60|01020|1BWl0 1qM0 WM0 8Hz0","Asia/Yerevan|AMT AMST|-40 -50|01010|1BWm0 1qM0 WM0 1qM0","Atlantic/Azores|AZOT AZOST|10 0|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Atlantic/Canary|WET WEST|0 -10|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Atlantic/Cape_Verde|CVT|10|0|","Atlantic/South_Georgia|GST|20|0|","Atlantic/Stanley|FKST FKT|30 40|010|1C6R0 U10","Australia/ACT|AEDT AEST|-b0 -a0|01010101010101010101010|1C140 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0","Australia/Adelaide|ACDT ACST|-au -9u|01010101010101010101010|1C14u 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0","Australia/Brisbane|AEST|-a0|0|","Australia/Darwin|ACST|-9u|0|","Australia/Eucla|ACWST|-8J|0|","Australia/LHI|LHDT LHST|-b0 -au|01010101010101010101010|1C130 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu","Australia/Perth|AWST|-80|0|","Chile/EasterIsland|EASST EAST|50 60|01010101010101010101010|1C1f0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1zb0 Op0 1zb0 Rd0 1wn0 Rd0","Eire|GMT IST|0 -10|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Etc/GMT+1|GMT+1|10|0|","Etc/GMT+10|GMT+10|a0|0|","Etc/GMT+11|GMT+11|b0|0|","Etc/GMT+12|GMT+12|c0|0|","Etc/GMT+2|GMT+2|20|0|","Etc/GMT+3|GMT+3|30|0|","Etc/GMT+4|GMT+4|40|0|","Etc/GMT+5|GMT+5|50|0|","Etc/GMT+6|GMT+6|60|0|","Etc/GMT+7|GMT+7|70|0|","Etc/GMT+8|GMT+8|80|0|","Etc/GMT+9|GMT+9|90|0|","Etc/GMT-1|GMT-1|-10|0|","Etc/GMT-10|GMT-10|-a0|0|","Etc/GMT-11|GMT-11|-b0|0|","Etc/GMT-12|GMT-12|-c0|0|","Etc/GMT-13|GMT-13|-d0|0|","Etc/GMT-14|GMT-14|-e0|0|","Etc/GMT-2|GMT-2|-20|0|","Etc/GMT-3|GMT-3|-30|0|","Etc/GMT-4|GMT-4|-40|0|","Etc/GMT-5|GMT-5|-50|0|","Etc/GMT-6|GMT-6|-60|0|","Etc/GMT-7|GMT-7|-70|0|","Etc/GMT-8|GMT-8|-80|0|","Etc/GMT-9|GMT-9|-90|0|","Etc/UCT|UCT|0|0|","Etc/UTC|UTC|0|0|","Europe/Belfast|GMT BST|0 -10|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Kaliningrad|EET EEST FET|-20 -30 -30|01020|1BWo0 1qM0 WM0 8Hz0","Europe/Minsk|EET EEST FET MSK|-20 -30 -30 -30|01023|1BWo0 1qM0 WM0 8Hy0","Europe/Moscow|MSK MSD MSK|-30 -40 -40|01020|1BWn0 1qM0 WM0 8Hz0","Europe/Samara|SAMT SAMST SAMT|-40 -40 -30|0120|1BWm0 1qN0 WM0","Europe/Simferopol|EET EEST MSK MSK|-20 -30 -40 -30|01010101023|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11z0 1nW0","Europe/Volgograd|MSK MSK|-30 -40|01010|1BWn0 1qM0 WM0 8Hz0","HST|HST|a0|0|","Indian/Chagos|IOT|-60|0|","Indian/Christmas|CXT|-70|0|","Indian/Cocos|CCT|-6u|0|","Indian/Kerguelen|TFT|-50|0|","Indian/Mahe|SCT|-40|0|","Indian/Maldives|MVT|-50|0|","Indian/Mauritius|MUT|-40|0|","Indian/Reunion|RET|-40|0|","Kwajalein|MHT|-c0|0|","MET|MET MEST|-10 -20|01010101010101010101010|1BWp0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","NZ-CHAT|CHADT CHAST|-dJ -cJ|01010101010101010101010|1C120 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00","Pacific/Apia|SST SDT WSDT WSST|b0 a0 -e0 -d0|01012323232323232323232|1Dbn0 1ff0 1a00 CI0 AQ0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00","Pacific/Bougainville|PGT BST|-a0 -b0|01|1NwE0","Pacific/Chuuk|CHUT|-a0|0|","Pacific/Efate|VUT|-b0|0|","Pacific/Enderbury|PHOT|-d0|0|","Pacific/Fakaofo|TKT TKT|b0 -d0|01|1Gfn0","Pacific/Fiji|FJST FJT|-d0 -c0|01010101010101010101010|1BWe0 1o00 Rc0 1wo0 Ao0 1Nc0 Ao0 1Q00 xz0 1SN0 uM0 1SM0 xA0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1SM0","Pacific/Funafuti|TVT|-c0|0|","Pacific/Galapagos|GALT|60|0|","Pacific/Gambier|GAMT|90|0|","Pacific/Guadalcanal|SBT|-b0|0|","Pacific/Guam|ChST|-a0|0|","Pacific/Kiritimati|LINT|-e0|0|","Pacific/Kosrae|KOST|-b0|0|","Pacific/Marquesas|MART|9u|0|","Pacific/Midway|SST|b0|0|","Pacific/Nauru|NRT|-c0|0|","Pacific/Niue|NUT|b0|0|","Pacific/Norfolk|NFT|-bu|0|","Pacific/Noumea|NCT|-b0|0|","Pacific/Palau|PWT|-90|0|","Pacific/Pohnpei|PONT|-b0|0|","Pacific/Port_Moresby|PGT|-a0|0|","Pacific/Rarotonga|CKT|a0|0|","Pacific/Tahiti|TAHT|a0|0|","Pacific/Tarawa|GILT|-c0|0|","Pacific/Tongatapu|TOT|-d0|0|","Pacific/Wake|WAKT|-c0|0|","Pacific/Wallis|WFT|-c0|0|"],links:["Africa/Abidjan|Africa/Accra","Africa/Abidjan|Africa/Bamako","Africa/Abidjan|Africa/Banjul","Africa/Abidjan|Africa/Bissau","Africa/Abidjan|Africa/Conakry","Africa/Abidjan|Africa/Dakar","Africa/Abidjan|Africa/Freetown","Africa/Abidjan|Africa/Lome","Africa/Abidjan|Africa/Monrovia","Africa/Abidjan|Africa/Nouakchott","Africa/Abidjan|Africa/Ouagadougou","Africa/Abidjan|Africa/Sao_Tome","Africa/Abidjan|Africa/Timbuktu","Africa/Abidjan|America/Danmarkshavn","Africa/Abidjan|Atlantic/Reykjavik","Africa/Abidjan|Atlantic/St_Helena","Africa/Abidjan|Etc/GMT","Africa/Abidjan|Etc/GMT+0","Africa/Abidjan|Etc/GMT-0","Africa/Abidjan|Etc/GMT0","Africa/Abidjan|Etc/Greenwich","Africa/Abidjan|GMT","Africa/Abidjan|GMT+0","Africa/Abidjan|GMT-0","Africa/Abidjan|GMT0","Africa/Abidjan|Greenwich","Africa/Abidjan|Iceland","Africa/Addis_Ababa|Africa/Asmara","Africa/Addis_Ababa|Africa/Asmera","Africa/Addis_Ababa|Africa/Dar_es_Salaam","Africa/Addis_Ababa|Africa/Djibouti","Africa/Addis_Ababa|Africa/Juba","Africa/Addis_Ababa|Africa/Kampala","Africa/Addis_Ababa|Africa/Khartoum","Africa/Addis_Ababa|Africa/Mogadishu","Africa/Addis_Ababa|Africa/Nairobi","Africa/Addis_Ababa|Indian/Antananarivo","Africa/Addis_Ababa|Indian/Comoro","Africa/Addis_Ababa|Indian/Mayotte","Africa/Algiers|Africa/Tunis","Africa/Bangui|Africa/Brazzaville","Africa/Bangui|Africa/Douala","Africa/Bangui|Africa/Kinshasa","Africa/Bangui|Africa/Lagos","Africa/Bangui|Africa/Libreville","Africa/Bangui|Africa/Luanda","Africa/Bangui|Africa/Malabo","Africa/Bangui|Africa/Ndjamena","Africa/Bangui|Africa/Niamey","Africa/Bangui|Africa/Porto-Novo","Africa/Blantyre|Africa/Bujumbura","Africa/Blantyre|Africa/Gaborone","Africa/Blantyre|Africa/Harare","Africa/Blantyre|Africa/Kigali","Africa/Blantyre|Africa/Lubumbashi","Africa/Blantyre|Africa/Lusaka","Africa/Blantyre|Africa/Maputo","Africa/Cairo|Egypt","Africa/Casablanca|Africa/El_Aaiun","Africa/Ceuta|Arctic/Longyearbyen","Africa/Ceuta|Atlantic/Jan_Mayen","Africa/Ceuta|CET","Africa/Ceuta|Europe/Amsterdam","Africa/Ceuta|Europe/Andorra","Africa/Ceuta|Europe/Belgrade","Africa/Ceuta|Europe/Berlin","Africa/Ceuta|Europe/Bratislava","Africa/Ceuta|Europe/Brussels","Africa/Ceuta|Europe/Budapest","Africa/Ceuta|Europe/Busingen","Africa/Ceuta|Europe/Copenhagen","Africa/Ceuta|Europe/Gibraltar","Africa/Ceuta|Europe/Ljubljana","Africa/Ceuta|Europe/Luxembourg","Africa/Ceuta|Europe/Madrid","Africa/Ceuta|Europe/Malta","Africa/Ceuta|Europe/Monaco","Africa/Ceuta|Europe/Oslo","Africa/Ceuta|Europe/Paris","Africa/Ceuta|Europe/Podgorica","Africa/Ceuta|Europe/Prague","Africa/Ceuta|Europe/Rome","Africa/Ceuta|Europe/San_Marino","Africa/Ceuta|Europe/Sarajevo","Africa/Ceuta|Europe/Skopje","Africa/Ceuta|Europe/Stockholm","Africa/Ceuta|Europe/Tirane","Africa/Ceuta|Europe/Vaduz","Africa/Ceuta|Europe/Vatican","Africa/Ceuta|Europe/Vienna","Africa/Ceuta|Europe/Warsaw","Africa/Ceuta|Europe/Zagreb","Africa/Ceuta|Europe/Zurich","Africa/Ceuta|Poland","Africa/Johannesburg|Africa/Maseru","Africa/Johannesburg|Africa/Mbabane","Africa/Tripoli|Libya","America/Adak|America/Atka","America/Adak|US/Aleutian","America/Anchorage|America/Juneau","America/Anchorage|America/Nome","America/Anchorage|America/Sitka","America/Anchorage|America/Yakutat","America/Anchorage|US/Alaska","America/Anguilla|America/Antigua","America/Anguilla|America/Aruba","America/Anguilla|America/Barbados","America/Anguilla|America/Blanc-Sablon","America/Anguilla|America/Curacao","America/Anguilla|America/Dominica","America/Anguilla|America/Grenada","America/Anguilla|America/Guadeloupe","America/Anguilla|America/Kralendijk","America/Anguilla|America/Lower_Princes","America/Anguilla|America/Marigot","America/Anguilla|America/Martinique","America/Anguilla|America/Montserrat","America/Anguilla|America/Port_of_Spain","America/Anguilla|America/Puerto_Rico","America/Anguilla|America/Santo_Domingo","America/Anguilla|America/St_Barthelemy","America/Anguilla|America/St_Kitts","America/Anguilla|America/St_Lucia","America/Anguilla|America/St_Thomas","America/Anguilla|America/St_Vincent","America/Anguilla|America/Tortola","America/Anguilla|America/Virgin","America/Argentina/Buenos_Aires|America/Argentina/Catamarca","America/Argentina/Buenos_Aires|America/Argentina/ComodRivadavia","America/Argentina/Buenos_Aires|America/Argentina/Cordoba","America/Argentina/Buenos_Aires|America/Argentina/Jujuy","America/Argentina/Buenos_Aires|America/Argentina/La_Rioja","America/Argentina/Buenos_Aires|America/Argentina/Mendoza","America/Argentina/Buenos_Aires|America/Argentina/Rio_Gallegos","America/Argentina/Buenos_Aires|America/Argentina/Salta","America/Argentina/Buenos_Aires|America/Argentina/San_Juan","America/Argentina/Buenos_Aires|America/Argentina/San_Luis","America/Argentina/Buenos_Aires|America/Argentina/Tucuman","America/Argentina/Buenos_Aires|America/Argentina/Ushuaia","America/Argentina/Buenos_Aires|America/Buenos_Aires","America/Argentina/Buenos_Aires|America/Catamarca","America/Argentina/Buenos_Aires|America/Cordoba","America/Argentina/Buenos_Aires|America/Jujuy","America/Argentina/Buenos_Aires|America/Mendoza","America/Argentina/Buenos_Aires|America/Rosario","America/Atikokan|America/Cayman","America/Atikokan|America/Coral_Harbour","America/Atikokan|America/Jamaica","America/Atikokan|America/Panama","America/Atikokan|EST","America/Atikokan|Jamaica","America/Belem|America/Fortaleza","America/Belem|America/Maceio","America/Belem|America/Recife","America/Belem|America/Santarem","America/Belize|America/Costa_Rica","America/Belize|America/El_Salvador","America/Belize|America/Guatemala","America/Belize|America/Managua","America/Belize|America/Regina","America/Belize|America/Swift_Current","America/Belize|America/Tegucigalpa","America/Belize|Canada/East-Saskatchewan","America/Belize|Canada/Saskatchewan","America/Boa_Vista|America/Manaus","America/Boa_Vista|America/Porto_Velho","America/Boa_Vista|Brazil/West","America/Boise|America/Cambridge_Bay","America/Boise|America/Denver","America/Boise|America/Edmonton","America/Boise|America/Inuvik","America/Boise|America/Ojinaga","America/Boise|America/Shiprock","America/Boise|America/Yellowknife","America/Boise|Canada/Mountain","America/Boise|MST7MDT","America/Boise|Navajo","America/Boise|US/Mountain","America/Campo_Grande|America/Cuiaba","America/Cancun|America/Merida","America/Cancun|America/Mexico_City","America/Cancun|America/Monterrey","America/Cancun|Mexico/General","America/Chicago|America/Indiana/Knox","America/Chicago|America/Indiana/Tell_City","America/Chicago|America/Knox_IN","America/Chicago|America/Matamoros","America/Chicago|America/Menominee","America/Chicago|America/North_Dakota/Center","America/Chicago|America/North_Dakota/New_Salem","America/Chicago|America/Rainy_River","America/Chicago|America/Rankin_Inlet","America/Chicago|America/Resolute","America/Chicago|America/Winnipeg","America/Chicago|CST6CDT","America/Chicago|Canada/Central","America/Chicago|US/Central","America/Chicago|US/Indiana-Starke","America/Chihuahua|America/Mazatlan","America/Chihuahua|Mexico/BajaSur","America/Creston|America/Dawson_Creek","America/Creston|America/Hermosillo","America/Creston|America/Phoenix","America/Creston|MST","America/Creston|US/Arizona","America/Dawson|America/Ensenada","America/Dawson|America/Los_Angeles","America/Dawson|America/Tijuana","America/Dawson|America/Vancouver","America/Dawson|America/Whitehorse","America/Dawson|Canada/Pacific","America/Dawson|Canada/Yukon","America/Dawson|Mexico/BajaNorte","America/Dawson|PST8PDT","America/Dawson|US/Pacific","America/Dawson|US/Pacific-New","America/Detroit|America/Fort_Wayne","America/Detroit|America/Indiana/Indianapolis","America/Detroit|America/Indiana/Marengo","America/Detroit|America/Indiana/Petersburg","America/Detroit|America/Indiana/Vevay","America/Detroit|America/Indiana/Vincennes","America/Detroit|America/Indiana/Winamac","America/Detroit|America/Indianapolis","America/Detroit|America/Iqaluit","America/Detroit|America/Kentucky/Louisville","America/Detroit|America/Kentucky/Monticello","America/Detroit|America/Louisville","America/Detroit|America/Montreal","America/Detroit|America/Nassau","America/Detroit|America/New_York","America/Detroit|America/Nipigon","America/Detroit|America/Pangnirtung","America/Detroit|America/Thunder_Bay","America/Detroit|America/Toronto","America/Detroit|Canada/Eastern","America/Detroit|EST5EDT","America/Detroit|US/East-Indiana","America/Detroit|US/Eastern","America/Detroit|US/Michigan","America/Eirunepe|America/Porto_Acre","America/Eirunepe|America/Rio_Branco","America/Eirunepe|Brazil/Acre","America/Glace_Bay|America/Halifax","America/Glace_Bay|America/Moncton","America/Glace_Bay|America/Thule","America/Glace_Bay|Atlantic/Bermuda","America/Glace_Bay|Canada/Atlantic","America/Havana|Cuba","America/Metlakatla|Pacific/Pitcairn","America/Noronha|Brazil/DeNoronha","America/Santiago|Antarctica/Palmer","America/Santiago|Chile/Continental","America/Sao_Paulo|Brazil/East","America/St_Johns|Canada/Newfoundland","Antarctica/McMurdo|Antarctica/South_Pole","Antarctica/McMurdo|NZ","Antarctica/McMurdo|Pacific/Auckland","Asia/Aden|Asia/Baghdad","Asia/Aden|Asia/Bahrain","Asia/Aden|Asia/Kuwait","Asia/Aden|Asia/Qatar","Asia/Aden|Asia/Riyadh","Asia/Aqtau|Asia/Aqtobe","Asia/Ashgabat|Asia/Ashkhabad","Asia/Bangkok|Asia/Ho_Chi_Minh","Asia/Bangkok|Asia/Phnom_Penh","Asia/Bangkok|Asia/Saigon","Asia/Bangkok|Asia/Vientiane","Asia/Calcutta|Asia/Colombo","Asia/Calcutta|Asia/Kolkata","Asia/Chongqing|Asia/Chungking","Asia/Chongqing|Asia/Harbin","Asia/Chongqing|Asia/Macao","Asia/Chongqing|Asia/Macau","Asia/Chongqing|Asia/Shanghai","Asia/Chongqing|Asia/Taipei","Asia/Chongqing|PRC","Asia/Chongqing|ROC","Asia/Dacca|Asia/Dhaka","Asia/Dubai|Asia/Muscat","Asia/Hong_Kong|Hongkong","Asia/Istanbul|Europe/Istanbul","Asia/Istanbul|Turkey","Asia/Jakarta|Asia/Pontianak","Asia/Jerusalem|Asia/Tel_Aviv","Asia/Jerusalem|Israel","Asia/Kashgar|Asia/Urumqi","Asia/Kathmandu|Asia/Katmandu","Asia/Kuala_Lumpur|Asia/Kuching","Asia/Makassar|Asia/Ujung_Pandang","Asia/Nicosia|EET","Asia/Nicosia|Europe/Athens","Asia/Nicosia|Europe/Bucharest","Asia/Nicosia|Europe/Chisinau","Asia/Nicosia|Europe/Helsinki","Asia/Nicosia|Europe/Kiev","Asia/Nicosia|Europe/Mariehamn","Asia/Nicosia|Europe/Nicosia","Asia/Nicosia|Europe/Riga","Asia/Nicosia|Europe/Sofia","Asia/Nicosia|Europe/Tallinn","Asia/Nicosia|Europe/Tiraspol","Asia/Nicosia|Europe/Uzhgorod","Asia/Nicosia|Europe/Vilnius","Asia/Nicosia|Europe/Zaporozhye","Asia/Pyongyang|Asia/Seoul","Asia/Pyongyang|ROK","Asia/Samarkand|Asia/Tashkent","Asia/Singapore|Singapore","Asia/Tehran|Iran","Asia/Thimbu|Asia/Thimphu","Asia/Tokyo|Japan","Asia/Ulaanbaatar|Asia/Ulan_Bator","Atlantic/Canary|Atlantic/Faeroe","Atlantic/Canary|Atlantic/Faroe","Atlantic/Canary|Atlantic/Madeira","Atlantic/Canary|Europe/Lisbon","Atlantic/Canary|Portugal","Atlantic/Canary|WET","Australia/ACT|Australia/Canberra","Australia/ACT|Australia/Currie","Australia/ACT|Australia/Hobart","Australia/ACT|Australia/Melbourne","Australia/ACT|Australia/NSW","Australia/ACT|Australia/Sydney","Australia/ACT|Australia/Tasmania","Australia/ACT|Australia/Victoria","Australia/Adelaide|Australia/Broken_Hill","Australia/Adelaide|Australia/South","Australia/Adelaide|Australia/Yancowinna","Australia/Brisbane|Australia/Lindeman","Australia/Brisbane|Australia/Queensland","Australia/Darwin|Australia/North","Australia/LHI|Australia/Lord_Howe","Australia/Perth|Australia/West","Chile/EasterIsland|Pacific/Easter","Eire|Europe/Dublin","Etc/UCT|UCT","Etc/UTC|Etc/Universal","Etc/UTC|Etc/Zulu","Etc/UTC|UTC","Etc/UTC|Universal","Etc/UTC|Zulu","Europe/Belfast|Europe/Guernsey","Europe/Belfast|Europe/Isle_of_Man","Europe/Belfast|Europe/Jersey","Europe/Belfast|Europe/London","Europe/Belfast|GB","Europe/Belfast|GB-Eire","Europe/Moscow|W-SU","HST|Pacific/Honolulu","HST|Pacific/Johnston","HST|US/Hawaii","Kwajalein|Pacific/Kwajalein","Kwajalein|Pacific/Majuro","NZ-CHAT|Pacific/Chatham","Pacific/Chuuk|Pacific/Truk","Pacific/Chuuk|Pacific/Yap","Pacific/Guam|Pacific/Saipan","Pacific/Midway|Pacific/Pago_Pago","Pacific/Midway|Pacific/Samoa","Pacific/Midway|US/Samoa","Pacific/Pohnpei|Pacific/Ponape"]}),t}),function(t){function e(t,i){return new e.prototype.init(t,i)}Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;return function(){return e.apply(t)}});var i=0;t.fn.redactor=function(i){var n=[],r=Array.prototype.slice.call(arguments,1);return this.each("string"==typeof i?function(){var e,s=t.data(this,"redactor");if("-1"!=i.search(/\./)?(e=i.split("."),"undefined"!=typeof s[e[0]]&&(e=s[e[0]][e[1]])):e=s[i],"undefined"!=typeof s&&t.isFunction(e)){var o=e.apply(s,r);void 0!==o&&o!==s&&n.push(o)}else t.error('No such method "'+i+'" for Redactor')}:function(){t.data(this,"redactor",{}),t.data(this,"redactor",e(this,i))}),0===n.length?this:1===n.length?n[0]:n},t.Redactor=e,t.Redactor.VERSION="10.2.2",t.Redactor.modules=["alignment","autosave","block","buffer","build","button","caret","clean","code","core","dropdown","file","focus","image","indent","inline","insert","keydown","keyup","lang","line","link","linkify","list","modal","observe","paragraphize","paste","placeholder","progress","selection","shortcuts","tabifier","tidy","toolbar","upload","utils"],t.Redactor.opts={lang:"en",direction:"ltr",plugins:!1,focus:!1,focusEnd:!1,placeholder:!1,visual:!0,tabindex:!1,minHeight:!1,maxHeight:!1,linebreaks:!1,replaceDivs:!0,paragraphize:!0,cleanStyleOnEnter:!1,enterKey:!0,cleanOnPaste:!0,cleanSpaces:!0,pastePlainText:!1,autosave:!1,autosaveName:!1,autosaveInterval:60,autosaveOnChange:!1,autosaveFields:!1,linkTooltip:!0,linkProtocol:"http",linkNofollow:!1,linkSize:50,imageEditable:!0,imageLink:!0,imagePosition:!0,imageFloatMargin:"10px",imageResizable:!0,imageUpload:null,imageUploadParam:"file",uploadImageField:!1,dragImageUpload:!0,fileUpload:null,fileUploadParam:"file",dragFileUpload:!0,s3:!1,convertLinks:!0,convertUrlLinks:!0,convertImageLinks:!0,convertVideoLinks:!0,preSpaces:4,tabAsSpaces:!1,tabKey:!0,scrollTarget:!1,toolbar:!0,toolbarFixed:!0,toolbarFixedTarget:document,toolbarFixedTopOffset:0,toolbarExternal:!1,toolbarOverflow:!1,source:!0,buttons:["html","formatting","bold","italic","deleted","unorderedlist","orderedlist","outdent","indent","image","file","link","alignment","horizontalrule"],buttonsHide:[],buttonsHideOnMobile:[],formatting:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],formattingAdd:!1,tabifier:!0,deniedTags:["script","style"],allowedTags:!1,paragraphizeBlocks:["table","div","pre","form","ul","ol","h1","h2","h3","h4","h5","h6","dl","blockquote","figcaption","address","section","header","footer","aside","article","object","style","script","iframe","select","input","textarea","button","option","map","area","math","hr","fieldset","legend","hgroup","nav","figure","details","menu","summary","p"],removeComments:!1,replaceTags:[["strike","del"],["b","strong"]],replaceStyles:[["font-weight:\\s?bold","strong"],["font-style:\\s?italic","em"],["text-decoration:\\s?underline","u"],["text-decoration:\\s?line-through","del"]],removeDataAttr:!1,removeAttr:!1,allowedAttr:!1,removeWithoutAttr:["span"],removeEmpty:["p"],activeButtons:["deleted","italic","bold","underline","unorderedlist","orderedlist","alignleft","aligncenter","alignright","justify"],activeButtonsStates:{b:"bold",strong:"bold",i:"italic",em:"italic",del:"deleted",strike:"deleted",ul:"unorderedlist",ol:"orderedlist",u:"underline"},shortcuts:{"ctrl+shift+m, meta+shift+m":{func:"inline.removeFormat"},"ctrl+b, meta+b":{func:"inline.format",params:["bold"]},"ctrl+i, meta+i":{func:"inline.format",params:["italic"]},"ctrl+h, meta+h":{func:"inline.format",params:["superscript"]},"ctrl+l, meta+l":{func:"inline.format",params:["subscript"]},"ctrl+k, meta+k":{func:"link.show"},"ctrl+shift+7":{func:"list.toggle",params:["orderedlist"]},"ctrl+shift+8":{func:"list.toggle",params:["unorderedlist"]}},shortcutsAdd:!1,buffer:[],rebuffer:[],emptyHtml:"<p>&#x200b;</p>",invisibleSpace:"&#x200b;",imageTypes:["image/png","image/jpeg","image/gif"],indentValue:20,verifiedTags:["a","img","b","strong","sub","sup","i","em","u","small","strike","del","cite","ul","ol","li"],inlineTags:["strong","b","u","em","i","code","del","ins","samp","kbd","sup","sub","mark","var","cite","small"],alignmentTags:["P","H1","H2","H3","H4","H5","H6","DL","DT","DD","DIV","TD","BLOCKQUOTE","OUTPUT","FIGCAPTION","ADDRESS","SECTION","HEADER","FOOTER","ASIDE","ARTICLE"],blockLevelElements:["PRE","UL","OL","LI"],highContrast:!1,observe:{dropdowns:[]},langs:{en:{html:"HTML",video:"Insert Video",image:"Insert Image",table:"Table",link:"Link",link_insert:"Insert link",link_edit:"Edit link",unlink:"Unlink",formatting:"Formatting",paragraph:"Normal text",quote:"Quote",code:"Code",header1:"Header 1",header2:"Header 2",header3:"Header 3",header4:"Header 4",header5:"Header 5",bold:"Bold",italic:"Italic",fontcolor:"Font Color",backcolor:"Back Color",unorderedlist:"Unordered List",orderedlist:"Ordered List",outdent:"Outdent",indent:"Indent",cancel:"Cancel",insert:"Insert",save:"Save",_delete:"Delete",insert_table:"Insert Table",insert_row_above:"Add Row Above",insert_row_below:"Add Row Below",insert_column_left:"Add Column Left",insert_column_right:"Add Column Right",delete_column:"Delete Column",delete_row:"Delete Row",delete_table:"Delete Table",rows:"Rows",columns:"Columns",add_head:"Add Head",delete_head:"Delete Head",title:"Title",image_position:"Position",none:"None",left:"Left",right:"Right",center:"Center",image_web_link:"Image Web Link",text:"Text",mailto:"Email",web:"URL",video_html_code:"Video Embed Code or Youtube/Vimeo Link",file:"Insert File",upload:"Upload",download:"Download",choose:"Choose",or_choose:"Or choose",drop_file_here:"Drop file here",align_left:"Align text to the left",align_center:"Center text",align_right:"Align text to the right",align_justify:"Justify text",horizontalrule:"Insert Horizontal Rule",deleted:"Deleted",anchor:"Anchor",link_new_tab:"Open link in new tab",underline:"Underline",alignment:"Alignment",filename:"Name (optional)",edit:"Edit",upload_label:"Drop file here or "}},linkify:{regexps:{youtube:/https?:\/\/(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube\.com\S*[^\w\-\s])([\w\-]{11})(?=[^\w\-]|$)(?![?=&+%\w.\-]*(?:['"][^<>]*>|<\/a>))[?=&+%\w.-]*/gi,vimeo:/https?:\/\/(www\.)?vimeo.com\/(\d+)($|\/)/,image:/((https?|www)[^\s]+\.)(jpe?g|png|gif)(\?[^\s-]+)?/gi,url:/(https?:\/\/(?:www\.|(?!www))[^\s\.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/gi}},codemirror:!1},e.fn=t.Redactor.prototype={keyCode:{BACKSPACE:8,DELETE:46,UP:38,DOWN:40,ENTER:13,SPACE:32,ESC:27,TAB:9,CTRL:17,META:91,SHIFT:16,ALT:18,RIGHT:39,LEFT:37,LEFT_WIN:91},init:function(e,n){if(this.$element=t(e),this.uuid=i++,this.rtePaste=!1,this.$pasteBox=!1,this.loadOptions(n),this.loadModules(),this.formatting={},t.merge(this.opts.blockLevelElements,this.opts.alignmentTags),this.reIsBlock=new RegExp("^("+this.opts.blockLevelElements.join("|")+")$","i"),this.tidy.setupAllowed(),this.opts.deniedTags!==!1)for(var r=["html","head","link","body","meta","applet"],s=0;s<r.length;s++)this.opts.deniedTags.push(r[s]);
this.lang.load(),t.extend(this.opts.shortcuts,this.opts.shortcutsAdd),this.core.setCallback("start"),this.start=!0,this.build.run()},loadOptions:function(e){this.opts=t.extend({},t.extend(!0,{},t.Redactor.opts),this.$element.data(),e)},getModuleMethods:function(t){return Object.getOwnPropertyNames(t).filter(function(e){return"function"==typeof t[e]})},loadModules:function(){for(var e=t.Redactor.modules.length,i=0;e>i;i++)this.bindModuleMethods(t.Redactor.modules[i])},bindModuleMethods:function(t){if("undefined"!=typeof this[t]){this[t]=this[t]();for(var e=this.getModuleMethods(this[t]),i=e.length,n=0;i>n;n++)this[t][e[n]]=this[t][e[n]].bind(this)}},alignment:function(){return{left:function(){this.alignment.set("")},right:function(){this.alignment.set("right")},center:function(){this.alignment.set("center")},justify:function(){this.alignment.set("justify")},set:function(t){this.utils.browser("msie")||this.$editor.focus(),this.buffer.set(),this.selection.save(),this.alignment.blocks=this.selection.getBlocks(),this.alignment.type=t,this.alignment.isLinebreaksOrNoBlocks()?this.alignment.setText():this.alignment.setBlocks(),this.selection.restore(),this.code.sync()},setText:function(){var e=this.selection.wrap("div");t(e).attr("data-tagblock","redactor").css("text-align",this.alignment.type)},setBlocks:function(){t.each(this.alignment.blocks,t.proxy(function(t,e){var i=this.utils.getAlignmentElement(e);i&&(this.alignment.isNeedReplaceElement(i)?this.alignment.replaceElement(i):this.alignment.alignElement(i))},this))},isLinebreaksOrNoBlocks:function(){return this.opts.linebreaks&&this.alignment.blocks[0]===!1},isNeedReplaceElement:function(t){return""===this.alignment.type&&"undefined"!=typeof t.data("tagblock")},replaceElement:function(t){t.replaceWith(t.html())},alignElement:function(t){t.css("text-align",this.alignment.type),this.utils.removeEmptyAttr(t,"style")}}},autosave:function(){return{html:!1,enable:function(){this.opts.autosave&&(this.autosave.name=this.opts.autosaveName?this.opts.autosaveName:this.$textarea.attr("name"),this.opts.autosaveOnChange||(this.autosaveInterval=setInterval(this.autosave.load,1e3*this.opts.autosaveInterval)))},onChange:function(){this.opts.autosaveOnChange&&this.autosave.load()},load:function(){if(this.autosave.source=this.code.get(),this.autosave.html!==this.autosave.source){var e={};e.name=this.autosave.name,e[this.autosave.name]=this.autosave.source,e=this.autosave.getHiddenFields(e);var i=t.ajax({url:this.opts.autosave,type:"post",data:e});i.done(this.autosave.success)}},getHiddenFields:function(e){return this.opts.autosaveFields===!1||"object"!=typeof this.opts.autosaveFields?e:(t.each(this.opts.autosaveFields,t.proxy(function(i,n){null!==n&&0===n.toString().indexOf("#")&&(n=t(n).val()),e[i]=n},this)),e)},success:function(e){var i;try{i=t.parseJSON(e)}catch(n){i=e}var r="undefined"==typeof i.error?"autosave":"autosaveError";this.core.setCallback(r,this.autosave.name,i),this.autosave.html=this.autosave.source},disable:function(){clearInterval(this.autosaveInterval)}}},block:function(){return{formatting:function(t){this.block.clearStyle=!1;var e,i;"undefined"!=typeof this.formatting[t].data?e="data":"undefined"!=typeof this.formatting[t].attr?e="attr":"undefined"!=typeof this.formatting[t]["class"]&&(e="class"),"undefined"!=typeof this.formatting[t].clear&&(this.block.clearStyle=!0),e&&(i=this.formatting[t][e]),this.block.format(this.formatting[t].tag,e,i)},format:function(e,i,n){"quote"==e&&(e="blockquote");var r=["p","pre","blockquote","h1","h2","h3","h4","h5","h6"];if(-1!=t.inArray(e,r)){this.block.isRemoveInline="pre"==e||-1!=e.search(/h[1-6]/i),this.utils.browser("msie")||this.$editor.focus();var s=t.trim(this.$editor.html());if(this.block.isEmpty=this.utils.isEmpty(s),this.utils.browser("mozilla")&&!this.focus.isFocused()&&this.block.isEmpty){var o;this.opts.linebreaks||(o=this.$editor.children().first(),this.caret.setEnd(o))}this.block.blocks=this.selection.getBlocks(),this.block.blocksSize=this.block.blocks.length,this.block.type=i,this.block.value=n,this.buffer.set(),this.selection.save(),this.block.set(e),this.selection.restore(),this.code.sync(),this.observe.load()}},set:function(t){this.selection.get(),this.block.containerTag=this.range.commonAncestorContainer.tagName,this.range.collapsed?this.block.setCollapsed(t):this.block.setMultiple(t)},setCollapsed:function(e){if(this.opts.linebreaks&&this.block.isEmpty&&"p"!=e){var i=document.createElement(e);return this.$editor.html(i),void this.caret.setEnd(i)}var n=this.block.blocks[0];if(n!==!1){if("LI"==n.tagName){if("blockquote"!=e)return;return void this.block.formatListToBlockquote()}var r="TD"==this.block.containerTag||"TH"==this.block.containerTag;if(r&&!this.opts.linebreaks)document.execCommand("formatblock",!1,"<"+e+">"),n=this.selection.getBlock(),this.block.toggle(t(n));else if(n.tagName.toLowerCase()!=e)if(this.opts.linebreaks&&"p"==e)t(n).append("<br>"),this.utils.replaceWithContents(n);else{var s=this.utils.replaceToTag(n,e);this.block.toggle(s),"p"!=e&&"blockquote"!=e&&s.find("img").remove(),this.block.isRemoveInline&&this.utils.removeInlineTags(s),("p"==e||this.block.headTag)&&s.find("p").contents().unwrap(),this.block.formatTableWrapping(s)}else if("blockquote"==e&&n.tagName.toLowerCase()==e)if(this.opts.linebreaks)t(n).append("<br>"),this.utils.replaceWithContents(n);else{var o=this.utils.replaceToTag(n,"p");this.block.toggle(o)}else n.tagName.toLowerCase()==e&&this.block.toggle(t(n));"undefined"==typeof this.block.type&&"undefined"==typeof this.block.value&&t(n).removeAttr("class").removeAttr("style")}},setMultiple:function(e){var i=this.block.blocks[0],n="TD"==this.block.containerTag||"TH"==this.block.containerTag;if(i!==!1&&1===this.block.blocksSize)if(i.tagName.toLowerCase()==e&&"blockquote"==e)if(this.opts.linebreaks)t(i).append("<br>"),this.utils.replaceWithContents(i);else{var r=this.utils.replaceToTag(i,"p");this.block.toggle(r)}else if("LI"==i.tagName){if("blockquote"!=e)return;this.block.formatListToBlockquote()}else if("BLOCKQUOTE"==this.block.containerTag)this.block.formatBlockquote(e);else if(this.opts.linebreaks&&(n||this.range.commonAncestorContainer!=i))this.block.formatWrap(e);else if(this.opts.linebreaks&&"p"==e)t(i).prepend("<br>").append("<br>"),this.utils.replaceWithContents(i);else if("TD"===i.tagName)this.block.formatWrap(e);else{var s=this.utils.replaceToTag(i,e);this.block.toggle(s),this.block.isRemoveInline&&this.utils.removeInlineTags(s),("p"==e||this.block.headTag)&&s.find("p").contents().unwrap()}else if(this.opts.linebreaks||"p"!=e){if("blockquote"==e){for(var o=0,a=0;a<this.block.blocksSize;a++)"BLOCKQUOTE"==this.block.blocks[a].tagName&&o++;if(o==this.block.blocksSize)return void t.each(this.block.blocks,t.proxy(function(e,i){var n=!1;this.opts.linebreaks?(t(i).prepend("<br>").append("<br>"),n=this.utils.replaceWithContents(i)):n=this.utils.replaceToTag(i,"p"),n&&"undefined"==typeof this.block.type&&"undefined"==typeof this.block.value&&n.removeAttr("class").removeAttr("style")},this))}this.block.formatWrap(e)}else{var l=0,c=!1;"class"==this.block.type&&(c="toggle",l=t(this.block.blocks).filter("."+this.block.value).length,this.block.blocksSize==l?c="toggle":this.block.blocksSize>l?c="set":0===l&&(c="set"));var u=["ul","ol","li","td","th","dl","dt","dd"];t.each(this.block.blocks,t.proxy(function(i,n){if(-1==t.inArray(n.tagName.toLowerCase(),u)){var r=this.utils.replaceToTag(n,e);c?"toggle"==c?this.block.toggle(r):"remove"==c?this.block.remove(r):"set"==c&&this.block.setForce(r):this.block.toggle(r),"p"!=e&&"blockquote"!=e&&r.find("img").remove(),this.block.isRemoveInline&&this.utils.removeInlineTags(r),("p"==e||this.block.headTag)&&r.find("p").contents().unwrap(),"undefined"==typeof this.block.type&&"undefined"==typeof this.block.value&&r.removeAttr("class").removeAttr("style")}},this))}},setForce:function(t){return this.block.clearStyle&&t.removeAttr("class").removeAttr("style"),"class"==this.block.type?void t.addClass(this.block.value):"attr"==this.block.type||"data"==this.block.type?void t.attr(this.block.value.name,this.block.value.value):void 0},toggle:function(t){return this.block.clearStyle&&t.removeAttr("class").removeAttr("style"),"class"==this.block.type?void t.toggleClass(this.block.value):"attr"==this.block.type||"data"==this.block.type?void(t.attr(this.block.value.name)==this.block.value.value?t.removeAttr(this.block.value.name):t.attr(this.block.value.name,this.block.value.value)):void t.removeAttr("style class")},remove:function(t){t.removeClass(this.block.value)},formatListToBlockquote:function(){var e=t(this.block.blocks[0]).closest("ul, ol",this.$editor[0]);t(e).find("ul, ol").contents().unwrap(),t(e).find("li").append(t("<br>")).contents().unwrap();var i=this.utils.replaceToTag(e,"blockquote");this.block.toggle(i)},formatBlockquote:function(e){document.execCommand("outdent"),document.execCommand("formatblock",!1,e),this.clean.clearUnverified(),this.$editor.find("p:empty").remove();var i=this.selection.getBlock();"p"!=e&&t(i).find("img").remove(),this.opts.linebreaks||this.block.toggle(t(i)),this.$editor.find("ul, ol, tr, blockquote, p").each(t.proxy(this.utils.removeEmpty,this)),this.opts.linebreaks&&"p"==e&&this.utils.replaceWithContents(i)},formatWrap:function(e){if("UL"==this.block.containerTag||"OL"==this.block.containerTag){if("blockquote"!=e)return;this.block.formatListToBlockquote()}var i=this.selection.wrap(e);if(i!==!1){var n=t(i);this.block.formatTableWrapping(n);var r=n.find(this.opts.blockLevelElements.join(",")+", td, table, thead, tbody, tfoot, th, tr");if(r.contents().unwrap(),"p"!=e&&"blockquote"!=e&&n.find("img").remove(),t.each(this.block.blocks,t.proxy(this.utils.removeEmpty,this)),n.append(this.selection.getMarker(2)),this.opts.linebreaks||this.block.toggle(n),this.$editor.find("ul, ol, tr, blockquote, p").each(t.proxy(this.utils.removeEmpty,this)),n.find("blockquote:empty").remove(),this.block.isRemoveInline&&this.utils.removeInlineTags(n),this.opts.linebreaks&&"p"==e&&this.utils.replaceWithContents(n),this.opts.linebreaks){var s=n.next().next();0!=s.size()&&"BR"===s[0].tagName&&s.remove()}}},formatTableWrapping:function(t){0!==t.closest("table",this.$editor[0]).length&&(0===t.closest("tr",this.$editor[0]).length&&t.wrap("<tr>"),0===t.closest("td",this.$editor[0]).length&&0===t.closest("th").length&&t.wrap("<td>"))},removeData:function(e){var i=this.selection.getBlocks();t(i).removeAttr("data-"+e),this.code.sync()},setData:function(e,i){var n=this.selection.getBlocks();t(n).attr("data-"+e,i),this.code.sync()},toggleData:function(e,i){var n=this.selection.getBlocks();t.each(n,function(){t(this).attr("data-"+e)?t(this).removeAttr("data-"+e):t(this).attr("data-"+e,i)})},removeAttr:function(e){var i=this.selection.getBlocks();t(i).removeAttr(e),this.code.sync()},setAttr:function(e,i){var n=this.selection.getBlocks();t(n).attr(e,i),this.code.sync()},toggleAttr:function(e,i){var n=this.selection.getBlocks();t.each(n,function(){t(this).attr(name)?t(this).removeAttr(name):t(this).attr(name,i)})},removeClass:function(e){var i=this.selection.getBlocks();t(i).removeClass(e),this.utils.removeEmptyAttr(i,"class"),this.code.sync()},setClass:function(e){var i=this.selection.getBlocks();t(i).addClass(e),this.code.sync()},toggleClass:function(e){var i=this.selection.getBlocks();t(i).toggleClass(e),this.code.sync()}}},buffer:function(){return{set:function(t){"undefined"==typeof t||"undo"==t?this.buffer.setUndo():this.buffer.setRedo()},setUndo:function(){this.selection.save(),this.opts.buffer.push(this.$editor.html()),this.selection.restore()},setRedo:function(){this.selection.save(),this.opts.rebuffer.push(this.$editor.html()),this.selection.restore()},getUndo:function(){this.$editor.html(this.opts.buffer.pop())},getRedo:function(){this.$editor.html(this.opts.rebuffer.pop())},add:function(){this.opts.buffer.push(this.$editor.html())},undo:function(){0!==this.opts.buffer.length&&(this.buffer.set("redo"),this.buffer.getUndo(),this.selection.restore(),setTimeout(t.proxy(this.observe.load,this),50))},redo:function(){0!==this.opts.rebuffer.length&&(this.buffer.set("undo"),this.buffer.getRedo(),this.selection.restore(),setTimeout(t.proxy(this.observe.load,this),50))}}},build:function(){return{run:function(){this.build.createContainerBox(),this.build.loadContent(),this.build.loadEditor(),this.build.enableEditor(),this.build.setCodeAndCall()},isTextarea:function(){return"TEXTAREA"===this.$element[0].tagName},createContainerBox:function(){this.$box=t('<div class="redactor-box" role="application" />')},createTextarea:function(){this.$textarea=t("<textarea />").attr("name",this.build.getTextareaName())},getTextareaName:function(){return"undefined"==typeof name?"content-"+this.uuid:this.$element.attr("id")},loadContent:function(){var e=this.build.isTextarea()?"val":"html";this.content=t.trim(this.$element[e]())},enableEditor:function(){this.$editor.attr({contenteditable:!0,dir:this.opts.direction})},loadEditor:function(){var t=this.build.isTextarea()?"fromTextarea":"fromElement";this.build[t]()},fromTextarea:function(){this.$editor=t("<div />"),this.$textarea=this.$element,this.$box.insertAfter(this.$element).append(this.$editor).append(this.$element),this.$editor.addClass("redactor-editor"),this.$element.hide()},fromElement:function(){this.$editor=this.$element,this.build.createTextarea(),this.$box.insertAfter(this.$editor).append(this.$editor).append(this.$textarea),this.$editor.addClass("redactor-editor"),this.$textarea.hide()},setCodeAndCall:function(){this.code.set(this.content),this.build.setOptions(),this.build.callEditor(),this.opts.visual||setTimeout(t.proxy(this.code.showCode,this),200)},callEditor:function(){this.build.disableMozillaEditing(),this.build.disableIeLinks(),this.build.setEvents(),this.build.setHelpers(),this.opts.toolbar&&(this.opts.toolbar=this.toolbar.init(),this.toolbar.build()),this.modal.loadTemplates(),this.build.plugins(),setTimeout(t.proxy(this.observe.load,this),4),this.core.setCallback("init")},setOptions:function(){t(this.$textarea).attr("dir",this.opts.direction),this.opts.linebreaks&&this.$editor.addClass("redactor-linebreaks"),this.opts.tabindex&&this.$editor.attr("tabindex",this.opts.tabindex),this.opts.minHeight&&this.$editor.css("minHeight",this.opts.minHeight),this.opts.maxHeight&&this.$editor.css("maxHeight",this.opts.maxHeight)},setEventDropUpload:function(t){if(t.preventDefault(),this.opts.dragImageUpload&&this.opts.dragFileUpload){var e=t.dataTransfer.files;this.upload.directUpload(e[0],t)}},setEventDrop:function(t){this.code.sync(),setTimeout(this.clean.clearUnverified,1),this.core.setCallback("drop",t)},setEvents:function(){this.$editor.on("drop.redactor",t.proxy(function(t){return t=t.originalEvent||t,void 0!==window.FormData&&t.dataTransfer?0===t.dataTransfer.files.length?this.build.setEventDrop(t):(this.build.setEventDropUpload(t),setTimeout(this.clean.clearUnverified,1),void this.core.setCallback("drop",t)):!0},this)),this.$editor.on("click.redactor",t.proxy(function(t){var e=this.core.getEvent(),i="click"==e||"arrow"==e?!1:"click";this.core.addEvent(i),this.utils.disableSelectAll(),this.core.setCallback("click",t)},this)),this.$editor.on("paste.redactor",t.proxy(this.paste.init,this)),this.$editor.on("cut.redactor",t.proxy(this.code.sync,this)),this.$editor.on("keydown.redactor",t.proxy(this.keydown.init,this)),this.$editor.on("keyup.redactor",t.proxy(this.keyup.init,this)),t.isFunction(this.opts.codeKeydownCallback)&&this.$textarea.on("keydown.redactor-textarea",t.proxy(this.opts.codeKeydownCallback,this)),t.isFunction(this.opts.codeKeyupCallback)&&this.$textarea.on("keyup.redactor-textarea",t.proxy(this.opts.codeKeyupCallback,this)),t.isFunction(this.opts.focusCallback)&&this.$editor.on("focus.redactor",t.proxy(this.opts.focusCallback,this)),t(document).on("mousedown.redactor."+this.uuid,t.proxy(function(t){this.blurClickedElement=t.target},this)),this.$editor.on("blur.redactor",t.proxy(function(e){this.start||this.rtePaste||this.build.isBlured()&&(this.utils.disableSelectAll(),t.isFunction(this.opts.blurCallback)&&this.core.setCallback("blur",e))},this))},isBlured:function(){if(this.blurClickedElement===!0)return!0;var e=t(this.blurClickedElement);return!e.hasClass("redactor-toolbar, redactor-dropdown")&&!e.is("#redactor-modal")&&0===e.parents(".redactor-toolbar, .redactor-dropdown, #redactor-modal").length},setHelpers:function(){this.linkify.isEnabled()&&this.linkify.format(),this.placeholder.enable(),this.opts.focus&&setTimeout(this.focus.setStart,100),this.opts.focusEnd&&setTimeout(this.focus.setEnd,100)},plugins:function(){this.opts.plugins&&t.each(this.opts.plugins,t.proxy(function(i,n){var r="undefined"!=typeof RedactorPlugins&&"undefined"!=typeof RedactorPlugins[n]?RedactorPlugins:e.fn;if(t.isFunction(r[n])){this[n]=r[n]();for(var s=this.getModuleMethods(this[n]),o=s.length,a=0;o>a;a++)this[n][s[a]]=this[n][s[a]].bind(this);t.isFunction(this[n].init)&&this[n].init()}},this))},disableMozillaEditing:function(){if(this.utils.browser("mozilla"))try{document.execCommand("enableObjectResizing",!1,!1),document.execCommand("enableInlineTableEditing",!1,!1)}catch(t){}},disableIeLinks:function(){this.utils.browser("msie")&&document.execCommand("AutoUrlDetect",!1,!1)}}},button:function(){return{build:function(e,i){var n=t('<a href="#" class="re-icon re-'+e+'" rel="'+e+'" />').attr({role:"button","aria-label":i.title,tabindex:"-1"});if((i.func||i.command||i.dropdown)&&this.button.setEvent(n,e,i),i.dropdown){n.addClass("redactor-toolbar-link-dropdown").attr("aria-haspopup",!0);var r=t('<div class="redactor-dropdown redactor-dropdown-'+this.uuid+" redactor-dropdown-box-"+e+'" style="display: none;">');n.data("dropdown",r),this.dropdown.build(e,r,i.dropdown)}return this.utils.isDesktop()&&this.button.createTooltip(n,e,i.title),n},setEvent:function(e,i,n){e.on("touchstart click",t.proxy(function(t){if(e.hasClass("redactor-button-disabled"))return!1;var r="func",s=n.func;n.command?(r="command",s=n.command):n.dropdown&&(r="dropdown",s=!1),this.button.onClick(t,i,r,s)},this))},createTooltip:function(e,i,n){var r=t("<span>").addClass("redactor-toolbar-tooltip redactor-toolbar-tooltip-"+this.uuid+" redactor-toolbar-tooltip-"+i).hide().html(n);r.appendTo("body"),e.on("mouseover",function(){if(!t(this).hasClass("redactor-button-disabled")){var i=e.offset();r.show(),r.css({top:i.top+e.innerHeight()+"px",left:i.left+e.innerWidth()/2-r.innerWidth()/2+"px"})}}),e.on("mouseout",function(){r.hide()})},onClick:function(t,e,i,n){this.button.caretOffset=this.caret.getOffset(),t.preventDefault(),this.utils.browser("msie")&&(t.returnValue=!1),"command"==i?this.inline.format(n):"dropdown"==i?this.dropdown.show(t,e):this.button.onClickCallback(t,n,e)},onClickCallback:function(e,i,n){var r;if(this.blurClickedElement=!0,t.isFunction(i))i.call(this,n);else if("-1"!=i.search(/\./)){if(r=i.split("."),"undefined"==typeof this[r[0]])return;this[r[0]][r[1]](n)}else this[i](n);this.observe.buttons(e,n)},get:function(t){return this.$toolbar.find("a.re-"+t)},setActive:function(t){this.button.get(t).addClass("redactor-act")},setInactive:function(t){this.button.get(t).removeClass("redactor-act")},setInactiveAll:function(t){"undefined"==typeof t?this.$toolbar.find("a.re-icon").removeClass("redactor-act"):this.$toolbar.find("a.re-icon").not(".re-"+t).removeClass("redactor-act")},setActiveInVisual:function(){this.$toolbar.find("a.re-icon").not("a.re-html, a.re-fullscreen").removeClass("redactor-button-disabled")},setInactiveInCode:function(){this.$toolbar.find("a.re-icon").not("a.re-html, a.re-fullscreen").addClass("redactor-button-disabled")},changeIcon:function(t,e){this.button.get(t).addClass("re-"+e)},removeIcon:function(t,e){this.button.get(t).removeClass("re-"+e)},setAwesome:function(t,e){var i=this.button.get(t);i.removeClass("redactor-btn-image").addClass("fa-redactor-btn"),i.html('<i class="fa '+e+'"></i>')},addCallback:function(e,i){if("buffer"!=e){var n="dropdown"==i?"dropdown":"func",r=e.attr("rel");e.on("touchstart click",t.proxy(function(t){return e.hasClass("redactor-button-disabled")?!1:void this.button.onClick(t,r,n,i)},this))}},addDropdown:function(e,i){e.addClass("redactor-toolbar-link-dropdown").attr("aria-haspopup",!0);var n=e.attr("rel");this.button.addCallback(e,"dropdown");var r=t('<div class="redactor-dropdown redactor-dropdown-'+this.uuid+" redactor-dropdown-box-"+n+'" style="display: none;">');return e.data("dropdown",r),i&&this.dropdown.build(n,r,i),r},add:function(e,i){if(this.opts.toolbar){if(this.button.isMobileUndoRedo(e))return"buffer";var n=this.button.build(e,{title:i});return n.addClass("redactor-btn-image"),this.$toolbar.append(t("<li>").append(n)),n}},addFirst:function(e,i){if(this.opts.toolbar){if(this.button.isMobileUndoRedo(e))return"buffer";var n=this.button.build(e,{title:i});return n.addClass("redactor-btn-image"),this.$toolbar.prepend(t("<li>").append(n)),n}},addAfter:function(e,i,n){if(this.opts.toolbar){if(this.button.isMobileUndoRedo(i))return"buffer";var r=this.button.build(i,{title:n});r.addClass("redactor-btn-image");var s=this.button.get(e);return 0!==s.length?s.parent().after(t("<li>").append(r)):this.$toolbar.append(t("<li>").append(r)),r}},addBefore:function(e,i,n){if(this.opts.toolbar){if(this.button.isMobileUndoRedo(i))return"buffer";var r=this.button.build(i,{title:n});r.addClass("redactor-btn-image");var s=this.button.get(e);return 0!==s.length?s.parent().before(t("<li>").append(r)):this.$toolbar.append(t("<li>").append(r)),r}},remove:function(t){this.button.get(t).remove()},isMobileUndoRedo:function(t){return("undo"==t||"redo"==t)&&!this.utils.isDesktop()}}},caret:function(){return{setStart:function(e){if(this.utils.isBlock(e))this.caret.set(e,0,e,0);else{var i=this.utils.createSpaceElement();t(e).prepend(i),this.caret.setEnd(i)}},setEnd:function(t){return t=t[0]||t,1==t.lastChild.nodeType?this.caret.setAfter(t.lastChild):void this.caret.set(t,1,t,1)},set:function(e,i,n,r){if(e=e[0]||e,n=n[0]||n,this.utils.isBlockTag(e.tagName)&&""===e.innerHTML&&(e.innerHTML=this.opts.invisibleSpace),"BR"==e.tagName&&this.opts.linebreaks===!1){var s=t(this.opts.emptyHtml)[0];t(e).replaceWith(s),e=s,n=e}this.selection.get();try{this.range.setStart(e,i),this.range.setEnd(n,r)}catch(o){}this.selection.addRange()},setAfter:function(e){try{var i=t(e)[0].tagName;if("BR"==i||this.utils.isBlock(e))"BR"!=i&&this.utils.browser("msie")?this.caret.setStart(t(e).next()):this.caret.setAfterOrBefore(e,"after");else{var n=this.utils.createSpaceElement();t(e).after(n),this.caret.setEnd(n)}}catch(r){var n=this.utils.createSpaceElement();t(e).after(n),this.caret.setEnd(n)}},setBefore:function(e){this.utils.isBlock(e)?this.caret.setEnd(t(e).prev()):this.caret.setAfterOrBefore(e,"before")},setAfterOrBefore:function(t,e){if(this.utils.browser("msie")||this.$editor.focus(),t=t[0]||t,this.selection.get(),"after"==e)try{this.range.setStartAfter(t),this.range.setEndAfter(t)}catch(i){}else try{this.range.setStartBefore(t),this.range.setEndBefore(t)}catch(i){}this.range.collapse(!1),this.selection.addRange()},getOffsetOfElement:function(e){e=e[0]||e,this.selection.get();var i=this.range.cloneRange();return i.selectNodeContents(e),i.setEnd(this.range.endContainer,this.range.endOffset),t.trim(i.toString()).length},getOffset:function(){var t=0,e=window.getSelection();if(e.rangeCount>0){var i=window.getSelection().getRangeAt(0),n=i.cloneRange();n.selectNodeContents(this.$editor[0]),n.setEnd(i.endContainer,i.endOffset),t=n.toString().length}return t},setOffset:function(t,e){"undefined"==typeof e&&(e=t),this.focus.isFocused()||this.focus.setStart();for(var i,n=(this.selection.get(),0),r=document.createTreeWalker(this.$editor[0],NodeFilter.SHOW_TEXT,null,null);i==r.nextNode();)if(n+=i.nodeValue.length,n>t&&(this.range.setStart(i,i.nodeValue.length+t-n),t=1/0),n>=e){this.range.setEnd(i,i.nodeValue.length+e-n);break}this.range.collapse(!1),this.selection.addRange()},setToPoint:function(t,e){this.caret.setOffset(t,e)},getCoords:function(){return this.caret.getOffset()}}},clean:function(){return{onSet:function(e){e=e.replace(/<script(.*?[^>]?)>([\w\W]*?)<\/script>/gi,'<pre class="redactor-script-tag" style="display: none;" $1>$2</pre>'),e=e.replace(/\$/g,"&#36;"),e=e.replace(/<a href="(.*?[^>]?)(.*?[^>]?)">/gi,'<a href="$1&reg$2">'),this.opts.replaceDivs&&(e=this.clean.replaceDivs(e)),this.opts.linebreaks&&(e=this.clean.replaceParagraphsToBr(e)),e=this.clean.saveFormTags(e);var i=t("<div>");i.html(e);var n=i.find("font[style]");return 0!==n.length&&(n.replaceWith(function(){var e=t(this),i=t("<span>").attr("style",e.attr("style"));return i.append(e.contents())}),e=i.html()),i.remove(),e=e.replace(/<font(.*?[^<])>/gi,""),e=e.replace(/<\/font>/gi,""),e=this.tidy.load(e),this.opts.paragraphize&&(e=this.paragraphize.load(e)),e=this.clean.setVerified(e),e=this.clean.convertInline(e),e=e.replace(/&amp;/g,"&")},onSync:function(e){if(e=e.replace(/\u200B/g,""),e=e.replace(/&#x200b;/gi,""),this.opts.cleanSpaces&&(e=e.replace(/&nbsp;/gi," ")),-1!=e.search(/^<p>(||\s||<br\s?\/?>||&nbsp;)<\/p>$/i))return"";e=e.replace(/<pre class="redactor-script-tag" style="display: none;"(.*?[^>]?)>([\w\W]*?)<\/pre>/gi,"<script$1>$2</script>"),e=this.clean.restoreFormTags(e);var i={"":"&trade;","":"&copy;","":"&hellip;","":"&mdash;","":"&dash;"};t.each(i,function(t,i){e=e.replace(new RegExp(t,"g"),i)}),this.utils.browser("mozilla")&&(e=e.replace(/<br\s?\/?>$/gi,"")),e=e.replace(new RegExp("<br\\s?/?></li>","gi"),"</li>"),e=e.replace(new RegExp("</li><br\\s?/?>","gi"),"</li>"),e=e.replace(/<(.*?)rel="\s*?"(.*?[^>]?)>/gi,'<$1$2">'),e=e.replace(/<(.*?)style="\s*?"(.*?[^>]?)>/gi,'<$1$2">'),e=e.replace(/="">/gi,">"),e=e.replace(/""">/gi,'">'),e=e.replace(/"">/gi,'">'),e=e.replace(/<div(.*?[^>]) data-tagblock="redactor"(.*?[^>])>/gi,"<div$1$2>"),e=e.replace(/<(.*?) data-verified="redactor"(.*?[^>])>/gi,"<$1$2>");var n=t("<div/>").html(t.parseHTML(e,document,!0));return n.find("span").removeAttr("rel"),n.find("pre .redactor-invisible-space").each(function(){t(this).contents().unwrap()}),e=n.html(),e=e.replace(/<img(.*?[^>])rel="(.*?[^>])"(.*?[^>])>/gi,"<img$1$3>"),e=e.replace(/<span class="redactor-invisible-space">(.*?)<\/span>/gi,"$1"),e=e.replace(/ data-save-url="(.*?[^>])"/gi,""),e=e.replace(/<span(.*?)id="redactor-image-box"(.*?[^>])>([\w\W]*?)<img(.*?)><\/span>/gi,"$3<img$4>"),e=e.replace(/<span(.*?)id="redactor-image-resizer"(.*?[^>])>(.*?)<\/span>/gi,""),e=e.replace(/<span(.*?)id="redactor-image-editter"(.*?[^>])>(.*?)<\/span>/gi,""),e=e.replace(/<font(.*?[^<])>/gi,""),e=e.replace(/<\/font>/gi,""),e=this.tidy.load(e),this.opts.linkNofollow&&(e=e.replace(/<a(.*?)rel="nofollow"(.*?[^>])>/gi,"<a$1$2>"),e=e.replace(/<a(.*?[^>])>/gi,'<a$1 rel="nofollow">')),e=e.replace(/\sdata-redactor-(tag|class|style)="(.*?[^>])"/gi,""),e=e.replace(new RegExp('<(.*?) data-verified="redactor"(.*?[^>])>',"gi"),"<$1$2>"),e=e.replace(new RegExp('<(.*?) data-verified="redactor">',"gi"),"<$1>"),e=e.replace(/&amp;/g,"&")},onPaste:function(e,i){if(e=t.trim(e),e=e.replace(/\$/g,"&#36;"),e=e.replace(/<span class="s[0-9]">/gi,"<span>"),e=e.replace(/<span class="Apple-converted-space">&nbsp;<\/span>/gi," "),e=e.replace(/<span class="Apple-tab-span"[^>]*>\t<\/span>/gi,"	"),e=e.replace(/<span[^>]*>(\s|&nbsp;)<\/span>/gi," "),this.opts.pastePlainText)return this.clean.getPlainText(e);if(!this.utils.isSelectAll()&&"undefined"==typeof i){if(this.utils.isCurrentOrParent(["FIGCAPTION","A"]))return this.clean.getPlainText(e,!1);if(this.utils.isCurrentOrParent("PRE"))return e=e.replace(//g,'"'),e=e.replace(//g,'"'),e=e.replace(//g,"'"),e=e.replace(//g,"'"),this.clean.getPreCode(e);if(this.utils.isCurrentOrParent(["BLOCKQUOTE","H1","H2","H3","H4","H5","H6"])){if(e=this.clean.getOnlyImages(e),!this.utils.browser("msie")){var n=this.selection.getBlock();n&&"P"==n.tagName&&(e=e.replace(/<img(.*?)>/gi,"<p><img$1></p>"))}return e}if(this.utils.isCurrentOrParent(["TD"]))return e=this.clean.onPasteTidy(e,"td"),this.opts.linebreaks&&(e=this.clean.replaceParagraphsToBr(e)),e=this.clean.replaceDivsToBr(e);if(this.utils.isCurrentOrParent(["LI"]))return this.clean.onPasteTidy(e,"li")}return e=this.clean.isSingleLine(e,i),this.clean.singleLine||(this.opts.linebreaks&&(e=this.clean.replaceParagraphsToBr(e)),this.opts.replaceDivs&&(e=this.clean.replaceDivs(e)),e=this.clean.saveFormTags(e)),e=this.clean.onPasteWord(e),e=this.clean.onPasteExtra(e),e=this.clean.onPasteTidy(e,"all"),!this.clean.singleLine&&this.opts.paragraphize&&(e=this.paragraphize.load(e)),e=this.clean.removeDirtyStyles(e),e=this.clean.onPasteRemoveSpans(e),e=this.clean.onPasteRemoveEmpty(e),e=this.clean.convertInline(e)},onPasteWord:function(e){if(e=e.replace(/<!--[\s\S]*?-->/gi,""),e=e.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,""),e=e.replace(/<o\:p[^>]*>[\s\S]*?<\/o\:p>/gi,""),e.match(/class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i)){e=e.replace(/<!--[\s\S]+?-->/gi,""),e=e.replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,""),e=e.replace(/<(\/?)s>/gi,"<$1strike>"),e=e.replace(/ /gi," "),e=e.replace(/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(t,e){return e.length>0?e.replace(/./," ").slice(Math.floor(e.length/2)).split("").join(""):""}),e=this.clean.onPasteIeFixLinks(e),e=e.replace(/<img(.*?)v:shapes=(.*?)>/gi,""),e=e.replace(/src="file\:\/\/(.*?)"/,'src=""');var i=t("<div/>").html(e),n=!1,r=1,s=[];i.find("p[style]").each(function(){var e=t(this).attr("style").match(/mso\-list\:l([0-9]+)\slevel([0-9]+)/);if(e){var o=parseInt(e[1]),a=parseInt(e[2]),l=t(this).html().match(/^[\w]+\./)?"ol":"ul",c=t("<li/>").html(t(this).html());if(c.html(c.html().replace(/^([\w\.]+)</,"<")),c.find("span:first").remove(),1==a&&-1==t.inArray(o,s)){var u=t("<"+l+"/>").attr({"data-level":a,"data-list":o}).html(c);t(this).replaceWith(u),n=o,s.push(o)}else{if(a>r){for(var h=i.find('[data-level="'+r+'"][data-list="'+n+'"]'),d=h,p=r;a>p;p++)u=t("<"+l+"/>"),u.appendTo(d.find("li").last()),d=u;d.attr({"data-level":a,"data-list":o}).html(c)}else{var h=i.find('[data-level="'+a+'"][data-list="'+o+'"]').last();h.append(c)}r=a,n=o,t(this).remove()}}}),i.find("[data-level][data-list]").removeAttr("data-level data-list"),e=i.html(),e=e.replace(//g,""),e=e.replace(/<p class="Mso(.*?)"/gi,"<p"),e=e.replace(/ class=\"(mso[^\"]*)\"/gi,""),e=e.replace(/ class=(mso\w+)/gi,""),e=e.replace(/<o:p(.*?)>([\w\W]*?)<\/o:p>/gi,"$2"),e=e.replace(/\n/g," "),e=e.replace(/<p>\n?<li>/gi,"<li>")}return e},onPasteExtra:function(t){return t=t.replace(/<b\sid="internal-source-marker(.*?)">([\w\W]*?)<\/b>/gi,"$2"),t=t.replace(/<b(.*?)id="docs-internal-guid(.*?)">([\w\W]*?)<\/b>/gi,"$3"),t=t.replace(/<span[^>]*(font-style: italic; font-weight: bold|font-weight: bold; font-style: italic)[^>]*>/gi,'<span style="font-weight: bold;"><span style="font-style: italic;">'),t=t.replace(/<span[^>]*font-style: italic[^>]*>/gi,'<span style="font-style: italic;">'),t=t.replace(/<span[^>]*font-weight: bold[^>]*>/gi,'<span style="font-weight: bold;">'),t=t.replace(/<span[^>]*text-decoration: underline[^>]*>/gi,'<span style="text-decoration: underline;">'),t=t.replace(/<img>/gi,""),t=t.replace(/\n{3,}/gi,"\n"),t=t.replace(/<font(.*?)>([\w\W]*?)<\/font>/gi,"$2"),t=t.replace(/<p><p>/gi,"<p>"),t=t.replace(/<\/p><\/p>/gi,"</p>"),t=t.replace(/<li>(\s*|\t*|\n*)<p>/gi,"<li>"),t=t.replace(/<\/p>(\s*|\t*|\n*)<\/li>/gi,"</li>"),t=t.replace(/<\/p>\s<p/gi,"</p><p"),t=t.replace(/<img src="webkit-fake-url\:\/\/(.*?)"(.*?)>/gi,""),t=t.replace(/<p>([\w\W]*?)<\/p>/gi,"<li>$1</li>"),this.utils.browser("mozilla")&&(t=t.replace(/<br\s?\/?>$/gi,"")),t},onPasteTidy:function(t,e){var i=["span","a","pre","blockquote","small","em","strong","code","kbd","mark","address","cite","var","samp","dfn","sup","sub","b","i","u","del","ol","ul","li","dl","dt","dd","p","br","video","audio","iframe","embed","param","object","img","table","td","th","tr","tbody","tfoot","thead","h1","h2","h3","h4","h5","h6"],n=!1,r=[["a","*"],["img",["src","alt"]],["span",["class","rel","data-verified"]],["iframe","*"],["video","*"],["audio","*"],["embed","*"],["object","*"],["param","*"],["source","*"]];
"all"==e?(n=["p","span","h1","h2","h3","h4","h5","h6"],r=[["table","class"],["td",["colspan","rowspan"]],["a","*"],["img",["src","alt","data-redactor-inserted-image"]],["span",["class","rel","data-verified"]],["iframe","*"],["video","*"],["audio","*"],["embed","*"],["object","*"],["param","*"],["source","*"]]):"td"==e?i=["ul","ol","li","span","a","small","em","strong","code","kbd","mark","cite","var","samp","dfn","sup","sub","b","i","u","del","ol","ul","li","dl","dt","dd","br","iframe","video","audio","embed","param","object","img","h1","h2","h3","h4","h5","h6"]:"li"==e&&(i=["ul","ol","li","span","a","small","em","strong","code","kbd","mark","cite","var","samp","dfn","sup","sub","b","i","u","del","br","iframe","video","audio","embed","param","object","img"]);var s={deniedTags:this.opts.deniedTags?this.opts.deniedTags:!1,allowedTags:this.opts.allowedTags?this.opts.allowedTags:i,removeComments:!0,removePhp:!0,removeAttr:this.opts.removeAttr?this.opts.removeAttr:!1,allowedAttr:this.opts.allowedAttr?this.opts.allowedAttr:r,removeEmpty:n};return this.tidy.load(t,s)},onPasteRemoveEmpty:function(t){return t=t.replace(/<(p|h[1-6])>(|\s|\n|\t|<br\s?\/?>)<\/(p|h[1-6])>/gi,""),this.opts.linebreaks||(t=t.replace(/<br>$/i,"")),t},onPasteRemoveSpans:function(t){return t=t.replace(/<span>(.*?)<\/span>/gi,"$1"),t=t.replace(/<span[^>]*>\s|&nbsp;<\/span>/gi," ")},onPasteIeFixLinks:function(e){if(!this.utils.browser("msie"))return e;var i=t.trim(e);return 0===i.search(/^<a(.*?)>(.*?)<\/a>$/i)&&(e=e.replace(/^<a(.*?)>(.*?)<\/a>$/i,"$2")),e},isSingleLine:function(t,e){if(this.clean.singleLine=!1,!this.utils.isSelectAll()&&"undefined"==typeof e){var i=this.opts.blockLevelElements.join("|").replace("P|","").replace("DIV|",""),n=t.match(new RegExp("</("+i+")>","gi")),r=t.match(/<\/(p|div)>/gi);if(!n&&(null===r||r&&r.length<=1)){var s=t.match(/<br\s?\/?>/gi);s||(this.clean.singleLine=!0,t=t.replace(/<\/?(p|div)(.*?)>/gi,""))}}return t},stripTags:function(t,e){e=(((e||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var i=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi;return t.replace(i,function(t,i){return e.indexOf("<"+i.toLowerCase()+">")>-1?t:""})},savePreCode:function(t){return t=this.clean.savePreFormatting(t),t=this.clean.saveCodeFormatting(t),t=this.clean.restoreSelectionMarker(t)},savePreFormatting:function(e){var i=e.match(/<pre(.*?)>([\w\W]*?)<\/pre>/gi);return null!==i&&t.each(i,t.proxy(function(t,i){var n=i.match(/<pre(.*?)>([\w\W]*?)<\/pre>/i);n[2]=n[2].replace(/<br\s?\/?>/g,"\n"),n[2]=n[2].replace(/&nbsp;/g," "),this.opts.preSpaces&&(n[2]=n[2].replace(/\t/g,Array(this.opts.preSpaces+1).join(" "))),n[2]=this.clean.encodeEntities(n[2]),n[2]=n[2].replace(/\$/g,"&#36;"),e=e.replace(i,"<pre"+n[1]+">"+n[2]+"</pre>")},this)),e},saveCodeFormatting:function(e){var i=e.match(/<code(.*?)>([\w\W]*?)<\/code>/gi);return null!==i&&t.each(i,t.proxy(function(t,i){var n=i.match(/<code(.*?)>([\w\W]*?)<\/code>/i);n[2]=n[2].replace(/&nbsp;/g," "),n[2]=this.clean.encodeEntities(n[2]),n[2]=n[2].replace(/\$/g,"&#36;"),e=e.replace(i,"<code"+n[1]+">"+n[2]+"</code>")},this)),e},restoreSelectionMarker:function(t){return t=t.replace(/&lt;span id=&quot;selection-marker-([0-9])&quot; class=&quot;redactor-selection-marker&quot; data-verified=&quot;redactor&quot;&gt;&lt;\/span&gt;/g,'<span id="selection-marker-$1" class="redactor-selection-marker" data-verified="redactor"></span>')},getTextFromHtml:function(e){e=e.replace(/<br\s?\/?>|<\/H[1-6]>|<\/p>|<\/div>|<\/li>|<\/td>/gi,"\n");var i=document.createElement("div");return i.innerHTML=e,e=i.textContent||i.innerText,t.trim(e)},getPlainText:function(t,e){return t=this.clean.getTextFromHtml(t),t=t.replace(/\n/g,"<br />"),this.opts.paragraphize&&"undefined"==typeof e&&!this.utils.browser("mozilla")&&(t=this.paragraphize.load(t)),t},getPreCode:function(t){return t=t.replace(/<img(.*?) style="(.*?)"(.*?[^>])>/gi,"<img$1$3>"),t=t.replace(/<img(.*?)>/gi,"&lt;img$1&gt;"),t=this.clean.getTextFromHtml(t),this.opts.preSpaces&&(t=t.replace(/\t/g,Array(this.opts.preSpaces+1).join(" "))),t=this.clean.encodeEntities(t)},getOnlyImages:function(t){return t=t.replace(/<img(.*?)>/gi,"[img$1]"),t=t.replace(/<([Ss]*?)>/gi,""),t=t.replace(/\[img(.*?)\]/gi,"<img$1>")},getOnlyLinksAndImages:function(t){return t=t.replace(/<a(.*?)href="(.*?)"(.*?)>([\w\W]*?)<\/a>/gi,'[a href="$2"]$4[/a]'),t=t.replace(/<img(.*?)>/gi,"[img$1]"),t=t.replace(/<(.*?)>/gi,""),t=t.replace(/\[a href="(.*?)"\]([\w\W]*?)\[\/a\]/gi,'<a href="$1">$2</a>'),t=t.replace(/\[img(.*?)\]/gi,"<img$1>")},encodeEntities:function(t){return t=String(t).replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"'),t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},removeDirtyStyles:function(e){if(this.utils.browser("msie"))return e;var i=document.createElement("div");return i.innerHTML=e,this.clean.clearUnverifiedRemove(t(i)),e=i.innerHTML,t(i).remove(),e},clearUnverified:function(){if(!this.utils.browser("msie")){this.clean.clearUnverifiedRemove(this.$editor);var t=this.$editor.find("h1, h2, h3, h4, h5, h6");t.find("span").removeAttr("style"),t.find(this.opts.verifiedTags.join(", ")).removeAttr("style"),this.code.sync()}},clearUnverifiedRemove:function(e){e.find(this.opts.verifiedTags.join(", ")).removeAttr("style"),e.find("span").not('[data-verified="redactor"]').removeAttr("style"),e.find('span[data-verified="redactor"], img[data-verified="redactor"]').each(function(e,i){var n=t(i);n.attr("style",n.attr("rel"))})},cleanEmptyParagraph:function(){},setVerified:function(t){if(this.utils.browser("msie"))return t;t=t.replace(new RegExp("<img(.*?[^>])>","gi"),'<img$1 data-verified="redactor">'),t=t.replace(new RegExp("<span(.*?[^>])>","gi"),'<span$1 data-verified="redactor">');var e=t.match(new RegExp('<(span|img)(.*?)style="(.*?)"(.*?[^>])>',"gi"));if(e)for(var i=e.length,n=0;i>n;n++)try{var r=e[n].replace(/style="(.*?)"/i,'style="$1" rel="$1"');t=t.replace(e[n],r)}catch(s){}return t},convertInline:function(e){var i=t("<div />").html(e),n=this.opts.inlineTags;return n.push("span"),i.find(n.join(",")).each(function(){var e=t(this),i=this.tagName.toLowerCase();e.attr("data-redactor-tag",i),"span"==i&&(e.attr("style")?e.attr("data-redactor-style",e.attr("style")):e.attr("class")&&e.attr("data-redactor-class",e.attr("class")))}),e=i.html(),i.remove(),e},normalizeLists:function(){this.$editor.find("li").each(function(e,i){var n=t(i).next();0===n.length||"UL"!=n[0].tagName&&"OL"!=n[0].tagName||t(i).append(n)})},removeSpaces:function(t){return t=t.replace(/\n/g,""),t=t.replace(/[\t]*/g,""),t=t.replace(/\n\s*\n/g,"\n"),t=t.replace(/^[\s\n]*/g," "),t=t.replace(/[\s\n]*$/g," "),t=t.replace(/>\s{2,}</g,"> <"),t=t.replace(/\n\n/g,"\n"),t=t.replace(/\u200B/g,"")},replaceDivs:function(t){return this.opts.linebreaks?(t=t.replace(/<div><br\s?\/?><\/div>/gi,"<br />"),t=t.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"$2<br />")):t=t.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"<p$1>$2</p>"),t=t.replace(/<div(.*?[^>])>/gi,""),t=t.replace(/<\/div>/gi,"")},replaceDivsToBr:function(t){return t=t.replace(/<div\s(.*?)>/gi,"<p>"),t=t.replace(/<div><br\s?\/?><\/div>/gi,"<br /><br />"),t=t.replace(/<div>([\w\W]*?)<\/div>/gi,"$1<br /><br />")},replaceParagraphsToBr:function(t){return t=t.replace(/<p\s(.*?)>/gi,"<p>"),t=t.replace(/<p><br\s?\/?><\/p>/gi,"<br />"),t=t.replace(/<p>([\w\W]*?)<\/p>/gi,"$1<br /><br />"),t=t.replace(/(<br\s?\/?>){1,}\n?<\/blockquote>/gi,"</blockquote>")},saveFormTags:function(t){return t.replace(/<form(.*?)>([\w\W]*?)<\/form>/gi,'<section$1 rel="redactor-form-tag">$2</section>')},restoreFormTags:function(t){return t.replace(/<section(.*?) rel="redactor-form-tag"(.*?)>([\w\W]*?)<\/section>/gi,"<form$1$2>$3</form>")}}},code:function(){return{set:function(e){e=t.trim(e.toString()),e=this.clean.onSet(e),this.utils.browser("msie")&&(e=e.replace(/<span(.*?)id="selection-marker-(1|2)"(.*?)><\/span>;/gi,"")),this.$editor.html(e),this.code.sync(),""!==e&&this.placeholder.remove(),setTimeout(t.proxy(this.buffer.add,this),15),this.start===!1&&this.observe.load()},get:function(){var t=this.$textarea.val();return this.opts.replaceDivs&&(t=this.clean.replaceDivs(t)),this.opts.linebreaks&&(t=this.clean.replaceParagraphsToBr(t)),t=this.tabifier.get(t)},sync:function(){setTimeout(t.proxy(this.code.startSync,this),10)},startSync:function(){var t=this.$editor.html();this.code.syncCode&&this.code.syncCode==t||(this.code.syncCode=t,t=this.core.setCallback("syncBefore",t),t=this.clean.onSync(t),this.$textarea.val(t),this.core.setCallback("sync",t),this.start===!1&&this.core.setCallback("change",t),this.start=!1,0==this.autosave.html&&(this.autosave.html=this.code.get()),this.opts.codemirror&&this.$textarea.next(".CodeMirror").each(function(e,i){i.CodeMirror.setValue(t)}),this.autosave.onChange(),this.autosave.enable())},toggle:function(){this.opts.visual?this.code.showCode():this.code.showVisual()},showCode:function(){this.selection.save(),this.code.offset=this.caret.getOffset();var e=t(window).scrollTop(),i=(this.$editor.innerWidth(),this.$editor.innerHeight());this.$editor.hide();var n=this.$textarea.val();this.modified=this.clean.removeSpaces(n),n=this.tabifier.get(n);var r=0,s=0,o=t("<div/>").append(t.parseHTML(this.clean.onSync(this.$editor.html()),document,!0)),a=o.find("span.redactor-selection-marker");if(a.length>0){var l=this.tabifier.get(o.html()).replace(/&amp;/g,"&");1==a.length?(r=this.utils.strpos(l,o.find("#selection-marker-1").prop("outerHTML")),s=r):2==a.length&&(r=this.utils.strpos(l,o.find("#selection-marker-1").prop("outerHTML")),s=this.utils.strpos(l,o.find("#selection-marker-2").prop("outerHTML"))-o.find("#selection-marker-1").prop("outerHTML").toString().length)}this.selection.removeMarkers(),this.$textarea.val(n),this.opts.codemirror?this.$textarea.next(".CodeMirror").each(function(e,o){t(o).show(),o.CodeMirror.setValue(n),o.CodeMirror.setSize("100%",i),o.CodeMirror.refresh(),r==s?o.CodeMirror.setCursor(o.CodeMirror.posFromIndex(r).line,o.CodeMirror.posFromIndex(s).ch):o.CodeMirror.setSelection({line:o.CodeMirror.posFromIndex(r).line,ch:o.CodeMirror.posFromIndex(r).ch},{line:o.CodeMirror.posFromIndex(s).line,ch:o.CodeMirror.posFromIndex(s).ch}),o.CodeMirror.focus()}):(this.$textarea.height(i).show().focus(),this.$textarea.on("keydown.redactor-textarea-indenting",this.code.textareaIndenting),t(window).scrollTop(e),this.$textarea[0].setSelectionRange&&this.$textarea[0].setSelectionRange(r,s),this.$textarea[0].scrollTop=0),this.opts.visual=!1,this.button.setInactiveInCode(),this.button.setActive("html"),this.core.setCallback("source",n)},showVisual:function(){var t;if(!this.opts.visual){var e=0,i=0;if(this.opts.codemirror){var n;this.$textarea.next(".CodeMirror").each(function(r,s){n=s.CodeMirror.listSelections(),e=s.CodeMirror.indexFromPos(n[0].anchor),i=s.CodeMirror.indexFromPos(n[0].head),t=s.CodeMirror.getValue()})}else e=this.$textarea.get(0).selectionStart,i=this.$textarea.get(0).selectionEnd,t=this.$textarea.hide().val();if(e>i&&i>0){var r=i,s=e;e=r,i=s}if(e=this.code.enlargeOffset(t,e),i=this.code.enlargeOffset(t,i),t=t.substr(0,e)+this.selection.getMarkerAsHtml(1)+t.substr(e),i>e){var o=this.selection.getMarkerAsHtml(1).toString().length;t=t.substr(0,i+o)+this.selection.getMarkerAsHtml(2)+t.substr(i+o)}this.modified!==this.clean.removeSpaces(t)&&this.code.set(t),this.opts.codemirror&&this.$textarea.next(".CodeMirror").hide(),this.$editor.show(),this.utils.isEmpty(t)||this.placeholder.remove(),this.selection.restore(),this.$textarea.off("keydown.redactor-textarea-indenting"),this.button.setActiveInVisual(),this.button.setInactive("html"),this.observe.load(),this.opts.visual=!0,this.core.setCallback("visual",t)}},textareaIndenting:function(t){if(9!==t.keyCode)return!0;var e=this.$textarea,i=e.get(0).selectionStart;return e.val(e.val().substring(0,i)+"	"+e.val().substring(e.get(0).selectionEnd)),e.get(0).selectionStart=e.get(0).selectionEnd=i+1,!1},enlargeOffset:function(t,e){var i=t.length,n=0;if(">"==t[e])n++;else for(var r=e;i>=r&&(n++,">"!=t[r]);r++)if("<"==t[r]||r==i){n=0;break}return e+n}}},core:function(){return{getObject:function(){return t.extend({},this)},getEditor:function(){return this.$editor},getBox:function(){return this.$box},getElement:function(){return this.$element},getTextarea:function(){return this.$textarea},getToolbar:function(){return this.$toolbar?this.$toolbar:!1},addEvent:function(t){this.core.event=t},getEvent:function(){return this.core.event},setCallback:function(e,i,n){var r=e+"Callback",s="redactor",o=this.opts[r];if(this.$textarea){var a=!1,l=t._data(this.$textarea[0],"events");if("undefined"!=typeof l&&"undefined"!=typeof l[r]&&t.each(l[r],t.proxy(function(t,e){if(e.namespace==s){var n="undefined"==typeof n?[i]:[i,n];a="undefined"==typeof n?e.handler.call(this,i):e.handler.call(this,i,n)}},this)),a)return a}return t.isFunction(o)?"undefined"==typeof n?o.call(this,i):o.call(this,i,n):"undefined"==typeof n?i:n},destroy:function(){this.opts.destroyed=!0,this.core.setCallback("destroy"),this.$element.off(".redactor").removeData("redactor"),this.$editor.off(".redactor"),t(document).off("mousedown.redactor."+this.uuid),t(document).off("click.redactor-image-delete."+this.uuid),t(document).off("click.redactor-image-resize-hide."+this.uuid),t(document).off("touchstart.redactor."+this.uuid+" click.redactor."+this.uuid),t("body").off("scroll.redactor."+this.uuid),t(this.opts.toolbarFixedTarget).off("scroll.redactor."+this.uuid),this.$editor.removeClass("redactor-editor redactor-linebreaks redactor-placeholder"),this.$editor.removeAttr("contenteditable");var e=this.code.get();this.opts.toolbar&&this.$toolbar.find("a").each(function(){var e=t(this);e.data("dropdown")&&(e.data("dropdown").remove(),e.data("dropdown",{}))}),this.build.isTextarea()?(this.$box.after(this.$element),this.$box.remove(),this.$element.val(e).show()):(this.$box.after(this.$editor),this.$box.remove(),this.$element.html(e).show()),this.$pasteBox&&this.$pasteBox.remove(),this.$modalBox&&this.$modalBox.remove(),this.$modalOverlay&&this.$modalOverlay.remove(),t(".redactor-toolbar-tooltip-"+this.uuid).remove(),clearInterval(this.autosaveInterval)}}},dropdown:function(){return{build:function(e,i,n){"formatting"==e&&this.opts.formattingAdd&&t.each(this.opts.formattingAdd,t.proxy(function(t,e){var i,r=e.tag;"undefined"!=typeof e["class"]&&(r=r+"-"+e["class"]),e.type=this.utils.isBlockTag(e.tag)?"block":"inline",i="undefined"!=typeof e.func?e.func:"inline"==e.type?"inline.formatting":"block.formatting",this.opts.linebreaks&&"block"==e.type&&"p"==e.tag||(this.formatting[r]={tag:e.tag,style:e.style,"class":e["class"],attr:e.attr,data:e.data,clear:e.clear},n[r]={func:i,title:e.title})},this)),t.each(n,t.proxy(function(n,r){var s=t('<a href="#" class="redactor-dropdown-'+n+'" role="button">'+r.title+"</a>");"formatting"==e&&s.addClass("redactor-formatting-"+n),s.on("click",t.proxy(function(e){e.preventDefault();var i="func",s=r.func;r.command?(i="command",s=r.command):r.dropdown&&(i="dropdown",s=r.dropdown),t(e.target).hasClass("redactor-dropdown-link-inactive")||(this.button.onClick(e,n,i,s),this.dropdown.hideAll())},this)),this.observe.addDropdown(s,n,r),i.append(s)},this))},show:function(e,i){if(!this.opts.visual)return e.preventDefault(),!1;var n=this.button.get(i),r=n.data("dropdown").appendTo(document.body);if(this.opts.highContrast&&r.addClass("redactor-dropdown-contrast"),n.hasClass("dropact"))this.dropdown.hideAll();else{this.dropdown.hideAll(),this.observe.dropdowns(),this.core.setCallback("dropdownShow",{dropdown:r,key:i,button:n}),this.button.setActive(i),n.addClass("dropact");var s=n.offset(),o=r.width();s.left+o>t(document).width()&&(s.left=Math.max(0,s.left-o));var a=s.left+"px";if(this.$toolbar.hasClass("toolbar-fixed-box")){var l=this.$toolbar.innerHeight()+this.opts.toolbarFixedTopOffset,c="fixed";this.opts.toolbarFixedTarget!==document&&(l=this.$toolbar.innerHeight()+this.$toolbar.offset().top+this.opts.toolbarFixedTopOffset,c="absolute"),r.css({position:c,left:a,top:l+"px"}).show()}else{var l=n.innerHeight()+s.top+"px";r.css({position:"absolute",left:a,top:l}).show()}this.core.setCallback("dropdownShown",{dropdown:r,key:i,button:n}),this.$dropdown=r}t(document).one("click.redactor-dropdown",t.proxy(this.dropdown.hide,this)),this.$editor.one("click.redactor-dropdown",t.proxy(this.dropdown.hide,this)),t(document).one("keyup.redactor-dropdown",t.proxy(this.dropdown.closeHandler,this)),r.on("mouseover.redactor-dropdown",t.proxy(this.utils.disableBodyScroll,this)).on("mouseout.redactor-dropdown",t.proxy(this.utils.enableBodyScroll,this)),e.stopPropagation()},closeHandler:function(t){t.which==this.keyCode.ESC&&(this.dropdown.hideAll(),this.$editor.focus())},hideAll:function(){this.$toolbar.find("a.dropact").removeClass("redactor-act").removeClass("dropact"),this.utils.enableBodyScroll(),t(".redactor-dropdown-"+this.uuid).hide(),t(".redactor-dropdown-link-selected").removeClass("redactor-dropdown-link-selected"),this.$dropdown&&(this.$dropdown.off(".redactor-dropdown"),this.core.setCallback("dropdownHide",this.$dropdown),this.$dropdown=!1)},hide:function(e){var i=t(e.target);i.hasClass("dropact")||i.hasClass("redactor-dropdown-link-inactive")||(i.removeClass("dropact"),i.off("mouseover mouseout"),this.dropdown.hideAll())}}},file:function(){return{show:function(){this.modal.load("file",this.lang.get("file"),700),this.upload.init("#redactor-modal-file-upload",this.opts.fileUpload,this.file.insert),this.selection.save(),this.selection.get();var e=this.sel.toString();t("#redactor-filename").val(e),this.modal.show()},insert:function(e,i,n){if("undefined"!=typeof e.error)return this.modal.close(),this.selection.restore(),void this.core.setCallback("fileUploadError",e);var r;if("string"==typeof e)r=e;else{var s=t("#redactor-filename").val();("undefined"==typeof s||""===s)&&(s=e.filename),r='<a href="'+e.filelink+'" id="filelink-marker">'+s+"</a>"}if(i){this.selection.removeMarkers();var o=this.selection.getMarker();this.insert.nodeToCaretPositionFromPoint(n,o)}else this.modal.close();if(this.selection.restore(),this.buffer.set(),this.insert.htmlWithoutClean(r),"string"!=typeof e){var a=t(this.$editor.find("a#filelink-marker"));0!==a.length?a.removeAttr("id").removeAttr("style"):a=!1,this.core.setCallback("fileUpload",a,e)}}}},focus:function(){return{setStart:function(){this.$editor.focus();var t=this.$editor.children().first();if(0!==t.length&&0!==t[0].length&&"BR"!=t[0].tagName&&3!=t[0].nodeType){if("UL"==t[0].tagName||"OL"==t[0].tagName){var e=t.find("li").first();if(!this.utils.isBlock(e)&&""===e.text())return void this.caret.setStart(e)}return this.opts.linebreaks&&!this.utils.isBlockTag(t[0].tagName)?(this.selection.get(),this.range.setStart(this.$editor[0],0),this.range.setEnd(this.$editor[0],0),void this.selection.addRange()):void this.caret.setStart(t)}},setEnd:function(){var t=this.$editor.children().last();this.$editor.focus(),0!==t.size()&&(this.utils.isEmpty(this.$editor.html())?(this.selection.get(),this.range.collapse(!0),this.range.setStartAfter(t[0]),this.range.setEnd(t[0],0),this.selection.addRange()):(this.selection.get(),this.range.selectNodeContents(t[0]),this.range.collapse(!1),this.selection.addRange()))},isFocused:function(){var e=document.getSelection().focusNode;return null===e?!1:this.opts.linebreaks&&t(e.parentNode).hasClass("redactor-linebreaks")?!0:this.utils.isRedactorParent(e.parentNode)?this.$editor.is(":focus"):!1}}},image:function(){return{show:function(){this.modal.load("image",this.lang.get("image"),700),this.upload.init("#redactor-modal-image-droparea",this.opts.imageUpload,this.image.insert),this.selection.save(),this.modal.show()},showEdit:function(e){var i=e.closest("a",this.$editor[0]);if(this.modal.load("imageEdit",this.lang.get("edit"),705),this.modal.createCancelButton(),this.image.buttonDelete=this.modal.createDeleteButton(this.lang.get("_delete")),this.image.buttonSave=this.modal.createActionButton(this.lang.get("save")),this.image.buttonDelete.on("click",t.proxy(function(){this.image.remove(e)},this)),this.image.buttonSave.on("click",t.proxy(function(){this.image.update(e)},this)),t(".redactor-link-tooltip").remove(),t("#redactor-image-title").val(e.attr("alt")),this.opts.imageLink){var n=t("#redactor-image-link");n.attr("href",e.attr("src")),0!==i.length&&(n.val(i.attr("href")),"_blank"==i.attr("target")&&t("#redactor-image-link-blank").prop("checked",!0))}else t(".redactor-image-link-option").hide();if(this.opts.imagePosition){var r="block"==e.css("display")&&"none"==e.css("float")?"center":e.css("float");t("#redactor-image-align").val(r)}else t(".redactor-image-position-option").hide();this.modal.show(),t("#redactor-image-title").focus()},setFloating:function(e){var i=t("#redactor-image-align").val(),n="",r="",s="";switch(i){case"left":n="left",s="0 "+this.opts.imageFloatMargin+" "+this.opts.imageFloatMargin+" 0";break;case"right":n="right",s="0 0 "+this.opts.imageFloatMargin+" "+this.opts.imageFloatMargin;break;case"center":r="block",s="auto"}e.css({"float":n,display:r,margin:s}),e.attr("rel",e.attr("style"))},update:function(e){this.image.hideResize(),this.buffer.set();var i=e.closest("a",this.$editor[0]),n=t("#redactor-image-title").val().replace(/(<([^>]+)>)/gi,"");e.attr("alt",n),this.image.setFloating(e);var r=t.trim(t("#redactor-image-link").val()),r=r.replace(/(<([^>]+)>)/gi,"");if(""!==r){var s="((xn--)?[a-z0-9]+(-[a-z0-9]+)*\\.)+[a-z]{2,}",o=new RegExp("^(http|ftp|https)://"+s,"i"),a=new RegExp("^"+s,"i");-1==r.search(o)&&0===r.search(a)&&this.opts.linkProtocol&&(r=this.opts.linkProtocol+"://"+r);var l=t("#redactor-image-link-blank").prop("checked")?!0:!1;if(0===i.length){var c=t('<a href="'+r+'">'+this.utils.getOuterHtml(e)+"</a>");l&&c.attr("target","_blank"),e.replaceWith(c)}else i.attr("href",r),l?i.attr("target","_blank"):i.removeAttr("target")}else 0!==i.length&&i.replaceWith(this.utils.getOuterHtml(e));this.modal.close(),this.observe.images(),this.code.sync()},setEditable:function(e){this.opts.imageEditable&&e.on("dragstart",t.proxy(this.image.onDrag,this));var i=t.proxy(function(){this.observe.image=e,this.image.resizer=this.image.loadEditableControls(e),t(document).on("mousedown.redactor-image-resize-hide."+this.uuid,t.proxy(this.image.hideResize,this)),this.opts.imageResizable&&this.image.resizer.on("mousedown.redactor touchstart.redactor",t.proxy(function(t){this.image.setResizable(t,e)},this))},this);e.off("mousedown.redactor").on("mousedown.redactor",t.proxy(this.image.hideResize,this)),e.off("click.redactor touchstart.redactor").on("click.redactor touchstart.redactor",i)},setResizable:function(t,e){t.preventDefault(),this.image.resizeHandle={x:t.pageX,y:t.pageY,el:e,ratio:e.width()/e.height(),h:e.height()},t=t.originalEvent||t,t.targetTouches&&(this.image.resizeHandle.x=t.targetTouches[0].pageX,this.image.resizeHandle.y=t.targetTouches[0].pageY),this.image.startResize()},startResize:function(){t(document).on("mousemove.redactor-image-resize touchmove.redactor-image-resize",t.proxy(this.image.moveResize,this)),t(document).on("mouseup.redactor-image-resize touchend.redactor-image-resize",t.proxy(this.image.stopResize,this))},moveResize:function(t){t.preventDefault(),t=t.originalEvent||t;var e=this.image.resizeHandle.h;e+=t.targetTouches?t.targetTouches[0].pageY-this.image.resizeHandle.y:t.pageY-this.image.resizeHandle.y;var i=Math.round(e*this.image.resizeHandle.ratio);if(!(50>e||100>i)){var e=Math.round(this.image.resizeHandle.el.width()/this.image.resizeHandle.ratio);this.image.resizeHandle.el.attr({width:i,height:e}),this.image.resizeHandle.el.width(i),this.image.resizeHandle.el.height(e),this.code.sync()}},stopResize:function(){this.handle=!1,t(document).off(".redactor-image-resize"),this.image.hideResize()},onDrag:function(e){return 0!==this.$editor.find("#redactor-image-box").length?(e.preventDefault(),!1):void this.$editor.on("drop.redactor-image-inside-drop",t.proxy(function(){setTimeout(t.proxy(this.image.onDrop,this),1)},this))},onDrop:function(){this.image.fixImageSourceAfterDrop(),this.observe.images(),this.$editor.off("drop.redactor-image-inside-drop"),this.clean.clearUnverified(),this.code.sync()},fixImageSourceAfterDrop:function(){this.$editor.find("img[data-save-url]").each(function(){var e=t(this);e.attr("src",e.attr("data-save-url")),e.removeAttr("data-save-url")})},hideResize:function(e){if(!e||0===t(e.target).closest("#redactor-image-box",this.$editor[0]).length){if(e&&"IMG"==e.target.tagName){var i=t(e.target);i.attr("data-save-url",i.attr("src"))}var n=this.$editor.find("#redactor-image-box");0!==n.length&&(t("#redactor-image-editter").remove(),t("#redactor-image-resizer").remove(),n.find("img").css({marginTop:n[0].style.marginTop,marginBottom:n[0].style.marginBottom,marginLeft:n[0].style.marginLeft,marginRight:n[0].style.marginRight}),n.css("margin",""),n.find("img").css("opacity",""),n.replaceWith(function(){return t(this).contents()}),t(document).off("mousedown.redactor-image-resize-hide."+this.uuid),"undefined"!=typeof this.image.resizeHandle&&this.image.resizeHandle.el.attr("rel",this.image.resizeHandle.el.attr("style")),this.code.sync())}},loadResizableControls:function(e,i){if(this.opts.imageResizable&&!this.utils.isMobile()){var n=t('<span id="redactor-image-resizer" data-redactor="verified"></span>');return this.utils.isDesktop()||n.css({width:"15px",height:"15px"}),n.attr("contenteditable",!1),i.append(n),i.append(e),n}return i.append(e),!1},loadEditableControls:function(e){var i=t('<span id="redactor-image-box" data-redactor="verified">');if(i.css("float",e.css("float")).attr("contenteditable",!1),"auto"!=e[0].style.margin?(i.css({marginTop:e[0].style.marginTop,marginBottom:e[0].style.marginBottom,marginLeft:e[0].style.marginLeft,marginRight:e[0].style.marginRight}),e.css("margin","")):i.css({display:"block",margin:"auto"}),e.css("opacity",".5").after(i),this.opts.imageEditable){this.image.editter=t('<span id="redactor-image-editter" data-redactor="verified">'+this.lang.get("edit")+"</span>"),this.image.editter.attr("contenteditable",!1),this.image.editter.on("click",t.proxy(function(){this.image.showEdit(e)},this)),i.append(this.image.editter);var n=this.image.editter.innerWidth();this.image.editter.css("margin-left","-"+n/2+"px")}return this.image.loadResizableControls(e,i)},remove:function(e){var i=t(e),n=i.closest("a",this.$editor[0]),r=i.closest("figure",this.$editor[0]),s=i.parent();0!==t("#redactor-image-box").length&&(s=t("#redactor-image-box").parent());var o;0!==r.length?(o=r.next(),r.remove()):0!==n.length?(s=n.parent(),n.remove()):i.remove(),t("#redactor-image-box").remove(),this.caret.setStart(0!==r.length?o:s),this.core.setCallback("imageDelete",i[0].src,i),this.modal.close(),this.code.sync()},insert:function(e,i,n){if("undefined"!=typeof e.error)return this.modal.close(),this.selection.restore(),void this.core.setCallback("imageUploadError",e);var r;"string"==typeof e?r=t(e).attr("data-redactor-inserted-image","true"):(r=t("<img>"),r.attr("src",e.filelink).attr("data-redactor-inserted-image","true"));var s=r,o=this.utils.isCurrentOrParent("P");if(o&&(s=t("<blockquote />").append(r)),i){this.selection.removeMarkers();var a=this.selection.getMarker();this.insert.nodeToCaretPositionFromPoint(n,a)}else this.modal.close();this.selection.restore(),this.buffer.set(),this.insert.html(this.utils.getOuterHtml(s),!1);var l=this.$editor.find("img[data-redactor-inserted-image=true]").removeAttr("data-redactor-inserted-image");o?l.parent().contents().unwrap().wrap("<p />"):this.opts.linebreaks&&(this.utils.isEmpty(this.code.get())||l.before("<br>"),l.after("<br>")),"string"!=typeof e&&this.core.setCallback("imageUpload",l,e)}}},indent:function(){return{increase:function(){this.utils.browser("msie")||this.$editor.focus(),this.buffer.set(),this.selection.save();var t=this.selection.getBlock();t&&"LI"==t.tagName?this.indent.increaseLists():t===!1&&this.opts.linebreaks?this.indent.increaseText():this.indent.increaseBlocks(),this.selection.restore(),this.code.sync()},increaseLists:function(){document.execCommand("indent"),this.indent.fixEmptyIndent(),this.clean.normalizeLists(),this.clean.clearUnverified()},increaseBlocks:function(){t.each(this.selection.getBlocks(),t.proxy(function(t,e){if("TD"!==e.tagName&&"TH"!==e.tagName){var i=this.utils.getAlignmentElement(e),n=this.utils.normalize(i.css("margin-left"))+this.opts.indentValue;i.css("margin-left",n+"px")}},this))},increaseText:function(){var e=this.selection.wrap("div");t(e).attr("data-tagblock","redactor"),t(e).css("margin-left",this.opts.indentValue+"px")},decrease:function(){this.buffer.set(),this.selection.save();var t=this.selection.getBlock();t&&"LI"==t.tagName?this.indent.decreaseLists():this.indent.decreaseBlocks(),this.selection.restore(),this.code.sync()},decreaseLists:function(){document.execCommand("outdent");var e=this.selection.getCurrent(),i=t(e).closest("li",this.$editor[0]);this.indent.fixEmptyIndent(),this.opts.linebreaks||0!==i.length||(document.execCommand("formatblock",!1,"p"),this.$editor.find("ul, ol, blockquote, p").each(t.proxy(this.utils.removeEmpty,this))),this.clean.clearUnverified()},decreaseBlocks:function(){t.each(this.selection.getBlocks(),t.proxy(function(t,e){var i=this.utils.getAlignmentElement(e),n=this.utils.normalize(i.css("margin-left"))-this.opts.indentValue;0>=n?this.opts.linebreaks&&"undefined"!=typeof i.data("tagblock")?i.replaceWith(i.html()+"<br />"):(i.css("margin-left",""),this.utils.removeEmptyAttr(i,"style")):i.css("margin-left",n+"px")},this))},fixEmptyIndent:function(){var e=this.selection.getBlock();if(this.range.collapsed&&e&&"LI"==e.tagName&&this.utils.isEmpty(t(e).text())){var i=t(e);i.find("span").not(".redactor-selection-marker").contents().unwrap(),i.append("<br>")}}}},inline:function(){return{formatting:function(t){var e,i;"undefined"!=typeof this.formatting[t].style?e="style":"undefined"!=typeof this.formatting[t]["class"]&&(e="class"),e&&(i=this.formatting[t][e]),this.inline.format(this.formatting[t].tag,e,i)},format:function(e,i,n){var r=this.selection.getCurrent();if(!(r&&"TR"===r.tagName||(this.blurClickedElement=!0,this.utils.isCurrentOrParent("PRE")||this.utils.isCurrentOrParentHeader()))){for(var s=["b","bold","i","italic","underline","strikethrough","deleted","superscript","subscript"],o=["strong","strong","em","em","u","del","del","sup","sub"],a=0;a<s.length;a++)e==s[a]&&(e=o[a]);if(this.opts.allowedTags){if(-1==t.inArray(e,this.opts.allowedTags))return}else if(-1!==t.inArray(e,this.opts.deniedTags))return;this.inline.type=i||!1,this.inline.value=n||!1,this.buffer.set(),this.utils.browser("msie")||this.$editor.focus(),this.selection.get(),this.range.collapsed?this.inline.formatCollapsed(e):this.inline.formatMultiple(e)}},formatCollapsed:function(e){var i=this.selection.getCurrent(),n=t(i).closest(e+"[data-redactor-tag="+e+"]",this.$editor[0]);if(0!==n.length&&"style"!=this.inline.type&&"SPAN"!=n[0].tagName)return void(this.utils.isEmpty(n.text())?(this.caret.setAfter(n[0]),n.remove(),this.code.sync()):this.utils.isEndOfElement(n)&&this.caret.setAfter(n[0]));var r=t("<"+e+">").attr("data-verified","redactor").attr("data-redactor-tag",e);r.html(this.opts.invisibleSpace),r=this.inline.setFormat(r);var r=this.insert.node(r);this.caret.setEnd(r),this.code.sync()},formatMultiple:function(e){if(this.inline.formatConvert(e),this.selection.save(),document.execCommand("strikethrough"),this.$editor.find("strike").each(t.proxy(function(i,n){var r=t(n);this.inline.formatRemoveSameChildren(r,e);var s;this.inline.type?(s=t("<span>").attr("data-redactor-tag",e).attr("data-verified","redactor"),s=this.inline.setFormat(s)):s=t("<"+e+">").attr("data-redactor-tag",e).attr("data-verified","redactor"),r.replaceWith(s.html(r.contents()));var o=s.parent();if(o&&"U"===o[0].tagName&&s.parent().replaceWith(s),"span"==e&&o&&"SPAN"===o[0].tagName&&"style"===this.inline.type)for(var a=this.inline.value.split(";"),l=0;l<a.length;l++){if(""===a[l])return;
var c=a[l].split(":");o.css(c[0],""),this.utils.removeEmptyAttr(o,"style")&&o.replaceWith(o.contents())}},this)),"span"!=e&&this.$editor.find(this.opts.inlineTags.join(", ")).each(t.proxy(function(e,i){var n=t(i);if("U"===i.tagName&&0===i.attributes.length)return void n.replaceWith(n.contents());var r=n.css("text-decoration");"line-through"===r&&(n.css("text-decoration",""),this.utils.removeEmptyAttr(n,"style"))},this)),"del"!=e){var i=this;this.$editor.find("inline").each(function(t,e){i.utils.replaceToTag(e,"del")})}this.selection.restore(),this.code.sync()},formatRemoveSameChildren:function(e,i){var n=this;e.children(i).each(function(){var e=t(this);if(!e.hasClass("redactor-selection-marker"))if("style"==n.inline.type)for(var i=n.inline.value.split(";"),r=0;r<i.length;r++){if(""===i[r])return;var s=i[r].split(":");e.css(s[0],""),n.utils.removeEmptyAttr(e,"style")&&e.replaceWith(e.contents())}else e.contents().unwrap()})},formatConvert:function(e){this.selection.save();var i="";"class"==this.inline.type?i="[data-redactor-class="+this.inline.value+"]":"style"==this.inline.type&&(i='[data-redactor-style="'+this.inline.value+'"]');var n=this;"del"!=e&&this.$editor.find("del").each(function(t,e){n.utils.replaceToTag(e,"inline")}),"span"!=e&&this.$editor.find(e).each(function(){var e=t(this);e.replaceWith(t("<strike />").html(e.contents()))}),this.$editor.find('[data-redactor-tag="'+e+'"]'+i).each(function(){if(""!==i||"span"!=e||this.tagName.toLowerCase()!=e){var n=t(this);n.replaceWith(t("<strike />").html(n.contents()))}}),this.selection.restore()},setFormat:function(t){switch(this.inline.type){case"class":t.hasClass(this.inline.value)?(t.removeClass(this.inline.value),t.removeAttr("data-redactor-class")):(t.addClass(this.inline.value),t.attr("data-redactor-class",this.inline.value));break;case"style":t[0].style.cssText=this.inline.value,t.attr("data-redactor-style",this.inline.value)}return t},removeStyle:function(){this.buffer.set();var e=this.selection.getCurrent(),i=this.selection.getInlines();if(this.selection.save(),e&&"SPAN"===e.tagName){var n=t(e);n.removeAttr("style"),0===n[0].attributes.length&&n.replaceWith(n.contents())}t.each(i,t.proxy(function(e,i){var n=t(i);-1==t.inArray(i.tagName.toLowerCase(),this.opts.inlineTags)||n.hasClass("redactor-selection-marker")||(n.removeAttr("style"),0===n[0].attributes.length&&n.replaceWith(n.contents()))},this)),this.selection.restore(),this.code.sync()},removeStyleRule:function(e){this.buffer.set();var i=this.selection.getParent(),n=this.selection.getInlines();if(this.selection.save(),i&&"SPAN"===i.tagName){var r=t(i);r.css(e,""),this.utils.removeEmptyAttr(r,"style"),0===r[0].attributes.length&&r.replaceWith(r.contents())}t.each(n,t.proxy(function(i,n){var r=t(n);-1==t.inArray(n.tagName.toLowerCase(),this.opts.inlineTags)||r.hasClass("redactor-selection-marker")||(r.css(e,""),this.utils.removeEmptyAttr(r,"style"),0===r[0].attributes.length&&r.replaceWith(r.contents()))},this)),this.selection.restore(),this.code.sync()},removeFormat:function(){this.buffer.set();var e=this.selection.getCurrent();this.selection.save(),document.execCommand("removeFormat"),e&&"SPAN"===e.tagName&&t(e).replaceWith(t(e).contents()),t.each(this.selection.getNodes(),t.proxy(function(e,i){var n=t(i);-1==t.inArray(i.tagName.toLowerCase(),this.opts.inlineTags)||n.hasClass("redactor-selection-marker")||n.replaceWith(n.contents())},this)),this.selection.restore(),this.code.sync()},toggleClass:function(t){this.inline.format("span","class",t)},toggleStyle:function(t){this.inline.format("span","style",t)}}},insert:function(){return{set:function(e,i){this.placeholder.remove(),e=this.clean.setVerified(e),"undefined"==typeof i&&(e=this.clean.onPaste(e,!1)),this.$editor.html(e),this.selection.remove(),this.focus.setEnd(),this.clean.normalizeLists(),this.code.sync(),this.observe.load(),"undefined"==typeof i&&setTimeout(t.proxy(this.clean.clearUnverified,this),10)},text:function(e){if(this.placeholder.remove(),e=e.toString(),e=t.trim(e),e=this.clean.getPlainText(e,!1),this.$editor.focus(),this.utils.browser("msie"))this.insert.htmlIe(e);else{this.selection.get(),this.range.deleteContents();var i=document.createElement("div");i.innerHTML=e;for(var n,r,s=document.createDocumentFragment();n=i.firstChild;)r=s.appendChild(n);if(this.range.insertNode(s),r){var o=this.range.cloneRange();o.setStartAfter(r),o.collapse(!0),this.sel.removeAllRanges(),this.sel.addRange(o)}}this.code.sync(),this.clean.clearUnverified()},htmlWithoutClean:function(t){this.insert.html(t,!1)},html:function(e,i){this.placeholder.remove(),"undefined"==typeof i&&(i=!0),this.$editor.focus(),e=this.clean.setVerified(e),i&&(e=this.clean.onPaste(e)),this.utils.browser("msie")?this.insert.htmlIe(e):(this.clean.singleLine?this.insert.execHtml(e):document.execCommand("insertHTML",!1,e),this.insert.htmlFixMozilla()),this.clean.normalizeLists(),this.opts.linebreaks||this.$editor.find("p").each(t.proxy(this.utils.removeEmpty,this)),this.code.sync(),this.observe.load(),i&&this.clean.clearUnverified()},htmlFixMozilla:function(){if(this.utils.browser("mozilla")){var e=t(this.selection.getBlock()).next();e.length>0&&"P"==e[0].tagName&&""===e.html()&&e.remove()}},htmlIe:function(e){if(this.utils.isIe11()){var i=this.utils.isCurrentOrParent("P"),n=t("<div>").append(e),r=n.contents().is("p, :header, dl, ul, ol, div, table, td, blockquote, pre, address, section, header, footer, aside, article");return void(i&&r?this.insert.ie11FixInserting(i,e):this.insert.ie11PasteFrag(e))}document.selection.createRange().pasteHTML(e)},execHtml:function(t){t=this.clean.setVerified(t),this.selection.get(),this.range.deleteContents();var e=document.createElement("div");e.innerHTML=t;for(var i,n,r=document.createDocumentFragment();i=e.firstChild;)n=r.appendChild(i);this.range.insertNode(r),this.range.collapse(!0),this.caret.setAfter(n)},node:function(e,i){e=e[0]||e;var n=this.utils.getOuterHtml(e);return n=this.clean.setVerified(n),null!==n.match(/</g)&&(e=t(n)[0]),this.selection.get(),i!==!1&&this.range.deleteContents(),this.range.insertNode(e),this.range.collapse(!1),this.selection.addRange(),e},nodeToPoint:function(t,e,i){t=t[0]||t,this.selection.get();var n;if(document.caretPositionFromPoint){var r=document.caretPositionFromPoint(e,i);this.range.setStart(r.offsetNode,r.offset),this.range.collapse(!0),this.range.insertNode(t)}else if(document.caretRangeFromPoint)n=document.caretRangeFromPoint(e,i),n.insertNode(t);else if("undefined"!=typeof document.body.createTextRange){n=document.body.createTextRange(),n.moveToPoint(e,i);var s=n.duplicate();s.moveToPoint(e,i),n.setEndPoint("EndToEnd",s),n.select()}},nodeToCaretPositionFromPoint:function(t,e){e=e[0]||e;var i,n=t.clientX,r=t.clientY;if(document.caretPositionFromPoint){var s=document.caretPositionFromPoint(n,r),o=document.getSelection();i=o.getRangeAt(0),i.setStart(s.offsetNode,s.offset),i.collapse(!0),i.insertNode(e)}else if(document.caretRangeFromPoint)i=document.caretRangeFromPoint(n,r),i.insertNode(e);else if("undefined"!=typeof document.body.createTextRange){i=document.body.createTextRange(),i.moveToPoint(n,r);var a=i.duplicate();a.moveToPoint(n,r),i.setEndPoint("EndToEnd",a),i.select()}},ie11FixInserting:function(e,i){var n=document.createElement("span");n.className="redactor-ie-paste",this.insert.node(n);var r=t(e).html();r="<p>"+r.replace(/<span class="redactor-ie-paste"><\/span>/gi,"</p>"+i+"<p>")+"</p>",r=r.replace(/<p><\/p>/gi,""),t(e).replaceWith(r)},ie11PasteFrag:function(t){this.selection.get(),this.range.deleteContents();var e=document.createElement("div");e.innerHTML=t;for(var i,n,r=document.createDocumentFragment();i=e.firstChild;)n=r.appendChild(i);this.range.insertNode(r),this.range.collapse(!1),this.selection.addRange()}}},keydown:function(){return{init:function(e){if(!this.rtePaste){var i=e.which,n=i>=37&&40>=i;this.keydown.ctrl=e.ctrlKey||e.metaKey,this.keydown.current=this.selection.getCurrent(),this.keydown.parent=this.selection.getParent(),this.keydown.block=this.selection.getBlock(),this.keydown.pre=this.utils.isTag(this.keydown.current,"pre"),this.keydown.blockquote=this.utils.isTag(this.keydown.current,"blockquote"),this.keydown.figcaption=this.utils.isTag(this.keydown.current,"figcaption"),this.shortcuts.init(e,i),this.utils.isDesktop()&&(this.keydown.checkEvents(n,i),this.keydown.setupBuffer(e,i)),this.keydown.addArrowsEvent(n),this.keydown.setupSelectAll(e,i);var r=this.core.setCallback("keydown",e);if(r===!1)return e.preventDefault(),!1;if(this.opts.enterKey&&(this.utils.browser("msie")||this.utils.browser("mozilla"))&&(i===this.keyCode.DOWN||i===this.keyCode.RIGHT)){var s=!1,o=!1;if(this.keydown.block&&"TD"===this.keydown.block.tagName&&(o=t(this.keydown.block).closest("table",this.$editor[0])),o&&o.find("td").last()[0]===this.keydown.block&&(s=!0),this.utils.isEndOfElement()&&s){var a=t(this.opts.emptyHtml);o.after(a),this.caret.setStart(a)}}if(this.opts.enterKey&&i===this.keyCode.DOWN&&this.keydown.onArrowDown(),!this.opts.enterKey&&i===this.keyCode.ENTER)return e.preventDefault(),void(this.range.collapsed||this.range.deleteContents());if(i==this.keyCode.ENTER&&!e.shiftKey&&!e.ctrlKey&&!e.metaKey){var l=this.core.setCallback("enter",e);if(l===!1)return e.preventDefault(),!1;if(this.keydown.blockquote&&this.keydown.exitFromBlockquote(e)===!0)return!1;var c,u;if(this.keydown.pre)return this.keydown.insertNewLine(e);if(this.keydown.blockquote||this.keydown.figcaption)return c=this.selection.getCurrent(),u=t(c).next(),0!==u.length&&"BR"==u[0].tagName?this.keydown.insertBreakLine(e):this.utils.isEndOfElement()&&c&&"SPAN"!=c?this.keydown.insertDblBreakLine(e):this.keydown.insertBreakLine(e);if(this.opts.linebreaks&&!this.keydown.block)return c=this.selection.getCurrent(),u=t(this.keydown.current).next(),0!==u.length&&"BR"==u[0].tagName?this.keydown.insertBreakLine(e):c!==!1&&t(c).hasClass("redactor-invisible-space")?(this.caret.setAfter(c),t(c).contents().unwrap(),this.keydown.insertDblBreakLine(e)):this.utils.isEndOfEditor()?this.keydown.insertDblBreakLine(e):this.keydown.insertBreakLine(0===u.length&&c===!1&&"undefined"!=typeof u.context?e:e);if(this.opts.linebreaks&&this.keydown.block)setTimeout(t.proxy(this.keydown.replaceDivToBreakLine,this),1);else if(!this.opts.linebreaks&&this.keydown.block){if(setTimeout(t.proxy(this.keydown.replaceDivToParagraph,this),1),"LI"===this.keydown.block.tagName){c=this.selection.getCurrent();var h=t(c).closest("li",this.$editor[0]),d=h.closest("ul,ol",this.$editor[0]);if(0!==h.length&&this.utils.isEmpty(h.html())&&0===d.next().length&&this.utils.isEmpty(d.find("li").last().html())){d.find("li").last().remove();var a=t(this.opts.emptyHtml);return d.after(a),this.caret.setStart(a),!1}}}else if(!this.opts.linebreaks&&!this.keydown.block)return this.keydown.insertParagraph(e)}if(i===this.keyCode.ENTER&&(e.ctrlKey||e.shiftKey))return this.keydown.onShiftEnter(e);if(i===this.keyCode.TAB||e.metaKey&&221===i||e.metaKey&&219===i)return this.keydown.onTab(e,i);if(i===this.keyCode.BACKSPACE||i===this.keyCode.DELETE){var p=this.selection.getNodes();if(p)for(var f,g=p.length,m=0;g>m;m++){var v=t(p[m]).children("img");if(0!==v.length){var b=this;t.each(v,function(e,i){var n=t(i);"none"==n.css("float")&&(b.core.setCallback("imageDelete",i.src,n),f=i)})}else"IMG"==p[m].tagName&&f!=p[m]&&(this.core.setCallback("imageDelete",p[m].src,t(p[m])),f=p[m])}}if(i===this.keyCode.BACKSPACE){var y=this.selection.getBlock(),_="0px"!==t(y).css("margin-left");if(y&&_&&this.range.collapsed&&this.utils.isStartOfElement())return this.indent.decrease(),void e.preventDefault();if(this.utils.browser("mozilla")){var w=this.selection.getPrev(),x=t(w).prev()[0];w&&"HR"===w.tagName&&t(w).remove(),x&&"HR"===x.tagName&&t(x).remove()}this.keydown.removeInvisibleSpace(),this.keydown.removeEmptyListInTable(e)}this.code.sync()}},checkEvents:function(t,e){t||"click"!=this.core.getEvent()&&"arrow"!=this.core.getEvent()||(this.core.addEvent(!1),this.keydown.checkKeyEvents(e)&&this.buffer.set())},checkKeyEvents:function(e){var i=this.keyCode,n=[i.BACKSPACE,i.DELETE,i.ENTER,i.SPACE,i.ESC,i.TAB,i.CTRL,i.META,i.ALT,i.SHIFT];return-1==t.inArray(e,n)?!0:!1},addArrowsEvent:function(t){return t?"click"==this.core.getEvent()||"arrow"==this.core.getEvent()?void this.core.addEvent(!1):void this.core.addEvent("arrow"):void 0},setupBuffer:function(t,e){return this.keydown.ctrl&&90===e&&!t.shiftKey&&!t.altKey&&this.opts.buffer.length?(t.preventDefault(),void this.buffer.undo()):this.keydown.ctrl&&90===e&&t.shiftKey&&!t.altKey&&0!==this.opts.rebuffer.length?(t.preventDefault(),void this.buffer.redo()):void(this.keydown.ctrl||(e==this.keyCode.BACKSPACE||e==this.keyCode.DELETE||e==this.keyCode.ENTER&&!t.ctrlKey&&!t.shiftKey||e==this.keyCode.SPACE)&&this.buffer.set())},setupSelectAll:function(t,e){this.keydown.ctrl&&65===e?this.utils.enableSelectAll():e==this.keyCode.LEFT_WIN||this.keydown.ctrl||this.utils.disableSelectAll()},onArrowDown:function(){for(var t=[this.keydown.blockquote,this.keydown.pre,this.keydown.figcaption],e=0;e<t.length;e++)if(t[e])return this.keydown.insertAfterLastElement(t[e]),!1},onShiftEnter:function(t){return this.buffer.set(),this.utils.isEndOfElement()?this.keydown.insertDblBreakLine(t):this.keydown.insertBreakLine(t)},onTab:function(t,e){if(!this.opts.tabKey)return!0;if(this.utils.isEmpty(this.code.get())&&this.opts.tabAsSpaces===!1)return!0;t.preventDefault();var i;return this.keydown.pre&&!t.shiftKey?(i=document.createTextNode(this.opts.preSpaces?Array(this.opts.preSpaces+1).join(""):"	"),this.insert.node(i),this.code.sync()):this.opts.tabAsSpaces!==!1?(i=document.createTextNode(Array(this.opts.tabAsSpaces+1).join("")),this.insert.node(i),this.code.sync()):t.metaKey&&219===e?this.indent.decrease():t.metaKey&&221===e?this.indent.increase():t.shiftKey?this.indent.decrease():this.indent.increase(),!1},replaceDivToBreakLine:function(){var e=this.selection.getBlock(),i=e.innerHTML.replace(/<br\s?\/?>/gi,"");if(("DIV"===e.tagName||"P"===e.tagName)&&""===i&&!t(e).hasClass("redactor-editor")){var n=document.createElement("br");return t(e).replaceWith(n),this.caret.setBefore(n),this.code.sync(),!1}},replaceDivToParagraph:function(){var e=this.selection.getBlock(),i=e.innerHTML.replace(/<br\s?\/?>/gi,"");if("DIV"===e.tagName&&this.utils.isEmpty(i)&&!t(e).hasClass("redactor-editor")){var n=document.createElement("p");return n.innerHTML=this.opts.invisibleSpace,t(e).replaceWith(n),this.caret.setStart(n),this.code.sync(),!1}this.opts.cleanStyleOnEnter&&"P"==e.tagName&&t(e).removeAttr("class").removeAttr("style")},insertParagraph:function(t){t.preventDefault(),this.selection.get();var e=document.createElement("p");return e.innerHTML=this.opts.invisibleSpace,this.range.deleteContents(),this.range.insertNode(e),this.caret.setStart(e),this.code.sync(),!1},exitFromBlockquote:function(e){if(this.utils.isEndOfElement()){var i=t.trim(t(this.keydown.block).html());if(-1!=i.search(/(<br\s?\/?>){2}$/i)){if(e.preventDefault(),this.opts.linebreaks){var n=document.createElement("br");t(this.keydown.blockquote).after(n),this.caret.setBefore(n),t(this.keydown.block).html(i.replace(/<br\s?\/?>$/i,""))}else{var r=t(this.opts.emptyHtml);t(this.keydown.blockquote).after(r),this.caret.setStart(r)}return!0}}},insertAfterLastElement:function(e){if(this.utils.isEndOfElement())if(this.buffer.set(),this.opts.linebreaks){var i=t("<div>").append(t.trim(this.$editor.html())).contents(),n=i.last()[0];if("SPAN"==n.tagName&&""===n.innerHTML&&(n=i.prev()[0]),this.utils.getOuterHtml(n)!=this.utils.getOuterHtml(e))return;var r=document.createElement("br");t(e).after(r),this.caret.setAfter(r)}else{if(this.$editor.contents().last()[0]!==e)return;var s=t(this.opts.emptyHtml);t(e).after(s),this.caret.setStart(s)}},insertNewLine:function(t){t.preventDefault();var e=document.createTextNode("\n");return this.selection.get(),this.range.deleteContents(),this.range.insertNode(e),this.caret.setAfter(e),this.code.sync(),!1},insertBreakLine:function(t){return this.keydown.insertBreakLineProcessing(t)},insertDblBreakLine:function(t){return this.keydown.insertBreakLineProcessing(t,!0)},insertBreakLineProcessing:function(e,i){e.stopPropagation(),this.selection.get();var n=document.createElement("br");this.utils.browser("msie")?(this.range.collapse(!1),this.range.setEnd(this.range.endContainer,this.range.endOffset)):this.range.deleteContents(),this.range.insertNode(n);var r=t(n).parent("a");if(r.length>0&&(r.find(n).remove(),r.after(n)),i===!0){var s=t(n).next();if(0!==s.length&&"BR"===s[0].tagName&&this.utils.isEndOfEditor())return this.caret.setAfter(n),this.code.sync(),!1;var o=document.createElement("br");this.range.insertNode(o),this.caret.setAfter(o)}else if(this.utils.browser("msie")){var a=document.createElement("span");a.innerHTML="&#x200b;",t(n).after(a),this.caret.setAfter(a),t(a).remove()}else{var l=document.createRange();l.setStartAfter(n),l.collapse(!0);var c=window.getSelection();c.removeAllRanges(),c.addRange(l)}return this.code.sync(),!1},removeInvisibleSpace:function(){var e=t(this.keydown.current);0===e.text().search(/^\u200B$/g)&&e.remove()},removeEmptyListInTable:function(e){var i=t(this.keydown.current),n=t(this.keydown.parent),r=i.closest("td",this.$editor[0]);if(0!==r.length&&i.closest("li",this.$editor[0])&&1===n.children("li").length){if(!this.utils.isEmpty(i.text()))return;e.preventDefault(),i.remove(),n.remove(),this.caret.setStart(r)}}}},keyup:function(){return{init:function(e){if(!this.rtePaste){var i=e.which;this.keyup.current=this.selection.getCurrent(),this.keyup.parent=this.selection.getParent();var n=this.utils.isRedactorParent(t(this.keyup.parent).parent()),r=this.core.setCallback("keyup",e);if(r===!1)return e.preventDefault(),!1;if(!this.opts.linebreaks&&3==this.keyup.current.nodeType&&this.keyup.current.length<=1&&(this.keyup.parent===!1||"BODY"==this.keyup.parent.tagName)&&this.keyup.replaceToParagraph(),!this.opts.linebreaks&&this.utils.isRedactorParent(this.keyup.current)&&"DIV"===this.keyup.current.tagName&&this.keyup.replaceToParagraph(!1),this.opts.linebreaks||!t(this.keyup.parent).hasClass("redactor-invisible-space")||n!==!1&&"BODY"!=n[0].tagName||(t(this.keyup.parent).contents().unwrap(),this.keyup.replaceToParagraph()),this.linkify.isEnabled()&&this.linkify.isKey(i)&&this.linkify.format(),i===this.keyCode.DELETE||i===this.keyCode.BACKSPACE){if(this.utils.browser("mozilla")){var s=t(this.keydown.current).closest("td",this.$editor[0]);if(0!==s.size()&&""!==s.text())return e.preventDefault(),!1}return this.clean.clearUnverified(),this.observe.image?(e.preventDefault(),this.image.hideResize(),this.buffer.set(),this.image.remove(this.observe.image),this.observe.image=!1,!1):(this.$editor.find("p").each(t.proxy(function(e,i){this.utils.removeEmpty(e,t(i).html())},this)),this.opts.linebreaks&&this.keyup.current&&"DIV"==this.keyup.current.tagName&&this.utils.isEmpty(this.keyup.current.innerHTML)&&(t(this.keyup.current).after(this.selection.getMarkerAsHtml()),this.selection.restore(),t(this.keyup.current).remove()),this.keyup.formatEmpty(e))}}},replaceToParagraph:function(e){var i,n=t(this.keyup.current);i=t("<p>").append(e===!1?n.html():n.clone()),n.replaceWith(i);var r=t(i).next();"undefined"!=typeof r[0]&&"BR"==r[0].tagName&&r.remove(),this.caret.setEnd(i)},formatEmpty:function(e){var i=t.trim(this.$editor.html());if(this.utils.isEmpty(i))return e.preventDefault(),this.opts.linebreaks?(this.$editor.html(this.selection.getMarkerAsHtml()),this.selection.restore()):(this.$editor.html(this.opts.emptyHtml),this.focus.setStart()),this.code.sync(),!1}}},lang:function(){return{load:function(){this.opts.curLang=this.opts.langs[this.opts.lang]},get:function(t){return"undefined"!=typeof this.opts.curLang[t]?this.opts.curLang[t]:""}}},line:function(){return{insert:function(){this.buffer.set();var t=this.selection.getBlocks();return t[0]!==!1&&this.line.isExceptLastOrFirst(t)?void(this.utils.browser("msie")||this.$editor.focus()):void(this.utils.browser("msie")?this.line.insertInIe():this.line.insertInOthersBrowsers())},isExceptLastOrFirst:function(e){var i=["li","td","th","blockquote","figcaption","pre","dl","dt","dd"],n=e[0].tagName.toLowerCase(),r=this.selection.getLastBlock();r="undefined"==typeof r?n:r.tagName.toLowerCase();var s=-1!=t.inArray(n,i),o=-1!=t.inArray(r,i);return s&&o||s?!0:void 0},insertInIe:function(){this.utils.saveScroll(),this.buffer.set(),this.insert.node(document.createElement("hr")),this.utils.restoreScroll(),this.code.sync()},insertInOthersBrowsers:function(){this.buffer.set();var t='<p id="redactor-insert-line"><br /></p>';this.opts.linebreaks&&(t='<br id="redactor-insert-line">'),document.execCommand("insertHtml",!1,"<hr>"+t),this.line.setFocus(),this.code.sync()},setFocus:function(){var e=this.$editor.find("#redactor-insert-line"),i=t(e).next()[0],n=i;this.utils.browser("mozilla")&&i&&""===i.innerHTML&&(n=t(i).next()[0],t(i).remove()),n?(e.remove(),this.opts.linebreaks||(this.$editor.focus(),this.line.setStart(n))):(e.removeAttr("id"),this.line.setStart(e[0]))},setStart:function(t){if("undefined"!=typeof t){var e=document.createTextNode("");this.selection.get(),this.range.setStart(t,0),this.range.insertNode(e),this.range.collapse(!0),this.selection.addRange()}}}},link:function(){return{show:function(e){"undefined"!=typeof e&&e.preventDefault&&e.preventDefault(),this.observe.isCurrent("a")?this.modal.load("link",this.lang.get("link_edit"),600):this.modal.load("link",this.lang.get("link_insert"),600),this.modal.createCancelButton();var i=this.lang.get(this.observe.isCurrent("a")?"edit":"insert");this.link.buttonInsert=this.modal.createActionButton(i),this.selection.get(),this.link.getData(),this.link.cleanUrl(),"_blank"==this.link.target&&t("#redactor-link-blank").prop("checked",!0),this.link.$inputUrl=t("#redactor-link-url"),this.link.$inputText=t("#redactor-link-url-text"),this.link.$inputText.val(this.link.text),this.link.$inputUrl.val(this.link.url),this.link.buttonInsert.on("click",t.proxy(this.link.insert,this)),t(".redactor-link-tooltip").remove(),this.selection.save(),this.modal.show(),this.link.$inputUrl.focus()},cleanUrl:function(){var t=self.location.href.replace(/\/$/i,"");if("undefined"!=typeof this.link.url&&(this.link.url=this.link.url.replace(t,""),this.link.url=this.link.url.replace(/^\/#/,"#"),this.link.url=this.link.url.replace("mailto:",""),!this.opts.linkProtocol)){var e=new RegExp("^(http|ftp|https)://"+self.location.host,"i");this.link.url=this.link.url.replace(e,"")}},getData:function(){this.link.$node=!1;var e=t(this.selection.getCurrent()).closest("a",this.$editor[0]);0!==e.length&&"A"===e[0].tagName?(this.link.$node=e,this.link.url=e.attr("href"),this.link.text=e.text(),this.link.target=e.attr("target")):(this.link.text=this.sel.toString(),this.link.url="",this.link.target="")},insert:function(){this.placeholder.remove();var e="",i=this.link.$inputUrl.val(),n=this.link.$inputText.val().replace(/(<([^>]+)>)/gi,"");if(""===t.trim(i))return void this.link.$inputUrl.addClass("redactor-input-error").on("keyup",function(){t(this).removeClass("redactor-input-error"),t(this).off("keyup")});if(-1!=i.search("@")&&/(http|ftp|https):\/\//i.test(i)===!1)i="mailto:"+i;else if(0!==i.search("#")){t("#redactor-link-blank").prop("checked")&&(e="_blank");var r="((xn--)?[a-z0-9]+(-[a-z0-9]+)*\\.)+[a-z]{2,}",s=new RegExp("^(http|ftp|https)://"+r,"i"),o=new RegExp("^"+r,"i"),a=new RegExp(".(html|php)$","i");-1==i.search(s)&&-1==i.search(a)&&0===i.search(o)&&this.opts.linkProtocol&&(i=this.opts.linkProtocol+"://"+i)}this.link.set(n,i,e),this.modal.close()},set:function(e,i,n){e=t.trim(e.replace(/<|>/g,"")),this.selection.restore();var r=this.selection.getBlocks();if(""!==e||""!==i){if(""===e&&""!==i&&(e=i),this.link.$node){this.buffer.set();var s=this.link.$node,o=s.children();if(o.length>0){for(;o.length;)o=o.children();o=o.end()}else o=s;s.attr("href",i),o.text(e),""!==n?s.attr("target",n):s.removeAttr("target"),this.selection.selectElement(s),this.code.sync()}else{if(this.utils.browser("mozilla")&&""===this.link.text){var a=t("<a />").attr("href",i).text(e);""!==n&&a.attr("target",n),this.insert.node(a),this.selection.selectElement(a)}else{var a;this.utils.browser("msie")?(a=t('<a href="'+i+'">').text(e),""!==n&&a.attr("target",n),a=t(this.insert.node(a)),this.selection.getText().match(/\s$/)&&a.after(" "),this.selection.selectElement(a)):(document.execCommand("createLink",!1,i),a=t(this.selection.getCurrent()).closest("a",this.$editor[0]),this.utils.browser("mozilla")&&(a=t('a[_moz_dirty=""]')),""!==n&&a.attr("target",n),a.removeAttr("style").removeAttr("_moz_dirty"),this.selection.getText().match(/\s$/)&&a.after(" "),(""!==this.link.text||this.link.text!=e)&&(!this.opts.linebreaks&&r&&r.length<=1&&a.text(e),this.selection.selectElement(a)))}this.code.sync(),this.core.setCallback("insertedLink",a)}setTimeout(t.proxy(function(){this.observe.links()},this),5)}},unlink:function(e){"undefined"!=typeof e&&e.preventDefault&&e.preventDefault();var i=this.selection.getNodes();if(i){this.buffer.set();for(var n=i.length,r=[],s=0;n>s;s++){"A"===i[s].tagName&&r.push(i[s]);var o=t(i[s]).closest("a",this.$editor[0]);o.replaceWith(o.contents())}this.core.setCallback("deletedLink",r),t(".redactor-link-tooltip").remove(),this.code.sync()}},toggleClass:function(t){this.link.setClass(t,"toggleClass")},addClass:function(t){this.link.setClass(t,"addClass")},removeClass:function(t){this.link.setClass(t,"removeClass")},setClass:function(e,i){var n=this.selection.getInlinesTags(["a"]);n!==!1&&t.each(n,function(){t(this)[i](e)})}}},linkify:function(){return{isKey:function(t){return t==this.keyCode.ENTER||t==this.keyCode.SPACE},isEnabled:function(){return this.opts.convertLinks&&(this.opts.convertUrlLinks||this.opts.convertImageLinks||this.opts.convertVideoLinks)&&!this.utils.isCurrentOrParent("PRE")},format:function(){var e=this.linkify,i=this.opts;this.$editor.find(":not(iframe,img,a,pre)").addBack().contents().filter(function(){return 3===this.nodeType&&""!=t.trim(this.nodeValue)&&!t(this).parent().is("pre")&&(this.nodeValue.match(i.linkify.regexps.youtube)||this.nodeValue.match(i.linkify.regexps.vimeo)||this.nodeValue.match(i.linkify.regexps.image)||this.nodeValue.match(i.linkify.regexps.url))}).each(function(){var n=t(this).text(),r=n;i.convertVideoLinks&&(r.match(i.linkify.regexps.youtube)||r.match(i.linkify.regexps.vimeo))?r=e.convertVideoLinks(r):i.convertImageLinks&&r.match(i.linkify.regexps.image)?r=e.convertImages(r):i.convertUrlLinks&&(r=e.convertLinks(r)),t(this).before(n.replace(n,r)).remove()});var n=this.$editor.find(".redactor-linkify-object").each(function(){var e=t(this);return e.removeClass("redactor-linkify-object"),""===e.attr("class")&&e.removeAttr("class"),e[0]});this.core.setCallback("linkify",n),this.code.sync()},convertVideoLinks:function(t){var e='<iframe class="redactor-linkify-object" width="500" height="281" src="',i='" frameborder="0" allowfullscreen></iframe>';return t.match(this.opts.linkify.regexps.youtube)&&(t=t.replace(this.opts.linkify.regexps.youtube,e+"//www.youtube.com/embed/$1"+i)),t.match(this.opts.linkify.regexps.vimeo)&&(t=t.replace(this.opts.linkify.regexps.vimeo,e+"//player.vimeo.com/video/$2"+i)),t},convertImages:function(t){var e=t.match(this.opts.linkify.regexps.image);return e&&(t=t.replace(t,'<img src="'+e+'" class="redactor-linkify-object" />'),this.opts.linebreaks&&(this.utils.isEmpty(this.code.get())||(t="<br>"+t)),t+="<br>"),t},convertLinks:function(e){var i=e.match(this.opts.linkify.regexps.url);if(i){i=t.grep(i,function(e,n){return t.inArray(e,i)===n});for(var n=i.length,r=0;n>r;r++){var s=i[r],o=s,a=this.opts.linkProtocol+"://";null!==s.match(/(https?|ftp):\/\//i)&&(a=""),o.length>this.opts.linkSize&&(o=o.substring(0,this.opts.linkSize)+"..."),o=decodeURIComponent(o);var l="\\b";-1!=t.inArray(s.slice(-1),["/","&","="])&&(l="");var c=new RegExp("("+s.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")+l+")","g");e=e.replace(c,'<a href="'+a+t.trim(s)+'" class="redactor-linkify-object">'+t.trim(o)+"</a>")}}return e}}},list:function(){return{toggle:function(e){this.placeholder.remove(),this.utils.browser("msie")||this.$editor.focus(),this.buffer.set(),this.selection.save();var i=this.selection.getParent(),n=t(i).closest("ol, ul",this.$editor[0]);this.utils.isRedactorParent(n)||0===n.length||(n=!1);var r,s,o=!1;if(n&&n.length){o=!0;var a=n[0].tagName;r="orderedlist"===e&&"UL"===a,s="unorderedlist"===e&&"OL"===a}r?this.utils.replaceToTag(n,"ol"):s?this.utils.replaceToTag(n,"ul"):o?this.list.remove(e,n):this.list.insert(e),this.selection.restore(),this.code.sync()},insert:function(e){var i=this.selection.getCurrent(),n=t(i).closest("td, th",this.$editor[0]);this.utils.browser("msie")&&this.opts.linebreaks?this.list.insertInIe(e):document.execCommand("insert"+e);var r=this.selection.getParent(),s=t(r).closest("ol, ul",this.$editor[0]);if(0!==n.length){var o=n.clone();n.after(o).remove("")}if(this.utils.isEmpty(s.find("li").text())){var a=s.children("li");a.find("br").remove(),a.append(this.selection.getMarkerAsHtml()),this.opts.linebreaks&&this.utils.browser("mozilla")&&2==a.size()&&this.utils.isEmpty(a.eq(1).text())&&a.eq(1).remove()}if(s.length){var l=s.parent();this.utils.isRedactorParent(l)&&"LI"!=l[0].tagName&&this.utils.isBlock(l[0])&&l.replaceWith(l.contents())}this.utils.browser("msie")||this.$editor.focus(),this.clean.clearUnverified()},insertInIe:function(e){var i=this.selection.wrap("div"),n=t(i).html(),r=t("orderedlist"==e?"<ol>":"<ul>"),s=t("<li>");if(""===t.trim(n))s.append(this.selection.getMarkerAsHtml()),r.append(s),this.$editor.find("#selection-marker-1").replaceWith(r);else{var o=n.split(/<br\s?\/?>/gi);if(o)for(var a=0;a<o.length;a++)""!==t.trim(o[a])&&r.append(t("<li>").html(o[a]));else s.append(n),r.append(s);t(i).replaceWith(r)}},remove:function(e){t.inArray("ul",this.selection.getBlocks())&&(e="unorderedlist"),document.execCommand("insert"+e);var i=t(this.selection.getCurrent());this.indent.fixEmptyIndent(),this.opts.linebreaks||0!==i.closest("li, th, td",this.$editor[0]).length||(document.execCommand("formatblock",!1,"p"),this.$editor.find("ul, ol, blockquote").each(t.proxy(this.utils.removeEmpty,this)));var n=t(this.selection.getCurrent()).closest("table",this.$editor[0]),r=n.prev();this.opts.linebreaks||0===n.length||0===r.length||"BR"!=r[0].tagName||r.remove(),this.clean.clearUnverified()}}},modal:function(){return{callbacks:{},loadTemplates:function(){this.opts.modal={imageEdit:String()+'<section id="redactor-modal-image-edit"><label>'+this.lang.get("title")+'</label><input type="text" id="redactor-image-title" /><label class="redactor-image-link-option">'+this.lang.get("link")+'</label><input type="text" id="redactor-image-link" class="redactor-image-link-option" aria-label="'+this.lang.get("link")+'" /><label class="redactor-image-link-option"><input type="checkbox" id="redactor-image-link-blank" aria-label="'+this.lang.get("link_new_tab")+'"> '+this.lang.get("link_new_tab")+'</label><label class="redactor-image-position-option">'+this.lang.get("image_position")+'</label><select class="redactor-image-position-option" id="redactor-image-align" aria-label="'+this.lang.get("image_position")+'"><option value="none">'+this.lang.get("none")+'</option><option value="left">'+this.lang.get("left")+'</option><option value="center">'+this.lang.get("center")+'</option><option value="right">'+this.lang.get("right")+"</option></select></section>",image:String()+'<section id="redactor-modal-image-insert"><div id="redactor-modal-image-droparea"></div></section>',file:String()+'<section id="redactor-modal-file-insert"><div id="redactor-modal-file-upload-box"><label>'+this.lang.get("filename")+'</label><input type="text" id="redactor-filename" aria-label="'+this.lang.get("filename")+'" /><br><br><div id="redactor-modal-file-upload"></div></div></section>',link:String()+'<section id="redactor-modal-link-insert"><label>URL</label><input type="url" id="redactor-link-url" aria-label="URL" /><label>'+this.lang.get("text")+'</label><input type="text" id="redactor-link-url-text" aria-label="'+this.lang.get("text")+'" /><label><input type="checkbox" id="redactor-link-blank"> '+this.lang.get("link_new_tab")+"</label></section>"},t.extend(this.opts,this.opts.modal)
},addCallback:function(t,e){this.modal.callbacks[t]=e},createTabber:function(e){this.modal.$tabber=t("<div>").attr("id","redactor-modal-tabber"),e.prepend(this.modal.$tabber)},addTab:function(e,i,n){var r=t('<a href="#" rel="tab'+e+'">').text(i);n&&r.addClass("active");var s=this;r.on("click",function(e){e.preventDefault(),t(".redactor-tab").hide(),t(".redactor-"+t(this).attr("rel")).show(),s.modal.$tabber.find("a").removeClass("active"),t(this).addClass("active")}),this.modal.$tabber.append(r)},addTemplate:function(t,e){this.opts.modal[t]=e},getTemplate:function(t){return this.opts.modal[t]},getModal:function(){return this.$modalBody.find("section")},load:function(t,e,i){this.modal.templateName=t,this.modal.width=i,this.modal.build(),this.modal.enableEvents(),this.modal.setTitle(e),this.modal.setDraggable(),this.modal.setContent(),"undefined"!=typeof this.modal.callbacks[t]&&this.modal.callbacks[t].call(this)},show:function(){this.utils.disableBodyScroll(),this.utils.isMobile()?this.modal.showOnMobile():this.modal.showOnDesktop(),this.opts.highContrast&&this.$modalBox.addClass("redactor-modal-contrast"),this.$modalOverlay.show(),this.$modalBox.show(),this.$modal.attr("tabindex","-1"),this.$modal.focus(),this.modal.setButtonsWidth(),this.utils.saveScroll(),this.utils.isMobile()||(setTimeout(t.proxy(this.modal.showOnDesktop,this),0),t(window).on("resize.redactor-modal",t.proxy(this.modal.resize,this))),this.core.setCallback("modalOpened",this.modal.templateName,this.$modal),t(document).off("focusin.modal"),this.$modal.find("input[type=text],input[type=url],input[type=email]").on("keydown.redactor-modal",t.proxy(this.modal.setEnter,this))},showOnDesktop:function(){var e=this.$modal.outerHeight(),i=t(window).height(),n=t(window).width();return this.modal.width>n?void this.$modal.css({width:"96%",marginTop:i/2-e/2+"px"}):void this.$modal.css(e>i?{width:this.modal.width+"px",marginTop:"20px"}:{width:this.modal.width+"px",marginTop:i/2-e/2+"px"})},showOnMobile:function(){this.$modal.css({width:"96%",marginTop:"2%"})},resize:function(){this.utils.isMobile()?this.modal.showOnMobile():this.modal.showOnDesktop()},setTitle:function(t){this.$modalHeader.html(t)},setContent:function(){this.$modalBody.html(this.modal.getTemplate(this.modal.templateName))},setDraggable:function(){"undefined"!=typeof t.fn.draggable&&(this.$modal.draggable({handle:this.$modalHeader}),this.$modalHeader.css("cursor","move"))},setEnter:function(t){13==t.which&&(t.preventDefault(),this.$modal.find("button.redactor-modal-action-btn").click())},createCancelButton:function(){var e=t("<button>").addClass("redactor-modal-btn redactor-modal-close-btn").html(this.lang.get("cancel"));e.on("click",t.proxy(this.modal.close,this)),this.$modalFooter.append(e)},createDeleteButton:function(t){return this.modal.createButton(t,"delete")},createActionButton:function(t){return this.modal.createButton(t,"action")},createButton:function(e,i){var n=t("<button>").addClass("redactor-modal-btn").addClass("redactor-modal-"+i+"-btn").html(e);return this.$modalFooter.append(n),n},setButtonsWidth:function(){var t=this.$modalFooter.find("button"),e=t.length;0!==e&&t.css("width",100/e+"%")},build:function(){this.modal.buildOverlay(),this.$modalBox=t('<div id="redactor-modal-box"/>').hide(),this.$modal=t('<div id="redactor-modal" role="dialog" aria-labelledby="redactor-modal-header" />'),this.$modalHeader=t('<header id="redactor-modal-header"/>'),this.$modalClose=t('<button type="button" id="redactor-modal-close" tabindex="1" aria-label="Close" />').html("&times;"),this.$modalBody=t('<div id="redactor-modal-body" />'),this.$modalFooter=t("<footer />"),this.$modal.append(this.$modalHeader),this.$modal.append(this.$modalClose),this.$modal.append(this.$modalBody),this.$modal.append(this.$modalFooter),this.$modalBox.append(this.$modal),this.$modalBox.appendTo(document.body)},buildOverlay:function(){this.$modalOverlay=t('<div id="redactor-modal-overlay">').hide(),t("body").prepend(this.$modalOverlay)},enableEvents:function(){this.$modalClose.on("click.redactor-modal",t.proxy(this.modal.close,this)),t(document).on("keyup.redactor-modal",t.proxy(this.modal.closeHandler,this)),this.$editor.on("keyup.redactor-modal",t.proxy(this.modal.closeHandler,this)),this.$modalBox.on("click.redactor-modal",t.proxy(this.modal.close,this))},disableEvents:function(){this.$modalClose.off("click.redactor-modal"),t(document).off("keyup.redactor-modal"),this.$editor.off("keyup.redactor-modal"),this.$modalBox.off("click.redactor-modal"),t(window).off("resize.redactor-modal")},closeHandler:function(t){t.which==this.keyCode.ESC&&this.modal.close(!1)},close:function(e){if(e){if(!t(e.target).hasClass("redactor-modal-close-btn")&&e.target!=this.$modalClose[0]&&e.target!=this.$modalBox[0])return;e.preventDefault()}this.$modalBox&&(this.modal.disableEvents(),this.utils.enableBodyScroll(),this.$modalOverlay.remove(),this.$modalBox.fadeOut("fast",t.proxy(function(){this.$modalBox.remove(),setTimeout(t.proxy(this.utils.restoreScroll,this),0),void 0!==e&&this.selection.restore(),t(document.body).css("overflow",this.modal.bodyOveflow),this.core.setCallback("modalClosed",this.modal.templateName)},this)))}}},observe:function(){return{load:function(){if("undefined"==typeof this.opts.destroyed){if(this.utils.browser("msie")){var e=this;this.$editor.find("pre, code").on("mouseover",function(){e.$editor.attr("contenteditable",!1),t(this).attr("contenteditable",!0)}).on("mouseout",function(){e.$editor.attr("contenteditable",!0),t(this).removeAttr("contenteditable")})}this.observe.images(),this.observe.links()}},toolbar:function(t,e){this.observe.buttons(t,e),this.observe.dropdowns()},isCurrent:function(e,i){if("undefined"==typeof i)var i=t(this.selection.getCurrent());return i.is(e)||i.parents(e).length>0},dropdowns:function(){var e=t(this.selection.getCurrent());t.each(this.opts.observe.dropdowns,t.proxy(function(t,i){var n=i.observe,r=n.element,s=i.item,o="undefined"!=typeof n["in"]?n["in"]:!1,a="undefined"!=typeof n.out?n.out:!1;e.closest(r).size()>0?this.observe.setDropdownProperties(s,o,a):this.observe.setDropdownProperties(s,a,o)},this))},setDropdownProperties:function(t,e,i){i&&"undefined"!=typeof i.attr&&this.observe.setDropdownAttr(t,i.attr,!0),"undefined"!=typeof e.attr&&this.observe.setDropdownAttr(t,e.attr),"undefined"!=typeof e.title&&t.text(e.title)},setDropdownAttr:function(e,i,n){t.each(i,function(t,i){"class"==t?n?e.removeClass(i):e.addClass(i):n?e.removeAttr(t):e.attr(t,i)})},addDropdown:function(t,e,i){"undefined"!=typeof i.observe&&(i.item=t,this.opts.observe.dropdowns.push(i))},buttons:function(e,i){var n=this.selection.getCurrent(),r=this.selection.getParent();if(e!==!1?this.button.setInactiveAll():this.button.setInactiveAll(i),e===!1&&"html"!==i)return void(-1!=t.inArray(i,this.opts.activeButtons)&&this.button.toggleActive(i));t.each(this.opts.activeButtonsStates,t.proxy(function(e,i){var s=t(r).closest(e,this.$editor[0]),o=t(n).closest(e,this.$editor[0]);(0===s.length||this.utils.isRedactorParent(s))&&this.utils.isRedactorParent(o)&&(0!==s.length||0!==o.closest(e,this.$editor[0]).length)&&this.button.setActive(i)},this));var s=t(r).closest(this.opts.alignmentTags.toString().toLowerCase(),this.$editor[0]);if(this.utils.isRedactorParent(r)&&s.length){var o=""===s.css("text-align")?"left":s.css("text-align");this.button.setActive("align"+o)}},addButton:function(t,e){this.opts.activeButtons.push(e),this.opts.activeButtonsStates[t]=e},images:function(){this.$editor.find("img").each(t.proxy(function(e,i){var n=t(i);n.closest("a",this.$editor[0]).on("click",function(t){t.preventDefault()}),this.utils.browser("msie")&&n.attr("unselectable","on"),this.image.setEditable(n)},this)),t(document).on("click.redactor-image-delete."+this.uuid,t.proxy(function(t){this.observe.image=!1,"IMG"==t.target.tagName&&this.utils.isRedactorParent(t.target)&&(this.observe.image=this.observe.image&&this.observe.image==t.target?!1:t.target)},this))},links:function(){this.opts.linkTooltip&&(this.$editor.find("a").on("touchstart.redactor."+this.uuid+" click.redactor."+this.uuid,t.proxy(this.observe.showTooltip,this)),this.$editor.on("touchstart.redactor."+this.uuid+" click.redactor."+this.uuid,t.proxy(this.observe.closeTooltip,this)),t(document).on("touchstart.redactor."+this.uuid+" click.redactor."+this.uuid,t.proxy(this.observe.closeTooltip,this)))},getTooltipPosition:function(t){return t.offset()},showTooltip:function(e){var i=t(e.target);if("IMG"!=i[0].tagName&&("A"!==i[0].tagName&&(i=i.closest("a",this.$editor[0])),"A"===i[0].tagName)){var n=i,r=this.observe.getTooltipPosition(n),s=t('<span class="redactor-link-tooltip"></span>'),o=n.attr("href");void 0===o&&(o=""),o.length>24&&(o=o.substring(0,24)+"...");var a=t('<a href="'+n.attr("href")+'" target="_blank" />').html(o).addClass("redactor-link-tooltip-action"),l=t('<a href="#" />').html(this.lang.get("edit")).on("click",t.proxy(this.link.show,this)).addClass("redactor-link-tooltip-action"),c=t('<a href="#" />').html(this.lang.get("unlink")).on("click",t.proxy(this.link.unlink,this)).addClass("redactor-link-tooltip-action");s.append(a).append(" | ").append(l).append(" | ").append(c),s.css({top:r.top+parseInt(n.css("line-height"),10)+"px",left:r.left+"px"}),t(".redactor-link-tooltip").remove(),t("body").append(s)}},closeTooltip:function(e){e=e.originalEvent||e;var i=e.target,n=t(i).closest("a",this.$editor[0]);(0===n.length||"A"!==n[0].tagName||"A"===i.tagName)&&("A"===i.tagName&&this.utils.isRedactorParent(i)||t(i).hasClass("redactor-link-tooltip-action")||t(".redactor-link-tooltip").remove())}}},paragraphize:function(){return{load:function(e){return this.opts.linebreaks?e:""===e||"<p></p>"===e?this.opts.emptyHtml:(e+="\n",this.paragraphize.safes=[],this.paragraphize.z=0,e=e.replace(/(<br\s?\/?>){1,}\n?<\/blockquote>/gi,"</blockquote>"),e=this.paragraphize.getSafes(e),e=this.paragraphize.getSafesComments(e),e=this.paragraphize.replaceBreaksToNewLines(e),e=this.paragraphize.replaceBreaksToParagraphs(e),e=this.paragraphize.clear(e),e=this.paragraphize.restoreSafes(e),e=e.replace(new RegExp("<br\\s?/?>\n?<("+this.opts.paragraphizeBlocks.join("|")+")(.*?[^>])>","gi"),"<p><br /></p>\n<$1$2>"),t.trim(e))},getSafes:function(e){var i=t("<div />").append(e);return i.find("blockquote p").replaceWith(function(){return t(this).append("<br />").contents()}),e=i.html(),i.find(this.opts.paragraphizeBlocks.join(", ")).each(t.proxy(function(t,i){this.paragraphize.z++,this.paragraphize.safes[this.paragraphize.z]=i.outerHTML,e=e.replace(i.outerHTML,"\n{replace"+this.paragraphize.z+"}")},this)),e},getSafesComments:function(e){var i=e.match(/<!--([\w\W]*?)-->/gi);return i?(t.each(i,t.proxy(function(t,i){this.paragraphize.z++,this.paragraphize.safes[this.paragraphize.z]=i,e=e.replace(i,"\n{replace"+this.paragraphize.z+"}")},this)),e):e},restoreSafes:function(e){return t.each(this.paragraphize.safes,function(t,i){i="undefined"!=typeof i?i.replace(/\$/g,"&#36;"):i,e=e.replace("{replace"+t+"}",i)}),e},replaceBreaksToParagraphs:function(t){var e=t.split(new RegExp("\n","g"),-1);if(t="",e)for(var i=e.length,n=0;i>n;n++){if(!e.hasOwnProperty(n))return;-1==e[n].search("{replace")?(e[n]=e[n].replace(/<p>\n\t?<\/p>/gi,""),e[n]=e[n].replace(/<p><\/p>/gi,""),""!==e[n]&&(t+="<p>"+e[n].replace(/^\n+|\n+$/g,"")+"</p>")):t+=e[n]}return t},replaceBreaksToNewLines:function(t){return t=t.replace(/<br \/>\s*<br \/>/gi,"\n\n"),t=t.replace(/<br\s?\/?>\n?<br\s?\/?>/gi,"\n<br /><br />"),t=t.replace(new RegExp("\r\n","g"),"\n"),t=t.replace(new RegExp("\r","g"),"\n"),t=t.replace(new RegExp("/\n\n+/"),"g","\n\n")},clear:function(t){return t=t.replace(new RegExp("</blockquote></p>","gi"),"</blockquote>"),t=t.replace(new RegExp("<p></blockquote>","gi"),"</blockquote>"),t=t.replace(new RegExp("<p><blockquote>","gi"),"<blockquote>"),t=t.replace(new RegExp("<blockquote></p>","gi"),"<blockquote>"),t=t.replace(new RegExp("<p><p ","gi"),"<p "),t=t.replace(new RegExp("<p><p>","gi"),"<p>"),t=t.replace(new RegExp("</p></p>","gi"),"</p>"),t=t.replace(new RegExp("<p>\\s?</p>","gi"),""),t=t.replace(new RegExp("\n</p>","gi"),"</p>"),t=t.replace(new RegExp("<p>	?	?\n?<p>","gi"),"<p>"),t=t.replace(new RegExp("<p>	*</p>","gi"),"")}}},paste:function(){return{init:function(){return this.opts.cleanOnPaste?(this.rtePaste=!0,this.buffer.set(),this.selection.save(),this.utils.saveScroll(),this.paste.createPasteBox(),t(window).on("scroll.redactor-freeze",t.proxy(function(){t(window).scrollTop(this.saveBodyScroll)},this)),void setTimeout(t.proxy(function(){var e=this.$pasteBox.html();this.$pasteBox.remove(),this.selection.restore(),this.utils.restoreScroll(),this.paste.insert(e),t(window).off("scroll.redactor-freeze"),this.linkify.isEnabled()&&this.linkify.format()},this),1)):void setTimeout(t.proxy(this.code.sync,this),1)},createPasteBox:function(){this.$pasteBox=t("<div>").html("").attr("contenteditable","true").css({position:"fixed",width:0,top:0,left:"-9999px"}),this.utils.browser("msie")?this.$box.append(this.$pasteBox):t(".modal-body").length>0?t(".modal-body").append(this.$pasteBox):t("body").append(this.$pasteBox),this.$pasteBox.focus()},insert:function(e){e=this.core.setCallback("pasteBefore",e),e=this.utils.isSelectAll()?this.clean.onPaste(e,!1):this.clean.onPaste(e),e=this.core.setCallback("paste",e),this.utils.isSelectAll()?this.insert.set(e,!1):this.insert.html(e,!1),this.utils.disableSelectAll(),this.rtePaste=!1,setTimeout(t.proxy(this.clean.clearUnverified,this),10),setTimeout(t.proxy(function(){var e=this.$editor.find("span");t.each(e,function(e,i){var n=i.innerHTML.replace(/\u200B/,"");""===n&&0===i.attributes.length&&t(i).remove()})},this),10)}}},placeholder:function(){return{enable:function(){this.placeholder.is()&&(this.$editor.attr("placeholder",this.$element.attr("placeholder")),this.placeholder.toggle(),this.$editor.on("keydown.redactor-placeholder",t.proxy(this.placeholder.toggle,this)))},toggle:function(){setTimeout(t.proxy(function(){var t=this.utils.isEmpty(this.$editor.html(),!1)?"addClass":"removeClass";this.$editor[t]("redactor-placeholder")},this),5)},remove:function(){this.$editor.removeClass("redactor-placeholder")},is:function(){return this.opts.placeholder?this.$element.attr("placeholder",this.opts.placeholder):!("undefined"==typeof this.$element.attr("placeholder")||""===this.$element.attr("placeholder"))}}},progress:function(){return{show:function(){t(document.body).append(t('<div id="redactor-progress"><span></span></div>')),t("#redactor-progress").fadeIn()},hide:function(){t("#redactor-progress").fadeOut(1500,function(){t(this).remove()})}}},selection:function(){return{get:function(){this.sel=document.getSelection(),this.range=document.getSelection&&this.sel.getRangeAt&&this.sel.rangeCount?this.sel.getRangeAt(0):document.createRange()},addRange:function(){try{this.sel.removeAllRanges()}catch(t){}this.sel.addRange(this.range)},getCurrent:function(){var t=!1;return this.selection.get(),this.sel&&this.sel.rangeCount>0&&(t=this.sel.getRangeAt(0).startContainer),this.utils.isRedactorParent(t)},getParent:function(e){return e=e||this.selection.getCurrent(),e?this.utils.isRedactorParent(t(e).parent()[0]):!1},getPrev:function(){return window.getSelection().anchorNode.previousSibling},getNext:function(){return window.getSelection().anchorNode.nextSibling},getBlock:function(e){for(e=e||this.selection.getCurrent();e;){if(this.utils.isBlockTag(e.tagName))return t(e).hasClass("redactor-editor")?!1:e;e=e.parentNode}return!1},getInlines:function(e,i){if(this.selection.get(),this.range&&this.range.collapsed)return!1;var n=[];e="undefined"==typeof e||e===!1?this.selection.getNodes():e;var r=this.opts.inlineTags;if(r.push("span"),"undefined"!=typeof i)for(var s=0;s<i.length;s++)r.push(i[s]);return t.each(e,t.proxy(function(e,i){-1!=t.inArray(i.tagName.toLowerCase(),r)&&n.push(i)},this)),0===n.length?!1:n},getInlinesTags:function(e){if(this.selection.get(),this.range&&this.range.collapsed)return!1;var i=[],n=this.selection.getNodes();return t.each(n,t.proxy(function(n,r){-1!=t.inArray(r.tagName.toLowerCase(),e)&&i.push(r)},this)),0===i.length?!1:i},getBlocks:function(e){if(this.selection.get(),this.range&&this.range.collapsed)return[this.selection.getBlock()];var i=[];return e="undefined"==typeof e?this.selection.getNodes():e,t.each(e,t.proxy(function(t,e){this.utils.isBlock(e)&&(this.selection.lastBlock=e,i.push(e))},this)),0===i.length?[this.selection.getBlock()]:i},getLastBlock:function(){return this.selection.lastBlock},getNodes:function(){this.selection.get();var e=this.selection.getNodesMarker(1),i=this.selection.getNodesMarker(2);if(this.range.collapsed===!1){if(window.getSelection){var n=window.getSelection();if(n.rangeCount>0){var r=n.getRangeAt(0),s=r.startContainer,o=r.startOffset,a=r.cloneRange();a.collapse(!1),a.insertNode(i),a.setStart(s,o),a.collapse(!0),a.insertNode(e),r.setStartAfter(e),r.setEndBefore(i),n.removeAllRanges(),n.addRange(r)}}}else this.selection.setNodesMarker(this.range,e,!0),i=e;var l=[],c=0,u=this;this.$editor.find("*").each(function(){if(this==e){var n=t(this).parent();0!==n.length&&"BODY"!=n[0].tagName&&u.utils.isRedactorParent(n[0])&&l.push(n[0]),l.push(this),c=1}else c>0&&(l.push(this),c+=1);return this==i?!1:void 0});for(var h=[],d=l.length,p=0;d>p;p++)"nodes-marker-1"!=l[p].id&&"nodes-marker-2"!=l[p].id&&h.push(l[p]);return this.selection.removeNodesMarkers(),h},getNodesMarker:function(e){return t('<span id="nodes-marker-'+e+'" class="redactor-nodes-marker" data-verified="redactor">'+this.opts.invisibleSpace+"</span>")[0]},setNodesMarker:function(t,e,i){var t=t.cloneRange();try{t.collapse(i),t.insertNode(e)}catch(n){}},removeNodesMarkers:function(){t(document).find("span.redactor-nodes-marker").remove(),this.$editor.find("span.redactor-nodes-marker").remove()},fromPoint:function(t,e){this.caret.setOffset(t,e)},wrap:function(t){if(this.selection.get(),this.range.collapsed)return!1;var e=document.createElement(t);return e.appendChild(this.range.extractContents()),this.range.insertNode(e),e},selectElement:function(t){if(this.utils.browser("mozilla")){t=t[0]||t;var e=document.createRange();e.selectNodeContents(t)}else this.caret.set(t,0,t,1)},selectAll:function(){this.selection.get(),this.range.selectNodeContents(this.$editor[0]),this.selection.addRange()},remove:function(){this.selection.get(),this.sel.removeAllRanges()},save:function(){this.selection.createMarkers()},createMarkers:function(){this.selection.get();var t=this.selection.getMarker(1);if(this.selection.setMarker(this.range,t,!0),this.range.collapsed===!1){var e=this.selection.getMarker(2);this.selection.setMarker(this.range,e,!1)}this.savedSel=this.$editor.html()},getMarker:function(e){return"undefined"==typeof e&&(e=1),t('<span id="selection-marker-'+e+'" class="redactor-selection-marker"  data-verified="redactor">'+this.opts.invisibleSpace+"</span>")[0]},getMarkerAsHtml:function(t){return this.utils.getOuterHtml(this.selection.getMarker(t))},setMarker:function(t,e,i){t=t.cloneRange();try{t.collapse(i),t.insertNode(e)}catch(n){this.focus.setStart()}},restore:function(){var t=this.$editor.find("span#selection-marker-1"),e=this.$editor.find("span#selection-marker-2");this.utils.browser("mozilla")&&this.$editor.focus(),0!==t.length&&0!==e.length?this.caret.set(t,0,e,0):0!==t.length?this.caret.set(t,0,t,0):this.$editor.focus(),this.selection.removeMarkers(),this.savedSel=!1},removeMarkers:function(){this.$editor.find("span.redactor-selection-marker").each(function(e,i){var n=t(i).text().replace(/\u200B/g,"");""===n?t(i).remove():t(i).replaceWith(function(){return t(this).contents()})})},getText:function(){return this.selection.get(),this.sel.toString()},getHtml:function(){var t="";if(this.selection.get(),this.sel.rangeCount){for(var e=document.createElement("div"),i=this.sel.rangeCount,n=0;i>n;++n)e.appendChild(this.sel.getRangeAt(n).cloneContents());t=e.innerHTML}return this.clean.onSync(t)},replaceSelection:function(t){this.selection.get(),this.range.deleteContents();var e=document.createElement("div");e.innerHTML=t;for(var i,n=document.createDocumentFragment();i=e.firstChild;)n.appendChild(i);this.range.insertNode(n)},replaceWithHtml:function(t){t=this.selection.getMarkerAsHtml(1)+t+this.selection.getMarkerAsHtml(2),this.selection.get(),window.getSelection&&window.getSelection().getRangeAt?this.selection.replaceSelection(t):document.selection&&document.selection.createRange&&this.range.pasteHTML(t),this.selection.restore(),this.code.sync()}}},shortcuts:function(){return{init:function(e,i){return this.opts.shortcuts?void t.each(this.opts.shortcuts,t.proxy(function(i,n){for(var r=i.split(","),s=r.length,o=0;s>o;o++)"string"==typeof r[o]&&this.shortcuts.handler(e,t.trim(r[o]),t.proxy(function(){var t;"-1"!=n.func.search(/\./)?(t=n.func.split("."),"undefined"!=typeof this[t[0]]&&this[t[0]][t[1]].apply(this,n.params)):this[n.func].apply(this,n.params)},this))},this)):(!e.ctrlKey&&!e.metaKey||66!==i&&73!==i||e.preventDefault(),!1)},handler:function(e,i,n){var r={8:"backspace",9:"tab",10:"return",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"};i=i.toLowerCase().split(" ");var o=r[e.keyCode],a=String.fromCharCode(e.which).toLowerCase(),l="",c={};t.each(["alt","ctrl","meta","shift"],function(t,i){e[i+"Key"]&&o!==i&&(l+=i+"+")}),o&&(c[l+o]=!0),a&&(c[l+a]=!0,c[l+s[a]]=!0,"shift+"===l&&(c[s[a]]=!0));for(var u=0,h=i.length;h>u;u++)if(c[i[u]])return e.preventDefault(),n.apply(this,arguments)}}},tabifier:function(){return{get:function(t){if(!this.opts.tabifier)return t;var e=["area","body","head","hr","i?frame","link","meta","noscript","style","script","table","tbody","thead","tfoot"],i=["li","dt","dt","h[1-6]","option","script"],n=["p","blockquote","div","dl","fieldset","form","frameset","map","ol","pre","select","td","th","tr","ul"];this.tabifier.lineBefore=new RegExp("^<(/?"+e.join("|/?")+"|"+i.join("|")+")[ >]"),this.tabifier.lineAfter=new RegExp("^<(br|/?"+e.join("|/?")+"|/"+i.join("|/")+")[ >]"),this.tabifier.newLevel=new RegExp("^</?("+n.join("|")+")[ >]");var r=0,s=t.length,o=0,a=null,l=null,c="",u="",h="";for(this.tabifier.cleanlevel=0;s>r;r++){if(o=r,-1==t.substr(r).indexOf("<"))return u+=t.substr(r),this.tabifier.finish(u);for(;s>o&&"<"!=t.charAt(o);)o++;for(r!=o&&(h=t.substr(r,o-r),h.match(/^\s{2,}$/g)||("\n"==u.charAt(u.length-1)?u+=this.tabifier.getTabs():"\n"==h.charAt(0)&&(u+="\n"+this.tabifier.getTabs(),h=h.replace(/^\s+/,"")),u+=h),h.match(/\n/)&&(u+="\n"+this.tabifier.getTabs())),a=o;s>o&&">"!=t.charAt(o);)o++;c=t.substr(a,o-a),r=o;var d;if("!--"==c.substr(1,3)){if(!c.match(/--$/)){for(;"-->"!=t.substr(o,3);)o++;o+=2,c=t.substr(a,o-a),r=o}"\n"!=u.charAt(u.length-1)&&(u+="\n"),u+=this.tabifier.getTabs(),u+=c+">\n"}else"!"==c[1]?u=this.tabifier.placeTag(c+">",u):"?"==c[1]?u+=c+">\n":(d=c.match(/^<(script|style|pre)/i))?(d[1]=d[1].toLowerCase(),c=this.tabifier.cleanTag(c),u=this.tabifier.placeTag(c,u),l=String(t.substr(r+1)).toLowerCase().indexOf("</"+d[1]),l&&(h=t.substr(r+1,l),r+=l,u+=h)):(c=this.tabifier.cleanTag(c),u=this.tabifier.placeTag(c,u))}return this.tabifier.finish(u)},getTabs:function(){for(var t="",e=0;e<this.tabifier.cleanlevel;e++)t+="	";return t},finish:function(t){return t=t.replace(/\n\s*\n/g,"\n"),t=t.replace(/^[\s\n]*/,""),t=t.replace(/[\s\n]*$/,""),t=t.replace(/<script(.*?)>\n<\/script>/gi,"<script$1></script>"),this.tabifier.cleanlevel=0,t},cleanTag:function(t){var e="";t=t.replace(/\n/g," "),t=t.replace(/\s{2,}/g," "),t=t.replace(/^\s+|\s+$/g," ");var i="";t.match(/\/$/)&&(i="/",t=t.replace(/\/+$/,""));for(var n;n=/\s*([^= ]+)(?:=((['"']).*?\3|[^ ]+))?/.exec(t);)n[2]?e+=n[1].toLowerCase()+"="+n[2]:n[1]&&(e+=n[1].toLowerCase()),e+=" ",t=t.substr(n[0].length);return e.replace(/\s*$/,"")+i+">"},placeTag:function(t,e){var i=t.match(this.tabifier.newLevel);return(t.match(this.tabifier.lineBefore)||i)&&(e=e.replace(/\s*$/,""),e+="\n"),i&&"/"==t.charAt(1)&&this.tabifier.cleanlevel--,"\n"==e.charAt(e.length-1)&&(e+=this.tabifier.getTabs()),i&&"/"!=t.charAt(1)&&this.tabifier.cleanlevel++,e+=t,(t.match(this.tabifier.lineAfter)||t.match(this.tabifier.newLevel))&&(e=e.replace(/ *$/,"")),e}}},tidy:function(){return{setupAllowed:function(){if(this.opts.allowedTags&&(this.opts.deniedTags=!1),this.opts.allowedAttr&&(this.opts.removeAttr=!1),!this.opts.linebreaks){var t=["p","section"];this.opts.allowedTags&&this.tidy.addToAllowed(t),this.opts.deniedTags&&this.tidy.removeFromDenied(t)}},addToAllowed:function(e){for(var i=e.length,n=0;i>n;n++)-1==t.inArray(e[n],this.opts.allowedTags)&&this.opts.allowedTags.push(e[n])},removeFromDenied:function(e){for(var i=e.length,n=0;i>n;n++){var r=t.inArray(e[n],this.opts.deniedTags);-1!=r&&this.opts.deniedTags.splice(r,1)}},load:function(e,i){return this.tidy.settings={deniedTags:this.opts.deniedTags,allowedTags:this.opts.allowedTags,removeComments:this.opts.removeComments,replaceTags:this.opts.replaceTags,replaceStyles:this.opts.replaceStyles,removeDataAttr:this.opts.removeDataAttr,removeAttr:this.opts.removeAttr,allowedAttr:this.opts.allowedAttr,removeWithoutAttr:this.opts.removeWithoutAttr,removeEmpty:this.opts.removeEmpty},t.extend(this.tidy.settings,i),e=this.tidy.removeComments(e),this.tidy.$div=t("<div />").append(e),this.tidy.replaceTags(),this.tidy.replaceStyles(),this.tidy.removeTags(),this.tidy.removeAttr(),this.tidy.removeEmpty(),this.tidy.removeParagraphsInLists(),this.tidy.removeDataAttr(),this.tidy.removeWithoutAttr(),e=this.tidy.$div.html(),this.tidy.$div.remove(),e},removeComments:function(t){return this.tidy.settings.removeComments?t.replace(/<!--[\s\S]*?-->/gi,""):t},replaceTags:function(e){if(!this.tidy.settings.replaceTags)return e;for(var i=this.tidy.settings.replaceTags.length,n=[],r=[],s=0;i>s;s++)r.push(this.tidy.settings.replaceTags[s][1]),n.push(this.tidy.settings.replaceTags[s][0]);t.each(n,t.proxy(function(e,i){this.tidy.$div.find(i).replaceWith(function(){return t("<"+r[e]+" />",{html:t(this).html()})})},this))},replaceStyles:function(){if(this.tidy.settings.replaceStyles){var e=this.tidy.settings.replaceStyles.length;this.tidy.$div.find("span").each(t.proxy(function(i,n){for(var r=t(n),s=r.attr("style"),o=0;e>o;o++)if(s&&s.match(new RegExp("^"+this.tidy.settings.replaceStyles[o][0],"i"))){var a=this.tidy.settings.replaceStyles[o][1];r.replaceWith(function(){var e=document.createElement(a);return t(e).append(t(this).contents())})}},this))}},removeTags:function(){!this.tidy.settings.deniedTags&&this.tidy.settings.allowedTags&&this.tidy.$div.find("*").not(this.tidy.settings.allowedTags.join(",")).each(function(e,i){""===i.innerHTML?t(i).remove():t(i).contents().unwrap()}),this.tidy.settings.deniedTags&&this.tidy.$div.find(this.tidy.settings.deniedTags.join(",")).each(function(e,i){t(i).hasClass("redactor-script-tag")||t(i).hasClass("redactor-selection-marker")||(""===i.innerHTML?t(i).remove():t(i).contents().unwrap())})},removeAttr:function(){var e;if(!this.tidy.settings.removeAttr&&this.tidy.settings.allowedAttr){var i=[],n=[];e=this.tidy.settings.allowedAttr.length;for(var r=0;e>r;r++)i.push(this.tidy.settings.allowedAttr[r][0]),n.push(this.tidy.settings.allowedAttr[r][1]);this.tidy.$div.find("*").each(t.proxy(function(e,r){var s=t(r),o=t.inArray(s[0].tagName.toLowerCase(),i),a=this.tidy.removeAttrGetRemoves(o,n,s);a&&t.each(a,function(t,e){s.removeAttr(e)})},this))}if(this.tidy.settings.removeAttr){e=this.tidy.settings.removeAttr.length;for(var r=0;e>r;r++){var s=this.tidy.settings.removeAttr[r][1];t.isArray(s)&&(s=s.join(" ")),this.tidy.$div.find(this.tidy.settings.removeAttr[r][0]).removeAttr(s)}}},removeAttrGetRemoves:function(e,i,n){var r=[];return-1==e?t.each(n[0].attributes,function(t,e){r.push(e.name)}):"*"==i[e]?r=[]:t.each(n[0].attributes,function(n,s){t.isArray(i[e])?-1==t.inArray(s.name,i[e])&&r.push(s.name):i[e]!=s.name&&r.push(s.name)}),r},removeAttrs:function(e,i){return i=new RegExp(i,"g"),e.each(function(){for(var e=t(this),n=this.attributes.length-1,r=n;r>=0;r--){var s=this.attributes[r];s&&s.specified&&s.name.search(i)>=0&&e.removeAttr(s.name)}})},removeEmpty:function(){this.tidy.settings.removeEmpty&&this.tidy.$div.find(this.tidy.settings.removeEmpty.join(",")).each(function(){var e=t(this),i=e.text();i=i.replace(/\u200B/g,""),i=i.replace(/&nbsp;/gi,""),i=i.replace(/\s/g,""),""===i&&0===e.children().length&&e.remove()})},removeParagraphsInLists:function(){this.tidy.$div.find("li p").contents().unwrap()},removeDataAttr:function(){if(this.tidy.settings.removeDataAttr){var e=this.tidy.settings.removeDataAttr;t.isArray(this.tidy.settings.removeDataAttr)&&(e=this.tidy.settings.removeDataAttr.join(",")),this.tidy.removeAttrs(this.tidy.$div.find(e),"^(data-)")}},removeWithoutAttr:function(){this.tidy.settings.removeWithoutAttr&&this.tidy.$div.find(this.tidy.settings.removeWithoutAttr.join(",")).each(function(){0===this.attributes.length&&t(this).contents().unwrap()})}}},toolbar:function(){return{init:function(){return{html:{title:this.lang.get("html"),func:"code.toggle"},formatting:{title:this.lang.get("formatting"),dropdown:{p:{title:this.lang.get("paragraph"),func:"block.format"},blockquote:{title:this.lang.get("quote"),func:"block.format"},pre:{title:this.lang.get("code"),func:"block.format"},h1:{title:this.lang.get("header1"),func:"block.format"},h2:{title:this.lang.get("header2"),func:"block.format"},h3:{title:this.lang.get("header3"),func:"block.format"},h4:{title:this.lang.get("header4"),func:"block.format"},h5:{title:this.lang.get("header5"),func:"block.format"}}},bold:{title:this.lang.get("bold"),func:"inline.format"},italic:{title:this.lang.get("italic"),func:"inline.format"},deleted:{title:this.lang.get("deleted"),func:"inline.format"},underline:{title:this.lang.get("underline"),func:"inline.format"},unorderedlist:{title:"&bull; "+this.lang.get("unorderedlist"),func:"list.toggle"},orderedlist:{title:"1. "+this.lang.get("orderedlist"),func:"list.toggle"},outdent:{title:"< "+this.lang.get("outdent"),func:"indent.decrease"},indent:{title:"> "+this.lang.get("indent"),func:"indent.increase"},image:{title:this.lang.get("image"),func:"image.show"},file:{title:this.lang.get("file"),func:"file.show"},link:{title:this.lang.get("link"),dropdown:{link:{title:this.lang.get("link_insert"),func:"link.show",observe:{element:"a","in":{title:this.lang.get("link_edit")},out:{title:this.lang.get("link_insert")}}},unlink:{title:this.lang.get("unlink"),func:"link.unlink",observe:{element:"a",out:{attr:{"class":"redactor-dropdown-link-inactive","aria-disabled":!0}}}}}},alignment:{title:this.lang.get("alignment"),dropdown:{left:{title:this.lang.get("align_left"),func:"alignment.left"},center:{title:this.lang.get("align_center"),func:"alignment.center"},right:{title:this.lang.get("align_right"),func:"alignment.right"},justify:{title:this.lang.get("align_justify"),func:"alignment.justify"}}},horizontalrule:{title:this.lang.get("horizontalrule"),func:"line.insert"}}},build:function(){this.toolbar.hideButtons(),this.toolbar.hideButtonsOnMobile(),this.toolbar.isButtonSourceNeeded(),0!==this.opts.buttons.length&&(this.$toolbar=this.toolbar.createContainer(),this.toolbar.setOverflow(),this.toolbar.append(),this.toolbar.setFormattingTags(),this.toolbar.loadButtons(),this.toolbar.setFixed(),this.opts.activeButtons&&this.$editor.on("mouseup.redactor keyup.redactor focus.redactor",t.proxy(this.observe.toolbar,this)))
},createContainer:function(){return t("<ul>").addClass("redactor-toolbar").attr({id:"redactor-toolbar-"+this.uuid,role:"toolbar"})},setFormattingTags:function(){t.each(this.opts.toolbar.formatting.dropdown,t.proxy(function(e){-1==t.inArray(e,this.opts.formatting)&&delete this.opts.toolbar.formatting.dropdown[e]},this))},loadButtons:function(){t.each(this.opts.buttons,t.proxy(function(e,i){if(this.opts.toolbar[i]){if("file"===i){if(this.opts.fileUpload===!1)return;if(!this.opts.fileUpload&&this.opts.s3===!1)return}if("image"===i){if(this.opts.imageUpload===!1)return;if(!this.opts.imageUpload&&this.opts.s3===!1)return}var n=this.opts.toolbar[i];this.$toolbar.append(t("<li>").append(this.button.build(i,n)))}},this))},append:function(){this.opts.toolbarExternal?(this.$toolbar.addClass("redactor-toolbar-external"),t(this.opts.toolbarExternal).html(this.$toolbar)):this.$box.prepend(this.$toolbar)},setFixed:function(){this.utils.isDesktop()&&(this.opts.toolbarExternal||this.opts.toolbarFixed&&(this.toolbar.observeScroll(),t(this.opts.toolbarFixedTarget).on("scroll.redactor."+this.uuid,t.proxy(this.toolbar.observeScroll,this))))},setOverflow:function(){this.utils.isMobile()&&this.opts.toolbarOverflow&&this.$toolbar.addClass("redactor-toolbar-overflow")},isButtonSourceNeeded:function(){if(!this.opts.source){var t=this.opts.buttons.indexOf("html");-1!==t&&this.opts.buttons.splice(t,1)}},hideButtons:function(){0!==this.opts.buttonsHide.length&&t.each(this.opts.buttonsHide,t.proxy(function(t,e){var i=this.opts.buttons.indexOf(e);this.opts.buttons.splice(i,1)},this))},hideButtonsOnMobile:function(){this.utils.isMobile()&&0!==this.opts.buttonsHideOnMobile.length&&t.each(this.opts.buttonsHideOnMobile,t.proxy(function(t,e){var i=this.opts.buttons.indexOf(e);this.opts.buttons.splice(i,1)},this))},observeScroll:function(){var e=t(this.opts.toolbarFixedTarget).scrollTop(),i=1;this.opts.toolbarFixedTarget===document&&(i=this.$box.offset().top),e+this.opts.toolbarFixedTopOffset>i?this.toolbar.observeScrollEnable(e,i):this.toolbar.observeScrollDisable()},observeScrollEnable:function(e,i){var n=this.opts.toolbarFixedTopOffset+e-i,r=0,s=i+this.$box.height()-32,o=this.$box.innerWidth();this.$toolbar.addClass("toolbar-fixed-box"),this.$toolbar.css({position:"absolute",width:o,top:n+"px",left:r}),e>s&&t(".redactor-dropdown-"+this.uuid+":visible").hide(),this.toolbar.setDropdownsFixed(),this.$toolbar.css("visibility",s>e?"visible":"hidden")},observeScrollDisable:function(){this.$toolbar.css({position:"relative",width:"auto",top:0,left:0,visibility:"visible"}),this.toolbar.unsetDropdownsFixed(),this.$toolbar.removeClass("toolbar-fixed-box")},setDropdownsFixed:function(){var e=this.$toolbar.innerHeight()+this.opts.toolbarFixedTopOffset,i="fixed";this.opts.toolbarFixedTarget!==document&&(e=this.$toolbar.innerHeight()+this.$toolbar.offset().top+this.opts.toolbarFixedTopOffset,i="absolute"),t(".redactor-dropdown-"+this.uuid).each(function(){t(this).css({position:i,top:e+"px"})})},unsetDropdownsFixed:function(){var e=this.$toolbar.innerHeight()+this.$toolbar.offset().top;t(".redactor-dropdown-"+this.uuid).each(function(){t(this).css({position:"absolute",top:e+"px"})})}}},upload:function(){return{init:function(e,i,n){this.upload.direct=!1,this.upload.callback=n,this.upload.url=i,this.upload.$el=t(e),this.upload.$droparea=t('<div id="redactor-droparea" />'),this.upload.$placeholdler=t('<div id="redactor-droparea-placeholder" />').text(this.lang.get("upload_label")),this.upload.$input=t('<input type="file" name="file" />'),this.upload.$placeholdler.append(this.upload.$input),this.upload.$droparea.append(this.upload.$placeholdler),this.upload.$el.append(this.upload.$droparea),this.upload.$droparea.off("redactor.upload"),this.upload.$input.off("redactor.upload"),this.upload.$droparea.on("dragover.redactor.upload",t.proxy(this.upload.onDrag,this)),this.upload.$droparea.on("dragleave.redactor.upload",t.proxy(this.upload.onDragLeave,this)),this.upload.$input.on("change.redactor.upload",t.proxy(function(t){t=t.originalEvent||t,this.upload.traverseFile(this.upload.$input[0].files[0],t)},this)),this.upload.$droparea.on("drop.redactor.upload",t.proxy(function(t){t.preventDefault(),this.upload.$droparea.removeClass("drag-hover").addClass("drag-drop"),this.upload.onDrop(t)},this))},directUpload:function(t,e){this.upload.direct=!0,this.upload.traverseFile(t,e)},onDrop:function(t){t=t.originalEvent||t;var e=t.dataTransfer.files;this.upload.traverseFile(e[0],t)},traverseFile:function(t,e){if(this.opts.s3)return this.upload.setConfig(t),void this.upload.s3uploadFile(t);var i=window.FormData?new FormData:null;if(window.FormData){this.upload.setConfig(t);var n="image"==this.upload.type?this.opts.imageUploadParam:this.opts.fileUploadParam;i.append(n,t)}this.progress.show(),this.core.setCallback("uploadStart",e,i),this.upload.sendData(i,e)},setConfig:function(t){this.upload.getType(t),this.upload.direct&&(this.upload.url="image"==this.upload.type?this.opts.imageUpload:this.opts.fileUpload,this.upload.callback="image"==this.upload.type?this.image.insert:this.file.insert)},getType:function(t){this.upload.type="image",-1==this.opts.imageTypes.indexOf(t.type)&&(this.upload.type="file")},getHiddenFields:function(e,i){return e===!1||"object"!=typeof e?i:(t.each(e,t.proxy(function(e,n){null!==n&&0===n.toString().indexOf("#")&&(n=t(n).val()),i.append(e,n)},this)),i)},sendData:function(e,i){"image"==this.upload.type?(e=this.upload.getHiddenFields(this.opts.uploadImageFields,e),e=this.upload.getHiddenFields(this.upload.imageFields,e)):(e=this.upload.getHiddenFields(this.opts.uploadFileFields,e),e=this.upload.getHiddenFields(this.upload.fileFields,e));var n=new XMLHttpRequest;n.open("POST",this.upload.url),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.onreadystatechange=t.proxy(function(){if(4==n.readyState){var e=n.responseText;e=e.replace(/^\[/,""),e=e.replace(/\]$/,"");var r;try{r="string"==typeof e?t.parseJSON(e):e}catch(s){r={error:!0}}this.progress.hide(),this.upload.direct||this.upload.$droparea.removeClass("drag-drop"),this.upload.callback(r,this.upload.direct,i)}},this),n.send(e)},onDrag:function(t){t.preventDefault(),this.upload.$droparea.addClass("drag-hover")},onDragLeave:function(t){t.preventDefault(),this.upload.$droparea.removeClass("drag-hover")},clearImageFields:function(){this.upload.imageFields={}},addImageFields:function(t,e){this.upload.imageFields[t]=e},removeImageFields:function(t){delete this.upload.imageFields[t]},clearFileFields:function(){this.upload.fileFields={}},addFileFields:function(t,e){this.upload.fileFields[t]=e},removeFileFields:function(t){delete this.upload.fileFields[t]},s3uploadFile:function(e){this.upload.s3executeOnSignedUrl(e,t.proxy(function(t){this.upload.s3uploadToS3(e,t)},this))},s3executeOnSignedUrl:function(t,e){var i=new XMLHttpRequest,n="?";"-1"!=this.opts.s3.search(/\?/)&&(n="&"),i.open("GET",this.opts.s3+n+"name="+t.name+"&type="+t.type,!0),i.overrideMimeType&&i.overrideMimeType("text/plain; charset=x-user-defined");var r=this;i.onreadystatechange=function(){4==this.readyState&&200==this.status?(r.progress.show(),e(decodeURIComponent(this.responseText))):4==this.readyState&&200!=this.status},i.send()},s3createCORSRequest:function(t,e){var i=new XMLHttpRequest;return"withCredentials"in i?i.open(t,e,!0):"undefined"!=typeof XDomainRequest?(i=new XDomainRequest,i.open(t,e)):i=null,i},s3uploadToS3:function(e,i){var n=this.upload.s3createCORSRequest("PUT",i);n&&(n.onload=t.proxy(function(){if(200==n.status){this.progress.hide();var t=i.split("?");if(!t[0])return!1;this.upload.direct||this.upload.$droparea.removeClass("drag-drop");var e={filelink:t[0]};if("file"==this.upload.type){var r=t[0].split("/");e.filename=r[r.length-1]}this.upload.callback(e,this.upload.direct,!1)}},this),n.onerror=function(){},n.upload.onprogress=function(){},n.setRequestHeader("Content-Type",e.type),n.setRequestHeader("x-amz-acl","public-read"),n.send(e))}}},utils:function(){return{isMobile:function(){return/(iPhone|iPod|BlackBerry|Android)/.test(navigator.userAgent)},isDesktop:function(){return!/(iPhone|iPod|iPad|BlackBerry|Android)/.test(navigator.userAgent)},isString:function(t){return"[object String]"==Object.prototype.toString.call(t)},isEmpty:function(e,i){return e=e.replace(/[\u200B-\u200D\uFEFF]/g,""),e=e.replace(/&nbsp;/gi,""),e=e.replace(/<\/?br\s?\/?>/g,""),e=e.replace(/\s/g,""),e=e.replace(/^<p>[^\W\w\D\d]*?<\/p>$/i,""),e=e.replace(/<iframe(.*?[^>])>$/i,"iframe"),e=e.replace(/<source(.*?[^>])>$/i,"source"),i!==!1&&(e=e.replace(/<[^\/>][^>]*><\/[^>]+>/gi,""),e=e.replace(/<[^\/>][^>]*><\/[^>]+>/gi,"")),e=t.trim(e),""===e},normalize:function(t){return"undefined"==typeof t?0:parseInt(t.replace("px",""),10)},hexToRgb:function(t){if("undefined"!=typeof t){if(-1==t.search(/^#/))return t;var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(e,function(t,e,i,n){return e+e+i+i+n+n});var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return"rgb("+parseInt(i[1],16)+", "+parseInt(i[2],16)+", "+parseInt(i[3],16)+")"}},getOuterHtml:function(e){return t("<div>").append(t(e).eq(0).clone()).html()},getAlignmentElement:function(e){return-1!==t.inArray(e.tagName,this.opts.alignmentTags)?t(e):t(e).closest(this.opts.alignmentTags.toString().toLowerCase(),this.$editor[0])},removeEmptyAttr:function(e,i){var n=t(e);return"undefined"==typeof n.attr(i)?!0:""===n.attr(i)?(n.removeAttr(i),!0):!1},removeEmpty:function(e,i){var n=t(t.parseHTML(i));if(n.find(".redactor-invisible-space").removeAttr("style").removeAttr("class"),0===n.find("hr, br, img, iframe, source").length){var r=t.trim(n.text());this.utils.isEmpty(r,!1)&&n.remove()}},saveScroll:function(){this.saveEditorScroll=this.$editor.scrollTop(),this.saveBodyScroll=t(window).scrollTop(),this.opts.scrollTarget&&(this.saveTargetScroll=t(this.opts.scrollTarget).scrollTop())},restoreScroll:function(){("undefined"!=typeof this.saveScroll||"undefined"!=typeof this.saveBodyScroll)&&(t(window).scrollTop(this.saveBodyScroll),this.$editor.scrollTop(this.saveEditorScroll),this.opts.scrollTarget&&t(this.opts.scrollTarget).scrollTop(this.saveTargetScroll))},createSpaceElement:function(){var t=document.createElement("span");return t.className="redactor-invisible-space",t.innerHTML=this.opts.invisibleSpace,t},removeInlineTags:function(e){var i=this.opts.inlineTags;i.push("span"),"PRE"==e.tagName&&i.push("a"),t(e).find(i.join(",")).not("span.redactor-selection-marker").contents().unwrap()},replaceWithContents:function(e,i){var n=this;return t(e).replaceWith(function(){return i===!0&&n.utils.removeInlineTags(this),t(this).contents()}),t(e)},replaceToTag:function(e,i,n){var r,s=this;return t(e).replaceWith(function(){r=t("<"+i+" />").append(t(this).contents());for(var e=0;e<this.attributes.length;e++)r.attr(this.attributes[e].name,this.attributes[e].value);return n===!0&&s.utils.removeInlineTags(r),r}),r},isStartOfElement:function(){var t=this.selection.getBlock();if(!t)return!1;var e=this.caret.getOffsetOfElement(t);return 0===e?!0:!1},isEndOfElement:function(e){if("undefined"==typeof e){var e=this.selection.getBlock();if(!e)return!1}var i=this.caret.getOffsetOfElement(e),n=t.trim(t(e).text()).replace(/\n\r\n/g,"");return i==n.length?!0:!1},isEndOfEditor:function(){var e=this.$editor[0],i=this.caret.getOffsetOfElement(e),n=t.trim(t(e).html().replace(/(<([^>]+)>)/gi,""));return i==n.length?!0:!1},isBlock:function(t){return t=t[0]||t,t&&this.utils.isBlockTag(t.tagName)},isBlockTag:function(t){return"undefined"==typeof t?!1:this.reIsBlock.test(t)},isTag:function(e,i){var n=t(e).closest(i,this.$editor[0]);return 1==n.length?n[0]:!1},isSelectAll:function(){return this.selectAll},enableSelectAll:function(){this.selectAll=!0},disableSelectAll:function(){this.selectAll=!1},isRedactorParent:function(e){return e?0===t(e).parents(".redactor-editor").length||t(e).hasClass("redactor-editor")?!1:e:!1},isCurrentOrParentHeader:function(){return this.utils.isCurrentOrParent(["H1","H2","H3","H4","H5","H6"])},isCurrentOrParent:function(e){var i=this.selection.getParent(),n=this.selection.getCurrent();if(t.isArray(e)){var r=0;return t.each(e,t.proxy(function(t,e){this.utils.isCurrentOrParentOne(n,i,e)&&r++},this)),0===r?!1:!0}return this.utils.isCurrentOrParentOne(n,i,e)},isCurrentOrParentOne:function(t,e,i){return i=i.toUpperCase(),e&&e.tagName===i?e:t&&t.tagName===i?t:!1},isOldIe:function(){return this.utils.browser("msie")&&parseInt(this.utils.browser("version"),10)<9?!0:!1},isLessIe10:function(){return this.utils.browser("msie")&&parseInt(this.utils.browser("version"),10)<10?!0:!1},isIe11:function(){return!!navigator.userAgent.match(/Trident\/7\./)},browser:function(t){var e=navigator.userAgent.toLowerCase(),i=/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return"safari"==t?"undefined"!=typeof i[3]?"safari"==i[3]:!1:"version"==t?i[2]:"webkit"==t?"chrome"==i[1]||"opr"==i[1]||"webkit"==i[1]:"rv"==i[1]?"msie"==t:"opr"==i[1]?"webkit"==t:t==i[1]},strpos:function(t,e,i){var n=t.indexOf(e,i);return n>=0?n:!1},disableBodyScroll:function(){var e=t("html"),i=window.innerWidth;if(!i){var n=document.documentElement.getBoundingClientRect();i=n.right-Math.abs(n.left)}var r=document.body.clientWidth<i,s=this.utils.measureScrollbar();e.css("overflow","hidden"),r&&e.css("padding-right",s)},measureScrollbar:function(){var e=t("body"),i=document.createElement("div");i.className="redactor-scrollbar-measure",e.append(i);var n=i.offsetWidth-i.clientWidth;return e[0].removeChild(i),n},enableBodyScroll:function(){t("html").css({overflow:"","padding-right":""}),t("body").remove("redactor-scrollbar-measure")}}}},t(window).on("load.tools.redactor",function(){t('[data-tools="redactor"]').redactor()}),e.prototype.init.prototype=e.prototype}(jQuery),define("redactor",["jquery"],function(){}),function(t){"undefined"==typeof t.fn.each2&&t.extend(t.fn,{each2:function(e){for(var i=t([0]),n=-1,r=this.length;++n<r&&(i.context=i[0]=this[n])&&e.call(i[0],n,i)!==!1;);return this}})}(jQuery),function(t,e){function i(t){var e,i,n,r;if(!t||t.length<1)return t;for(e="",i=0,n=t.length;n>i;i++)r=t.charAt(i),e+=R[r]||r;return e}function n(t,e){for(var i=0,n=e.length;n>i;i+=1)if(s(t,e[i]))return i;return-1}function r(){var e=t(z);e.appendTo("body");var i={width:e.width()-e[0].clientWidth,height:e.height()-e[0].clientHeight};return e.remove(),i}function s(t,i){return t===i?!0:t===e||i===e?!1:null===t||null===i?!1:t.constructor===String?t+""==i+"":i.constructor===String?i+""==t+"":!1}function o(e,i){var n,r,s;if(null===e||e.length<1)return[];for(n=e.split(i),r=0,s=n.length;s>r;r+=1)n[r]=t.trim(n[r]);return n}function a(t){return t.outerWidth(!1)-t.width()}function l(i){var n="keyup-change-value";i.on("keydown",function(){t.data(i,n)===e&&t.data(i,n,i.val())}),i.on("keyup",function(){var r=t.data(i,n);r!==e&&i.val()!==r&&(t.removeData(i,n),i.trigger("keyup-change"))})}function c(i){i.on("mousemove",function(i){var n=B;(n===e||n.x!==i.pageX||n.y!==i.pageY)&&t(i.target).trigger("mousemove-filtered",i)})}function u(t,i,n){n=n||e;var r;return function(){var e=arguments;window.clearTimeout(r),r=window.setTimeout(function(){i.apply(n,e)},t)}}function h(t){var e,i=!1;return function(){return i===!1&&(e=t(),i=!0),e}}function d(t,e){var i=u(t,function(t){e.trigger("scroll-debounced",t)});e.on("scroll",function(t){n(t.target,e.get())>=0&&i(t)})}function p(t){t[0]!==document.activeElement&&window.setTimeout(function(){var e,i=t[0],n=t.val().length;t.focus(),t.is(":visible")&&i===document.activeElement&&(i.setSelectionRange?i.setSelectionRange(n,n):i.createTextRange&&(e=i.createTextRange(),e.collapse(!1),e.select()))},0)}function f(e){e=t(e)[0];var i=0,n=0;if("selectionStart"in e)i=e.selectionStart,n=e.selectionEnd-i;else if("selection"in document){e.focus();var r=document.selection.createRange();n=document.selection.createRange().text.length,r.moveStart("character",-e.value.length),i=r.text.length-n}return{offset:i,length:n}}function g(t){t.preventDefault(),t.stopPropagation()}function m(t){t.preventDefault(),t.stopImmediatePropagation()}function v(e){if(!N){var i=e[0].currentStyle||window.getComputedStyle(e[0],null);N=t(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:i.fontSize,fontFamily:i.fontFamily,fontStyle:i.fontStyle,fontWeight:i.fontWeight,letterSpacing:i.letterSpacing,textTransform:i.textTransform,whiteSpace:"nowrap"}),N.attr("class","select2-sizer"),t("body").append(N)}return N.text(e.val()),N.width()}function b(e,i,n){var r,s,o=[];r=e.attr("class"),r&&(r=""+r,t(r.split(" ")).each2(function(){0===this.indexOf("select2-")&&o.push(this)})),r=i.attr("class"),r&&(r=""+r,t(r.split(" ")).each2(function(){0!==this.indexOf("select2-")&&(s=n(this),s&&o.push(s))})),e.attr("class",o.join(" "))}function y(t,e,n,r){var s=i(t.toUpperCase()).indexOf(i(e.toUpperCase())),o=e.length;return 0>s?void n.push(r(t)):(n.push(r(t.substring(0,s))),n.push("<span class='select2-match'>"),n.push(r(t.substring(s,s+o))),n.push("</span>"),void n.push(r(t.substring(s+o,t.length))))}function _(t){var e={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(t).replace(/[&<>"'\/\\]/g,function(t){return e[t]})}function w(i){var n,r=null,s=i.quietMillis||100,o=i.url,a=this;return function(l){window.clearTimeout(n),n=window.setTimeout(function(){var n=i.data,s=o,c=i.transport||t.fn.select2.ajaxDefaults.transport,u={type:i.type||"GET",cache:i.cache||!1,jsonpCallback:i.jsonpCallback||e,dataType:i.dataType||"json"},h=t.extend({},t.fn.select2.ajaxDefaults.params,u);n=n?n.call(a,l.term,l.page,l.context):null,s="function"==typeof s?s.call(a,l.term,l.page,l.context):s,r&&r.abort(),i.params&&(t.isFunction(i.params)?t.extend(h,i.params.call(a)):t.extend(h,i.params)),t.extend(h,{url:s,dataType:i.dataType,data:n,success:function(t){var e=i.results(t,l.page);l.callback(e)}}),r=c.call(a,h)},s)}}function x(e){var i,n,r=e,s=function(t){return""+t.text};t.isArray(r)&&(n=r,r={results:n}),t.isFunction(r)===!1&&(n=r,r=function(){return n});var o=r();return o.text&&(s=o.text,t.isFunction(s)||(i=o.text,s=function(t){return t[i]})),function(e){var i,n=e.term,o={results:[]};return""===n?void e.callback(r()):(i=function(r,o){var a,l;if(r=r[0],r.children){a={};for(l in r)r.hasOwnProperty(l)&&(a[l]=r[l]);a.children=[],t(r.children).each2(function(t,e){i(e,a.children)}),(a.children.length||e.matcher(n,s(a),r))&&o.push(a)}else e.matcher(n,s(r),r)&&o.push(r)},t(r().results).each2(function(t,e){i(e,o.results)}),void e.callback(o))}}function k(i){var n=t.isFunction(i);return function(r){var s=r.term,o={results:[]};t(n?i():i).each(function(){var t=this.text!==e,i=t?this.text:this;(""===s||r.matcher(s,i))&&o.results.push(t?this:{id:this,text:this})}),r.callback(o)}}function C(e,i){if(t.isFunction(e))return!0;if(!e)return!1;throw new Error(i+" must be a function or a falsy value")}function A(e){return t.isFunction(e)?e():e}function T(e){var i=0;return t.each(e,function(t,e){e.children?i+=T(e.children):i++}),i}function S(t,i,n,r){var o,a,l,c,u,h=t,d=!1;if(!r.createSearchChoice||!r.tokenSeparators||r.tokenSeparators.length<1)return e;for(;;){for(a=-1,l=0,c=r.tokenSeparators.length;c>l&&(u=r.tokenSeparators[l],a=t.indexOf(u),!(a>=0));l++);if(0>a)break;if(o=t.substring(0,a),t=t.substring(a+u.length),o.length>0&&(o=r.createSearchChoice.call(this,o,i),o!==e&&null!==o&&r.id(o)!==e&&null!==r.id(o))){for(d=!1,l=0,c=i.length;c>l;l++)if(s(r.id(o),r.id(i[l]))){d=!0;break}d||n(o)}}return h!==t?t:void 0}function M(e,i){var n=function(){};return n.prototype=new e,n.prototype.constructor=n,n.prototype.parent=e.prototype,n.prototype=t.extend(n.prototype,i),n}if(window.Select2===e){var D,$,E,P,I,N,F,O,B={x:0,y:0},D={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(t){switch(t=t.which?t.which:t){case D.LEFT:case D.RIGHT:case D.UP:case D.DOWN:return!0}return!1},isControl:function(t){var e=t.which;switch(e){case D.SHIFT:case D.CTRL:case D.ALT:return!0}return t.metaKey?!0:!1},isFunctionKey:function(t){return t=t.which?t.which:t,t>=112&&123>=t}},z="<div class='select2-measure-scrollbar'></div>",R={"":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"AA","":"AE","":"AE","":"AE","":"AO","":"AU","":"AV","":"AV","":"AY","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"DZ","":"DZ","":"Dz","":"Dz","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"F","":"F","":"F","":"F","":"F","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"J","":"J","":"J","":"J","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"LJ","":"Lj","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"NJ","":"Nj","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"OI","":"OO","":"OU","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"Q","":"Q","":"Q","":"Q","":"Q","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"TZ","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"VY","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"X","":"X","":"X","":"X","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"aa","":"ae","":"ae","":"ae","":"ao","":"au","":"av","":"av","":"ay","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"dz","":"dz","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"f","":"f","":"f","":"f","":"f","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"hv","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"j","":"j","":"j","":"j","":"j","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"lj","":"m","":"m","":"m","":"m","":"m","":"m","":"m","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"nj","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"oi","":"ou","":"oo","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"q","":"q","":"q","":"q","":"q","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"tz","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"vy","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"x","":"x","":"x","":"x","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z"};F=t(document),I=function(){var t=1;return function(){return t++}}(),F.on("mousemove",function(t){B.x=t.pageX,B.y=t.pageY}),$=M(Object,{bind:function(t){var e=this;return function(){t.apply(e,arguments)}},init:function(i){var n,s,o=".select2-results";this.opts=i=this.prepareOpts(i),this.id=i.id,i.element.data("select2")!==e&&null!==i.element.data("select2")&&i.element.data("select2").destroy(),this.container=this.createContainer(),this.containerId="s2id_"+(i.element.attr("id")||"autogen"+I()),this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.body=h(function(){return i.element.closest("body")}),b(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",i.element.attr("style")),this.container.css(A(i.containerCss)),this.container.addClass(A(i.containerCssClass)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",g),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),b(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(A(i.dropdownCssClass)),this.dropdown.data("select2",this),this.dropdown.on("click",g),this.results=n=this.container.find(o),this.search=s=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",g),c(this.results),this.dropdown.on("mousemove-filtered touchstart touchmove touchend",o,this.bind(this.highlightUnderEvent)),d(80,this.results),this.dropdown.on("scroll-debounced",o,this.bind(this.loadMoreIfNeeded)),t(this.container).on("change",".select2-input",function(t){t.stopPropagation()}),t(this.dropdown).on("change",".select2-input",function(t){t.stopPropagation()}),t.fn.mousewheel&&n.mousewheel(function(t,e,i,r){var s=n.scrollTop();r>0&&0>=s-r?(n.scrollTop(0),g(t)):0>r&&n.get(0).scrollHeight-n.scrollTop()+r<=n.height()&&(n.scrollTop(n.get(0).scrollHeight-n.height()),g(t))}),l(s),s.on("keyup-change input paste",this.bind(this.updateResults)),s.on("focus",function(){s.addClass("select2-focused")}),s.on("blur",function(){s.removeClass("select2-focused")}),this.dropdown.on("mouseup",o,this.bind(function(e){t(e.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(e),this.selectHighlighted(e))})),this.dropdown.on("click mouseup mousedown",function(t){t.stopPropagation()}),t.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==i.maximumInputLength&&this.search.attr("maxlength",i.maximumInputLength);var a=i.element.prop("disabled");a===e&&(a=!1),this.enable(!a);var u=i.element.prop("readonly");u===e&&(u=!1),this.readonly(u),O=O||r(),this.autofocus=i.element.prop("autofocus"),i.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.nextSearchTerm=e},destroy:function(){var t=this.opts.element,i=t.data("select2");this.close(),this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),i!==e&&(i.container.remove(),i.dropdown.remove(),t.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||!1),this.elementTabIndex?t.attr({tabindex:this.elementTabIndex}):t.removeAttr("tabindex"),t.show())},optionToData:function(t){return t.is("option")?{id:t.prop("value"),text:t.text(),element:t.get(),css:t.attr("class"),disabled:t.prop("disabled"),locked:s(t.attr("locked"),"locked")||s(t.data("locked"),!0)}:t.is("optgroup")?{text:t.attr("label"),children:[],element:t.get(),css:t.attr("class")}:void 0},prepareOpts:function(i){var n,r,a,l,c=this;if(n=i.element,"select"===n.get(0).tagName.toLowerCase()&&(this.select=r=i.element),r&&t.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in i)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),i=t.extend({},{populateResults:function(n,r,s){var o,a=this.opts.id;(o=function(n,r,l){var u,h,d,p,f,g,m,v,b,y;for(n=i.sortResults(n,r,s),u=0,h=n.length;h>u;u+=1)d=n[u],f=d.disabled===!0,p=!f&&a(d)!==e,g=d.children&&d.children.length>0,m=t("<li></li>"),m.addClass("select2-results-dept-"+l),m.addClass("select2-result"),m.addClass(p?"select2-result-selectable":"select2-result-unselectable"),f&&m.addClass("select2-disabled"),g&&m.addClass("select2-result-with-children"),m.addClass(c.opts.formatResultCssClass(d)),v=t(document.createElement("div")),v.addClass("select2-result-label"),y=i.formatResult(d,v,s,c.opts.escapeMarkup),y!==e&&v.html(y),m.append(v),g&&(b=t("<ul></ul>"),b.addClass("select2-result-sub"),o(d.children,b,l+1),m.append(b)),m.data("select2-data",d),r.append(m)})(r,n,0)}},t.fn.select2.defaults,i),"function"!=typeof i.id&&(a=i.id,i.id=function(t){return t[a]
}),t.isArray(i.element.data("select2Tags"))){if("tags"in i)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+i.element.attr("id");i.tags=i.element.data("select2Tags")}if(r?(i.query=this.bind(function(t){var i,r,s,o={results:[],more:!1},a=t.term;s=function(e,i){var n;e.is("option")?t.matcher(a,e.text(),e)&&i.push(c.optionToData(e)):e.is("optgroup")&&(n=c.optionToData(e),e.children().each2(function(t,e){s(e,n.children)}),n.children.length>0&&i.push(n))},i=n.children(),this.getPlaceholder()!==e&&i.length>0&&(r=this.getPlaceholderOption(),r&&(i=i.not(r))),i.each2(function(t,e){s(e,o.results)}),t.callback(o)}),i.id=function(t){return t.id},i.formatResultCssClass=function(t){return t.css}):"query"in i||("ajax"in i?(l=i.element.data("ajax-url"),l&&l.length>0&&(i.ajax.url=l),i.query=w.call(i.element,i.ajax)):"data"in i?i.query=x(i.data):"tags"in i&&(i.query=k(i.tags),i.createSearchChoice===e&&(i.createSearchChoice=function(e){return{id:t.trim(e),text:t.trim(e)}}),i.initSelection===e&&(i.initSelection=function(e,n){var r=[];t(o(e.val(),i.separator)).each(function(){var e={id:this,text:this},n=i.tags;t.isFunction(n)&&(n=n()),t(n).each(function(){return s(this.id,e.id)?(e=this,!1):void 0}),r.push(e)}),n(r)}))),"function"!=typeof i.query)throw"query function not defined for Select2 "+i.element.attr("id");return i},monitorSource:function(){var t,i,n=this.opts.element;n.on("change.select2",this.bind(function(){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),t=this.bind(function(){var t=n.prop("disabled");t===e&&(t=!1),this.enable(!t);var i=n.prop("readonly");i===e&&(i=!1),this.readonly(i),b(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(A(this.opts.containerCssClass)),b(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(A(this.opts.dropdownCssClass))}),n.on("propertychange.select2",t),this.mutationCallback===e&&(this.mutationCallback=function(e){e.forEach(t)}),i=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,i!==e&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new i(this.mutationCallback),this.propertyObserver.observe(n.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(e){var i=t.Event("select2-selecting",{val:this.id(e),object:e});return this.opts.element.trigger(i),!i.isDefaultPrevented()},triggerChange:function(e){e=e||{},e=t.extend({},e,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(e),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return this.enabledInterface===!0},enableInterface:function(){var t=this._enabled&&!this._readonly,e=!t;return t===this.enabledInterface?!1:(this.container.toggleClass("select2-container-disabled",e),this.close(),this.enabledInterface=t,!0)},enable:function(t){t===e&&(t=!0),this._enabled!==t&&(this._enabled=t,this.opts.element.prop("disabled",!t),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(t){return t===e&&(t=!1),this._readonly===t?!1:(this._readonly=t,this.opts.element.prop("readonly",t),this.enableInterface(),!0)},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var e,i,n,r,s,o=this.dropdown,a=this.container.offset(),l=this.container.outerHeight(!1),c=this.container.outerWidth(!1),u=o.outerHeight(!1),h=t(window),d=h.width(),p=h.height(),f=h.scrollLeft()+d,g=h.scrollTop()+p,m=a.top+l,v=a.left,b=g>=m+u,y=a.top-u>=this.body().scrollTop(),_=o.outerWidth(!1),w=f>=v+_,x=o.hasClass("select2-drop-above");x?(i=!0,!y&&b&&(n=!0,i=!1)):(i=!1,!b&&y&&(n=!0,i=!0)),n&&(o.hide(),a=this.container.offset(),l=this.container.outerHeight(!1),c=this.container.outerWidth(!1),u=o.outerHeight(!1),f=h.scrollLeft()+d,g=h.scrollTop()+p,m=a.top+l,v=a.left,_=o.outerWidth(!1),w=f>=v+_,o.show()),this.opts.dropdownAutoWidth?(s=t(".select2-results",o)[0],o.addClass("select2-drop-auto-width"),o.css("width",""),_=o.outerWidth(!1)+(s.scrollHeight===s.clientHeight?0:O.width),_>c?c=_:_=c,w=f>=v+_):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body().css("position")&&(e=this.body().offset(),m-=e.top,v-=e.left),w||(v=a.left+c-_),r={left:v,width:c},i?(r.bottom=p-a.top,r.top="auto",this.container.addClass("select2-drop-above"),o.addClass("select2-drop-above")):(r.top=m,r.bottom="auto",this.container.removeClass("select2-drop-above"),o.removeClass("select2-drop-above")),r=t.extend(r,A(this.opts.dropdownCss)),o.css(r)},shouldOpen:function(){var e;return this.opened()?!1:this._enabled===!1||this._readonly===!0?!1:(e=t.Event("select2-opening"),this.opts.element.trigger(e),!e.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(this.opening(),!0):!1},opening:function(){var e,i=this.containerId,n="scroll."+i,r="resize."+i,s="orientationchange."+i;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),e=t("#select2-drop-mask"),0==e.length&&(e=t(document.createElement("div")),e.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),e.hide(),e.appendTo(this.body()),e.on("mousedown touchstart click",function(e){var i,n=t("#select2-drop");n.length>0&&(i=n.data("select2"),i.opts.selectOnBlur&&i.selectHighlighted({noFocus:!0}),i.close({focus:!0}),e.preventDefault(),e.stopPropagation())})),this.dropdown.prev()[0]!==e[0]&&this.dropdown.before(e),t("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),e.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var o=this;this.container.parents().add(window).each(function(){t(this).on(r+" "+n+" "+s,function(){o.positionDropdown()})})},close:function(){if(this.opened()){var e=this.containerId,i="scroll."+e,n="resize."+e,r="orientationchange."+e;this.container.parents().add(window).each(function(){t(this).off(i).off(n).off(r)}),this.clearDropdownAlignmentPreference(),t("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),this.clearSearch(),this.search.removeClass("select2-active"),this.opts.element.trigger(t.Event("select2-close"))}},externalSearch:function(t){this.open(),this.search.val(t),this.updateResults(!1)},clearSearch:function(){},getMaximumSelectionSize:function(){return A(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var e,i,n,r,s,o,a,l=this.results;if(i=this.highlight(),!(0>i)){if(0==i)return void l.scrollTop(0);e=this.findHighlightableChoices().find(".select2-result-label"),n=t(e[i]),r=n.offset().top+n.outerHeight(!0),i===e.length-1&&(a=l.find("li.select2-more-results"),a.length>0&&(r=a.offset().top+a.outerHeight(!0))),s=l.offset().top+l.outerHeight(!0),r>s&&l.scrollTop(l.scrollTop()+(r-s)),o=n.offset().top-l.offset().top,0>o&&"none"!=n.css("display")&&l.scrollTop(l.scrollTop()+o)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled, .select2-selected)")},moveHighlight:function(e){for(var i=this.findHighlightableChoices(),n=this.highlight();n>-1&&n<i.length;){n+=e;var r=t(i[n]);if(r.hasClass("select2-result-selectable")&&!r.hasClass("select2-disabled")&&!r.hasClass("select2-selected")){this.highlight(n);break}}},highlight:function(e){var i,r,s=this.findHighlightableChoices();return 0===arguments.length?n(s.filter(".select2-highlighted")[0],s.get()):(e>=s.length&&(e=s.length-1),0>e&&(e=0),this.removeHighlight(),i=t(s[e]),i.addClass("select2-highlighted"),this.ensureHighlightVisible(),r=i.data("select2-data"),void(r&&this.opts.element.trigger({type:"select2-highlight",val:this.id(r),choice:r})))},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(e){var i=t(e.target).closest(".select2-result-selectable");if(i.length>0&&!i.is(".select2-highlighted")){var n=this.findHighlightableChoices();this.highlight(n.index(i))}else 0==i.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var t,e=this.results,i=e.find("li.select2-more-results"),n=this.resultsPage+1,r=this,s=this.search.val(),o=this.context;0!==i.length&&(t=i.offset().top-e.offset().top-e.height(),t<=this.opts.loadMorePadding&&(i.addClass("select2-active"),this.opts.query({element:this.opts.element,term:s,page:n,context:o,matcher:this.opts.matcher,callback:this.bind(function(t){r.opened()&&(r.opts.populateResults.call(this,e,t.results,{term:s,page:n,context:o}),r.postprocessResults(t,!1,!1),t.more===!0?(i.detach().appendTo(e).text(r.opts.formatLoadMore(n+1)),window.setTimeout(function(){r.loadMoreIfNeeded()},10)):i.remove(),r.positionDropdown(),r.resultsPage=n,r.context=t.context,this.opts.element.trigger({type:"select2-loaded",items:t}))})})))},tokenize:function(){},updateResults:function(i){function n(){c.removeClass("select2-active"),d.positionDropdown()}function r(t){u.html(t),n()}var o,a,l,c=this.search,u=this.results,h=this.opts,d=this,p=c.val(),f=t.data(this.container,"select2-last-term");if((i===!0||!f||!s(p,f))&&(t.data(this.container,"select2-last-term",p),i===!0||this.showSearchInput!==!1&&this.opened())){l=++this.queryCount;var g=this.getMaximumSelectionSize();if(g>=1&&(o=this.data(),t.isArray(o)&&o.length>=g&&C(h.formatSelectionTooBig,"formatSelectionTooBig")))return void r("<li class='select2-selection-limit'>"+h.formatSelectionTooBig(g)+"</li>");if(c.val().length<h.minimumInputLength)return r(C(h.formatInputTooShort,"formatInputTooShort")?"<li class='select2-no-results'>"+h.formatInputTooShort(c.val(),h.minimumInputLength)+"</li>":""),void(i&&this.showSearch&&this.showSearch(!0));if(h.maximumInputLength&&c.val().length>h.maximumInputLength)return void r(C(h.formatInputTooLong,"formatInputTooLong")?"<li class='select2-no-results'>"+h.formatInputTooLong(c.val(),h.maximumInputLength)+"</li>":"");h.formatSearching&&0===this.findHighlightableChoices().length&&r("<li class='select2-searching'>"+h.formatSearching()+"</li>"),c.addClass("select2-active"),this.removeHighlight(),a=this.tokenize(),a!=e&&null!=a&&c.val(a),this.resultsPage=1,h.query({element:h.element,term:c.val(),page:this.resultsPage,context:null,matcher:h.matcher,callback:this.bind(function(o){var a;if(l==this.queryCount){if(!this.opened())return void this.search.removeClass("select2-active");if(this.context=o.context===e?null:o.context,this.opts.createSearchChoice&&""!==c.val()&&(a=this.opts.createSearchChoice.call(d,c.val(),o.results),a!==e&&null!==a&&d.id(a)!==e&&null!==d.id(a)&&0===t(o.results).filter(function(){return s(d.id(this),d.id(a))}).length&&o.results.unshift(a)),0===o.results.length&&C(h.formatNoMatches,"formatNoMatches"))return void r("<li class='select2-no-results'>"+h.formatNoMatches(c.val())+"</li>");u.empty(),d.opts.populateResults.call(this,u,o.results,{term:c.val(),page:this.resultsPage,context:null}),o.more===!0&&C(h.formatLoadMore,"formatLoadMore")&&(u.append("<li class='select2-more-results'>"+d.opts.escapeMarkup(h.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){d.loadMoreIfNeeded()},10)),this.postprocessResults(o,i),n(),this.opts.element.trigger({type:"select2-loaded",items:o})}})})}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){p(this.search)},selectHighlighted:function(t){var e=this.highlight(),i=this.results.find(".select2-highlighted"),n=i.closest(".select2-result").data("select2-data");n?(this.highlight(e),this.onSelect(n,t)):t&&t.noFocus&&this.close()},getPlaceholder:function(){var t;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((t=this.getPlaceholderOption())!==e?t.text():e)},getPlaceholderOption:function(){if(this.select){var t=this.select.children("option").first();if(this.opts.placeholderOption!==e)return"first"===this.opts.placeholderOption&&t||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===t.text()&&""===t.val())return t}},initContainerWidth:function(){function i(){var i,n,r,s,o,a;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if(i=this.opts.element.attr("style"),i!==e)for(n=i.split(";"),s=0,o=n.length;o>s;s+=1)if(a=n[s].replace(/\s/g,""),r=a.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),null!==r&&r.length>=1)return r[1];return"resolve"===this.opts.width?(i=this.opts.element.css("width"),i.indexOf("%")>0?i:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px"):null}return t.isFunction(this.opts.width)?this.opts.width():this.opts.width}var n=i.call(this);null!==n&&this.container.css("width",n)}}),E=M($,{createContainer:function(){var e=t(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&nbsp;</span><abbr class='select2-search-choice-close'></abbr>","   <button class='select2-arrow btn btn-mini btn-clear dropdown-toggle'><i class='icon-chevron-down'></i></button>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <input type='text' placeholder='Search...' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return e},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var i,n,r;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.search.focus(),i=this.search.get(0),i.createTextRange?(n=i.createTextRange(),n.collapse(!1),n.select()):i.setSelectionRange&&(r=this.search.val().length,i.setSelectionRange(r,r)),""===this.search.val()&&this.nextSearchTerm!=e&&(this.search.val(this.nextSearchTerm),this.search.select()),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(t.Event("select2-open"))},close:function(t){this.opened()&&(this.parent.close.apply(this,arguments),t=t||{focus:!0},this.focusser.removeAttr("disabled"),t.focus&&this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.removeAttr("disabled"),this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.removeAttr("disabled"),this.focusser.focus()},destroy:function(){t("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments)},initContainer:function(){var e,i=this.container,n=this.dropdown;this.showSearch(this.opts.minimumResultsForSearch<0?!1:!0),this.selection=e=i.find(".select2-choice"),this.focusser=i.find(".select2-focusser"),this.focusser.attr("id","s2id_autogen"+I()),t("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.focusser.attr("id")),this.focusser.attr("tabindex",this.elementTabIndex),this.search.on("keydown",this.bind(function(t){if(this.isInterfaceEnabled()){if(t.which===D.PAGE_UP||t.which===D.PAGE_DOWN)return void g(t);switch(t.which){case D.UP:case D.DOWN:return this.moveHighlight(t.which===D.UP?-1:1),void g(t);case D.ENTER:return this.selectHighlighted(),void g(t);case D.TAB:return void this.selectHighlighted({noFocus:!0});case D.ESC:return this.cancel(t),void g(t)}}})),this.search.on("blur",this.bind(function(){document.activeElement===this.body().get(0)&&window.setTimeout(this.bind(function(){this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(t){if(this.isInterfaceEnabled()&&t.which!==D.TAB&&!D.isControl(t)&&!D.isFunctionKey(t)&&t.which!==D.ESC){if(this.opts.openOnEnter===!1&&t.which===D.ENTER)return void g(t);if(t.which==D.DOWN||t.which==D.UP||t.which==D.ENTER&&this.opts.openOnEnter){if(t.altKey||t.ctrlKey||t.shiftKey||t.metaKey)return;return this.open(),void g(t)}return t.which==D.DELETE||t.which==D.BACKSPACE?(this.opts.allowClear&&this.clear(),void g(t)):void 0}})),l(this.focusser),this.focusser.on("keyup-change input",this.bind(function(t){if(this.opts.minimumResultsForSearch>=0){if(t.stopPropagation(),this.opened())return;this.open()}})),e.on("mousedown","abbr",this.bind(function(t){this.isInterfaceEnabled()&&(this.clear(),m(t),this.close(),this.selection.focus())})),e.on("mousedown",this.bind(function(e){this.container.hasClass("select2-container-active")||this.opts.element.trigger(t.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),g(e)})),n.on("mousedown",this.bind(function(){this.search.focus()})),e.on("focus",this.bind(function(t){g(t)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(t.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(t.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(t.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.setPlaceholder()},clear:function(e){var i=this.selection.data("select2-data");if(i){var n=t.Event("select2-clearing");if(this.opts.element.trigger(n),n.isDefaultPrevented())return;var r=this.getPlaceholderOption();this.opts.element.val(r?r.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),e!==!1&&(this.opts.element.trigger({type:"select2-removed",val:this.id(i),choice:i}),this.triggerChange({removed:i}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var t=this;this.opts.initSelection.call(null,this.opts.element,function(i){i!==e&&null!==i&&(t.updateSelection(i),t.close(),t.setPlaceholder())})}},isPlaceholderOptionSelected:function(){var t;return this.getPlaceholder()?(t=this.getPlaceholderOption())!==e&&t.prop("selected")||""===this.opts.element.val()||this.opts.element.val()===e||null===this.opts.element.val():!1},prepareOpts:function(){var e=this.parent.prepareOpts.apply(this,arguments),i=this;return"select"===e.element.get(0).tagName.toLowerCase()?e.initSelection=function(t,e){var n=t.find("option").filter(function(){return this.selected});e(i.optionToData(n))}:"data"in e&&(e.initSelection=e.initSelection||function(i,n){var r=i.val(),o=null;e.query({matcher:function(t,i,n){var a=s(r,e.id(n));return a&&(o=n),a},callback:t.isFunction(n)?function(){n(o)}:t.noop})}),e},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===e?e:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var t=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&t!==e){if(this.select&&this.getPlaceholderOption()===e)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(t)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(t,e,i){var n=0,r=this;if(this.findHighlightableChoices().each2(function(t,e){return s(r.id(e.data("select2-data")),r.opts.element.val())?(n=t,!1):void 0}),i!==!1&&this.highlight(e===!0&&n>=0?n:0),e===!0){var o=this.opts.minimumResultsForSearch;o>=0&&this.showSearch(T(t.results)>=o)}},showSearch:function(e){this.showSearchInput!==e&&(this.showSearchInput=e,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!e),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!e),t(this.dropdown,this.container).toggleClass("select2-with-searchbox",e))},onSelect:function(t,e){if(this.triggerSelect(t)){var i=this.opts.element.val(),n=this.data();this.opts.element.val(this.id(t)),this.updateSelection(t),this.opts.element.trigger({type:"select2-selected",val:this.id(t),choice:t}),this.nextSearchTerm=this.opts.nextSearchTerm(t,this.search.val()),this.close(),e&&e.noFocus||this.focusser.focus(),s(i,this.id(t))||this.triggerChange({added:t,removed:n})}},updateSelection:function(t){var i,n,r=this.selection.find(".select2-chosen");this.selection.data("select2-data",t),r.empty(),null!==t&&(i=this.opts.formatSelection(t,r,this.opts.escapeMarkup)),i!==e&&r.append(i),n=this.opts.formatSelectionCssClass(t,r),n!==e&&r.addClass(n),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==e&&this.container.addClass("select2-allowclear")},val:function(){var t,i=!1,n=null,r=this,s=this.data();if(0===arguments.length)return this.opts.element.val();if(t=arguments[0],arguments.length>1&&(i=arguments[1]),this.select)this.select.val(t).find("option").filter(function(){return this.selected}).each2(function(t,e){return n=r.optionToData(e),!1}),this.updateSelection(n),this.setPlaceholder(),i&&this.triggerChange({added:n,removed:s});else{if(!t&&0!==t)return void this.clear(i);if(this.opts.initSelection===e)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(t),this.opts.initSelection(this.opts.element,function(t){r.opts.element.val(t?r.id(t):""),r.updateSelection(t),r.setPlaceholder(),i&&r.triggerChange({added:t,removed:s})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(t){var i,n=!1;return 0===arguments.length?(i=this.selection.data("select2-data"),i==e&&(i=null),i):(arguments.length>1&&(n=arguments[1]),void(t?(i=this.data(),this.opts.element.val(t?this.id(t):""),this.updateSelection(t),n&&this.triggerChange({added:t,removed:i})):this.clear(n)))}}),P=M($,{createContainer:function(){var e=t(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return e},prepareOpts:function(){var e=this.parent.prepareOpts.apply(this,arguments),i=this;return"select"===e.element.get(0).tagName.toLowerCase()?e.initSelection=function(t,e){var n=[];t.find("option").filter(function(){return this.selected}).each2(function(t,e){n.push(i.optionToData(e))}),e(n)}:"data"in e&&(e.initSelection=e.initSelection||function(i,n){var r=o(i.val(),e.separator),a=[];e.query({matcher:function(i,n,o){var l=t.grep(r,function(t){return s(t,e.id(o))}).length;return l&&a.push(o),l},callback:t.isFunction(n)?function(){for(var t=[],i=0;i<r.length;i++)for(var o=r[i],l=0;l<a.length;l++){var c=a[l];if(s(o,e.id(c))){t.push(c),a.splice(l,1);break}}n(t)}:t.noop})}),e},selectChoice:function(t){var e=this.container.find(".select2-search-choice-focus");e.length&&t&&t[0]==e[0]||(e.length&&this.opts.element.trigger("choice-deselected",e),e.removeClass("select2-search-choice-focus"),t&&t.length&&(this.close(),t.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",t)))},destroy:function(){t("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments)},initContainer:function(){var e,i=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=e=this.container.find(i);var n=this;this.selection.on("click",".select2-search-choice:not(.select2-locked)",function(){n.search[0].focus(),n.selectChoice(t(this))}),this.search.attr("id","s2id_autogen"+I()),t("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.search.attr("id")),this.search.on("input paste",this.bind(function(){this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(t){if(this.isInterfaceEnabled()){++this.keydowns;var i=e.find(".select2-search-choice-focus"),n=i.prev(".select2-search-choice:not(.select2-locked)"),r=i.next(".select2-search-choice:not(.select2-locked)"),s=f(this.search);if(i.length&&(t.which==D.LEFT||t.which==D.RIGHT||t.which==D.BACKSPACE||t.which==D.DELETE||t.which==D.ENTER)){var o=i;return t.which==D.LEFT&&n.length?o=n:t.which==D.RIGHT?o=r.length?r:null:t.which===D.BACKSPACE?(this.unselect(i.first()),this.search.width(10),o=n.length?n:r):t.which==D.DELETE?(this.unselect(i.first()),this.search.width(10),o=r.length?r:null):t.which==D.ENTER&&(o=null),this.selectChoice(o),g(t),void(o&&o.length||this.open())}if((t.which===D.BACKSPACE&&1==this.keydowns||t.which==D.LEFT)&&0==s.offset&&!s.length)return this.selectChoice(e.find(".select2-search-choice:not(.select2-locked)").last()),void g(t);if(this.selectChoice(null),this.opened())switch(t.which){case D.UP:case D.DOWN:return this.moveHighlight(t.which===D.UP?-1:1),void g(t);case D.ENTER:return this.selectHighlighted(),void g(t);case D.TAB:return this.selectHighlighted({noFocus:!0}),void this.close();case D.ESC:return this.cancel(t),void g(t)}if(t.which!==D.TAB&&!D.isControl(t)&&!D.isFunctionKey(t)&&t.which!==D.BACKSPACE&&t.which!==D.ESC){if(t.which===D.ENTER){if(this.opts.openOnEnter===!1)return;if(t.altKey||t.ctrlKey||t.shiftKey||t.metaKey)return}this.open(),(t.which===D.PAGE_UP||t.which===D.PAGE_DOWN)&&g(t),t.which===D.ENTER&&g(t)}}})),this.search.on("keyup",this.bind(function(){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(e){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),e.stopImmediatePropagation(),this.opts.element.trigger(t.Event("select2-blur"))})),this.container.on("click",i,this.bind(function(e){this.isInterfaceEnabled()&&(t(e.target).closest(".select2-search-choice").length>0||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(t.Event("select2-focus")),this.open(),this.focusSearch(),e.preventDefault()))})),this.container.on("focus",i,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(t.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var t=this;this.opts.initSelection.call(null,this.opts.element,function(i){i!==e&&null!==i&&(t.updateSelection(i),t.close(),t.clearSearch())})}},clearSearch:function(){var t=this.getPlaceholder(),i=this.getMaxSearchWidth();t!==e&&0===this.getVal().length&&this.search.hasClass("select2-focused")===!1?(this.search.val(t).addClass("select2-default"),this.search.width(i>0?i:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),this.updateResults(!0),this.search.focus(),this.opts.element.trigger(t.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(e){var i=[],r=[],s=this;t(e).each(function(){n(s.id(this),i)<0&&(i.push(s.id(this)),r.push(this))}),e=r,this.selection.find(".select2-search-choice").remove(),t(e).each(function(){s.addSelectedChoice(this)}),s.postprocessResults()},tokenize:function(){var t=this.search.val();t=this.opts.tokenizer.call(this,t,this.data(),this.bind(this.onSelect),this.opts),null!=t&&t!=e&&(this.search.val(t),t.length>0&&this.open())},onSelect:function(t,e){this.triggerSelect(t)&&(this.addSelectedChoice(t),this.opts.element.trigger({type:"selected",val:this.id(t),choice:t}),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(t,!1,this.opts.closeOnSelect===!0),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()&&this.updateResults(!0),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:t}),e&&e.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(i){var n,r,s=!i.locked,o=t("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),a=t("<li class='select2-search-choice select2-locked'><div></div></li>"),l=s?o:a,c=this.id(i),u=this.getVal();n=this.opts.formatSelection(i,l.find("div"),this.opts.escapeMarkup),n!=e&&l.find("div").replaceWith("<div>"+n+"</div>"),r=this.opts.formatSelectionCssClass(i,l.find("div")),r!=e&&l.addClass(r),s&&l.find(".select2-search-choice-close").on("mousedown",g).on("click dblclick",this.bind(function(e){this.isInterfaceEnabled()&&(t(e.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(t(e.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.close(),this.focusSearch()})).dequeue(),g(e))})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),l.data("select2-data",i),l.insertBefore(this.searchContainer),u.push(c),this.setVal(u)},unselect:function(e){var i,r,s=this.getVal();if(e=e.closest(".select2-search-choice"),0===e.length)throw"Invalid argument: "+e+". Must be .select2-search-choice";if(i=e.data("select2-data")){for(;(r=n(this.id(i),s))>=0;)s.splice(r,1),this.setVal(s),this.select&&this.postprocessResults();var o=t.Event("select2-removing");o.val=this.id(i),o.choice=i,this.opts.element.trigger(o),o.isDefaultPrevented()||(e.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(i),choice:i}),this.triggerChange({removed:i}))
}},postprocessResults:function(t,e,i){var r=this.getVal(),s=this.results.find(".select2-result"),o=this.results.find(".select2-result-with-children"),a=this;s.each2(function(t,e){var i=a.id(e.data("select2-data"));n(i,r)>=0&&(e.addClass("select2-selected"),e.find(".select2-result-selectable").addClass("select2-selected"))}),o.each2(function(t,e){e.is(".select2-result-selectable")||0!==e.find(".select2-result-selectable:not(.select2-selected)").length||e.addClass("select2-selected")}),-1==this.highlight()&&i!==!1&&a.highlight(0),!this.opts.createSearchChoice&&!s.filter(".select2-result:not(.select2-selected)").length>0&&(!t||t&&!t.more&&0===this.results.find(".select2-no-results").length)&&C(a.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+a.opts.formatNoMatches(a.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-a(this.search)},resizeSearch:function(){var t,e,i,n,r,s=a(this.search);t=v(this.search)+10,e=this.search.offset().left,i=this.selection.width(),n=this.selection.offset().left,r=i-(e-n)-s,t>r&&(r=i-s),40>r&&(r=i-s),0>=r&&(r=t),this.search.width(Math.floor(r))},getVal:function(){var t;return this.select?(t=this.select.val(),null===t?[]:t):(t=this.opts.element.val(),o(t,this.opts.separator))},setVal:function(e){var i;this.select?this.select.val(e):(i=[],t(e).each(function(){n(this,i)<0&&i.push(this)}),this.opts.element.val(0===i.length?"":i.join(this.opts.separator)))},buildChangeDetails:function(t,e){for(var e=e.slice(0),t=t.slice(0),i=0;i<e.length;i++)for(var n=0;n<t.length;n++)s(this.opts.id(e[i]),this.opts.id(t[n]))&&(e.splice(i,1),i>0&&i--,t.splice(n,1),n--);return{added:e,removed:t}},val:function(i,n){var r,s=this;if(0===arguments.length)return this.getVal();if(r=this.data(),r.length||(r=[]),!i&&0!==i)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void(n&&this.triggerChange({added:this.data(),removed:r}));if(this.setVal(i),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),n&&this.triggerChange(this.buildChangeDetails(r,this.data()));else{if(this.opts.initSelection===e)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(e){var i=t.map(e,s.id);s.setVal(i),s.updateSelection(e),s.clearSearch(),n&&s.triggerChange(s.buildChangeDetails(r,s.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var e=[],i=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){e.push(i.opts.id(t(this).data("select2-data")))}),this.setVal(e),this.triggerChange()},data:function(e,i){var n,r,s=this;return 0===arguments.length?this.selection.find(".select2-search-choice").map(function(){return t(this).data("select2-data")}).get():(r=this.data(),e||(e=[]),n=t.map(e,function(t){return s.opts.id(t)}),this.setVal(n),this.updateSelection(e),this.clearSearch(),i&&this.triggerChange(this.buildChangeDetails(r,this.data())),void 0)}}),t.fn.select2=function(){var i,r,s,o,a,l=Array.prototype.slice.call(arguments,0),c=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],u=["opened","isFocused","container","dropdown"],h=["val","data"],d={search:"externalSearch"};return this.each(function(){if(0===l.length||"object"==typeof l[0])i=0===l.length?{}:t.extend({},l[0]),i.element=t(this),"select"===i.element.get(0).tagName.toLowerCase()?a=i.element.prop("multiple"):(a=i.multiple||!1,"tags"in i&&(i.multiple=a=!0)),r=a?new P:new E,r.init(i);else{if("string"!=typeof l[0])throw"Invalid arguments to select2 plugin: "+l;if(n(l[0],c)<0)throw"Unknown method: "+l[0];if(o=e,r=t(this).data("select2"),r===e)return;if(s=l[0],"container"===s?o=r.container:"dropdown"===s?o=r.dropdown:(d[s]&&(s=d[s]),o=r[s].apply(r,l.slice(1))),n(l[0],u)>=0||n(l[0],h)&&1==l.length)return!1}}),o===e?this:o},t.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(t,e,i,n){var r=[];return y(t.text,i.term,r,n),r.join("")},formatSelection:function(t,i,n){return t?n(t.text):e},sortResults:function(t){return t},formatResultCssClass:function(){return e},formatSelectionCssClass:function(){return e},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(t,e){var i=e-t.length;return"Please enter "+i+" more character"+(1==i?"":"s")},formatInputTooLong:function(t,e){var i=t.length-e;return"Please delete "+i+" character"+(1==i?"":"s")},formatSelectionTooBig:function(t){return"You can only select "+t+" item"+(1==t?"":"s")},formatLoadMore:function(){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(t){return t.id},matcher:function(t,e){return i(""+e).toUpperCase().indexOf(i(""+t).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:S,escapeMarkup:_,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(t){return t},adaptDropdownCssClass:function(){return null},nextSearchTerm:function(){return e}},t.fn.select2.ajaxDefaults={transport:t.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:w,local:x,tags:k},util:{debounce:u,markMatch:y,escapeMarkup:_,stripDiacritics:i},"class":{"abstract":$,single:E,multi:P}}}}(jQuery),define("select2",["jquery"],function(){}),define("fuelux/util",["require","jquery"],function(t){function e(t,e){return(t.textContent||t.innerText||i(t).text()||"").toLowerCase()===(e||"").toLowerCase()}var i=t("jquery");i.expr[":"].fuelTextExactCI=i.expr.createPseudo?i.expr.createPseudo(function(t){return function(i){return e(i,t)}}):function(t,i,n){return e(t,n[3])}}),define("fuelux/combobox",["require","jquery","./util"],function(t){var e=t("jquery"),i=e.fn.combobox;t("./util");var n=function(t,i){this.$element=e(t),this.options=e.extend({},e.fn.combobox.defaults,i),this.$element.on("click","a",e.proxy(this.itemclicked,this)),this.$element.on("change","input",e.proxy(this.inputchanged,this)),this.$input=this.$element.find("input"),this.$button=this.$element.find(".btn"),this.setDefaultSelection()};n.prototype={constructor:n,selectedItem:function(){var t=this.$selectedItem,i={};if(t){var n=this.$selectedItem.text();i=e.extend({text:n},this.$selectedItem.data())}else i={text:this.$input.val()};return i},selectByText:function(t){var e="li:fuelTextExactCI("+t+")";this.selectBySelector(e)},selectByValue:function(t){var e='li[data-value="'+t+'"]';this.selectBySelector(e)},selectByIndex:function(t){var e="li:eq("+t+")";this.selectBySelector(e)},selectBySelector:function(t){var e=this.$element.find(t);"undefined"!=typeof e[0]?(this.$selectedItem=e,this.$input.val(this.$selectedItem.text())):this.$selectedItem=null},setDefaultSelection:function(){var t="li[data-selected=true]:first",e=this.$element.find(t);e.length>0&&(this.selectBySelector(t),e.removeData("selected"),e.removeAttr("data-selected"))},enable:function(){this.$input.removeAttr("disabled"),this.$button.removeClass("disabled")},disable:function(){this.$input.attr("disabled",!0),this.$button.addClass("disabled")},itemclicked:function(t){this.$selectedItem=e(t.target).parent(),this.$input.val(this.$selectedItem.text()).trigger("change",{synthetic:!0});var i=this.selectedItem();this.$element.trigger("changed",i),t.preventDefault()},inputchanged:function(t,i){if(!i||!i.synthetic){var n=e(t.target).val();this.selectByText(n);var r=this.selectedItem();0===r.text.length&&(r={text:n}),this.$element.trigger("changed",r)}}},e.fn.combobox=function(t){var i,r=Array.prototype.slice.call(arguments,1),s=this.each(function(){var s=e(this),o=s.data("combobox"),a="object"==typeof t&&t;o||s.data("combobox",o=new n(this,a)),"string"==typeof t&&(i=o[t].apply(o,r))});return void 0===i?s:i},e.fn.combobox.defaults={},e.fn.combobox.Constructor=n,e.fn.combobox.noConflict=function(){return e.fn.combobox=i,this},e(function(){e(window).on("load",function(){e(".combobox").each(function(){var t=e(this);t.data("combobox")||t.combobox(t.data())})}),e("body").on("mousedown.combobox.data-api",".combobox",function(){var t=e(this);t.data("combobox")||t.combobox(t.data())})})}),define("fuelux/datepicker",["require","jquery"],function(t){var e=t("jquery"),i=e.fn.datepicker,n=!1;t(["moment"],function(t){n=t},function(t){var e=t.requireModules&&t.requireModules[0];"moment"===e&&"undefined"!=typeof window.console&&window.navigator.userAgent.search("PhantomJS")<0&&(window.console.log("Don't worry if you're seeing a 404 that's looking for moment.js. The Fuel UX Datepicker is trying to use moment.js to give you extra features."),window.console.log("Checkout the Fuel UX docs (http://exacttarget.github.io/fuelux/#datepicker) to see how to integrate moment.js for more features"))});var r=function(t,i){if(this.$element=e(t),this.options=e.extend(!0,{},e.fn.datepicker.defaults,i),this.formatDate=Boolean(this.options.createInput)&&Boolean(this.options.createInput["native"])?this.formatNativeDate:this.options.formatDate||this.formatDate,this.parseDate=this.options.parseDate||this.parseDate,this.blackoutDates=this.options.blackoutDates||this.blackoutDates,this._checkForMomentJS()&&(n=n||window.moment,this.moment=!0,this.momentFormat=this.options.momentConfig.formatCode,this.setCulture(this.options.momentConfig.culture)),null!==this.options.date?(this.date=this.options.date||new Date,this.date=this.parseDate(this.date,!1),this.viewDate=new Date(this.date.valueOf()),this.stagedDate=new Date(this.date.valueOf())):(this.date=null,this.viewDate=new Date,this.stagedDate=new Date),this.inputParsingTarget=null,this.viewDate.setHours(0,0,0,0),this.stagedDate.setHours(0,0,0,0),this.done=!1,this.minDate=new Date,this.minDate.setDate(this.minDate.getDate()-1),this.minDate.setHours(0,0,0,0),this.maxDate=new Date,this.maxDate.setFullYear(this.maxDate.getFullYear()+10),this.maxDate.setHours(23,59,59,999),this.years=this._yearRange(this.viewDate),this.bindingsAdded=!1,this.options.dropdownWidth=this.options.dropdownWidth||170,this.options.monthNames=this.options.monthNames||["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.options.weekdays=this.options.weekdays||["Su","Mo","Tu","We","Th","Fr","Sa"],this.options.showYears=!1,this.options.showDays=!0,this.options.showMonths=!1,this.options.restrictLastMonth=Boolean(this.options.restrictDateSelection),this.options.restrictNextMonth=!1,this.months=[{abbreviation:this.options.monthNames[0],"class":"",number:0},{abbreviation:this.options.monthNames[1],"class":"",number:1},{abbreviation:this.options.monthNames[2],"class":"",number:2},{abbreviation:this.options.monthNames[3],"class":"",number:3},{abbreviation:this.options.monthNames[4],"class":"",number:4},{abbreviation:this.options.monthNames[5],"class":"",number:5},{abbreviation:this.options.monthNames[6],"class":"",number:6},{abbreviation:this.options.monthNames[7],"class":"",number:7},{abbreviation:this.options.monthNames[8],"class":"",number:8},{abbreviation:this.options.monthNames[9],"class":"",number:9},{abbreviation:this.options.monthNames[10],"class":"",number:10},{abbreviation:this.options.monthNames[11],"class":"",number:11}],Boolean(this.options.createInput)){if("boolean"==typeof this.options.createInput&&Boolean(this.options.createInput)&&(this.options.createInput={}),"object"!=typeof this.options.createInput||!isNaN(this.options.createInput.length))throw new Error("createInput option needs to be an object or boolean true");this.options.createInput.inputSize=this.options.createInput.inputSize||"span3",this._renderInput()}else this._render()};r.prototype={constructor:r,disable:function(){this.$element.find("input, button").attr("disabled",!0)},enable:function(){this.$element.find("input, button").attr("disabled",!1)},getFormattedDate:function(){return this.formatDate(this.date)},getDate:function(t){var i=e("input",this.$element).val();return i?Boolean(t)&&Boolean(t.unix)?this.date.getTime():this.date:null},setDate:function(t){return this.date=this.parseDate(t,!1),this.stagedDate=this.date,this.viewDate=this.date,this._render(),this.$element.trigger("changed",this.date),this.date},getCulture:function(){if(Boolean(this.moment))return n.lang();throw"moment.js is not available so you cannot use this function"},setCulture:function(t){if(!Boolean(t))return!1;if(!Boolean(this.moment))throw"moment.js is not available so you cannot use this function";n.lang(t)},getFormatCode:function(){if(Boolean(this.moment))return this.momentFormat;throw"moment.js is not available so you cannot use this function"},setFormatCode:function(t){if(!Boolean(t))return!1;if(!Boolean(this.moment))throw"moment.js is not available so you cannot use this function";this.momentFormat=t},formatDate:function(t){return Boolean(this.moment)?n(t).format(this.momentFormat):this.padTwo(t.getMonth()+1)+"-"+this.padTwo(t.getDate())+"-"+t.getFullYear()},formatNativeDate:function(t){return t.getFullYear()+"-"+this.padTwo(t.getMonth()+1)+"-"+this.padTwo(t.getDate())},parseDate:function(t,i){if(this.moment)return i=i||!1,i?n(t,this.momentFormat).isValid():("string"===e.type(t),n(t).toDate());var r,s,o,a;if(Boolean(t)&&"Invalid Date"!==new Date(t).toString())return"string"==typeof t?(t=t.split("T")[0],s=/^\s*(\d{4})-(\d\d)-(\d\d)\s*$/,r=new Date(0/0),a=s.exec(t),a&&(o=+a[2],r.setFullYear(a[1],o-1,a[3]),o!==r.getMonth()+1&&r.setTime(0/0)),r):new Date(t);throw new Error("could not parse date")},blackoutDates:function(t){return t=t,!1},padTwo:function(t){var e="0"+t;return e.substr(e.length-2)},_setNullDate:function(t){this.date=null,this.viewDate=new Date,this.stagedDate=new Date,this._insertDateIntoInput(t||""),this._renderWithoutInputManipulation()},_restrictDateSelectionSetup:function(){var t,e;Boolean(this.options)&&(this.options.restrictDateSelection?(e=this.viewDate.getMonth()<(new Date).getMonth()?!0:!1,t=this.viewDate.getMonth()>(new Date).getMonth()?!1:!0):(t=!1,e=!1)),this.options.restrictLastMonth=t,this.options.restrictNextMonth=e},_processDateRestriction:function(t,e){var i="",n=!1;return e=e||!1,t<=this.minDate||t>=this.maxDate?Boolean(this.blackoutDates(t))?(i+=" restrict blackout",n=!0):Boolean(this.options)&&Boolean(this.options.restrictDateSelection)?(i+=" restrict",n=!0):i+=" past":Boolean(this.blackoutDates(t))&&(i+=" restrict blackout",n=!0),Boolean(e)?i:n},_repeat:function(t,e,i,n){for(var r=t,s=0,o=e.length;o>s;s++)r+=i(e[s]);return r+=n},_getDaysInMonth:function(t,e){return 32-new Date(e,t,32).getDate()},_range:function(t,e){for(var i=[],n=t;e>n;n++)i[i.length]=n;return i},_yearRange:function(t){for(var e=10*Math.floor(t.getFullYear()/10)-1,i=e+12,n=this._range(e,i),r=[],s=0,o=n.length;o>s;s++){var a="";0===s&&(a="previous"),s===n.length-1&&(a="next"),r[s]={number:n[s],"class":a}}return r},_killEvent:function(t){return t.stopPropagation(),t.preventDefault(),!1},_applySize:function(t,i){for(var n=0;n<t.length;n++)e(t[n]).css({width:i,height:i,"line-height":i})},_show:function(t){return t?"":"display: none;"},_hide:function(t){return this._show(!t)},_showView:function(t){1===t?(this.options.showDays=!0,this.options.showMonths=!1,this.options.showYears=!1):2===t?(this.options.showDays=!1,this.options.showMonths=!0,this.options.showYears=!1):3===t&&(this.options.showDays=!1,this.options.showMonths=!1,this.options.showYears=!0)},_updateCalendarData:function(){var t=this.viewDate.getMonth(),e=this.viewDate.getFullYear(),i=this.stagedDate.getDate(),n=this.stagedDate.getMonth(),r=this.stagedDate.getFullYear(),s=new Date(e,t,1).getDay(),o=this._getDaysInMonth(t,e),a=this._getDaysInMonth(t-1,e);0===s&&(s=7);var l=42-o-s;this.daysOfLastMonth=this._range(a-s+1,a+1),this.daysOfNextMonth=this._range(1,l+1);for(var c=0,u=this.daysOfLastMonth.length;u>c;c++){var h={};h.number=this.daysOfLastMonth[c],h["class"]="",h["class"]=this._processDateRestriction(new Date(e,t-1,this.daysOfLastMonth[c],0,0,0,0),!0),h["class"]+=" past",this.daysOfLastMonth[c]=h}for(var d=0,p=this.daysOfNextMonth.length;p>d;d++){var f={};f.number=this.daysOfNextMonth[d],f["class"]="",f["class"]=this._processDateRestriction(new Date(e,t+1,this.daysOfNextMonth[d],0,0,0,0),!0),this.daysOfNextMonth[d]=f}var g=new Date,m=g.getDate(),v=g.getMonth(),b=g.getFullYear(),y=t===v,_=e===b,w=t===n,x=e===r,k=this._range(1,o+1);this.daysOfThisMonth=[];for(var C=0,A=k.length;A>C;C++){var T=new Date(e,t,k[C]).getDay(),S="weekday";(6===T||0===T)&&(S="weekend"),1===T&&(S=""),S+=" weekday"+T,k[C]===i&&w&&x?S+=" selected":k[C]===m&&y&&_&&(S+=" today");var M=new Date(e,t,k[C],0,0,0,0);S+=this._processDateRestriction(M,!0),this.daysOfThisMonth[this.daysOfThisMonth.length]={number:k[C],"class":S}}for(var D=this._getDaysInMonth(this.minDate.getFullYear(),this.minDate.getMonth()),$=0,E=this.months.length;E>$;$++){this.months[$]["class"]="",_&&$===v&&(this.months[$]["class"]+=" today"),$===n&&x&&(this.months[$]["class"]+=" selected");var P=new Date(e,$,D,23,59,59,999),I=new Date(e,$,0,0,0,0,0);(P<=this.minDate||I>=this.maxDate)&&Boolean(this.options.restrictDateSelection)&&(this.months[$]["class"]+=" restrict")}this.years=this._yearRange(this.viewDate),D=this._getDaysInMonth(this.minDate.getFullYear(),11);for(var N=0,F=this.years.length;F>N;N++){this.years[N].number===b&&(this.years[N]["class"]+=" today"),this.years[N].number===r&&(this.years[N]["class"]+=" selected");var O=new Date(this.years[N].number,11,D,23,59,59,999),B=new Date(this.years[N].number,0,0,0,0,0,0);(O<=this.minDate||B>=this.maxDate)&&Boolean(this.options.restrictDateSelection)&&(this.years[N]["class"]+=" restrict")}},_updateCss:function(){for(;this.options.dropdownWidth%7!==0;)this.options.dropdownWidth++;this.$view.css("width",this.options.dropdownWidth+"px"),this.$header.css("width",this.options.dropdownWidth+"px"),this.$labelDiv.css("width",this.options.dropdownWidth-60+"px"),this.$footer.css("width",this.options.dropdownWidth+"px");for(var t=.25*this.options.dropdownWidth-2,e=Math.round((this.options.dropdownWidth-3*t)/2),i=e;i+e+3*t<this.options.dropdownWidth;)i+=.1;for(;i+e+3*t>this.options.dropdownWidth;)i-=.1;e=parseInt(e/2,10),i=parseInt(i/2,10),this.$calendar.css({"float":"left"}),this.$monthsView.css({width:this.options.dropdownWidth+"px","padding-top":e+"px","padding-bottom":i+"px"}),this.$yearsView.css({width:this.options.dropdownWidth+"px","padding-top":e+"px","padding-bottom":i+"px"});var n=Math.round(this.options.dropdownWidth/7)-2+"px",r=Math.round(this.options.dropdownWidth/7)+"px";this._applySize(this.$yearsView.children(),t+"px"),this._applySize(this.$monthsView.children(),t+"px"),this._applySize(this.$weekdaysDiv.children(),r),this._applySize(this.$lastMonthDiv.children(),n),this._applySize(this.$thisMonthDiv.children(),n),this._applySize(this.$nextMonthDiv.children(),n)},_close:function(){this.$input.dropdown("toggle")},_select:function(t){return this.inputParsingTarget=null,t.target.className.indexOf("restrict")>-1?this._killEvent(t):(this._killEvent(t),this._close(),this.stagedDate=this.viewDate,this.stagedDate.setDate(parseInt(t.target.innerHTML,10)),this.setDate(this.stagedDate),void(this.done=!0))},_pickYear:function(t){var i=parseInt(e(t.target).data("yearNumber"),10);return t.target.className.indexOf("restrict")>-1?this._killEvent(t):(this.viewDate=new Date(i,this.viewDate.getMonth(),1),this._showView(2),this._render(),this._killEvent(t))},_pickMonth:function(t){var i=parseInt(e(t.target).data("monthNumber"),10);return t.target.className.indexOf("restrict")>-1?this._killEvent(t):(this.viewDate=new Date(this.viewDate.getFullYear(),i,1),this._showView(1),this._render(),this._killEvent(t))},_previousSet:function(t){this._previous(t,!0)},_previous:function(t,e){return t.target.className.indexOf("restrict")>-1?this._killEvent(t):(this.options.showDays?this.viewDate=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth()-1,1):this.options.showMonths?this.viewDate=new Date(this.viewDate.getFullYear()-1,this.viewDate.getMonth(),1):this.options.showYears&&(this.viewDate=new Date(this.viewDate.getFullYear()-10,this.viewDate.getMonth(),1)),Boolean(e)?this._select(t):this._render(),this._killEvent(t))},_nextSet:function(t){this._next(t,!0)},_next:function(t,e){return t.target.className.indexOf("restrict")>-1?this._killEvent(t):(this.options.showDays?this.viewDate=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth()+1,1):this.options.showMonths?this.viewDate=new Date(this.viewDate.getFullYear()+1,this.viewDate.getMonth(),1):this.options.showYears&&(this.viewDate=new Date(this.viewDate.getFullYear()+10,this.viewDate.getMonth(),1)),Boolean(e)?this._select(t):this._render(),this._killEvent(t))},_today:function(t){return this.viewDate=new Date,this._showView(1),this._render(),this._killEvent(t)},_emptySpace:function(t){return Boolean(this.done)&&(this.done=!1),this._killEvent(t)},_monthLabel:function(){return this.options.monthNames[this.viewDate.getMonth()]},_yearLabel:function(){return this.viewDate.getFullYear()},_monthYearLabel:function(){var t;return this.options.showDays?t=this._monthLabel()+" "+this._yearLabel():this.options.showMonths?t=this._yearLabel():this.options.showYears&&(t=this.years[0].number+" - "+this.years[this.years.length-1].number),t},_toggleMonthYearPicker:function(t){return this.options.showDays?this._showView(2):this.options.showMonths?this._showView(3):this.options.showYears&&this._showView(1),this._render(),this._killEvent(t)},_renderCalendar:function(){var t=this;return t._restrictDateSelectionSetup(),'<div class="calendar"><div class="header clearfix"><div class="left hover"><div class="leftArrow"></div></div><div class="right hover"><div class="rightArrow"></div></div><div class="center hover">'+t._monthYearLabel()+'</div></div><div class="daysView" style="'+t._show(t.options.showDays)+'">'+t._repeat('<div class="weekdays">',t.options.weekdays,function(t){return"<div >"+t+"</div>"},"</div>")+t._repeat('<div class="lastmonth">',t.daysOfLastMonth,function(e){return t.options.restrictLastMonth&&(e["class"]=e["class"].replace("restrict","")+" restrict"),'<div class="'+e["class"]+'">'+e.number+"</div>"},"</div>")+t._repeat('<div class="thismonth">',t.daysOfThisMonth,function(t){return'<div class="'+t["class"]+'">'+t.number+"</div>"},"</div>")+t._repeat('<div class="nextmonth">',t.daysOfNextMonth,function(e){return t.options.restrictNextMonth&&(e["class"]=e["class"].replace("restrict","")+" restrict"),'<div class="'+e["class"]+'">'+e.number+"</div>"},"</div>")+"</div>"+t._repeat('<div class="monthsView" style="'+t._show(t.options.showMonths)+'">',t.months,function(t){return'<div data-month-number="'+t.number+'" class="'+t["class"]+'">'+t.abbreviation+"</div>"},"</div>")+t._repeat('<div class="yearsView" style="'+t._show(t.options.showYears)+'">',t.years,function(t){return'<div data-year-number="'+t.number+'" class="'+t["class"]+'">'+t.number+"</div>"},"</div>")+'<div class="footer"><div class="center hover">Today</div></div></div>'},_render:function(){this._insertDateIntoInput(),this._updateCalendarData(),Boolean(this.bindingsAdded)&&this._removeBindings(),this.$element.find(".dropdown-menu").html(this._renderCalendar()),this._initializeCalendarElements(),this._addBindings(),this._updateCss()},_renderWithoutInputManipulation:function(){this._updateCalendarData(),Boolean(this.bindingsAdded)&&this._removeBindings(),this.$element.find(".dropdown-menu").html(this._renderCalendar()),this._initializeCalendarElements(),this._addBindings(),this._updateCss()},_renderInput:function(){var t=Boolean(this.options.createInput["native"])?this._renderInputNative():this._renderInputHTML();this.$element.html(t),this._render()},_renderInputNative:function(){return'<input type="date" value="'+this.formatDate(this.date)+'"'+this._calculateInputSize(["native"])+">"},_renderInputHTML:function(){var t=Boolean(this.options.createInput.dropDownBtn)?"input-append":"input-group",e='<div class="'+t+'"><div class="dropdown-menu"></div><input type="text" '+this._calculateInputSize()+' value="'+this.formatDate(this.date)+'" data-toggle="dropdown">';return Boolean(this.options.createInput.dropDownBtn)&&(e+='<button type="button" class="btn" data-toggle="dropdown"><i class="icon-calendar"></i></button>'),e+="</div>",'<div class="datepicker dropdown">'+e+"</div>"},_calculateInputSize:function(t){return Boolean(parseInt(this.options.createInput.inputSize,10))?'style="width:'+this.options.createInput.inputSize+'px"':(t=Boolean(t)?" "+t.join(" "):"",'class="'+this.options.createInput.inputSize+t+'"')},_insertDateIntoInput:function(t){var e;e=Boolean(t)?this.formatDate(this.stagedDate):null!==this.date?this.formatDate(this.date):"",this.$element.find('input[type="text"]').val(e)},_inputDateParsing:function(){var t=this.$input.val(),e=!0,i=10,n=i-2;t.length>=n&&t.length<=i?Boolean(this.parseDate(t,!0))&&(this._processDateRestriction(this.parseDate(t))||(e=!1,this.setDate(t))):e=!1,e&&(this._setNullDate(!0),this.$element.trigger("inputParsingFailed"))},_checkForMomentJS:function(){return(e.isFunction(window.moment)||"undefined"!=typeof n&&e.isFunction(n))&&e.isPlainObject(this.options.momentConfig)&&Boolean(this.options.momentConfig.culture)&&Boolean(this.options.momentConfig.formatCode)?!0:!1},_initializeCalendarElements:function(){this.$input=this.$element.find('input[type="text"]'),this.$calendar=this.$element.find("div.calendar"),this.$header=this.$calendar.children().eq(0),this.$labelDiv=this.$header.children().eq(2),this.$view=this.$calendar.children().eq(1),this.$monthsView=this.$calendar.children().eq(2),this.$yearsView=this.$calendar.children().eq(3),this.$weekdaysDiv=this.$view.children().eq(0),this.$lastMonthDiv=this.$view.children().eq(1),this.$thisMonthDiv=this.$view.children().eq(2),this.$nextMonthDiv=this.$view.children().eq(3),this.$footer=this.$calendar.children().eq(4)},_addBindings:function(){var t=this;Boolean(this.moment)&&(this.$calendar.on("mouseover",function(){t.inputParsingTarget="calendar"}),this.$calendar.on("mouseout",function(){t.inputParsingTarget=null}),this.$input.on("blur",function(){null===t.inputParsingTarget&&t._inputDateParsing()})),this.$calendar.on("click",e.proxy(this._emptySpace,this)),this.$header.find(".left").on("click",e.proxy(this._previous,this)),this.$header.find(".right").on("click",e.proxy(this._next,this)),this.$header.find(".center").on("click",e.proxy(this._toggleMonthYearPicker,this)),this.$lastMonthDiv.find("div").on("click",e.proxy(this._previousSet,this)),this.$thisMonthDiv.find("div").on("click",e.proxy(this._select,this)),this.$nextMonthDiv.find("div").on("click",e.proxy(this._nextSet,this)),this.$monthsView.find("div").on("click",e.proxy(this._pickMonth,this)),this.$yearsView.find("div").on("click",e.proxy(this._pickYear,this)),this.$footer.find(".center").on("click",e.proxy(this._today,this)),this.bindingsAdded=!0},_removeBindings:function(){Boolean(this.moment)&&(this.$calendar.off("mouseover"),this.$calendar.off("mouseout"),this.$input.off("blur")),this.$calendar.off("click"),this.$header.find(".left").off("click"),this.$header.find(".right").off("click"),this.$header.find(".center").off("click"),this.$lastMonthDiv.find("div").off("click"),this.$thisMonthDiv.find("div").off("click"),this.$nextMonthDiv.find("div").off("click"),this.$monthsView.find("div").off("click"),this.$yearsView.find("div").off("click"),this.$footer.find(".center").off("click"),this.bindingsAdded=!1}},e.fn.datepicker=function(t){var i,n=Array.prototype.slice.call(arguments,1),s=this.each(function(){var s=e(this),o=s.data("datepicker"),a="object"==typeof t&&t;o||s.data("datepicker",o=new r(this,a)),"string"==typeof t&&(i=o[t].apply(o,n))});return void 0===i?s:i},e.fn.datepicker.defaults={date:new Date,momentConfig:{culture:"en",formatCode:"L"},createInput:!1,dropdownWidth:170,restrictDateSelection:!0},e.fn.datepicker.Constructor=r,e.fn.datepicker.noConflict=function(){return e.fn.datepicker=i,this}}),define("fuelux/radio",["require","jquery"],function(t){var e=t("jquery"),i=e.fn.radio,n=function(t,i){this.$element=e(t),this.options=e.extend({},e.fn.radio.defaults,i),this.$label=this.$element.parent(),this.$icon=this.$label.find("i"),this.$radio=this.$label.find("input[type=radio]"),this.groupName=this.$radio.attr("name"),this.setState(this.$radio),this.$radio.on("change",e.proxy(this.itemchecked,this))};n.prototype={constructor:n,setState:function(t){t=t||this.$radio;var e=t.is(":checked"),i=!!t.prop("disabled");this.$icon.removeClass("checked disabled"),this.$label.removeClass("checked"),e===!0&&(this.$icon.addClass("checked"),this.$label.addClass("checked")),i===!0&&this.$icon.addClass("disabled")},resetGroup:function(){var t=e('input[name="'+this.groupName+'"]');t.next().removeClass("checked"),t.parent().removeClass("checked")},enable:function(){this.$radio.attr("disabled",!1),this.$icon.removeClass("disabled")},disable:function(){this.$radio.attr("disabled",!0),this.$icon.addClass("disabled")},itemchecked:function(t){var i=e(t.target);this.resetGroup(),this.setState(i)},check:function(){this.resetGroup(),this.$radio.prop("checked",!0),this.setState(this.$radio)},uncheck:function(){this.$radio.prop("checked",!1),this.setState(this.$radio)},isChecked:function(){return this.$radio.is(":checked")}},e.fn.radio=function(t){var i,r=Array.prototype.slice.call(arguments,1),s=this.each(function(){var s=e(this),o=s.data("radio"),a="object"==typeof t&&t;o||s.data("radio",o=new n(this,a)),"string"==typeof t&&(i=o[t].apply(o,r))});return void 0===i?s:i},e.fn.radio.defaults={},e.fn.radio.Constructor=n,e.fn.radio.noConflict=function(){return e.fn.radio=i,this},e(function(){e(window).on("load",function(){e(".radio-custom > input[type=radio]").each(function(){var t=e(this);t.data("radio")||t.radio(t.data())})})})}),define("fuelux/select",["require","jquery","./util"],function(t){var e=t("jquery"),i=e.fn.select;t("./util");var n=function(t,i){this.$element=e(t),this.options=e.extend({},e.fn.select.defaults,i),this.$element.on("click","a",e.proxy(this.itemclicked,this)),this.$button=this.$element.find(".btn"),this.$hiddenField=this.$element.find(".hidden-field"),this.$label=this.$element.find(".dropdown-label"),this.setDefaultSelection(),"auto"===i.resize&&this.resize()};n.prototype={constructor:n,itemclicked:function(t){this.$selectedItem=e(t.target).parent(),this.$hiddenField.val(this.$selectedItem.attr("data-value")),this.$label.text(this.$selectedItem.text());var i=this.selectedItem();this.$element.trigger("changed",i),t.preventDefault()},resize:function(){var t=0,i=e("<div/>").addClass("select-sizer"),n=0;Boolean(e(document).find("html").hasClass("fuelux"))?e(document.body).append(i):e(".fuelux:first").append(i),this.$element.find("a").each(function(){i.text(e(this).text()),t=i.outerWidth(),t>n&&(n=t)}),i.remove(),this.$label.width(n)},selectedItem:function(){var t=this.$selectedItem.text();return e.extend({text:t},this.$selectedItem.data())},selectByText:function(t){var e="li a:fuelTextExactCI("+t+")";this.selectBySelector(e)},selectByValue:function(t){var e='li[data-value="'+t+'"]';this.selectBySelector(e)},selectByIndex:function(t){var e="li:eq("+t+")";this.selectBySelector(e)},selectBySelector:function(t){var e=this.$element.find(t);this.$selectedItem=e,this.$hiddenField.val(this.$selectedItem.attr("data-value")),this.$label.text(this.$selectedItem.text())},setDefaultSelection:function(){var t="li[data-selected=true]:first",e=this.$element.find(t);0===e.length?this.selectByIndex(0):(this.selectBySelector(t),e.removeData("selected"),e.removeAttr("data-selected"))
},enable:function(){this.$button.removeClass("disabled")},disable:function(){this.$button.addClass("disabled")}},e.fn.select=function(t){var i,r=Array.prototype.slice.call(arguments,1),s=this.each(function(){var s=e(this),o=s.data("select"),a="object"==typeof t&&t;o||s.data("select",o=new n(this,a)),"string"==typeof t&&(i=o[t].apply(o,r))});return void 0===i?s:i},e.fn.select.defaults={},e.fn.select.Constructor=n,e.fn.select.noConflict=function(){return e.fn.select=i,this},e(function(){e(window).on("load",function(){e(".select").each(function(){var t=e(this);t.data("select")||t.select(t.data())})}),e("body").on("mousedown.select.data-api",".select",function(){var t=e(this);t.data("select")||t.select(t.data())})})}),define("fuelux/spinner",["require","jquery"],function(t){var e=t("jquery"),i=e.fn.spinner,n=function(t,i){this.$element=e(t),this.options=e.extend({},e.fn.spinner.defaults,i),this.$input=this.$element.find(".spinner-input"),this.$element.on("keyup",this.$input,e.proxy(this.change,this)),this.$element.on("keydown",this.$input,e.proxy(this.keydown,this)),this.options.hold?(this.$element.on("mousedown",".spinner-up",e.proxy(function(){this.startSpin(!0)},this)),this.$element.on("mouseup",".spinner-up, .spinner-down",e.proxy(this.stopSpin,this)),this.$element.on("mouseout",".spinner-up, .spinner-down",e.proxy(this.stopSpin,this)),this.$element.on("mousedown",".spinner-down",e.proxy(function(){this.startSpin(!1)},this))):(this.$element.on("click",".spinner-up",e.proxy(function(){this.step(!0)},this)),this.$element.on("click",".spinner-down",e.proxy(function(){this.step(!1)},this))),this.$element.find(".spinner-up, .spinner-down").attr("tabIndex",-1),this.switches={count:1,enabled:!0},this.switches.speed="medium"===this.options.speed?300:"fast"===this.options.speed?100:500,this.lastValue=null,this.render(),this.options.disabled&&this.disable()};n.prototype={constructor:n,render:function(){var t=this.$input.val();t?this.value(t):this.$input.val(this.options.value),this.$input.attr("maxlength",(this.options.max+"").split("").length)},change:function(){var t=this.$input.val();t/1?this.options.value=t/1:(t=t.replace(/[^0-9]/g,"")||"",this.$input.val(t),this.options.value=t/1),this.triggerChangedEvent()},stopSpin:function(){void 0!==this.switches.timeout&&(clearTimeout(this.switches.timeout),this.switches.count=1,this.triggerChangedEvent())},triggerChangedEvent:function(){var t=this.value();t!==this.lastValue&&(this.lastValue=t,this.$element.trigger("changed",t),this.$element.trigger("change"))},startSpin:function(t){if(!this.options.disabled){var i=this.switches.count;1===i?(this.step(t),i=1):i=3>i?1.5:8>i?2.5:4,this.switches.timeout=setTimeout(e.proxy(function(){this.iterator(t)},this),this.switches.speed/i),this.switches.count++}},iterator:function(t){this.step(t),this.startSpin(t)},step:function(t){var e,i,n=this.options.value,r=t?this.options.max:this.options.min;if(t?r>n:n>r){var s=n+(t?1:-1)*this.options.step;this.options.step%1!==0&&(e=(this.options.step+"").split(".")[1].length,i=Math.pow(10,e),s=Math.round(s*i)/i),this.value((t?s>r:r>s)?r:s)}else if(this.options.cycle){var o=t?this.options.min:this.options.max;this.value(o)}},setOptions:function(t){for(var e in t)t.hasOwnProperty(e)&&(this.options[e]=t[e])},value:function(t){return!isNaN(parseFloat(t))&&isFinite(t)?(t=parseFloat(t),this.options.value=t,this.$input.val(t),this):this.options.value},disable:function(){this.options.disabled=!0,this.$input.attr("disabled",""),this.$element.find("button").addClass("disabled")},enable:function(){this.options.disabled=!1,this.$input.removeAttr("disabled"),this.$element.find("button").removeClass("disabled")},keydown:function(t){var e=t.keyCode;38===e?this.step(!0):40===e&&this.step(!1)}},e.fn.spinner=function(t){var i,r=Array.prototype.slice.call(arguments,1),s=this.each(function(){var s=e(this),o=s.data("spinner"),a="object"==typeof t&&t;o||s.data("spinner",o=new n(this,a)),"string"==typeof t&&(i=o[t].apply(o,r))});return void 0===i?s:i},e.fn.spinner.defaults={value:1,min:1,max:999,step:1,hold:!0,speed:"medium",disabled:!1},e.fn.spinner.Constructor=n,e.fn.spinner.noConflict=function(){return e.fn.spinner=i,this},e(function(){e("body").on("mousedown.spinner.data-api",".spinner",function(){var t=e(this);t.data("spinner")||t.spinner(t.data())})})}),define("fuelux/scheduler",["require","jquery","fuelux/combobox","fuelux/datepicker","fuelux/radio","fuelux/select","fuelux/spinner"],function(t){var e=t("jquery"),i=e.fn.scheduler;t("fuelux/combobox"),t("fuelux/datepicker"),t("fuelux/radio"),t("fuelux/select"),t("fuelux/spinner");var n=function(t,i){function n(t,e){var i=1;return-1!==t.indexOf("-")&&(i*=-1),Number(e)*i}var r=this;this.$element=e(t),this.options=e.extend({},e.fn.scheduler.defaults,i),this.$startDate=this.$element.find(".scheduler-start .datepicker"),this.$startTime=this.$element.find(".scheduler-start .combobox"),this.$timeZone=e(".scheduler-timezone select"),this.$repeatIntervalPanel=this.$element.find(".repeat-interval-panel"),this.$repeatIntervalSelect=this.$element.find(".repeat-interval .select"),this.$repeatIntervalSpinner=this.$element.find(".repeat-interval-panel .spinner"),this.$repeatIntervalTxt=this.$element.find(".repeat-interval-text"),this.$end=this.$element.find(".scheduler-end"),this.$endAfter=this.$end.find(".spinner"),this.$endSelect=this.$end.find(".select"),this.$endDate=this.$end.find(".datepicker"),this.$recurrencePanels=this.$element.find(".recurrence-panel"),this.$element.find(".scheduler-weekly .btn-group .btn").on("click",function(t,e){r.changed(t,e,!0)}),this.$element.find(".combobox").on("changed",e.proxy(this.changed,this)),this.$element.find(".datepicker").on("changed",e.proxy(this.changed,this)),this.$element.find(".select").on("changed",e.proxy(this.changed,this)),this.$element.find(".spinner").on("changed",e.proxy(this.changed,this)),this.$element.find(".scheduler-monthly label.radio, .scheduler-yearly label.radio").on("mouseup",e.proxy(this.changed,this)),this.$repeatIntervalSelect.on("changed",e.proxy(this.repeatIntervalSelectChanged,this)),this.$endSelect.on("changed",e.proxy(this.endSelectChanged,this)),this.$startDate.datepicker({date:null}),this.$startTime.combobox(),this.$element.find(".radio").radio();var s={dropdownAutoWidth:!0,ping:"pong",sortResults:function(t){return t=t.sort(function(t,e){t=t.text,e=e.text;var i,r,s=t.split(/\+|-/),o=e.split(/\+|-/);return s.length>1&&o.length>1&&s[0]==o[0]?(i=n(t,s[1]),r=n(e,o[1]),i>r?1:r>i?-1:0):t>e?1:e>t?-1:0})}};this.$timeZone.select2(s)};n.prototype={constructor:n,changed:function(t,i,n){n||t.stopPropagation(),this.$element.trigger("changed",{data:void 0!==i?i:e(t.currentTarget).data(),originalEvent:t,value:this.getValue()})},disable:function(){this.toggleState("disable")},enable:function(){this.toggleState("enable")},endSelectChanged:function(t,e){var i,n;e?n=e.value:(i=this.$endSelect.select("selectedItem"),n=i.value),this.$endAfter.hide(),this.$endDate.hide(),"after"===n?this.$endAfter.show():"date"===n&&this.$endDate.show()},getValue:function(){var t,i,n,r,s,o,a,l=this.$repeatIntervalSpinner.spinner("value"),c="",u=this.$repeatIntervalSelect.select("selectedItem").value,h=this.$startTime.combobox("selectedItem").text.toLowerCase(),d=this.$timeZone.val(),p=function(t,e){var i,n="";return n+=t.getFullYear(),n+=e,i=t.getMonth()+1,n+=10>i?"0"+i:i,n+=e,i=t.getDate(),n+=10>i?"0"+i:i},f="",g=this.$startDate.datepicker("getDate");g&&(f=""+p(g,"-"),f+="T",n=h.search("am")>=0,r=h.search("pm")>=0,h=e.trim(h.replace(/am/g,"").replace(/pm/g,"")).split(":"),h[0]=parseInt(h[0],10),h[1]=parseInt(h[1],10),n&&h[0]>11?h[0]=0:r&&h[0]<12&&(h[0]+=12),f+=h[0]<10?"0"+h[0]:h[0],f+=":",f+=h[1]<10?"0"+h[1]:h[1],f+=moment().tz(d).format("Z")),"none"===u?c="FREQ=DAILY;INTERVAL=1;COUNT=1;":"minutely"===u?(c="FREQ=MINUTELY;",c+="INTERVAL="+l+";"):"hourly"===u?(c="FREQ=HOURLY;",c+="INTERVAL="+l+";"):"daily"===u?(c+="FREQ=DAILY;",c+="INTERVAL="+l+";"):"weekdays"===u?(c+="FREQ=DAILY;",c+="BYDAY=MO,TU,WE,TH,FR;",c+="INTERVAL=1;"):"weekly"===u?(i=[],this.$element.find(".scheduler-weekly .btn-group button.active").each(function(){i.push(e(this).data().value)}),c+="FREQ=WEEKLY;",c+="BYDAY="+i.join(",")+";",c+="INTERVAL="+l+";"):"monthly"===u?(c+="FREQ=MONTHLY;",c+="INTERVAL="+l+";",a=parseInt(this.$element.find("input[name=scheduler-month]:checked").val(),10),1===a?(t=parseInt(this.$element.find(".scheduler-monthly-date .select").select("selectedItem").text,10),c+="BYMONTHDAY="+t+";"):2===a&&(i=this.$element.find(".month-days").select("selectedItem").value,o=this.$element.find(".month-day-pos").select("selectedItem").value,c+="BYDAY="+i+";",c+="BYSETPOS="+o+";")):"yearly"===u&&(c+="FREQ=YEARLY;",a=parseInt(this.$element.find("input[name=scheduler-year]:checked").val(),10),1===a?(s=this.$element.find(".scheduler-yearly-date .year-month").select("selectedItem").value,t=this.$element.find(".year-month-day").select("selectedItem").text,c+="BYMONTH="+s+";",c+="BYMONTHDAY="+t+";"):2===a&&(i=this.$element.find(".year-month-days").select("selectedItem").value,o=this.$element.find(".year-month-day-pos").select("selectedItem").value,s=this.$element.find(".scheduler-yearly-day .year-month").select("selectedItem").value,c+="BYDAY="+i+";",c+="BYSETPOS="+o+";",c+="BYMONTH="+s+";"));var m=this.$endSelect.select("selectedItem").value,v="";"none"!==u&&("after"===m?v="COUNT="+this.$endAfter.spinner("value")+";":"date"===m&&(v="UNTIL="+p(this.$endDate.datepicker("getDate"),"")+";")),c+=v;var b={startDateTime:f,timeZone:{name:d,offset:moment().tz(d).format("Z")},recurrencePattern:c};return b},repeatIntervalSelectChanged:function(t,e,i){var n,r,s,i;switch(e?(r=e.value,s=e.text):(n=this.$repeatIntervalSelect.select("selectedItem"),r=n.value,s=n.text),this.$repeatIntervalTxt.text(s),r.toLowerCase()){case"hourly":case"daily":case"weekly":case"monthly":this.$repeatIntervalSpinner.spinner("value",i||1),this.$repeatIntervalSpinner.spinner("setOptions",{step:1,min:1,max:999}),this.$repeatIntervalPanel.show();break;case"minutely":this.$repeatIntervalSpinner.spinner("value",i||5),this.$repeatIntervalSpinner.spinner("setOptions",{min:5,step:5,max:30}),this.$repeatIntervalPanel.show();break;default:this.$repeatIntervalPanel.hide()}this.$recurrencePanels.hide(),this.$element.find(".scheduler-"+r).show(),"none"===r?this.$end.hide():this.$end.show()},setValue:function(t){var i,n,r,s,o,a,l,c;if(t.startDateTime&&(c=t.startDateTime.split("T"),this.$startDate.datepicker("setDate",c[0]),c[1]&&(c[1]=c[1].split(":"),i=parseInt(c[1][0],10),o=c[1][1]?parseInt(c[1][1].split("+")[0].split("-")[0].split("Z")[0],10):0,a=12>i?"AM":"PM",0===i?i=12:i>12&&(i-=12),o=10>o?"0"+o:o,c=i+":"+o+" "+a,this.$startTime.find("input").val(c),this.$startTime.combobox("selectByText",c))),r="li[data",this.$timeZone.select2("val",userSettings.timezone),t.timeZone?this.$timeZone.select2("val",t.timeZone.name):t.startDateTime&&(c=t.startDateTime.split("T")[1],c=c?c.search(/\+/)>-1?"+"+e.trim(c.split("+")[1]):c.search(/\-/)>-1?"-"+e.trim(c.split("-")[1]):"+00:00":"+00:00",r+='-offset="'+c+'"]',this.$timeZone.select("selectBySelector",r)),t.recurrencePattern){for(l={},c=t.recurrencePattern.toUpperCase().split(";"),n=0,s=c.length;s>n;n++)""!==c[n]&&(r=c[n].split("="),l[r[0]]=r[1]);if("DAILY"===l.FREQ)r="MO,TU,WE,TH,FR"===l.BYDAY?"weekdays":"1"===l.INTERVAL&&"1"===l.COUNT?"none":"daily";else if("HOURLY"===l.FREQ)r="hourly";else if("MINUTELY"===l.FREQ)r="minutely",this.$repeatIntervalSpinner.spinner("value",15),this.$repeatIntervalSpinner.spinner("setOptions",{min:15,step:15,max:30});else if("WEEKLY"===l.FREQ){if(l.BYDAY)for(r=this.$element.find(".scheduler-weekly .btn-group"),r.find("button").removeClass("active"),c=l.BYDAY.split(","),n=0,s=c.length;s>n;n++)r.find('button[data-value="'+c[n]+'"]').addClass("active");r="weekly"}else"MONTHLY"===l.FREQ?(this.$element.find(".scheduler-monthly input").removeClass("checked"),l.BYMONTHDAY?(c=this.$element.find(".scheduler-monthly-date"),c.find("input").addClass("checked"),c.find(".select").select("selectByValue",l.BYMONTHDAY)):l.BYDAY&&(c=this.$element.find(".scheduler-monthly-day"),c.find("input").addClass("checked"),l.BYSETPOS&&c.find(".month-day-pos").select("selectByValue",l.BYSETPOS),c.find(".month-days").select("selectByValue",l.BYDAY)),r="monthly"):"YEARLY"===l.FREQ?(this.$element.find(".scheduler-yearly input").removeClass("checked"),l.BYMONTHDAY?(c=this.$element.find(".scheduler-yearly-date"),c.find("input").addClass("checked"),l.BYMONTH&&c.find(".year-month").select("selectByValue",l.BYMONTH),c.find(".year-month-day").select("selectByValue",l.BYMONTHDAY)):l.BYSETPOS&&(c=this.$element.find(".scheduler-yearly-day"),c.find("input").addClass("checked"),c.find(".year-month-day-pos").select("selectByValue",l.BYSETPOS),l.BYDAY&&c.find(".year-month-days").select("selectByValue",l.BYDAY),l.BYMONTH&&c.find(".year-month").select("selectByValue",l.BYMONTH)),r="yearly"):r="none";l.COUNT?(this.$endAfter.spinner("value",parseInt(l.COUNT,10)),this.$endSelect.select("selectByValue","after")):l.UNTIL&&(c=l.UNTIL,8===c.length&&(c=c.split(""),c.splice(4,0,"-"),c.splice(7,0,"-"),c=c.join("")),this.$endDate.datepicker("setDate",c),this.$endSelect.select("selectByValue","date")),this.endSelectChanged();var u;l.INTERVAL&&(u=parseInt(l.INTERVAL,10)),this.$repeatIntervalSelect.select("selectByValue",r),this.repeatIntervalSelectChanged(null,null,u)}},toggleState:function(t){this.$element.find(".combobox").combobox(t),this.$element.find(".datepicker").datepicker(t),this.$element.find(".select").select(t),this.$element.find(".spinner").spinner(t),this.$element.find(".radio").radio(t),t="disable"===t?"addClass":"removeClass",this.$element.find(".scheduler-weekly .btn-group")[t]("disabled")},value:function(t){return t?this.setValue(t):this.getValue()}},e.fn.scheduler=function(t){var i,r=Array.prototype.slice.call(arguments,1),s=this.each(function(){var s=e(this),o=s.data("scheduler"),a="object"==typeof t&&t;o||s.data("scheduler",o=new n(this,a)),"string"==typeof t&&(i=o[t].apply(o,r))});return void 0===i?s:i},e.fn.scheduler.defaults={},e.fn.scheduler.Constructor=n,e.fn.scheduler.noConflict=function(){return e.fn.scheduler=i,this},e(function(){e("body").on("mousedown.scheduler.data-api",".scheduler",function(){var t=e(this);t.data("scheduler")||t.scheduler(t.data())})})}),require.config({baseUrl:"/static/js",paths:{jquery:"vendor/jquery/jquery-min",jquery_b64:"vendor/jquery/jquery.base64.min",bootstrap:"vendor/bootstrap/bootstrap-bundle",moment:"vendor/moment.min",momenttz:"vendor/moment-timezone.min",underscore:"vendor/underscore/underscore-1.8.1",backbone:"vendor/backbone/backbone-min",sessionstorage:"vendor/backbone/backbone.sessionStorage","backbone.validator":"vendor/backbone/backbone-validation-amd-min",d3:"vendor/d3/d3.min",select2:"vendor/select2",templar2:"vendor/templar2",bipclient:"client",redactor:"vendor/redactor/redactor",fuelux:"vendor/fuelux",c_domain:"collections/domain/c_domain_all",c_channel:"collections/channel/c_channel_all",c_channel_bip_list:"collections/channel/c_channel_bip_list",c_mount_local:"collections/mount/c_mount_local",c_bip:"collections/bip/c_bip_all",c_bip_desc:"collections/bip/c_bip_descriptions",c_bip_share:"collections/bip/c_bip_share",c_bip_log:"collections/bip/c_bip_log",c_channel_log:"collections/channel/c_channel_log",c_pod:"collections/channel/c_pod_all",wotadmin_hub:"vendor/wotadmin-hub"},shim:{backbone:{deps:["underscore","jquery"],exports:"Backbone"},templar2:{deps:["jquery"]},bootstrap:["jquery"],"backbone.validator":{deps:["backbone"]},d3:{exports:"d3"},bipclient:{exports:"BipClient"},jquery_b64:{deps:["jquery"]},moment:{deps:["jquery"]},momenttz:{deps:["jquery","moment"]},redactor:{deps:["jquery"]},select2:{deps:["jquery"]},wotadmin_hub:{exports:["WotAdmin_Hub"]}}}),require(["underscore","backbone","dash","bipclient","c_domain","c_channel","c_pod","c_bip","c_bip_desc","c_bip_share","c_mount_local","backbone.validator","bootstrap","moment","momenttz","redactor","select2","fuelux/scheduler"],function(t,e,i,n,r,s,o,a,l,c,u){function h(){w++,w>5?window.location="/timeout":setTimeout(function(){p()},2e3)}function d(){$.when(g.fetch({success:function(){n.decorateChannels()}}),f.fetch(),m.fetch(),v.fetch(),y.fetch({success:function(){n.decorateChannels()}})).done(function(){i.initialize()}),b.fetch({reset:!0})}function p(){n.init().then(function(){_.fetch({success:function(t){var e=t.where({active:!0}).shift();e&&n.setCredentials(e.get("username"),e.get("token"),e.get("url")),d()}})},function(){h()})}t.extend(e.Model.prototype,e.Validation.mixin);var f=new r;n.setCollection("domain",f);var g=new s;n.setCollection("channel",g);var m=new a;n.setCollection("bip",m);var v=new l;n.setCollection("bip_descriptions",v);var b=new c;n.setCollection("bip_shares",b);var y=new o;n.setCollection("pod",y);var _=new u,w=0;p()}),define("dash-main",function(){});
//# sourceMappingURL=dash-built.js
//# sourceMappingURL=dash-built.js.map